import { __decorate } from "tslib";
import { Component, Input, ViewChild, Output, EventEmitter } from '@angular/core';
import { ControllerService } from './services/controller.service';
import { MenuService } from './menu/menu.service';
import { ModelService } from './services/model.service';
import { ExportService } from './services/export.service';
import { FormService } from './forms/form.service';
import { ApiService } from './services/api.service';
import { PrintService } from './services/print.service';
import { DashboardService } from './services/dashboard.service';
import { StiHttpClientService } from './services/http-client.service';
import { StylesService } from './services/styles.service';
import { HelperService } from './services/helper.service';
import { MouseService } from './services/mouse.service';
import { PageService } from './services/page.service';
import { TooltipService } from './services/tooltip.service';
import { FindService } from './services/find.service';
import { AnimationService } from './services/animation.service';
import { InteractionsService } from './services/interactions.service';
import { RadioButtonService } from './services/radio-button.service';
import { CollectionsService } from './services/collections.service';
import { MailService } from './services/mail.service';
import { EditableFieldsService } from './services/editable-fields.service';
import { DrillDownService } from './services/drill-down.service';
import { Md5Service } from './services/md5.service';
import { FullScreenService } from './services/full-screen.service';
import { ToolbarService } from './services/toolbar.service';
//1bfb351c1add27b1537ffce9c723e3cb1f5b27bb 02.03.2021 17:29:20
let StimulsoftViewerComponent = class StimulsoftViewerComponent {
    constructor(controller, menuService, model, exportService, formService, api, printService, dashboardService) {
        this.controller = controller;
        this.menuService = menuService;
        this.model = model;
        this.exportService = exportService;
        this.formService = formService;
        this.api = api;
        this.printService = printService;
        this.dashboardService = dashboardService;
        /**
         * Occurs when report/dashboard loaded
         */
        this.loaded = new EventEmitter();
        /**
         * Occurs on error, $event is ErrorMessage object contains error: string & type: any  (if present)
         */
        this.error = new EventEmitter();
        /**
         * Occurs on export, $event object contains exportFormat: string & exportSettings: {}
         */
        this.export = new EventEmitter();
        /**
         * Occurs on export & email, $event object contains exportFormat: string & exportSettings: {}
         */
        this.email = new EventEmitter();
        /**
         * Occurs on export & email, $event object contains format: string : 'PrintPdf' or 'PrintWithoutPreview' or 'PrintWithPreview'
         */
        this.print = new EventEmitter();
        /**
         * Occurs on pressing 'Design' button
         */
        this.design = new EventEmitter();
        /**
         * Viewer background color
         */
        this.backgroundColor = 'White';
        this.initialized = false;
        this.viewInit = false;
        window.onresize = () => this.resize();
        this.initEvents();
    }
    ngOnChanges(changes) {
        this.loadViewer();
    }
    ngOnInit() {
        this.controller.getMessage().subscribe((message) => {
            switch (message.action) {
                case 'viewer_loaded':
                    this.initialized = true;
                    break;
            }
        });
    }
    ngAfterViewInit() {
        this.viewInit = true;
        this.loadViewer();
    }
    initEvents() {
        this.controller.getMessage().subscribe((message) => {
            switch (message.action) {
                case 'GetReport':
                case 'OpenReport':
                    setTimeout(() => {
                        this.loaded.next();
                    });
                    break;
            }
        });
        this.controller.getActionMessage().subscribe((message) => {
            switch (message.action) {
                case 'Error':
                    setTimeout(() => {
                        this.error.next(this.model.errorMessage);
                    });
                    break;
                case 'ExportReport':
                    setTimeout(() => {
                        this.export.next(message.data);
                    });
                    break;
                case 'Email':
                    setTimeout(() => {
                        this.email.next(message.data);
                    });
                    break;
                case 'Print':
                    setTimeout(() => {
                        this.print.next(message.data);
                    });
                    break;
                case 'Design':
                    setTimeout(() => {
                        this.design.next();
                    });
                    break;
            }
        });
    }
    loadViewer() {
        if (this.viewInit) {
            this.model.requestUrl = this.requestUrl;
            this.model.action = this.action;
            this.model.properties = this.properties;
            this.controller.loadViewer();
            this.resize();
            this.model.controls.viewer.el = this.viewerElement;
        }
    }
    resize() {
        var _a;
        if ((_a = this.viewerElement) === null || _a === void 0 ? void 0 : _a.nativeElement) {
            this.model.viewerSize = { width: this.viewerElement.nativeElement.offsetWidth, height: this.viewerElement.nativeElement.offsetHeight };
            this.controller.viewerResized();
        }
    }
};
StimulsoftViewerComponent.ctorParameters = () => [
    { type: ControllerService },
    { type: MenuService },
    { type: ModelService },
    { type: ExportService },
    { type: FormService },
    { type: ApiService },
    { type: PrintService },
    { type: DashboardService }
];
__decorate([
    ViewChild('viewer')
], StimulsoftViewerComponent.prototype, "viewerElement", void 0);
__decorate([
    Output()
], StimulsoftViewerComponent.prototype, "loaded", void 0);
__decorate([
    Output()
], StimulsoftViewerComponent.prototype, "error", void 0);
__decorate([
    Output()
], StimulsoftViewerComponent.prototype, "export", void 0);
__decorate([
    Output()
], StimulsoftViewerComponent.prototype, "email", void 0);
__decorate([
    Output()
], StimulsoftViewerComponent.prototype, "print", void 0);
__decorate([
    Output()
], StimulsoftViewerComponent.prototype, "design", void 0);
__decorate([
    Input()
], StimulsoftViewerComponent.prototype, "requestUrl", void 0);
__decorate([
    Input()
], StimulsoftViewerComponent.prototype, "action", void 0);
__decorate([
    Input()
], StimulsoftViewerComponent.prototype, "properties", void 0);
__decorate([
    Input()
], StimulsoftViewerComponent.prototype, "width", void 0);
__decorate([
    Input()
], StimulsoftViewerComponent.prototype, "height", void 0);
__decorate([
    Input()
], StimulsoftViewerComponent.prototype, "backgroundColor", void 0);
__decorate([
    Input()
], StimulsoftViewerComponent.prototype, "style", void 0);
StimulsoftViewerComponent = __decorate([
    Component({
        selector: 'stimulsoft-viewer-angular',
        template: `
    <span #viewer [style]="style"
      [style.top.px]="0"
      [style.right.px]="0"
      [style.bottom.px]="0"
      [style.left.px]="0"
      [style.display]="'inline-block'"
      [style.backgroundColor]="backgroundColor"
      [style.width]="this.width != null ? this.width : '100%'"
      [style.height]="this.height != null ? this.height : (model.options?.appearance.scrollbarsMode ? '650px' : '100%')">
      <div class="stiJsViewerMainPanel">
        <sti-center-text *ngIf="initialized"></sti-center-text>
        <sti-toolbar *ngIf="initialized"></sti-toolbar>
        <div *ngFor="let i of [1,2,3,4,5]" [style.zIndex]="i * 10" [style.display]="formService.form?.level == i ? '' : 'none'" class="stiJsViewerDisabledPanel"></div>
        <sti-about-panel *ngIf="initialized"></sti-about-panel>

        <sti-dashboards-panel *ngIf="initialized"></sti-dashboards-panel>
        <sti-report-panel *ngIf="initialized"></sti-report-panel>
        <sti-progress *ngIf="initialized"></sti-progress>
        <sti-find-panel *ngIf="initialized"></sti-find-panel>
        <sti-drill-down-panel *ngIf="initialized"></sti-drill-down-panel>
        <sti-resources-panel *ngIf="initialized"></sti-resources-panel>
        <sti-navigate-panel *ngIf="initialized"></sti-navigate-panel>

        <sti-export-form *ngIf="initialized" [exportFormSettings]="exportService.exportFormSettings"></sti-export-form>
        <sti-send-email-form *ngIf="initialized"></sti-send-email-form>
        <sti-password-form *ngIf="initialized"></sti-password-form>
        <sti-error-message-form *ngIf="initialized"></sti-error-message-form>
        <sti-notification-form *ngIf="initialized"></sti-notification-form>

        <sti-tooltip *ngIf="initialized"></sti-tooltip>
        <sti-menu *ngFor="let menu of menuService.menus" [menu]="menu"></sti-menu>
        <sti-bookmarks-panel *ngIf="initialized"></sti-bookmarks-panel>
        <sti-interactions-panel *ngIf="initialized"></sti-interactions-panel>

        <sti-open-dialog *ngIf="initialized" [fileMask]="model.openDialogFileMask"></sti-open-dialog>
      </div>
    </span>
  `,
        providers: [ModelService, StiHttpClientService, ControllerService, StylesService, HelperService, MenuService,
            MouseService, PageService, TooltipService, FindService, AnimationService, Md5Service, InteractionsService, FormService, RadioButtonService, ExportService,
            CollectionsService, MailService, EditableFieldsService, DrillDownService, PrintService, FullScreenService, ToolbarService, ApiService, DashboardService]
    })
], StimulsoftViewerComponent);
export { StimulsoftViewerComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3RpbXVsc29mdC12aWV3ZXItYW5ndWxhci5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9zdGltdWxzb2Z0LXZpZXdlci1hbmd1bGFyLyIsInNvdXJjZXMiOlsibGliL3N0aW11bHNvZnQtdmlld2VyLWFuZ3VsYXIuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFVLEtBQUssRUFBaUIsU0FBUyxFQUF5QixNQUFNLEVBQUUsWUFBWSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ2hJLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLCtCQUErQixDQUFDO0FBQ2xFLE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUNsRCxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0sMEJBQTBCLENBQUM7QUFFeEQsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLDJCQUEyQixDQUFDO0FBQzFELE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQUNuRCxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sd0JBQXdCLENBQUM7QUFDcEQsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLDBCQUEwQixDQUFDO0FBQ3hELE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLDhCQUE4QixDQUFDO0FBQ2hFLE9BQU8sRUFBRSxvQkFBb0IsRUFBRSxNQUFNLGdDQUFnQyxDQUFDO0FBQ3RFLE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSwyQkFBMkIsQ0FBQztBQUMxRCxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sMkJBQTJCLENBQUM7QUFDMUQsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLDBCQUEwQixDQUFDO0FBQ3hELE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSx5QkFBeUIsQ0FBQztBQUN0RCxPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0sNEJBQTRCLENBQUM7QUFDNUQsT0FBTyxFQUFFLFdBQVcs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SUFBVCxNQUFNLEVBQUU7eURBQWdEO0FBSy9DO0lBQVQsTUFBTSxFQUFFO3dEQUErQztBQUs5QztJQUFULE1BQU0sRUFBRTt3REFBK0M7QUFLOUM7SUFBVCxNQUFNLEVBQUU7eURBQWdEO0FBTWhEO0lBQVIsS0FBSyxFQUFFOzZEQUFvQjtBQUtuQjtJQUFSLEtBQUssRUFBRTt5REFBZ0I7QUFLZjtJQUFSLEtBQUssRUFBRTs2REFBaUI7QUFLaEI7SUFBUixLQUFLLEVBQUU7d0RBQWU7QUFLZDtJQUFSLEtBQUssRUFBRTt5REFBZ0I7QUFLZjtJQUFSLEtBQUssRUFBRTtrRUFBMkI7QUFLMUI7SUFBUixLQUFLLEVBQUU7d0RBQWU7QUF2RVoseUJBQXlCO0lBN0NyQyxTQUFTLENBQUM7UUFDVCxRQUFRLEVBQUUsMkJBQTJCO1FBQ3JDLFFBQVEsRUFBRTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7R0FzQ1Q7UUFDRCxTQUFTLEVBQUUsQ0FBQyxZQUFZLEVBQUUsb0JBQW9CLEVBQUUsaUJBQWlCLEVBQUUsYUFBYSxFQUFFLGFBQWEsRUFBRSxXQUFXO1lBQzFHLFlBQVksRUFBRSxXQUFXLEVBQUUsY0FBYyxFQUFFLFdBQVcsRUFBRSxnQkFBZ0IsRUFBRSxVQUFVLEVBQUUsbUJBQW1CLEVBQUUsV0FBVyxFQUFFLGtCQUFrQixFQUFFLGFBQWE7WUFDekosa0JBQWtCLEVBQUUsV0FBVyxFQUFFLHFCQUFxQixFQUFFLGdCQUFnQixFQUFFLFlBQVksRUFBRSxpQkFBaUIsRUFBRSxjQUFjLEVBQUUsVUFBVSxFQUFFLGdCQUFnQixDQUFDO0tBQzNKLENBQUM7R0FDVyx5QkFBeUIsQ0F5S3JDO1NBektZLHlCQUF5QiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgT25Jbml0LCBJbnB1dCwgQWZ0ZXJWaWV3SW5pdCwgVmlld0NoaWxkLCBFbGVtZW50UmVmLCBPbkNoYW5nZXMsIE91dHB1dCwgRXZlbnRFbWl0dGVyIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IENvbnRyb2xsZXJTZXJ2aWNlIH0gZnJvbSAnLi9zZXJ2aWNlcy9jb250cm9sbGVyLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBNZW51U2VydmljZSB9IGZyb20gJy4vbWVudS9tZW51LnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBNb2RlbFNlcnZpY2UgfSBmcm9tICcuL3NlcnZpY2VzL21vZGVsLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBNZXNzYWdlIH0gZnJvbSAnLi9zZXJ2aWNlcy9vYmplY3RzJztcclxuaW1wb3J0IHsgRXhwb3J0U2VydmljZSB9IGZyb20gJy4vc2VydmljZXMvZXhwb3J0LnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBGb3JtU2VydmljZSB9IGZyb20gJy4vZm9ybXMvZm9ybS5zZXJ2aWNlJztcclxuaW1wb3J0IHsgQXBpU2VydmljZSB9IGZyb20gJy4vc2VydmljZXMvYXBpLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBQcmludFNlcnZpY2UgfSBmcm9tICcuL3NlcnZpY2VzL3ByaW50LnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBEYXNoYm9hcmRTZXJ2aWNlIH0gZnJvbSAnLi9zZXJ2aWNlcy9kYXNoYm9hcmQuc2VydmljZSc7XHJcbmltcG9ydCB7IFN0aUh0dHBDbGllbnRTZXJ2aWNlIH0gZnJvbSAnLi9zZXJ2aWNlcy9odHRwLWNsaWVudC5zZXJ2aWNlJztcclxuaW1wb3J0IHsgU3R5bGVzU2VydmljZSB9IGZyb20gJy4vc2VydmljZXMvc3R5bGVzLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBIZWxwZXJTZXJ2aWNlIH0gZnJvbSAnLi9zZXJ2aWNlcy9oZWxwZXIuc2VydmljZSc7XHJcbmltcG9ydCB7IE1vdXNlU2VydmljZSB9IGZyb20gJy4vc2VydmljZXMvbW91c2Uuc2VydmljZSc7XHJcbmltcG9ydCB7IFBhZ2VTZXJ2aWNlIH0gZnJvbSAnLi9zZXJ2aWNlcy9wYWdlLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBUb29sdGlwU2VydmljZSB9IGZyb20gJy4vc2VydmljZXMvdG9vbHRpcC5zZXJ2aWNlJztcclxuaW1wb3J0IHsgRmluZFNlcnZpY2UgfSBmcm9tICcuL3NlcnZpY2VzL2ZpbmQuc2VydmljZSc7XHJcbmltcG9ydCB7IEFuaW1hdGlvblNlcnZpY2UgfSBmcm9tICcuL3NlcnZpY2VzL2FuaW1hdGlvbi5zZXJ2aWNlJztcclxuaW1wb3J0IHsgSW50ZXJhY3Rpb25zU2VydmljZSB9IGZyb20gJy4vc2VydmljZXMvaW50ZXJhY3Rpb25zLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBSYWRpb0J1dHRvblNlcnZpY2UgfSBmcm9tICcuL3NlcnZpY2VzL3JhZGlvLWJ1dHRvbi5zZXJ2aWNlJztcclxuaW1wb3J0IHsgQ29sbGVjdGlvbnNTZXJ2aWNlIH0gZnJvbSAnLi9zZXJ2aWNlcy9jb2xsZWN0aW9ucy5zZXJ2aWNlJztcclxuaW1wb3J0IHsgTWFpbFNlcnZpY2UgfSBmcm9tICcuL3NlcnZpY2VzL21haWwuc2VydmljZSc7XHJcbmltcG9ydCB7IEVkaXRhYmxlRmllbGRzU2VydmljZSB9IGZyb20gJy4vc2VydmljZXMvZWRpdGFibGUtZmllbGRzLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBEcmlsbERvd25TZXJ2aWNlIH0gZnJvbSAnLi9zZXJ2aWNlcy9kcmlsbC1kb3duLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBNZDVTZXJ2aWNlIH0gZnJvbSAnLi9zZXJ2aWNlcy9tZDUuc2VydmljZSc7XHJcbmltcG9ydCB7IEZ1bGxTY3JlZW5TZXJ2aWNlIH0gZnJvbSAnLi9zZXJ2aWNlcy9mdWxsLXNjcmVlbi5zZXJ2aWNlJztcclxuaW1wb3J0IHsgVG9vbGJhclNlcnZpY2UgfSBmcm9tICcuL3NlcnZpY2VzL3Rvb2xiYXIuc2VydmljZSc7XHJcbi8vMWJmYjM1MWMxYWRkMjdiMTUzN2ZmY2U5YzcyM2UzY2IxZjViMjdiYiAwMi4wMy4yMDIxIDE3OjI5OjIwXHJcblxyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogJ3N0aW11bHNvZnQtdmlld2VyLWFuZ3VsYXInLFxyXG4gIHRlbXBsYXRlOiBgXHJcbiAgICA8c3BhbiAjdmlld2VyIFtzdHlsZV09XCJzdHlsZVwiXHJcbiAgICAgIFtzdHlsZS50b3AucHhdPVwiMFwiXHJcbiAgICAgIFtzdHlsZS5yaWdodC5weF09XCIwXCJcclxuICAgICAgW3N0eWxlLmJvdHRvbS5weF09XCIwXCJcclxuICAgICAgW3N0eWxlLmxlZnQucHhdPVwiMFwiXHJcbiAgICAgIFtzdHlsZS5kaXNwbGF5XT1cIidpbmxpbmUtYmxvY2snXCJcclxuICAgICAgW3N0eWxlLmJhY2tncm91bmRDb2xvcl09XCJiYWNrZ3JvdW5kQ29sb3JcIlxyXG4gICAgICBbc3R5bGUud2lkdGhdPVwidGhpcy53aWR0aCAhPSBudWxsID8gdGhpcy53aWR0aCA6ICcxMDAlJ1wiXHJcbiAgICAgIFtzdHlsZS5oZWlnaHRdPVwidGhpcy5oZWlnaHQgIT0gbnVsbCA/IHRoaXMuaGVpZ2h0IDogKG1vZGVsLm9wdGlvbnM/LmFwcGVhcmFuY2Uuc2Nyb2xsYmFyc01vZGUgPyAnNjUwcHgnIDogJzEwMCUnKVwiPlxyXG4gICAgICA8ZGl2IGNsYXNzPVwic3RpSnNWaWV3ZXJNYWluUGFuZWxcIj5cclxuICAgICAgICA8c3RpLWNlbnRlci10ZXh0ICpuZ0lmPVwiaW5pdGlhbGl6ZWRcIj48L3N0aS1jZW50ZXItdGV4dD5cclxuICAgICAgICA8c3RpLXRvb2xiYXIgKm5nSWY9XCJpbml0aWFsaXplZFwiPjwvc3RpLXRvb2xiYXI+XHJcbiAgICAgICAgPGRpdiAqbmdGb3I9XCJsZXQgaSBvZiBbMSwyLDMsNCw1XVwiIFtzdHlsZS56SW5kZXhdPVwiaSAqIDEwXCIgW3N0eWxlLmRpc3BsYXldPVwiZm9ybVNlcnZpY2UuZm9ybT8ubGV2ZWwgPT0gaSA/ICcnIDogJ25vbmUnXCIgY2xhc3M9XCJzdGlKc1ZpZXdlckRpc2FibGVkUGFuZWxcIj48L2Rpdj5cclxuICAgICAgICA8c3RpLWFib3V0LXBhbmVsICpuZ0lmPVwiaW5pdGlhbGl6ZWRcIj48L3N0aS1hYm91dC1wYW5lbD5cclxuXHJcbiAgICAgICAgPHN0aS1kYXNoYm9hcmRzLXBhbmVsICpuZ0lmPVwiaW5pdGlhbGl6ZWRcIj48L3N0aS1kYXNoYm9hcmRzLXBhbmVsPlxyXG4gICAgICAgIDxzdGktcmVwb3J0LXBhbmVsICpuZ0lmPVwiaW5pdGlhbGl6ZWRcIj48L3N0aS1yZXBvcnQtcGFuZWw+XHJcbiAgICAgICAgPHN0aS1wcm9ncmVzcyAqbmdJZj1cImluaXRpYWxpemVkXCI+PC9zdGktcHJvZ3Jlc3M+XHJcbiAgICAgICAgPHN0aS1maW5kLXBhbmVsICpuZ0lmPVwiaW5pdGlhbGl6ZWRcIj48L3N0aS1maW5kLXBhbmVsPlxyXG4gICAgICAgIDxzdGktZHJpbGwtZG93bi1wYW5lbCAqbmdJZj1cImluaXRpYWxpemVkXCI+PC9zdGktZHJpbGwtZG93bi1wYW5lbD5cclxuICAgICAgICA8c3RpLXJlc291cmNlcy1wYW5lbCAqbmdJZj1cImluaXRpYWxpemVkXCI+PC9zdGktcmVzb3VyY2VzLXBhbmVsPlxyXG4gICAgICAgIDxzdGktbmF2aWdhdGUtcGFuZWwgKm5nSWY9XCJpbml0aWFsaXplZFwiPjwvc3RpLW5hdmlnYXRlLXBhbmVsPlxyXG5cclxuICAgICAgICA8c3RpLWV4cG9ydC1mb3JtICpuZ0lmPVwiaW5pdGlhbGl6ZWRcIiBbZXhwb3J0Rm9ybVNldHRpbmdzXT1cImV4cG9ydFNlcnZpY2UuZXhwb3J0Rm9ybVNldHRpbmdzXCI+PC9zdGktZXhwb3J0LWZvcm0+XHJcbiAgICAgICAgPHN0aS1zZW5kLWVtYWlsLWZvcm0gKm5nSWY9XCJpbml0aWFsaXplZFwiPjwvc3RpLXNlbmQtZW1haWwtZm9ybT5cclxuICAgICAgICA8c3RpLXBhc3N3b3JkLWZvcm0gKm5nSWY9XCJpbml0aWFsaXplZFwiPjwvc3RpLXBhc3N3b3JkLWZvcm0+XHJcbiAgICAgICAgPHN0aS1lcnJvci1tZXNzYWdlLWZvcm0gKm5nSWY9XCJpbml0aWFsaXplZFwiPjwvc3RpLWVycm9yLW1lc3NhZ2UtZm9ybT5cclxuICAgICAgICA8c3RpLW5vdGlmaWNhdGlvbi1mb3JtICpuZ0lmPVwiaW5pdGlhbGl6ZWRcIj48L3N0aS1ub3RpZmljYXRpb24tZm9ybT5cclxuXHJcbiAgICAgICAgPHN0aS10b29sdGlwICpuZ0lmPVwiaW5pdGlhbGl6ZWRcIj48L3N0aS10b29sdGlwPlxyXG4gICAgICAgIDxzdGktbWVudSAqbmdGb3I9XCJsZXQgbWVudSBvZiBtZW51U2VydmljZS5tZW51c1wiIFttZW51XT1cIm1lbnVcIj48L3N0aS1tZW51PlxyXG4gICAgICAgIDxzdGktYm9va21hcmtzLXBhbmVsICpuZ0lmPVwiaW5pdGlhbGl6ZWRcIj48L3N0aS1ib29rbWFya3MtcGFuZWw+XHJcbiAgICAgICAgPHN0aS1pbnRlcmFjdGlvbnMtcGFuZWwgKm5nSWY9XCJpbml0aWFsaXplZFwiPjwvc3RpLWludGVyYWN0aW9ucy1wYW5lbD5cclxuXHJcbiAgICAgICAgPHN0aS1vcGVuLWRpYWxvZyAqbmdJZj1cImluaXRpYWxpemVkXCIgW2ZpbGVNYXNrXT1cIm1vZGVsLm9wZW5EaWFsb2dGaWxlTWFza1wiPjwvc3RpLW9wZW4tZGlhbG9nPlxyXG4gICAgICA8L2Rpdj5cclxuICAgIDwvc3Bhbj5cclxuICBgLFxyXG4gIHByb3ZpZGVyczogW01vZGVsU2VydmljZSwgU3RpSHR0cENsaWVudFNlcnZpY2UsIENvbnRyb2xsZXJTZXJ2aWNlLCBTdHlsZXNTZXJ2aWNlLCBIZWxwZXJTZXJ2aWNlLCBNZW51U2VydmljZSxcclxuICAgIE1vdXNlU2VydmljZSwgUGFnZVNlcnZpY2UsIFRvb2x0aXBTZXJ2aWNlLCBGaW5kU2VydmljZSwgQW5pbWF0aW9uU2VydmljZSwgTWQ1U2VydmljZSwgSW50ZXJhY3Rpb25zU2VydmljZSwgRm9ybVNlcnZpY2UsIFJhZGlvQnV0dG9uU2VydmljZSwgRXhwb3J0U2VydmljZSxcclxuICAgIENvbGxlY3Rpb25zU2VydmljZSwgTWFpbFNlcnZpY2UsIEVkaXRhYmxlRmllbGRzU2VydmljZSwgRHJpbGxEb3duU2VydmljZSwgUHJpbnRTZXJ2aWNlLCBGdWxsU2NyZWVuU2VydmljZSwgVG9vbGJhclNlcnZpY2UsIEFwaVNlcnZpY2UsIERhc2hib2FyZFNlcnZpY2VdXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBTdGltdWxzb2Z0Vmlld2VyQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBBZnRlclZpZXdJbml0LCBPbkNoYW5nZXMge1xyXG5cclxuICAvKipcclxuICAgKiBSb290IHZpZXdlciBzcGFuXHJcbiAgICovXHJcbiAgQFZpZXdDaGlsZCgndmlld2VyJykgdmlld2VyRWxlbWVudDogRWxlbWVudFJlZjtcclxuXHJcbiAgLyoqXHJcbiAgICogT2NjdXJzIHdoZW4gcmVwb3J0L2Rhc2hib2FyZCBsb2FkZWRcclxuICAgKi9cclxuICBAT3V0cHV0KCkgbG9hZGVkOiBFdmVudEVtaXR0ZXI8YW55PiA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuXHJcbiAgLyoqXHJcbiAgICogT2NjdXJzIG9uIGVycm9yLCAkZXZlbnQgaXMgRXJyb3JNZXNzYWdlIG9iamVjdCBjb250YWlucyBlcnJvcjogc3RyaW5nICYgdHlwZTogYW55ICAoaWYgcHJlc2VudClcclxuICAgKi9cclxuICBAT3V0cHV0KCkgZXJyb3I6IEV2ZW50RW1pdHRlcjxhbnk+ID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG5cclxuICAvKipcclxuICAgKiBPY2N1cnMgb24gZXhwb3J0LCAkZXZlbnQgb2JqZWN0IGNvbnRhaW5zIGV4cG9ydEZvcm1hdDogc3RyaW5nICYgZXhwb3J0U2V0dGluZ3M6IHt9XHJcbiAgICovXHJcbiAgQE91dHB1dCgpIGV4cG9ydDogRXZlbnRFbWl0dGVyPGFueT4gPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcblxyXG4gIC8qKlxyXG4gICAqIE9jY3VycyBvbiBleHBvcnQgJiBlbWFpbCwgJGV2ZW50IG9iamVjdCBjb250YWlucyBleHBvcnRGb3JtYXQ6IHN0cmluZyAmIGV4cG9ydFNldHRpbmdzOiB7fVxyXG4gICAqL1xyXG4gIEBPdXRwdXQoKSBlbWFpbDogRXZlbnRFbWl0dGVyPGFueT4gPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcblxyXG4gIC8qKlxyXG4gICAqIE9jY3VycyBvbiBleHBvcnQgJiBlbWFpbCwgJGV2ZW50IG9iamVjdCBjb250YWlucyBmb3JtYXQ6IHN0cmluZyA6ICdQcmludFBkZicgb3IgJ1ByaW50V2l0aG91dFByZXZpZXcnIG9yICdQcmludFdpdGhQcmV2aWV3J1xyXG4gICAqL1xyXG4gIEBPdXRwdXQoKSBwcmludDogRXZlbnRFbWl0dGVyPGFueT4gPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcblxyXG4gIC8qKlxyXG4gICAqIE9jY3VycyBvbiBwcmVzc2luZyAnRGVzaWduJyBidXR0b25cclxuICAgKi9cclxuICBAT3V0cHV0KCkgZGVzaWduOiBFdmVudEVtaXR0ZXI8YW55PiA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuXHJcbiAgLyoqXHJcbiAgICogVXJsIHRvIHNlcnZlciBpbnN0YW5jZSwgbXVzdCBjb250YWlucyBwbGFjZWhvbGRlciB7YWN0aW9ufSB0aGF0IHdpbGwgcmVwbGFjZSB3aXRoIGFjdGlvblxyXG4gICAqIEV4YW1wbGU6IGh0dHA6Ly9zZXJ2ZXIudXJsOjUxNTI4L1ZpZXdlci97YWN0aW9ufVxyXG4gICAqL1xyXG4gIEBJbnB1dCgpIHJlcXVlc3RVcmw6IHN0cmluZztcclxuXHJcbiAgLyoqXHJcbiAgICogQ29udHJvbGxlciBhY3Rpb24gdGhhdCBoYW5kbGUgdmlld2VyIGluaXRpYWwgcmVxdWVzdFxyXG4gICAqL1xyXG4gIEBJbnB1dCgpIGFjdGlvbjogc3RyaW5nO1xyXG5cclxuICAvKipcclxuICAgKiBQcm9wZXJ0aWVzIHRoYXQgd2lsbCB0cmFuc2ZlciB0byBjb250cm9sbGVyIGFjdGlvbiBhcyBKU09OIG9iamVjdFxyXG4gICAqL1xyXG4gIEBJbnB1dCgpIHByb3BlcnRpZXM6IGFueTtcclxuXHJcbiAgLyoqXHJcbiAgICogVmlld2VyIHdpZHRoXHJcbiAgICovXHJcbiAgQElucHV0KCkgd2lkdGg6IHN0cmluZztcclxuXHJcbiAgLyoqXHJcbiAgICogVmlld2VyIGhlaWdodFxyXG4gICAqL1xyXG4gIEBJbnB1dCgpIGhlaWdodDogc3RyaW5nO1xyXG5cclxuICAvKipcclxuICAgKiBWaWV3ZXIgYmFja2dyb3VuZCBjb2xvclxyXG4gICAqL1xyXG4gIEBJbnB1dCgpIGJhY2tncm91bmRDb2xvciA9ICdXaGl0ZSc7XHJcblxyXG4gIC8qKlxyXG4gICAqIFN0eWxlIG9mIHZpZXdlciBhcHBsaWVkIHRvIG1haW4gc3BhbiBhcyBbc3R5bGVdPVwic3R5bGVcIlxyXG4gICAqL1xyXG4gIEBJbnB1dCgpIHN0eWxlOiBzdHJpbmc7XHJcblxyXG4gIHB1YmxpYyBpbml0aWFsaXplZCA9IGZhbHNlO1xyXG5cclxuICBwcml2YXRlIHZpZXdJbml0ID0gZmFsc2U7XHJcblxyXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgY29udHJvbGxlcjogQ29udHJvbGxlclNlcnZpY2UsIHB1YmxpYyBtZW51U2VydmljZTogTWVudVNlcnZpY2UsXHJcbiAgICBwdWJsaWMgbW9kZWw6IE1vZGVsU2VydmljZSwgcHVibGljIGV4cG9ydFNlcnZpY2U6IEV4cG9ydFNlcnZpY2UsIHB1YmxpYyBmb3JtU2VydmljZTogRm9ybVNlcnZpY2UsXHJcbiAgICBwdWJsaWMgYXBpOiBBcGlTZXJ2aWNlLCBwcml2YXRlIHByaW50U2VydmljZTogUHJpbnRTZXJ2aWNlLCBwcml2YXRlIGRhc2hib2FyZFNlcnZpY2U6IERhc2hib2FyZFNlcnZpY2UpIHtcclxuXHJcbiAgICB3aW5kb3cub25yZXNpemUgPSAoKSA9PiB0aGlzLnJlc2l6ZSgpO1xyXG5cclxuICAgIHRoaXMuaW5pdEV2ZW50cygpO1xyXG4gIH1cclxuXHJcbiAgbmdPbkNoYW5nZXMoY2hhbmdlczogaW1wb3J0KCdAYW5ndWxhci9jb3JlJykuU2ltcGxlQ2hhbmdlcyk6IHZvaWQge1xyXG4gICAgdGhpcy5sb2FkVmlld2VyKCk7XHJcbiAgfVxyXG5cclxuICBuZ09uSW5pdCgpOiB2b2lkIHtcclxuICAgIHRoaXMuY29udHJvbGxlci5nZXRNZXNzYWdlKCkuc3Vic2NyaWJlKChtZXNzYWdlOiBNZXNzYWdlKSA9PiB7XHJcbiAgICAgIHN3aXRjaCAobWVzc2FnZS5hY3Rpb24pIHtcclxuICAgICAgICBjYXNlICd2aWV3ZXJfbG9hZGVkJzpcclxuICAgICAgICAgIHRoaXMuaW5pdGlhbGl6ZWQgPSB0cnVlO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgbmdBZnRlclZpZXdJbml0KCk6IHZvaWQge1xyXG4gICAgdGhpcy52aWV3SW5pdCA9IHRydWU7XHJcbiAgICB0aGlzLmxvYWRWaWV3ZXIoKTtcclxuICB9XHJcblxyXG4gIGluaXRFdmVudHMoKSB7XHJcbiAgICB0aGlzLmNvbnRyb2xsZXIuZ2V0TWVzc2FnZSgpLnN1YnNjcmliZSgobWVzc2FnZTogTWVzc2FnZSkgPT4ge1xyXG4gICAgICBzd2l0Y2ggKG1lc3NhZ2UuYWN0aW9uKSB7XHJcbiAgICAgICAgY2FzZSAnR2V0UmVwb3J0JzpcclxuICAgICAgICBjYXNlICdPcGVuUmVwb3J0JzpcclxuICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmxvYWRlZC5uZXh0KCk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICB0aGlzLmNvbnRyb2xsZXIuZ2V0QWN0aW9uTWVzc2FnZSgpLnN1YnNjcmliZSgobWVzc2FnZTogTWVzc2FnZSkgPT4ge1xyXG4gICAgICBzd2l0Y2ggKG1lc3NhZ2UuYWN0aW9uKSB7XHJcbiAgICAgICAgY2FzZSAnRXJyb3InOlxyXG4gICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuZXJyb3IubmV4dCh0aGlzLm1vZGVsLmVycm9yTWVzc2FnZSk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICBjYXNlICdFeHBvcnRSZXBvcnQnOlxyXG4gICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuZXhwb3J0Lm5leHQobWVzc2FnZS5kYXRhKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgIGNhc2UgJ0VtYWlsJzpcclxuICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmVtYWlsLm5leHQobWVzc2FnZS5kYXRhKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgIGNhc2UgJ1ByaW50JzpcclxuICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnByaW50Lm5leHQobWVzc2FnZS5kYXRhKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgIGNhc2UgJ0Rlc2lnbic6XHJcbiAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5kZXNpZ24ubmV4dCgpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBsb2FkVmlld2VyKCkge1xyXG4gICAgaWYgKHRoaXMudmlld0luaXQpIHtcclxuICAgICAgdGhpcy5tb2RlbC5yZXF1ZXN0VXJsID0gdGhpcy5yZXF1ZXN0VXJsO1xyXG4gICAgICB0aGlzLm1vZGVsLmFjdGlvbiA9IHRoaXMuYWN0aW9uO1xyXG4gICAgICB0aGlzLm1vZGVsLnByb3BlcnRpZXMgPSB0aGlzLnByb3BlcnRpZXM7XHJcbiAgICAgIHRoaXMuY29udHJvbGxlci5sb2FkVmlld2VyKCk7XHJcbiAgICAgIHRoaXMucmVzaXplKCk7XHJcbiAgICAgIHRoaXMubW9kZWwuY29udHJvbHMudmlld2VyLmVsID0gdGhpcy52aWV3ZXJFbGVtZW50O1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcmVzaXplKCkge1xyXG4gICAgaWYgKHRoaXMudmlld2VyRWxlbWVudD8ubmF0aXZlRWxlbWVudCkge1xyXG4gICAgICB0aGlzLm1vZGVsLnZpZXdlclNpemUgPSB7IHdpZHRoOiB0aGlzLnZpZXdlckVsZW1lbnQubmF0aXZlRWxlbWVudC5vZmZzZXRXaWR0aCwgaGVpZ2h0OiB0aGlzLnZpZXdlckVsZW1lbnQubmF0aXZlRWxlbWVudC5vZmZzZXRIZWlnaHQgfTtcclxuICAgICAgdGhpcy5jb250cm9sbGVyLnZpZXdlclJlc2l6ZWQoKTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuIl19