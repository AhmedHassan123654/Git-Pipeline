import { __decorate } from "tslib";
import { Component, Input, ViewChild, Output, EventEmitter } from '@angular/core';
import { ControllerService } from '../services/controller.service';
import { ModelService } from '../services/model.service';
import { MenuService, Menu } from '../menu/menu.service';
import { TooltipService } from '../services/tooltip.service';
import { HelperService } from '../services/helper.service';
let ButtonComponent = class ButtonComponent {
    constructor(model, controller, menuService, tooltipService, helper) {
        this.model = model;
        this.controller = controller;
        this.menuService = menuService;
        this.tooltipService = tooltipService;
        this.helper = helper;
        this.margin = '1px';
        this.height = '23px';
        this.selected = false;
        this.imageCellTextAlign = 'center';
        this.imageSizesWidth = 16;
        this.imageSizesHeight = 16;
        this.closeButton = false;
        this.resourceButton = false;
        this.navagationPanelTooltip = false;
        this.helpLink = 'user-manual/index.html?viewer_reports.htm';
        this.action = new EventEmitter();
        this.closeButtonAction = new EventEmitter();
        this.over = false;
        this.showMenu = false;
        this.closeButtonPressed = false;
        this.resourceButtonPressed = false;
        this._enabled = true;
        this.canShowTooltip = true;
    }
    ngOnInit() {
        if (this.menuItems) {
            setTimeout(() => {
                this.menuObj = { type: 'buttonMenu', name: this.actionName, items: this.menuItems, parent: !this.resourceButton ? this.button : this.resButtonEl };
                this.menuService.addMenu(this.menuObj);
            }, 500);
        }
    }
    get styleName() {
        return this._styleName || 'stiJsViewerStandartSmallButton';
    }
    set styleName(value) {
        this._styleName = value;
    }
    get enabled() {
        return this._enabled;
    }
    set enabled(value) {
        if (!value) {
            this.over = false;
        }
        this._enabled = value;
    }
    mouseover() {
        if (!this.enabled) {
            return;
        }
        this.over = true;
        if (this.model.options.toolbar.showMenuMode === 'Hover' && ['Print', 'Save', 'SendEmail', 'Zoom', 'ViewMode'].some(a => a === this.actionName)) {
            this.tooltipService.hideImmediately();
            this.menuService.showMenu(this.actionName);
        }
        else if (this.tooltip && !this.menuService.menus.some(e => e.state === 'expanded') && this.canShowTooltip) {
            const top = !this.navagationPanelTooltip ? this.model.controls.toolbar.offsetHeight + this.model.controls.dashboardsPanel.offsetHeight :
                this.helper.findPosY(this.model.controls.navigatePanel.el.nativeElement, 'stiJsViewerMainPanel');
            const tooltip = this.tooltip === true ? (this.model.localization[this.actionName + 'ToolTip'] != null ? this.model.loc(this.actionName + 'ToolTip') : this.model.loc(this.actionName)) : this.tooltip;
            this.tooltipService.show(this.helper.findPosX(this.button.nativeElement, 'stiJsViewerMainPanel'), top, tooltip, !this.navagationPanelTooltip, this.helpLink);
        }
    }
    mouseout() {
        if (!this.enabled) {
            return;
        }
        this.over = false;
        this.tooltipService.hide();
        setTimeout(() => {
            this.canShowTooltip = true;
        }, 1000);
    }
    click() {
        if (this.enabled && !this.closeButtonPressed) {
            this.tooltipService.hideImmediately();
            if (this.menuItems == null || (this.resourceButton && !this.resourceButtonPressed)) {
                this.action.emit();
            }
            else {
                this.menuService.showMenu(this.actionName);
            }
        }
        this.canShowTooltip = false;
        this.closeButtonPressed = false;
        this.resourceButtonPressed = false;
    }
    get className() {
        var _a;
        return this.styleName ? this.styleName + ' ' + (this.enabled ? (this.styleName + ((this.selected || ((_a = this.menuObj) === null || _a === void 0 ? void 0 : _a.state) === 'expanded') ? 'Selected' : (this.over ? 'Over' : 'Default'))) : this.styleName + 'Disabled') : '';
    }
};
ButtonComponent.ctorParameters = () => [
    { type: ModelService },
    { type: ControllerService },
    { type: MenuService },
    { type: TooltipService },
    { type: HelperService }
];
__decorate([
    Input()
], ButtonComponent.prototype, "caption", void 0);
__decorate([
    Input()
], ButtonComponent.prototype, "caption2", void 0);
__decorate([
    Input()
], ButtonComponent.prototype, "captionAlign", void 0);
__decorate([
    Input()
], ButtonComponent.prototype, "captionPadding", void 0);
__decorate([
    Input()
], ButtonComponent.prototype, "captionPaddingLeft", void 0);
__decorate([
    Input()
], ButtonComponent.prototype, "captionWhiteSpace", void 0);
__decorate([
    Input()
], ButtonComponent.prototype, "captionOverflow", void 0);
__decorate([
    Input()
], ButtonComponent.prototype, "captionTextOverflow", void 0);
__decorate([
    Input()
], ButtonComponent.prototype, "captionWidth", void 0);
__decorate([
    Input()
], ButtonComponent.prototype, "captionMaxWidth", void 0);
__decorate([
    Input()
], ButtonComponent.prototype, "captionLineHeight", void 0);
__decorate([
    Input()
], ButtonComponent.prototype, "imageName", void 0);
__decorate([
    Input()
], ButtonComponent.prototype, "arrow", void 0);
__decorate([
    Input()
], ButtonComponent.prototype, "arrowMarginTop", void 0);
__decorate([
    Input()
], ButtonComponent.prototype, "margin", void 0);
__decorate([
    Input()
], ButtonComponent.prototype, "height", void 0);
__decorate([
    Input()
], ButtonComponent.prototype, "selected", void 0);
__decorate([
    Input()
], ButtonComponent.prototype, "minWidth", void 0);
__decorate([
    Input()
], ButtonComponent.prototype, "innerTableWidth", void 0);
__decorate([
    Input()
], ButtonComponent.prototype, "menuItems", void 0);
__decorate([
    Input()
], ButtonComponent.prototype, "actionName", void 0);
__decorate([
    Input()
], ButtonComponent.prototype, "tooltip", void 0);
__decorate([
    Input()
], ButtonComponent.prototype, "imageCellTextAlign", void 0);
__decorate([
    Input()
], ButtonComponent.prototype, "imageCellWidth", void 0);
__decorate([
    Input()
], ButtonComponent.prototype, "imageCellPadding", void 0);
__decorate([
    Input()
], ButtonComponent.prototype, "imageSizesWidth", void 0);
__decorate([
    Input()
], ButtonComponent.prototype, "imageSizesHeight", void 0);
__decorate([
    Input()
], ButtonComponent.prototype, "imageMargin", void 0);
__decorate([
    Input()
], ButtonComponent.prototype, "width", void 0);
__decorate([
    Input()
], ButtonComponent.prototype, "display", void 0);
__decorate([
    Input()
], ButtonComponent.prototype, "closeButton", void 0);
__decorate([
    Input()
], ButtonComponent.prototype, "resourceButton", void 0);
__decorate([
    Input()
], ButtonComponent.prototype, "styleColors", void 0);
__decorate([
    Input()
], ButtonComponent.prototype, "boxSizing", void 0);
__decorate([
    Input()
], ButtonComponent.prototype, "navagationPanelTooltip", void 0);
__decorate([
    Input()
], ButtonComponent.prototype, "cursor", void 0);
__decorate([
    Input()
], ButtonComponent.prototype, "fontSize", void 0);
__decorate([
    Input()
], ButtonComponent.prototype, "helpLink", void 0);
__decorate([
    Input()
], ButtonComponent.prototype, "borderColor", void 0);
__decorate([
    Output()
], ButtonComponent.prototype, "action", void 0);
__decorate([
    Output()
], ButtonComponent.prototype, "closeButtonAction", void 0);
__decorate([
    ViewChild('button')
], ButtonComponent.prototype, "button", void 0);
__decorate([
    ViewChild('resButtonEl')
], ButtonComponent.prototype, "resButtonEl", void 0);
__decorate([
    Input()
], ButtonComponent.prototype, "styleName", null);
__decorate([
    Input()
], ButtonComponent.prototype, "enabled", null);
ButtonComponent = __decorate([
    Component({
        selector: 'sti-button',
        template: `
  <div #button
    [style.fontFamily]="model.options.toolbar.fontFamily"
    [style.cursor]="cursor"
    [style.borderColor]="borderColor"
    [class]="className"
    [style]="{height: helper.val(height, '23px'), boxSizing: helper.val(boxSizing, 'content-box'), margin: helper.val(margin, '1px'), minWidth: minWidth, width: width, display: display }"
    [style.fontSize]="fontSize"
    (mouseover)="mouseover()"
    (mouseout)="mouseout()"
    (click)="click()" >
    <table class="stiJsViewerClearAllStyles" cellpadding="0" cellspacing="0" style="height: 100%;width:100%" [style.width]="innerTableWidth">
      <tbody>
        <tr class="stiJsViewerClearAllStyles">
          <td *ngIf="imageName != null" [style]="{lineHeight:'0', padding:helper.val(imageCellPadding, '0 3px'), textAlign: imageCellTextAlign, width: imageCellWidth}" class="stiJsViewerClearAllStyles">
            <img src="{{model.img(imageName)}}" [style.opacity]="enabled ? '1' : '0.5'"
                [style.width.px]="imageSizesWidth"
                [style.height.px]="imageSizesHeight"
                [style.margin]="imageMargin">
          </td>
          <td *ngIf="caption != null"
             [style]="{whiteSpace:'nowrap', textAlign: captionAlign || 'left', padding:captionPadding || ((arrow ? '1px 0' : '1px 5px') + (imageName ? ' 0 0' : ' 0 5px')), width: captionWidth}"
             [style.maxWidth]="captionMaxWidth"
             [style.lineHeight]="captionLineHeight"
             [style.paddingLeft]="captionPaddingLeft"
             [style.whiteSpace]="captionWhiteSpace"
             [style.overflow]="captionOverflow"
             [style.textOverflow]="captionTextOverflow"
             class="stiJsViewerClearAllStyles">
            {{caption}}
            <div *ngIf="caption2 != null">
            {{caption2}}
            </div>
          </td>
          <td *ngIf="arrow" class="stiJsViewerClearAllStyles">
            <img src="{{arrow == 'Up' || arrow == 'Down' ? model.img('Arrows.SmallArrow' + arrow + (arrow == 'Down' && styleColors && styleColors.isDarkStyle ? 'White.png' : '.png')) : model.img(arrow)}}"
            [style]="{lineHeight:'0', width:'8px', height:'8px', verticalAlign:'baseline', padding:caption ? '0 5px 0 5px' : '0 5px 0 2px', marginTop: arrowMarginTop}"
            [style.opacity]="enabled ? '1' : '0.5'"/>
          </td>

          <td *ngIf="closeButton" class="stiJsViewerClearAllStyles">
            <sti-button [imageName]="'CloseForm.png'"
              [imageMargin]="'1px 0 0 -1px'"
              [margin]="'0 2px 0 0'"
              [imageCellPadding]="'0'"
              [width]="model.options.isTouchDevice ? '22px' : '17px'"
              [height]="model.options.isTouchDevice ? '22px' : '17px'"
              (action)="closeButtonPressed = true; closeButtonAction.emit()">
            </sti-button>
          </td>

          <td #resButtonEl *ngIf="resourceButton" style="width: 1px;">
            <sti-button [imageName]="'Arrows.SmallArrowDown.png'"
              [styleName]="'stiJsViewerResourceDropDownButton'"
              [innerTableWidth]="'100%'"
              [margin]="'0 7px 0 3px'"
              [imageCellTextAlign]="'center'"
              [imageSizesWidth]="8"
              [imageSizesHeight]="8"
              [height]="model.options.isTouchDevice ? '23px' : '17px'"
              [width]="model.options.isTouchDevice ? '23px' : '17px'"
              (action)="resourceButtonPressed = true;">>
            </sti-button>
          </td>

        </tr>
      </tbody>
    </table>
  </div>
  `
    })
], ButtonComponent);
export { ButtonComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYnV0dG9uLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL3N0aW11bHNvZnQtdmlld2VyLWFuZ3VsYXIvIiwic291cmNlcyI6WyJsaWIvY29udHJvbHMvYnV0dG9uLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBVSxLQUFLLEVBQUUsU0FBUyxFQUFjLE1BQU0sRUFBRSxZQUFZLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDdEcsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0sZ0NBQWdDLENBQUM7QUFDbkUsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLDJCQUEyQixDQUFDO0FBQ3pELE9BQU8sRUFBRSxXQUFXLEVBQUUsSUFBSSxFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFDekQsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLDZCQUE2QixDQUFDO0FBQzdELE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSw0QkFBNEIsQ0FBQztBQTRFM0QsSUFBYSxlQUFlLEdBQTVCLE1BQWEsZUFBZTtJQXdEMUIsWUFBbUIsS0FBbUIsRUFBUyxVQUE2QixFQUFTLFdBQXdCLEVBQVUsY0FBOEIsRUFDNUksTUFBcUI7UUFEWCxVQUFLLEdBQUwsS0FBSyxDQUFjO1FBQVMsZUFBVSxHQUFWLFVBQVUsQ0FBbUI7UUFBUyxnQkFBVyxHQUFYLFdBQVcsQ0FBYTtRQUFVLG1CQUFjLEdBQWQsY0FBYyxDQUFnQjtRQUM1SSxXQUFNLEdBQU4sTUFBTSxDQUFlO1FBekNyQixXQUFNLEdBQUcsS0FBSyxDQUFDO1FBQ2YsV0FBTSxHQUFHLE1BQU0sQ0FBQztRQUNoQixhQUFRLEdBQUcsS0FBSyxDQUFDO1FBTWpCLHVCQUFrQixHQUFHLFFBQVEsQ0FBQztRQUc5QixvQkFBZSxHQUFHLEVBQUUsQ0FBQztRQUNyQixxQkFBZ0IsR0FBRyxFQUFFLENBQUM7UUFJdEIsZ0JBQVcsR0FBRyxLQUFLLENBQUM7UUFDcEIsbUJBQWMsR0FBRyxL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QUFDbEI7SUFBUixLQUFLLEVBQUU7K0RBQWdDO0FBQy9CO0lBQVIsS0FBSyxFQUFFOytDQUFnQjtBQUNmO0lBQVIsS0FBSyxFQUFFO2lEQUFrQjtBQUNqQjtJQUFSLEtBQUssRUFBRTtpREFBd0Q7QUFDdkQ7SUFBUixLQUFLLEVBQUU7b0RBQWE7QUFFWDtJQUFULE1BQU0sRUFBRTsrQ0FBZ0Q7QUFDL0M7SUFBVCxNQUFNLEVBQUU7MERBQTJEO0FBQy9DO0lBQXBCLFNBQVMsQ0FBQyxRQUFRLENBQUM7K0NBQW9CO0FBQ2Q7SUFBekIsU0FBUyxDQUFDLGFBQWEsQ0FBQztvREFBeUI7QUF1QnpDO0lBQVIsS0FBSyxFQUFFO2dEQUVQO0FBTVE7SUFBUixLQUFLLEVBQUU7OENBRVA7QUE5RVUsZUFBZTtJQXpFM0IsU0FBUyxDQUFDO1FBQ1QsUUFBUSxFQUFFLFlBQVk7UUFDdEIsUUFBUSxFQUFFOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7R0FxRVQ7S0FDRixDQUFDO0dBQ1csZUFBZSxDQXFJM0I7U0FySVksZUFBZSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgT25Jbml0LCBJbnB1dCwgVmlld0NoaWxkLCBFbGVtZW50UmVmLCBPdXRwdXQsIEV2ZW50RW1pdHRlciB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBDb250cm9sbGVyU2VydmljZSB9IGZyb20gJy4uL3NlcnZpY2VzL2NvbnRyb2xsZXIuc2VydmljZSc7XHJcbmltcG9ydCB7IE1vZGVsU2VydmljZSB9IGZyb20gJy4uL3NlcnZpY2VzL21vZGVsLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBNZW51U2VydmljZSwgTWVudSB9IGZyb20gJy4uL21lbnUvbWVudS5zZXJ2aWNlJztcclxuaW1wb3J0IHsgVG9vbHRpcFNlcnZpY2UgfSBmcm9tICcuLi9zZXJ2aWNlcy90b29sdGlwLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBIZWxwZXJTZXJ2aWNlIH0gZnJvbSAnLi4vc2VydmljZXMvaGVscGVyLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBNZW51SXRlbSB9IGZyb20gJy4uL21lbnUvbWVuaS1pdGVtLmNvbXBvbmVudCc7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogJ3N0aS1idXR0b24nLFxyXG4gIHRlbXBsYXRlOiBgXHJcbiAgPGRpdiAjYnV0dG9uXHJcbiAgICBbc3R5bGUuZm9udEZhbWlseV09XCJtb2RlbC5vcHRpb25zLnRvb2xiYXIuZm9udEZhbWlseVwiXHJcbiAgICBbc3R5bGUuY3Vyc29yXT1cImN1cnNvclwiXHJcbiAgICBbc3R5bGUuYm9yZGVyQ29sb3JdPVwiYm9yZGVyQ29sb3JcIlxyXG4gICAgW2NsYXNzXT1cImNsYXNzTmFtZVwiXHJcbiAgICBbc3R5bGVdPVwie2hlaWdodDogaGVscGVyLnZhbChoZWlnaHQsICcyM3B4JyksIGJveFNpemluZzogaGVscGVyLnZhbChib3hTaXppbmcsICdjb250ZW50LWJveCcpLCBtYXJnaW46IGhlbHBlci52YWwobWFyZ2luLCAnMXB4JyksIG1pbldpZHRoOiBtaW5XaWR0aCwgd2lkdGg6IHdpZHRoLCBkaXNwbGF5OiBkaXNwbGF5IH1cIlxyXG4gICAgW3N0eWxlLmZvbnRTaXplXT1cImZvbnRTaXplXCJcclxuICAgIChtb3VzZW92ZXIpPVwibW91c2VvdmVyKClcIlxyXG4gICAgKG1vdXNlb3V0KT1cIm1vdXNlb3V0KClcIlxyXG4gICAgKGNsaWNrKT1cImNsaWNrKClcIiA+XHJcbiAgICA8dGFibGUgY2xhc3M9XCJzdGlKc1ZpZXdlckNsZWFyQWxsU3R5bGVzXCIgY2VsbHBhZGRpbmc9XCIwXCIgY2VsbHNwYWNpbmc9XCIwXCIgc3R5bGU9XCJoZWlnaHQ6IDEwMCU7d2lkdGg6MTAwJVwiIFtzdHlsZS53aWR0aF09XCJpbm5lclRhYmxlV2lkdGhcIj5cclxuICAgICAgPHRib2R5PlxyXG4gICAgICAgIDx0ciBjbGFzcz1cInN0aUpzVmlld2VyQ2xlYXJBbGxTdHlsZXNcIj5cclxuICAgICAgICAgIDx0ZCAqbmdJZj1cImltYWdlTmFtZSAhPSBudWxsXCIgW3N0eWxlXT1cIntsaW5lSGVpZ2h0OicwJywgcGFkZGluZzpoZWxwZXIudmFsKGltYWdlQ2VsbFBhZGRpbmcsICcwIDNweCcpLCB0ZXh0QWxpZ246IGltYWdlQ2VsbFRleHRBbGlnbiwgd2lkdGg6IGltYWdlQ2VsbFdpZHRofVwiIGNsYXNzPVwic3RpSnNWaWV3ZXJDbGVhckFsbFN0eWxlc1wiPlxyXG4gICAgICAgICAgICA8aW1nIHNyYz1cInt7bW9kZWwuaW1nKGltYWdlTmFtZSl9fVwiIFtzdHlsZS5vcGFjaXR5XT1cImVuYWJsZWQgPyAnMScgOiAnMC41J1wiXHJcbiAgICAgICAgICAgICAgICBbc3R5bGUud2lkdGgucHhdPVwiaW1hZ2VTaXplc1dpZHRoXCJcclxuICAgICAgICAgICAgICAgIFtzdHlsZS5oZWlnaHQucHhdPVwiaW1hZ2VTaXplc0hlaWdodFwiXHJcbiAgICAgICAgICAgICAgICBbc3R5bGUubWFyZ2luXT1cImltYWdlTWFyZ2luXCI+XHJcbiAgICAgICAgICA8L3RkPlxyXG4gICAgICAgICAgPHRkICpuZ0lmPVwiY2FwdGlvbiAhPSBudWxsXCJcclxuICAgICAgICAgICAgIFtzdHlsZV09XCJ7d2hpdGVTcGFjZTonbm93cmFwJywgdGV4dEFsaWduOiBjYXB0aW9uQWxpZ24gfHwgJ2xlZnQnLCBwYWRkaW5nOmNhcHRpb25QYWRkaW5nIHx8ICgoYXJyb3cgPyAnMXB4IDAnIDogJzFweCA1cHgnKSArIChpbWFnZU5hbWUgPyAnIDAgMCcgOiAnIDAgNXB4JykpLCB3aWR0aDogY2FwdGlvbldpZHRofVwiXHJcbiAgICAgICAgICAgICBbc3R5bGUubWF4V2lkdGhdPVwiY2FwdGlvbk1heFdpZHRoXCJcclxuICAgICAgICAgICAgIFtzdHlsZS5saW5lSGVpZ2h0XT1cImNhcHRpb25MaW5lSGVpZ2h0XCJcclxuICAgICAgICAgICAgIFtzdHlsZS5wYWRkaW5nTGVmdF09XCJjYXB0aW9uUGFkZGluZ0xlZnRcIlxyXG4gICAgICAgICAgICAgW3N0eWxlLndoaXRlU3BhY2VdPVwiY2FwdGlvbldoaXRlU3BhY2VcIlxyXG4gICAgICAgICAgICAgW3N0eWxlLm92ZXJmbG93XT1cImNhcHRpb25PdmVyZmxvd1wiXHJcbiAgICAgICAgICAgICBbc3R5bGUudGV4dE92ZXJmbG93XT1cImNhcHRpb25UZXh0T3ZlcmZsb3dcIlxyXG4gICAgICAgICAgICAgY2xhc3M9XCJzdGlKc1ZpZXdlckNsZWFyQWxsU3R5bGVzXCI+XHJcbiAgICAgICAgICAgIHt7Y2FwdGlvbn19XHJcbiAgICAgICAgICAgIDxkaXYgKm5nSWY9XCJjYXB0aW9uMiAhPSBudWxsXCI+XHJcbiAgICAgICAgICAgIHt7Y2FwdGlvbjJ9fVxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgIDwvdGQ+XHJcbiAgICAgICAgICA8dGQgKm5nSWY9XCJhcnJvd1wiIGNsYXNzPVwic3RpSnNWaWV3ZXJDbGVhckFsbFN0eWxlc1wiPlxyXG4gICAgICAgICAgICA8aW1nIHNyYz1cInt7YXJyb3cgPT0gJ1VwJyB8fCBhcnJvdyA9PSAnRG93bicgPyBtb2RlbC5pbWcoJ0Fycm93cy5TbWFsbEFycm93JyArIGFycm93ICsgKGFycm93ID09ICdEb3duJyAmJiBzdHlsZUNvbG9ycyAmJiBzdHlsZUNvbG9ycy5pc0RhcmtTdHlsZSA/ICdXaGl0ZS5wbmcnIDogJy5wbmcnKSkgOiBtb2RlbC5pbWcoYXJyb3cpfX1cIlxyXG4gICAgICAgICAgICBbc3R5bGVdPVwie2xpbmVIZWlnaHQ6JzAnLCB3aWR0aDonOHB4JywgaGVpZ2h0Oic4cHgnLCB2ZXJ0aWNhbEFsaWduOidiYXNlbGluZScsIHBhZGRpbmc6Y2FwdGlvbiA/ICcwIDVweCAwIDVweCcgOiAnMCA1cHggMCAycHgnLCBtYXJnaW5Ub3A6IGFycm93TWFyZ2luVG9wfVwiXHJcbiAgICAgICAgICAgIFtzdHlsZS5vcGFjaXR5XT1cImVuYWJsZWQgPyAnMScgOiAnMC41J1wiLz5cclxuICAgICAgICAgIDwvdGQ+XHJcblxyXG4gICAgICAgICAgPHRkICpuZ0lmPVwiY2xvc2VCdXR0b25cIiBjbGFzcz1cInN0aUpzVmlld2VyQ2xlYXJBbGxTdHlsZXNcIj5cclxuICAgICAgICAgICAgPHN0aS1idXR0b24gW2ltYWdlTmFtZV09XCInQ2xvc2VGb3JtLnBuZydcIlxyXG4gICAgICAgICAgICAgIFtpbWFnZU1hcmdpbl09XCInMXB4IDAgMCAtMXB4J1wiXHJcbiAgICAgICAgICAgICAgW21hcmdpbl09XCInMCAycHggMCAwJ1wiXHJcbiAgICAgICAgICAgICAgW2ltYWdlQ2VsbFBhZGRpbmddPVwiJzAnXCJcclxuICAgICAgICAgICAgICBbd2lkdGhdPVwibW9kZWwub3B0aW9ucy5pc1RvdWNoRGV2aWNlID8gJzIycHgnIDogJzE3cHgnXCJcclxuICAgICAgICAgICAgICBbaGVpZ2h0XT1cIm1vZGVsLm9wdGlvbnMuaXNUb3VjaERldmljZSA/ICcyMnB4JyA6ICcxN3B4J1wiXHJcbiAgICAgICAgICAgICAgKGFjdGlvbik9XCJjbG9zZUJ1dHRvblByZXNzZWQgPSB0cnVlOyBjbG9zZUJ1dHRvbkFjdGlvbi5lbWl0KClcIj5cclxuICAgICAgICAgICAgPC9zdGktYnV0dG9uPlxyXG4gICAgICAgICAgPC90ZD5cclxuXHJcbiAgICAgICAgICA8dGQgI3Jlc0J1dHRvbkVsICpuZ0lmPVwicmVzb3VyY2VCdXR0b25cIiBzdHlsZT1cIndpZHRoOiAxcHg7XCI+XHJcbiAgICAgICAgICAgIDxzdGktYnV0dG9uIFtpbWFnZU5hbWVdPVwiJ0Fycm93cy5TbWFsbEFycm93RG93bi5wbmcnXCJcclxuICAgICAgICAgICAgICBbc3R5bGVOYW1lXT1cIidzdGlKc1ZpZXdlclJlc291cmNlRHJvcERvd25CdXR0b24nXCJcclxuICAgICAgICAgICAgICBbaW5uZXJUYWJsZVdpZHRoXT1cIicxMDAlJ1wiXHJcbiAgICAgICAgICAgICAgW21hcmdpbl09XCInMCA3cHggMCAzcHgnXCJcclxuICAgICAgICAgICAgICBbaW1hZ2VDZWxsVGV4dEFsaWduXT1cIidjZW50ZXInXCJcclxuICAgICAgICAgICAgICBbaW1hZ2VTaXplc1dpZHRoXT1cIjhcIlxyXG4gICAgICAgICAgICAgIFtpbWFnZVNpemVzSGVpZ2h0XT1cIjhcIlxyXG4gICAgICAgICAgICAgIFtoZWlnaHRdPVwibW9kZWwub3B0aW9ucy5pc1RvdWNoRGV2aWNlID8gJzIzcHgnIDogJzE3cHgnXCJcclxuICAgICAgICAgICAgICBbd2lkdGhdPVwibW9kZWwub3B0aW9ucy5pc1RvdWNoRGV2aWNlID8gJzIzcHgnIDogJzE3cHgnXCJcclxuICAgICAgICAgICAgICAoYWN0aW9uKT1cInJlc291cmNlQnV0dG9uUHJlc3NlZCA9IHRydWU7XCI+PlxyXG4gICAgICAgICAgICA8L3N0aS1idXR0b24+XHJcbiAgICAgICAgICA8L3RkPlxyXG5cclxuICAgICAgICA8L3RyPlxyXG4gICAgICA8L3Rib2R5PlxyXG4gICAgPC90YWJsZT5cclxuICA8L2Rpdj5cclxuICBgXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBCdXR0b25Db21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xyXG5cclxuICBASW5wdXQoKSBjYXB0aW9uOiBzdHJpbmc7XHJcbiAgQElucHV0KCkgY2FwdGlvbjI6IHN0cmluZztcclxuICBASW5wdXQoKSBjYXB0aW9uQWxpZ246IHN0cmluZztcclxuICBASW5wdXQoKSBjYXB0aW9uUGFkZGluZzogc3RyaW5nO1xyXG4gIEBJbnB1dCgpIGNhcHRpb25QYWRkaW5nTGVmdDogc3RyaW5nO1xyXG4gIEBJbnB1dCgpIGNhcHRpb25XaGl0ZVNwYWNlOiBzdHJpbmc7XHJcbiAgQElucHV0KCkgY2FwdGlvbk92ZXJmbG93OiBzdHJpbmc7XHJcbiAgQElucHV0KCkgY2FwdGlvblRleHRPdmVyZmxvdzogc3RyaW5nO1xyXG4gIEBJbnB1dCgpIGNhcHRpb25XaWR0aDogc3RyaW5nO1xyXG4gIEBJbnB1dCgpIGNhcHRpb25NYXhXaWR0aDogc3RyaW5nO1xyXG4gIEBJbnB1dCgpIGNhcHRpb25MaW5lSGVpZ2h0OiBzdHJpbmc7XHJcbiAgQElucHV0KCkgaW1hZ2VOYW1lOiBzdHJpbmc7XHJcbiAgQElucHV0KCkgYXJyb3c6IHN0cmluZztcclxuICBASW5wdXQoKSBhcnJvd01hcmdpblRvcDogc3RyaW5nO1xyXG4gIEBJbnB1dCgpIG1hcmdpbiA9ICcxcHgnO1xyXG4gIEBJbnB1dCgpIGhlaWdodCA9ICcyM3B4JztcclxuICBASW5wdXQoKSBzZWxlY3RlZCA9IGZhbHNlO1xyXG4gIEBJbnB1dCgpIG1pbldpZHRoOiBzdHJpbmc7XHJcbiAgQElucHV0KCkgaW5uZXJUYWJsZVdpZHRoOiBzdHJpbmc7XHJcbiAgQElucHV0KCkgbWVudUl0ZW1zOiBNZW51SXRlbVtdO1xyXG4gIEBJbnB1dCgpIGFjdGlvbk5hbWU6IHN0cmluZztcclxuICBASW5wdXQoKSB0b29sdGlwOiBhbnk7XHJcbiAgQElucHV0KCkgaW1hZ2VDZWxsVGV4dEFsaWduID0gJ2NlbnRlcic7XHJcbiAgQElucHV0KCkgaW1hZ2VDZWxsV2lkdGg6IHN0cmluZztcclxuICBASW5wdXQoKSBpbWFnZUNlbGxQYWRkaW5nOiBzdHJpbmc7XHJcbiAgQElucHV0KCkgaW1hZ2VTaXplc1dpZHRoID0gMTY7XHJcbiAgQElucHV0KCkgaW1hZ2VTaXplc0hlaWdodCA9IDE2O1xyXG4gIEBJbnB1dCgpIGltYWdlTWFyZ2luOiBzdHJpbmc7XHJcbiAgQElucHV0KCkgd2lkdGg6IHN0cmluZztcclxuICBASW5wdXQoKSBkaXNwbGF5OiBzdHJpbmc7XHJcbiAgQElucHV0KCkgY2xvc2VCdXR0b24gPSBmYWxzZTtcclxuICBASW5wdXQoKSByZXNvdXJjZUJ1dHRvbiA9IGZhbHNlO1xyXG4gIEBJbnB1dCgpIHN0eWxlQ29sb3JzOiBhbnk7XHJcbiAgQElucHV0KCkgYm94U2l6aW5nOiBzdHJpbmc7XHJcbiAgQElucHV0KCkgbmF2YWdhdGlvblBhbmVsVG9vbHRpcCA9IGZhbHNlO1xyXG4gIEBJbnB1dCgpIGN1cnNvcjogc3RyaW5nO1xyXG4gIEBJbnB1dCgpIGZvbnRTaXplOiBzdHJpbmc7XHJcbiAgQElucHV0KCkgaGVscExpbmsgPSAndXNlci1tYW51YWwvaW5kZXguaHRtbD92aWV3ZXJfcmVwb3J0cy5odG0nO1xyXG4gIEBJbnB1dCgpIGJvcmRlckNvbG9yO1xyXG5cclxuICBAT3V0cHV0KCkgYWN0aW9uOiBFdmVudEVtaXR0ZXI8YW55PiA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICBAT3V0cHV0KCkgY2xvc2VCdXR0b25BY3Rpb246IEV2ZW50RW1pdHRlcjxhbnk+ID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gIEBWaWV3Q2hpbGQoJ2J1dHRvbicpIGJ1dHRvbjogRWxlbWVudFJlZjtcclxuICBAVmlld0NoaWxkKCdyZXNCdXR0b25FbCcpIHJlc0J1dHRvbkVsOiBFbGVtZW50UmVmO1xyXG5cclxuICBvdmVyID0gZmFsc2U7XHJcbiAgc2hvd01lbnUgPSBmYWxzZTtcclxuICBjbG9zZUJ1dHRvblByZXNzZWQgPSBmYWxzZTtcclxuICByZXNvdXJjZUJ1dHRvblByZXNzZWQgPSBmYWxzZTtcclxuICBwcml2YXRlIF9lbmFibGVkID0gdHJ1ZTtcclxuICBwcml2YXRlIF9zdHlsZU5hbWU6IHN0cmluZztcclxuICBwcml2YXRlIG1lbnVPYmo6IE1lbnU7XHJcbiAgcHJpdmF0ZSBjYW5TaG93VG9vbHRpcCA9IHRydWU7XHJcblxyXG4gIGNvbnN0cnVjdG9yKHB1YmxpYyBtb2RlbDogTW9kZWxTZXJ2aWNlLCBwdWJsaWMgY29udHJvbGxlcjogQ29udHJvbGxlclNlcnZpY2UsIHB1YmxpYyBtZW51U2VydmljZTogTWVudVNlcnZpY2UsIHByaXZhdGUgdG9vbHRpcFNlcnZpY2U6IFRvb2x0aXBTZXJ2aWNlLFxyXG4gICAgcHVibGljIGhlbHBlcjogSGVscGVyU2VydmljZSkgeyB9XHJcblxyXG4gIG5nT25Jbml0KCk6IHZvaWQge1xyXG4gICAgaWYgKHRoaXMubWVudUl0ZW1zKSB7XHJcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgIHRoaXMubWVudU9iaiA9IHsgdHlwZTogJ2J1dHRvbk1lbnUnLCBuYW1lOiB0aGlzLmFjdGlvbk5hbWUsIGl0ZW1zOiB0aGlzLm1lbnVJdGVtcywgcGFyZW50OiAhdGhpcy5yZXNvdXJjZUJ1dHRvbiA/IHRoaXMuYnV0dG9uIDogdGhpcy5yZXNCdXR0b25FbCB9O1xyXG4gICAgICAgIHRoaXMubWVudVNlcnZpY2UuYWRkTWVudSh0aGlzLm1lbnVPYmopO1xyXG4gICAgICB9LCA1MDApO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgQElucHV0KCkgZ2V0IHN0eWxlTmFtZSgpOiBzdHJpbmcge1xyXG4gICAgcmV0dXJuIHRoaXMuX3N0eWxlTmFtZSB8fCAnc3RpSnNWaWV3ZXJTdGFuZGFydFNtYWxsQnV0dG9uJztcclxuICB9XHJcblxyXG4gIHNldCBzdHlsZU5hbWUodmFsdWU6IHN0cmluZykge1xyXG4gICAgdGhpcy5fc3R5bGVOYW1lID0gdmFsdWU7XHJcbiAgfVxyXG5cclxuICBASW5wdXQoKSBnZXQgZW5hYmxlZCgpOiBib29sZWFuIHtcclxuICAgIHJldHVybiB0aGlzLl9lbmFibGVkO1xyXG4gIH1cclxuXHJcbiAgc2V0IGVuYWJsZWQodmFsdWU6IGJvb2xlYW4pIHtcclxuICAgIGlmICghdmFsdWUpIHtcclxuICAgICAgdGhpcy5vdmVyID0gZmFsc2U7XHJcbiAgICB9XHJcbiAgICB0aGlzLl9lbmFibGVkID0gdmFsdWU7XHJcbiAgfVxyXG5cclxuICBtb3VzZW92ZXIoKSB7XHJcbiAgICBpZiAoIXRoaXMuZW5hYmxlZCkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICB0aGlzLm92ZXIgPSB0cnVlO1xyXG5cclxuICAgIGlmICh0aGlzLm1vZGVsLm9wdGlvbnMudG9vbGJhci5zaG93TWVudU1vZGUgPT09ICdIb3ZlcicgJiYgWydQcmludCcsICdTYXZlJywgJ1NlbmRFbWFpbCcsICdab29tJywgJ1ZpZXdNb2RlJ10uc29tZShhID0+IGEgPT09IHRoaXMuYWN0aW9uTmFtZSkpIHtcclxuICAgICAgdGhpcy50b29sdGlwU2VydmljZS5oaWRlSW1tZWRpYXRlbHkoKTtcclxuICAgICAgdGhpcy5tZW51U2VydmljZS5zaG93TWVudSh0aGlzLmFjdGlvbk5hbWUpO1xyXG4gICAgfSBlbHNlIGlmICh0aGlzLnRvb2x0aXAgJiYgIXRoaXMubWVudVNlcnZpY2UubWVudXMuc29tZShlID0+IGUuc3RhdGUgPT09ICdleHBhbmRlZCcpICYmIHRoaXMuY2FuU2hvd1Rvb2x0aXApIHtcclxuICAgICAgY29uc3QgdG9wID0gIXRoaXMubmF2YWdhdGlvblBhbmVsVG9vbHRpcCA/IHRoaXMubW9kZWwuY29udHJvbHMudG9vbGJhci5vZmZzZXRIZWlnaHQgKyB0aGlzLm1vZGVsLmNvbnRyb2xzLmRhc2hib2FyZHNQYW5lbC5vZmZzZXRIZWlnaHQgOlxyXG4gICAgICAgIHRoaXMuaGVscGVyLmZpbmRQb3NZKHRoaXMubW9kZWwuY29udHJvbHMubmF2aWdhdGVQYW5lbC5lbC5uYXRpdmVFbGVtZW50LCAnc3RpSnNWaWV3ZXJNYWluUGFuZWwnKTtcclxuICAgICAgY29uc3QgdG9vbHRpcCA9IHRoaXMudG9vbHRpcCA9PT0gdHJ1ZSA/ICh0aGlzLm1vZGVsLmxvY2FsaXphdGlvblt0aGlzLmFjdGlvbk5hbWUgKyAnVG9vbFRpcCddICE9IG51bGwgPyB0aGlzLm1vZGVsLmxvYyh0aGlzLmFjdGlvbk5hbWUgKyAnVG9vbFRpcCcpIDogdGhpcy5tb2RlbC5sb2ModGhpcy5hY3Rpb25OYW1lKSkgOiB0aGlzLnRvb2x0aXA7XHJcbiAgICAgIHRoaXMudG9vbHRpcFNlcnZpY2Uuc2hvdyh0aGlzLmhlbHBlci5maW5kUG9zWCh0aGlzLmJ1dHRvbi5uYXRpdmVFbGVtZW50LCAnc3RpSnNWaWV3ZXJNYWluUGFuZWwnKSxcclxuICAgICAgICB0b3AsIHRvb2x0aXAsICF0aGlzLm5hdmFnYXRpb25QYW5lbFRvb2x0aXAsIHRoaXMuaGVscExpbmspO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgbW91c2VvdXQoKSB7XHJcbiAgICBpZiAoIXRoaXMuZW5hYmxlZCkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICB0aGlzLm92ZXIgPSBmYWxzZTtcclxuICAgIHRoaXMudG9vbHRpcFNlcnZpY2UuaGlkZSgpO1xyXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgIHRoaXMuY2FuU2hvd1Rvb2x0aXAgPSB0cnVlO1xyXG4gICAgfSwgMTAwMCk7XHJcbiAgfVxyXG5cclxuICBjbGljaygpIHtcclxuICAgIGlmICh0aGlzLmVuYWJsZWQgJiYgIXRoaXMuY2xvc2VCdXR0b25QcmVzc2VkKSB7XHJcbiAgICAgIHRoaXMudG9vbHRpcFNlcnZpY2UuaGlkZUltbWVkaWF0ZWx5KCk7XHJcbiAgICAgIGlmICh0aGlzLm1lbnVJdGVtcyA9PSBudWxsIHx8ICh0aGlzLnJlc291cmNlQnV0dG9uICYmICF0aGlzLnJlc291cmNlQnV0dG9uUHJlc3NlZCkpIHtcclxuICAgICAgICB0aGlzLmFjdGlvbi5lbWl0KCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhpcy5tZW51U2VydmljZS5zaG93TWVudSh0aGlzLmFjdGlvbk5hbWUpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICB0aGlzLmNhblNob3dUb29sdGlwID0gZmFsc2U7XHJcbiAgICB0aGlzLmNsb3NlQnV0dG9uUHJlc3NlZCA9IGZhbHNlO1xyXG4gICAgdGhpcy5yZXNvdXJjZUJ1dHRvblByZXNzZWQgPSBmYWxzZTtcclxuICB9XHJcblxyXG4gIGdldCBjbGFzc05hbWUoKTogc3RyaW5nIHtcclxuICAgIHJldHVybiB0aGlzLnN0eWxlTmFtZSA/IHRoaXMuc3R5bGVOYW1lICsgJyAnICsgKHRoaXMuZW5hYmxlZCA/ICh0aGlzLnN0eWxlTmFtZSArICgodGhpcy5zZWxlY3RlZCB8fCB0aGlzLm1lbnVPYmo/LnN0YXRlID09PSAnZXhwYW5kZWQnKSA/ICdTZWxlY3RlZCcgOiAodGhpcy5vdmVyID8gJ092ZXInIDogJ0RlZmF1bHQnKSkpIDogdGhpcy5zdHlsZU5hbWUgKyAnRGlzYWJsZWQnKSA6ICcnO1xyXG4gIH1cclxufVxyXG4iXX0=