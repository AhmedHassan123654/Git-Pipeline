import { __decorate } from "tslib";
import { Component, ViewChild } from '@angular/core';
import { ControllerService } from '../services/controller.service';
import { ModelService } from '../services/model.service';
import { StylesService } from '../services/styles.service';
import { InteractionsService } from '../services/interactions.service';
let ReportPanelComponent = class ReportPanelComponent {
    constructor(controller, model, stylesService, interactionService) {
        this.controller = controller;
        this.model = model;
        this.stylesService = stylesService;
        this.interactionService = interactionService;
        this.touchZoomFirstDistance = 0;
        this.touchZoomSecondDistance = 0;
        this.touchZoomValue = 0;
        this.maxHeights = {};
        controller.getMessage().subscribe((message) => {
            if (message.action !== 'viewer_loaded' && this.model.reportParams.pagesArray) {
                if (this.model.reportParams.repaintOnlyDashboardContent) {
                    // jsObject.controls.reportPanel.repaintDashboardContent(parameters);
                }
                else {
                    this.loadPages();
                }
            }
            if (message.action === 'GetReport' || message.action === 'OpenReport') {
                setTimeout(() => {
                    if (!this.model.options.isParametersReceived && ((this.model.reportParams.type === 'Report' && this.model.options.toolbar.showParametersButton) || this.model.reportParams.type === 'Dashboard')) {
                        interactionService.postInteraction({ action: 'InitVars' });
                    }
                    if (this.model.reportParams.autoZoom) {
                        this.controller.action({ name: this.model.reportParams.autoZoom === -1 ? 'ZoomPageWidth' : 'ZoomOnePage' });
                        this.model.reportParams.autoZoom = null;
                    }
                });
            }
        });
    }
    ngOnInit() { }
    ngAfterViewInit() {
        this.model.controls.reportPanel.el = this.element;
    }
    loadPages() {
        this.maxHeights = {};
        const pagesArray = this.model.reportParams.pagesArray;
        this.stylesService.setupStyle(pagesArray[pagesArray.length - 2], 'page');
        const chartScript = pagesArray[pagesArray.length - 1];
        this.model.pages = pagesArray.slice(0, pagesArray.length - 2);
        setTimeout(() => {
            this.model.pages.forEach(page => this.interactionService.initializeInteractions(page.page));
            this.interactionService.updateAllHyperLinks();
            this.stylesService.addChartScript(chartScript);
        });
    }
    get position() {
        return this.model.options.heightType !== 'Percentage' || this.model.options.appearance.scrollbarsMode ? 'absolute' : 'relative';
    }
    scroll() {
        if (this.model.pagesNavigationIsActive()) {
            clearTimeout(this.scrollTimeout);
            // update current page number
            this.scrollTimeout = setTimeout(() => {
                let commonPagesHeight = 0;
                let index = 0;
                for (index = 0; index < this.model.pages.length; index++) {
                    commonPagesHeight += this.model.pages[index].page.offsetHeight + 10;
                    if (commonPagesHeight > this.element.nativeElement.scrollTop) {
                        break;
                    }
                }
                if (index < this.model.reportParams.pagesCount && index >= 0 && index !== this.model.reportParams.pageNumber) {
                    this.model.reportParams.pageNumber = index;
                }
            }, 300);
        }
    }
    eventTouchStart(e) {
        this.touchesLength++;
        this.touchStartX = parseInt(e.changedTouches[0].clientX, 10);
        if (this.model.options.appearance.allowTouchZoom && this.touchesLength === 1) {
            this.touchZoomFirstDistance = 0;
            this.touchZoomSecondDistance = 0;
            this.touchZoomValue = 0;
        }
    }
    eventTouchMove(e) {
        if (this.model.options.appearance.allowTouchZoom && e.touches.length > 1) {
            if ('preventDefault' in e) {
                e.preventDefault();
            }
            this.touchZoomSecondDistance = Math.sqrt(Math.pow(e.touches[0].pageX - e.touches[1].pageX, 2) + Math.pow(e.touches[0].pageY - e.touches[1].pageY, 2));
            if (this.touchZoomFirstDistance === 0) {
                this.touchZoomFirstDistance = Math.sqrt(Math.pow(e.touches[0].pageX - e.touches[1].pageX, 2) + Math.pow(e.touches[0].pageY - e.touches[1].pageY, 2));
            }
            const touchZoomOffset = Math.trunc((this.touchZoomSecondDistance - this.touchZoomFirstDistance) / 2.5);
            if (Math.abs(touchZoomOffset) >= 5) {
                this.touchZoomValue = Math.trunc((this.model.reportParams.zoom + touchZoomOffset) / 5) * 5;
                this.touchZoomValue = Math.min(Math.max(this.touchZoomValue, 20), 200);
                this.controller.actionSubject.next({ action: 'centerText', data: this.touchZoomValue.toString() });
            }
        }
    }
    eventTouchEnd(e) {
        if (this.touchesLength > 0) {
            this.touchesLength--;
        }
        if (this.model.options.isMobileDevice && this.model.options.toolbar.autoHide) {
            if (Math.trunc(this.touchStartX - e.changedTouches[0].clientX) !== 0) {
                this.controller.keepToolbar();
            }
            else {
                if (!this.model.controls.toolbar.visible) {
                    this.controller.showToolbar();
                }
                else {
                    this.controller.hideToolbar();
                }
            }
        }
        if (this.model.options.appearance.allowTouchZoom && this.touchZoomValue !== 0 && this.touchesLength === 0) {
            this.controller.actionSubject.next({ action: 'hideCenterText' });
            this.model.reportParams.zoom = this.touchZoomValue;
            this.controller.post('GetPages');
        }
    }
};
ReportPanelComponent.ctorParameters = () => [
    { type: ControllerService },
    { type: ModelService },
    { type: StylesService },
    { type: InteractionsService }
];
__decorate([
    ViewChild('element')
], ReportPanelComponent.prototype, "element", void 0);
ReportPanelComponent = __decorate([
    Component({
        selector: 'sti-report-panel',
        template: `
    <div #element
         [style.textAlign]="model.options.appearance.pageAlignment == 'default' ? 'center' : model.options.appearance.pageAlignment"
         [style.top]="0"
         [style.bottom]="0"
         [style.position]="position"
         [style.height]="model.options.heightType != 'Percentage' || model.options.appearance.scrollbarsMode ? 'auto' : 'calc(100% - 35px)'"
         [style.overflow] = "model.reportParams.type == 'Report' && model.options.appearance.scrollbarsMode ? 'auto' : 'hidden'"
         [style.marginTop.px]="model.controls.reportPanel.layout.top"
         [style.marginLeft.px]="model.controls.reportPanel.layout.left"
         [style.marginBottom.px]="position == 'absolute' ? model.controls.reportPanel.layout.bottom : 0"
         [style.paddingBottom.px]="position == 'relative' ? model.controls.reportPanel.layout.bottom : 0"
         [style.transition]="model.options.isMobileDevice ? 'margin 200ms ease' : null"
         (scroll)="scroll()"
         class="stiJsViewerReportPanel"
         (touchstart)="eventTouchStart($event)"
         (touchmove)="eventTouchMove($event)"
         (touchend)="eventTouchEnd($event)">
      <sti-page *ngFor="let page of model.pages" [pageAttributes]="page" [reportPanel]="this"></sti-page>
    </div>
  `
    })
], ReportPanelComponent);
export { ReportPanelComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVwb3J0LXBhbmVsLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL3N0aW11bHNvZnQtdmlld2VyLWFuZ3VsYXIvIiwic291cmNlcyI6WyJsaWIvY29tcG9uZW50cy9yZXBvcnQtcGFuZWwuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFVLFNBQVMsRUFBNkIsTUFBTSxlQUFlLENBQUM7QUFDeEYsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0sZ0NBQWdDLENBQUM7QUFDbkUsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLDJCQUEyQixDQUFDO0FBQ3pELE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSw0QkFBNEIsQ0FBQztBQUMzRCxPQUFPLEVBQUUsbUJBQW1CLEVBQUUsTUFBTSxrQ0FBa0MsQ0FBQztBQTRCdkUsSUFBYSxvQkFBb0IsR0FBakMsTUFBYSxvQkFBb0I7SUFhL0IsWUFBb0IsVUFBNkIsRUFBUyxLQUFtQixFQUFVLGFBQTRCLEVBQVUsa0JBQXVDO1FBQWhKLGVBQVUsR0FBVixVQUFVLENBQW1CO1FBQVMsVUFBSyxHQUFMLEtBQUssQ0FBYztRQUFVLGtCQUFhLEdBQWIsYUFBYSxDQUFlO1FBQVUsdUJBQWtCLEdBQWxCLGtCQUFrQixDQUFxQjtRQVA1SiwyQkFBc0IsR0FBRyxDQUFDLENBQUM7UUFDM0IsNEJBQXVCLEdBQUcsQ0FBQyxDQUFDO1FBQzVCLG1CQUFjLEdBQUcsQ0FBQyxDQUFDO1FBR3BCLGVBQVUsR0FBRyxFQUFFLENBQUM7UUFJckIsVUFBVSxDQUFDLFVBQVUsRUFBRSxDQUFDLFNBQVMsQ0FBQyxDQUFDLE9BQWdCLEVBQUUsRUFBRTtZQUVyRCxJQUFJLE9BQU8sQ0FBQyxNQUFNLEtBQUssZUFBZSxJQUFJLElBQUksQ0FBQyxLQUFLLENBQUMsWUFBWSxDQUFDLFVBQVUsRUFBRTtnQkFDNUUsSUFBSSxJQUFJLENBQUMsS0FBSyxDQUFDLFlBQVksQ0FBQywyQkFBMkIs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Q29tcG9uZW50LCBPbkluaXQsIFZpZXdDaGlsZCwgRWxlbWVudFJlZiwgQWZ0ZXJWaWV3SW5pdCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBDb250cm9sbGVyU2VydmljZSB9IGZyb20gJy4uL3NlcnZpY2VzL2NvbnRyb2xsZXIuc2VydmljZSc7XHJcbmltcG9ydCB7IE1vZGVsU2VydmljZSB9IGZyb20gJy4uL3NlcnZpY2VzL21vZGVsLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBTdHlsZXNTZXJ2aWNlIH0gZnJvbSAnLi4vc2VydmljZXMvc3R5bGVzLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBJbnRlcmFjdGlvbnNTZXJ2aWNlIH0gZnJvbSAnLi4vc2VydmljZXMvaW50ZXJhY3Rpb25zLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBNZXNzYWdlIH0gZnJvbSAnLi4vc2VydmljZXMvb2JqZWN0cyc7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogJ3N0aS1yZXBvcnQtcGFuZWwnLFxyXG4gIHRlbXBsYXRlOiBgXHJcbiAgICA8ZGl2ICNlbGVtZW50XHJcbiAgICAgICAgIFtzdHlsZS50ZXh0QWxpZ25dPVwibW9kZWwub3B0aW9ucy5hcHBlYXJhbmNlLnBhZ2VBbGlnbm1lbnQgPT0gJ2RlZmF1bHQnID8gJ2NlbnRlcicgOiBtb2RlbC5vcHRpb25zLmFwcGVhcmFuY2UucGFnZUFsaWdubWVudFwiXHJcbiAgICAgICAgIFtzdHlsZS50b3BdPVwiMFwiXHJcbiAgICAgICAgIFtzdHlsZS5ib3R0b21dPVwiMFwiXHJcbiAgICAgICAgIFtzdHlsZS5wb3NpdGlvbl09XCJwb3NpdGlvblwiXHJcbiAgICAgICAgIFtzdHlsZS5oZWlnaHRdPVwibW9kZWwub3B0aW9ucy5oZWlnaHRUeXBlICE9ICdQZXJjZW50YWdlJyB8fCBtb2RlbC5vcHRpb25zLmFwcGVhcmFuY2Uuc2Nyb2xsYmFyc01vZGUgPyAnYXV0bycgOiAnY2FsYygxMDAlIC0gMzVweCknXCJcclxuICAgICAgICAgW3N0eWxlLm92ZXJmbG93XSA9IFwibW9kZWwucmVwb3J0UGFyYW1zLnR5cGUgPT0gJ1JlcG9ydCcgJiYgbW9kZWwub3B0aW9ucy5hcHBlYXJhbmNlLnNjcm9sbGJhcnNNb2RlID8gJ2F1dG8nIDogJ2hpZGRlbidcIlxyXG4gICAgICAgICBbc3R5bGUubWFyZ2luVG9wLnB4XT1cIm1vZGVsLmNvbnRyb2xzLnJlcG9ydFBhbmVsLmxheW91dC50b3BcIlxyXG4gICAgICAgICBbc3R5bGUubWFyZ2luTGVmdC5weF09XCJtb2RlbC5jb250cm9scy5yZXBvcnRQYW5lbC5sYXlvdXQubGVmdFwiXHJcbiAgICAgICAgIFtzdHlsZS5tYXJnaW5Cb3R0b20ucHhdPVwicG9zaXRpb24gPT0gJ2Fic29sdXRlJyA/IG1vZGVsLmNvbnRyb2xzLnJlcG9ydFBhbmVsLmxheW91dC5ib3R0b20gOiAwXCJcclxuICAgICAgICAgW3N0eWxlLnBhZGRpbmdCb3R0b20ucHhdPVwicG9zaXRpb24gPT0gJ3JlbGF0aXZlJyA/IG1vZGVsLmNvbnRyb2xzLnJlcG9ydFBhbmVsLmxheW91dC5ib3R0b20gOiAwXCJcclxuICAgICAgICAgW3N0eWxlLnRyYW5zaXRpb25dPVwibW9kZWwub3B0aW9ucy5pc01vYmlsZURldmljZSA/ICdtYXJnaW4gMjAwbXMgZWFzZScgOiBudWxsXCJcclxuICAgICAgICAgKHNjcm9sbCk9XCJzY3JvbGwoKVwiXHJcbiAgICAgICAgIGNsYXNzPVwic3RpSnNWaWV3ZXJSZXBvcnRQYW5lbFwiXHJcbiAgICAgICAgICh0b3VjaHN0YXJ0KT1cImV2ZW50VG91Y2hTdGFydCgkZXZlbnQpXCJcclxuICAgICAgICAgKHRvdWNobW92ZSk9XCJldmVudFRvdWNoTW92ZSgkZXZlbnQpXCJcclxuICAgICAgICAgKHRvdWNoZW5kKT1cImV2ZW50VG91Y2hFbmQoJGV2ZW50KVwiPlxyXG4gICAgICA8c3RpLXBhZ2UgKm5nRm9yPVwibGV0IHBhZ2Ugb2YgbW9kZWwucGFnZXNcIiBbcGFnZUF0dHJpYnV0ZXNdPVwicGFnZVwiIFtyZXBvcnRQYW5lbF09XCJ0aGlzXCI+PC9zdGktcGFnZT5cclxuICAgIDwvZGl2PlxyXG4gIGBcclxufSlcclxuXHJcbmV4cG9ydCBjbGFzcyBSZXBvcnRQYW5lbENvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgQWZ0ZXJWaWV3SW5pdCB7XHJcblxyXG4gIEBWaWV3Q2hpbGQoJ2VsZW1lbnQnKSBlbGVtZW50OiBFbGVtZW50UmVmO1xyXG5cclxuICBwcml2YXRlIHNjcm9sbFRpbWVvdXQ6IGFueTtcclxuICBwcml2YXRlIHRvdWNoZXNMZW5ndGg6IG51bWJlcjtcclxuICBwcml2YXRlIHRvdWNoWm9vbUZpcnN0RGlzdGFuY2UgPSAwO1xyXG4gIHByaXZhdGUgdG91Y2hab29tU2Vjb25kRGlzdGFuY2UgPSAwO1xyXG4gIHByaXZhdGUgdG91Y2hab29tVmFsdWUgPSAwO1xyXG4gIHByaXZhdGUgdG91Y2hTdGFydFg6IG51bWJlcjtcclxuXHJcbiAgcHVibGljIG1heEhlaWdodHMgPSB7fTtcclxuXHJcbiAgY29uc3RydWN0b3IocHJpdmF0ZSBjb250cm9sbGVyOiBDb250cm9sbGVyU2VydmljZSwgcHVibGljIG1vZGVsOiBNb2RlbFNlcnZpY2UsIHByaXZhdGUgc3R5bGVzU2VydmljZTogU3R5bGVzU2VydmljZSwgcHJpdmF0ZSBpbnRlcmFjdGlvblNlcnZpY2U6IEludGVyYWN0aW9uc1NlcnZpY2UpIHtcclxuXHJcbiAgICBjb250cm9sbGVyLmdldE1lc3NhZ2UoKS5zdWJzY3JpYmUoKG1lc3NhZ2U6IE1lc3NhZ2UpID0+IHtcclxuXHJcbiAgICAgIGlmIChtZXNzYWdlLmFjdGlvbiAhPT0gJ3ZpZXdlcl9sb2FkZWQnICYmIHRoaXMubW9kZWwucmVwb3J0UGFyYW1zLnBhZ2VzQXJyYXkpIHtcclxuICAgICAgICBpZiAodGhpcy5tb2RlbC5yZXBvcnRQYXJhbXMucmVwYWludE9ubHlEYXNoYm9hcmRDb250ZW50KSB7XHJcbiAgICAgICAgICAvLyBqc09iamVjdC5jb250cm9scy5yZXBvcnRQYW5lbC5yZXBhaW50RGFzaGJvYXJkQ29udGVudChwYXJhbWV0ZXJzKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgdGhpcy5sb2FkUGFnZXMoKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmIChtZXNzYWdlLmFjdGlvbiA9PT0gJ0dldFJlcG9ydCcgfHwgbWVzc2FnZS5hY3Rpb24gPT09ICdPcGVuUmVwb3J0Jykge1xyXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgaWYgKCF0aGlzLm1vZGVsLm9wdGlvbnMuaXNQYXJhbWV0ZXJzUmVjZWl2ZWQgJiYgKCh0aGlzLm1vZGVsLnJlcG9ydFBhcmFtcy50eXBlID09PSAnUmVwb3J0JyAmJiB0aGlzLm1vZGVsLm9wdGlvbnMudG9vbGJhci5zaG93UGFyYW1ldGVyc0J1dHRvbikgfHwgdGhpcy5tb2RlbC5yZXBvcnRQYXJhbXMudHlwZSA9PT0gJ0Rhc2hib2FyZCcpKSB7XHJcbiAgICAgICAgICAgIGludGVyYWN0aW9uU2VydmljZS5wb3N0SW50ZXJhY3Rpb24oeyBhY3Rpb246ICdJbml0VmFycycgfSk7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgaWYgKHRoaXMubW9kZWwucmVwb3J0UGFyYW1zLmF1dG9ab29tKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY29udHJvbGxlci5hY3Rpb24oeyBuYW1lOiB0aGlzLm1vZGVsLnJlcG9ydFBhcmFtcy5hdXRvWm9vbSA9PT0gLTEgPyAnWm9vbVBhZ2VXaWR0aCcgOiAnWm9vbU9uZVBhZ2UnIH0pO1xyXG4gICAgICAgICAgICB0aGlzLm1vZGVsLnJlcG9ydFBhcmFtcy5hdXRvWm9vbSA9IG51bGw7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIG5nT25Jbml0KCkgeyB9XHJcblxyXG4gIG5nQWZ0ZXJWaWV3SW5pdCgpOiB2b2lkIHtcclxuICAgIHRoaXMubW9kZWwuY29udHJvbHMucmVwb3J0UGFuZWwuZWwgPSB0aGlzLmVsZW1lbnQ7XHJcbiAgfVxyXG5cclxuICBsb2FkUGFnZXMoKSB7XHJcbiAgICB0aGlzLm1heEhlaWdodHMgPSB7fTtcclxuICAgIGNvbnN0IHBhZ2VzQXJyYXk6IFtdID0gdGhpcy5tb2RlbC5yZXBvcnRQYXJhbXMucGFnZXNBcnJheTtcclxuICAgIHRoaXMuc3R5bGVzU2VydmljZS5zZXR1cFN0eWxlKHBhZ2VzQXJyYXlbcGFnZXNBcnJheS5sZW5ndGggLSAyXSwgJ3BhZ2UnKTtcclxuICAgIGNvbnN0IGNoYXJ0U2NyaXB0ID0gcGFnZXNBcnJheVtwYWdlc0FycmF5Lmxlbmd0aCAtIDFdO1xyXG4gICAgdGhpcy5tb2RlbC5wYWdlcyA9IHBhZ2VzQXJyYXkuc2xpY2UoMCwgcGFnZXNBcnJheS5sZW5ndGggLSAyKTtcclxuXHJcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgdGhpcy5tb2RlbC5wYWdlcy5mb3JFYWNoKHBhZ2UgPT4gdGhpcy5pbnRlcmFjdGlvblNlcnZpY2UuaW5pdGlhbGl6ZUludGVyYWN0aW9ucyhwYWdlLnBhZ2UpKTtcclxuICAgICAgdGhpcy5pbnRlcmFjdGlvblNlcnZpY2UudXBkYXRlQWxsSHlwZXJMaW5rcygpO1xyXG4gICAgICB0aGlzLnN0eWxlc1NlcnZpY2UuYWRkQ2hhcnRTY3JpcHQoY2hhcnRTY3JpcHQpO1xyXG4gICAgfSk7XHJcblxyXG4gIH1cclxuXHJcbiAgZ2V0IHBvc2l0aW9uKCk6IHN0cmluZyB7XHJcbiAgICByZXR1cm4gdGhpcy5tb2RlbC5vcHRpb25zLmhlaWdodFR5cGUgIT09ICdQZXJjZW50YWdlJyB8fCB0aGlzLm1vZGVsLm9wdGlvbnMuYXBwZWFyYW5jZS5zY3JvbGxiYXJzTW9kZSA/ICdhYnNvbHV0ZScgOiAncmVsYXRpdmUnO1xyXG4gIH1cclxuXHJcbiAgc2Nyb2xsKCkge1xyXG4gICAgaWYgKHRoaXMubW9kZWwucGFnZXNOYXZpZ2F0aW9uSXNBY3RpdmUoKSkge1xyXG4gICAgICBjbGVhclRpbWVvdXQodGhpcy5zY3JvbGxUaW1lb3V0KTtcclxuXHJcbiAgICAgIC8vIHVwZGF0ZSBjdXJyZW50IHBhZ2UgbnVtYmVyXHJcbiAgICAgIHRoaXMuc2Nyb2xsVGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgIGxldCBjb21tb25QYWdlc0hlaWdodCA9IDA7XHJcbiAgICAgICAgbGV0IGluZGV4ID0gMDtcclxuXHJcbiAgICAgICAgZm9yIChpbmRleCA9IDA7IGluZGV4IDwgdGhpcy5tb2RlbC5wYWdlcy5sZW5ndGg7IGluZGV4KyspIHtcclxuICAgICAgICAgIGNvbW1vblBhZ2VzSGVpZ2h0ICs9IHRoaXMubW9kZWwucGFnZXNbaW5kZXhdLnBhZ2Uub2Zmc2V0SGVpZ2h0ICsgMTA7XHJcbiAgICAgICAgICBpZiAoY29tbW9uUGFnZXNIZWlnaHQgPiB0aGlzLmVsZW1lbnQubmF0aXZlRWxlbWVudC5zY3JvbGxUb3ApIHtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoaW5kZXggPCB0aGlzLm1vZGVsLnJlcG9ydFBhcmFtcy5wYWdlc0NvdW50ICYmIGluZGV4ID49IDAgJiYgaW5kZXggIT09IHRoaXMubW9kZWwucmVwb3J0UGFyYW1zLnBhZ2VOdW1iZXIpIHtcclxuICAgICAgICAgIHRoaXMubW9kZWwucmVwb3J0UGFyYW1zLnBhZ2VOdW1iZXIgPSBpbmRleDtcclxuICAgICAgICB9XHJcbiAgICAgIH0sIDMwMCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZXZlbnRUb3VjaFN0YXJ0KGU6IGFueSkge1xyXG4gICAgdGhpcy50b3VjaGVzTGVuZ3RoKys7XHJcbiAgICB0aGlzLnRvdWNoU3RhcnRYID0gcGFyc2VJbnQoZS5jaGFuZ2VkVG91Y2hlc1swXS5jbGllbnRYLCAxMCk7XHJcblxyXG4gICAgaWYgKHRoaXMubW9kZWwub3B0aW9ucy5hcHBlYXJhbmNlLmFsbG93VG91Y2hab29tICYmIHRoaXMudG91Y2hlc0xlbmd0aCA9PT0gMSkge1xyXG4gICAgICB0aGlzLnRvdWNoWm9vbUZpcnN0RGlzdGFuY2UgPSAwO1xyXG4gICAgICB0aGlzLnRvdWNoWm9vbVNlY29uZERpc3RhbmNlID0gMDtcclxuICAgICAgdGhpcy50b3VjaFpvb21WYWx1ZSA9IDA7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZXZlbnRUb3VjaE1vdmUoZTogYW55KSB7XHJcbiAgICBpZiAodGhpcy5tb2RlbC5vcHRpb25zLmFwcGVhcmFuY2UuYWxsb3dUb3VjaFpvb20gJiYgZS50b3VjaGVzLmxlbmd0aCA+IDEpIHtcclxuICAgICAgaWYgKCdwcmV2ZW50RGVmYXVsdCcgaW4gZSkgeyBlLnByZXZlbnREZWZhdWx0KCk7IH1cclxuXHJcbiAgICAgIHRoaXMudG91Y2hab29tU2Vjb25kRGlzdGFuY2UgPSBNYXRoLnNxcnQoTWF0aC5wb3coZS50b3VjaGVzWzBdLnBhZ2VYIC0gZS50b3VjaGVzWzFdLnBhZ2VYLCAyKSArIE1hdGgucG93KGUudG91Y2hlc1swXS5wYWdlWSAtIGUudG91Y2hlc1sxXS5wYWdlWSwgMikpO1xyXG4gICAgICBpZiAodGhpcy50b3VjaFpvb21GaXJzdERpc3RhbmNlID09PSAwKSB7XHJcbiAgICAgICAgdGhpcy50b3VjaFpvb21GaXJzdERpc3RhbmNlID0gTWF0aC5zcXJ0KE1hdGgucG93KGUudG91Y2hlc1swXS5wYWdlWCAtIGUudG91Y2hlc1sxXS5wYWdlWCwgMikgKyBNYXRoLnBvdyhlLnRvdWNoZXNbMF0ucGFnZVkgLSBlLnRvdWNoZXNbMV0ucGFnZVksIDIpKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgY29uc3QgdG91Y2hab29tT2Zmc2V0ID0gTWF0aC50cnVuYygodGhpcy50b3VjaFpvb21TZWNvbmREaXN0YW5jZSAtIHRoaXMudG91Y2hab29tRmlyc3REaXN0YW5jZSkgLyAyLjUpO1xyXG4gICAgICBpZiAoTWF0aC5hYnModG91Y2hab29tT2Zmc2V0KSA+PSA1KSB7XHJcbiAgICAgICAgdGhpcy50b3VjaFpvb21WYWx1ZSA9IE1hdGgudHJ1bmMoKHRoaXMubW9kZWwucmVwb3J0UGFyYW1zLnpvb20gKyB0b3VjaFpvb21PZmZzZXQpIC8gNSkgKiA1O1xyXG4gICAgICAgIHRoaXMudG91Y2hab29tVmFsdWUgPSBNYXRoLm1pbihNYXRoLm1heCh0aGlzLnRvdWNoWm9vbVZhbHVlLCAyMCksIDIwMCk7XHJcbiAgICAgICAgdGhpcy5jb250cm9sbGVyLmFjdGlvblN1YmplY3QubmV4dCh7IGFjdGlvbjogJ2NlbnRlclRleHQnLCBkYXRhOiB0aGlzLnRvdWNoWm9vbVZhbHVlLnRvU3RyaW5nKCkgfSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIHB1YmxpYyBldmVudFRvdWNoRW5kKGU6IGFueSkge1xyXG4gICAgaWYgKHRoaXMudG91Y2hlc0xlbmd0aCA+IDApIHsgdGhpcy50b3VjaGVzTGVuZ3RoLS07IH1cclxuXHJcbiAgICBpZiAodGhpcy5tb2RlbC5vcHRpb25zLmlzTW9iaWxlRGV2aWNlICYmIHRoaXMubW9kZWwub3B0aW9ucy50b29sYmFyLmF1dG9IaWRlKSB7XHJcbiAgICAgIGlmIChNYXRoLnRydW5jKHRoaXMudG91Y2hTdGFydFggLSBlLmNoYW5nZWRUb3VjaGVzWzBdLmNsaWVudFgpICE9PSAwKSB7XHJcbiAgICAgICAgdGhpcy5jb250cm9sbGVyLmtlZXBUb29sYmFyKCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLm1vZGVsLmNvbnRyb2xzLnRvb2xiYXIudmlzaWJsZSkge1xyXG4gICAgICAgICAgdGhpcy5jb250cm9sbGVyLnNob3dUb29sYmFyKCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHRoaXMuY29udHJvbGxlci5oaWRlVG9vbGJhcigpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGlmICh0aGlzLm1vZGVsLm9wdGlvbnMuYXBwZWFyYW5jZS5hbGxvd1RvdWNoWm9vbSAmJiB0aGlzLnRvdWNoWm9vbVZhbHVlICE9PSAwICYmIHRoaXMudG91Y2hlc0xlbmd0aCA9PT0gMCkge1xyXG4gICAgICB0aGlzLmNvbnRyb2xsZXIuYWN0aW9uU3ViamVjdC5uZXh0KHsgYWN0aW9uOiAnaGlkZUNlbnRlclRleHQnIH0pO1xyXG4gICAgICB0aGlzLm1vZGVsLnJlcG9ydFBhcmFtcy56b29tID0gdGhpcy50b3VjaFpvb21WYWx1ZTtcclxuICAgICAgdGhpcy5jb250cm9sbGVyLnBvc3QoJ0dldFBhZ2VzJyk7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbiJdfQ==