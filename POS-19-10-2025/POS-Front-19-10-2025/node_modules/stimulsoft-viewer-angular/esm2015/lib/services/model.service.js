import { __decorate } from "tslib";
import { Injectable } from '@angular/core';
import { ControlClass } from './objects';
let ModelService = class ModelService {
    constructor() {
        this._reportParams = {};
        this.controls = new ControlClass();
        this.pages = [];
        this.months = [];
        this.dayOfWeek = [];
        this.dateRanges = [];
        this.encodingData = [];
        this.pdfSecurityCertificates = [];
        this.paperSizes = [];
        this.drillDownButtons = [];
        this.showProgress = false;
    }
    get reportParams() {
        return this._reportParams;
    }
    set reportParams(parameters) {
        this._reportParams.pagesArray = parameters.pagesArray;
        // Apply new report parameters, if not update current page
        if (parameters.action && parameters.action !== 'GetPages') {
            this.reportParams.type = parameters.reportType;
            this.reportParams.drillDownGuid = parameters.drillDownGuid;
            this.reportParams.dashboardDrillDownGuid = parameters.dashboardDrillDownGuid;
            this.reportParams.pagesCount = parameters.pagesCount;
            if (parameters.pageNumber != null) {
                this.reportParams.pageNumber = parameters.pageNumber;
            }
            this.reportParams.zoom = parameters.zoom;
            this.reportParams.viewMode = parameters.viewMode;
            this.reportParams.reportFileName = parameters.reportFileName;
            this.reportParams.collapsingStates = parameters.collapsingStates;
            if (parameters.bookmarksContent) {
                this.reportParams.bookmarksContent = parameters.bookmarksContent;
            }
            if (parameters.resources) {
                this.reportParams.resources = parameters.resources;
            }
            this.reportParams.isCompilationMode = parameters.isCompilationMode;
            if (parameters.variablesValues) {
                this.reportParams.variablesValues = parameters.variablesValues;
            }
            if (parameters.parametersDateFormat) {
                this.options.appearance.parametersPanelDateFormat = parameters.parametersDateFormat;
            }
            if (parameters.tableOfContentsPointers)
                this.reportParams.tableOfContentsPointers = parameters.tableOfContentsPointers;
            this.reportParams.isEditableReport = parameters.isEditableReport;
            if (parameters.userValues) {
                this.options.userValues = parameters.userValues;
            }
            this.reportParams.dashboards = parameters.dashboards;
            this.reportParams.previewSettings = parameters.previewSettings;
        }
    }
    setReportParams(parameters) {
        this._reportParams = parameters;
    }
    getReportParams() {
        return this.copyObject(this._reportParams);
    }
    copyObject(o) {
        if (!o || 'object' !== typeof o) {
            return o;
        }
        const c = 'function' === typeof o.pop ? [] : {};
        let p;
        let v;
        for (p in o) {
            if (o.hasOwnProperty(p) && p !== 'pagesArray') {
                v = o[p];
                if (v && 'object' === typeof v) {
                    c[p] = this.copyObject(v);
                }
                else {
                    c[p] = v;
                }
            }
        }
        return c;
    }
    set options(data) {
        this._options = this.toLower(data.options);
        if (data.jsOptions) {
            for (const key in data.jsOptions) {
                if (data.jsOptions.hasOwnProperty(key)) {
                    this._options[key] = data.jsOptions[key];
                }
            }
        }
        this._options.exports.defaultSettings = data.defaultSettings;
        this.localization = data.loc;
        this.months = data.months;
        this.dayOfWeek = data.dayOfWeek;
        this.images = data.images;
        this.dateRanges = data.dateRanges;
        this.paperSizes = data.paperSizes;
        this.encodingData = data.encodingData;
        this.pdfSecurityCertificates = data.pdfSecurityCertificates;
        this.clearViewerState();
        this.setupOptions();
    }
    get options() {
        return this._options;
    }
    loc(attr) {
        var _a;
        return _a = this.localization[attr], (_a !== null && _a !== void 0 ? _a : attr);
    }
    img(name) {
        var _a;
        if (name != null && name.length > 0 && !this.images[name]) {
            //console.warn(`Image: ${name} not found`);
        }
        return _a = this.images[name], (_a !== null && _a !== void 0 ? _a : '');
    }
    toLower(obj) {
        const result = {};
        Object.keys(obj).forEach(key => {
            result[key.substr(0, 1).toLowerCase() + key.substr(1)] = (typeof (obj[key]) === 'object' && obj[key] !== null) ? this.toLower(obj[key]) : obj[key];
        });
        return result;
    }
    clear() {
        this._options = undefined;
        this._reportParams = {};
        this._imagesForBookmark = undefined;
        this.pages = [];
        this.form = null;
    }
    clearViewerState() {
        this.reportParams = {};
        this.reportParams.type = 'Auto';
        this.reportParams.pageNumber = 0;
        this.reportParams.originalPageNumber = 0;
        this.reportParams.drillDownGuid = null;
        this.reportParams.dashboardDrillDownGuid = null;
        this.reportParams.collapsingStates = null;
        this.reportParams.bookmarksContent = null;
        this.reportParams.editableParameters = null;
        this.reportParams.resources = null;
        this.reportParams.drillDownParameters = [];
        this.reportParams.elementName = null;
        this.reportParams.variablesValues = null;
        this.reportParams.tableOfContentsPointers = [];
        this.reportParams.isEditableReport = false;
        this.options.viewerId = this.newToken();
        this.options.clientGuid = this.newToken();
        this.options.paramsVariables = null;
        this.options.multiFilterStates = null;
        this.options.isParametersReceived = false;
        this.options.drillDownInProgress = false;
        // this.controls.mainPanel.style.background = '';
        // this.tableElementGridStates = {};
        // Restore current page number, if reload current report
        if (this.reportParams.prevPageNumber) {
            this.reportParams.pageNumber = this.reportParams.prevPageNumber;
            delete this.reportParams.prevPageNumber;
        }
        this.fullScreenOptions = null;
        this.drillDownButtons = [];
        this.controls.parametersPanel.visible = false;
        this.controls.bookmarksPanel.visible = false;
        this.interactions = null;
        /*
        this.controls.drillDownPanel.visible = false;
        this.controls.findPanel.visible = false;
        this.controls.parametersPanel.visible = false;
        this.controls.resourcesPanel.visible = false;*/
    }
    style(value) {
        return value !== '' && value != null ? value : '';
    }
    createPostParameters(data, asObject = true, useOptions = true) {
        var _a, _b, _c, _d;
        let params;
        // Object params
        const postParams = {
            stiweb_component: 'Viewer',
            stiweb_imagesScalingFactor: this.getImagesScalingFactor()
        };
        if (this.properties) {
            postParams['properties'] = btoa(JSON.stringify(this.properties));
        }
        if (this.options && useOptions) {
            params = {
                viewerId: this.options.viewerId,
                routes: this.options.routes,
                formValues: this.options.formValues,
                clientGuid: this.options.clientGuid,
                drillDownGuid: this.reportParams.drillDownGuid,
                dashboardDrillDownGuid: this.reportParams.dashboardDrillDownGuid,
                cacheMode: this.options.server.cacheMode,
                cacheTimeout: this.options.server.cacheTimeout,
                cacheItemPriority: this.options.server.cacheItemPriority,
                pageNumber: this.reportParams.pageNumber,
                originalPageNumber: this.reportParams.originalPageNumber,
                reportType: this.reportParams.type,
                zoom: (this.reportParams.zoom && this.reportParams.zoom > 0) ? this.reportParams.zoom : (((_b = (_a = this.options) === null || _a === void 0 ? void 0 : _a.toolbar) === null || _b === void 0 ? void 0 : _b.zoom) > 0 ? (_d = (_c = this.options) === null || _c === void 0 ? void 0 : _c.toolbar) === null || _d === void 0 ? void 0 : _d.zoom : 100),
                viewMode: this.reportParams.viewMode || this.options.toolbar.viewMode,
                multiPageWidthCount: this.reportParams.multiPageWidthCount,
                multiPageHeightCount: this.reportParams.multiPageHeightCount,
                multiPageContainerWidth: this.reportParams.multiPageContainerWidth,
                multiPageContainerHeight: this.reportParams.multiPageContainerHeight,
                multiPageMargins: this.reportParams.multiPageMargins,
                showBookmarks: this.options.toolbar.showBookmarksButton,
                openLinksWindow: this.options.appearance.openLinksWindow,
                chartRenderType: this.options.appearance.chartRenderType,
                reportDisplayMode: this.options.appearance.reportDisplayMode,
                drillDownParameters: this.reportParams.drillDownParameters,
                editableParameters: this.reportParams.editableParameters,
                useRelativeUrls: this.options.server.useRelativeUrls,
                passQueryParametersForResources: this.options.server.passQueryParametersForResources,
                passQueryParametersToReport: this.options.server.passQueryParametersToReport,
                version: this.options.shortProductVersion,
                reportDesignerMode: this.options.reportDesignerMode,
                imagesQuality: this.options.appearance.imagesQuality,
                parametersPanelSortDataItems: this.options.appearance.parametersPanelSortDataItems,
                combineReportPages: this.options.appearance.combineReportPages,
                isAngular: true,
                allowAutoUpdateCookies: this.options.server.allowAutoUpdateCookies
            };
            if (this.options.server.useLocalizedCache && this.options.localization) {
                params['useLocalizedCache'] = true;
                params['localization'] = this.options.localization;
            }
            if (this.options.userValues) {
                params['userValues'] = this.options.userValues;
            }
        }
        else {
            params = {};
        }
        if (data) {
            Object.keys(data).forEach(key => params[key] = data[key]);
        }
        // Object params
        if (params.action) {
            postParams['stiweb_action'] = params.action;
            delete params.action;
        }
        if (params.base64Data) {
            postParams['stiweb_data'] = params.base64Data;
            delete params.base64Data;
        }
        if (this.options && useOptions) {
            // Params
            const jsonParams = JSON.stringify(params);
            if (this.options.server.useCompression) {
                // postParams['stiweb_packed_parameters'] = StiGZipHelper.pack(jsonParams);
                postParams['stiweb_parameters'] = btoa(jsonParams);
            }
            else {
                postParams['stiweb_parameters'] = btoa(jsonParams);
            }
        }
        if (asObject) {
            return postParams;
        }
    }
    newToken() {
        const a = '1234567890abcdefghijklmnopqrstuvwxyz'.split('');
        const b = [];
        const length = 32;
        for (let i = 0; i < length; i++) {
            const j = (Math.random() * (a.length - 1)).toFixed(0);
            b[i] = a[j];
        }
        return b.join('');
    }
    setupOptions() {
        var _a, _b, _c, _d, _e, _f;
        if (!this.options.exports.showExportToPowerPoint && !this.options.exports.showExportToPdf && !this.options.exports.showExportToXps &&
            !this.options.exports.showExportToOpenDocumentWriter && !this.options.exports.showExportToOpenDocumentCalc && !this.options.exports.showExportToText &&
            !this.options.exports.showExportToRtf && !this.options.exports.showExportToWord2007 && !this.options.exports.showExportToCsv && !this.options.exports.showExportToJson &&
            !this.options.exports.showExportToDbf && !this.options.exports.showExportToXml && !this.options.exports.showExportToDif && !this.options.exports.showExportToSylk &&
            !this.options.exports.showExportToExcel && !this.options.exports.showExportToExcel2007 && !this.options.exports.showExportToExcelXml && !this.options.exports.showExportToHtml &&
            !this.options.exports.showExportToHtml5 && !this.options.exports.showExportToMht && !this.options.exports.showExportToImageBmp && !this.options.exports.showExportToImageGif &&
            !this.options.exports.showExportToImageJpeg && !this.options.exports.showExportToImageMetafile && !this.options.exports.showExportToImagePcx &&
            !this.options.exports.showExportToImagePng && !this.options.exports.showExportToImageTiff && !this.options.exports.showExportToImageSvg && !this.options.exports.showExportToImageSvgz) {
            if (!this.options.exports.showExportToDocument) {
                this.options.toolbar.showSaveButton = false;
            }
            this.options.toolbar.showSendEmailButton = false;
        }
        // Options
        this.options.isTouchDevice = this.options.appearance.interfaceType === 'Auto'
            ? this.isTouchDevice() && this.isMobileDevice()
            : this.options.appearance.interfaceType === 'Touch';
        this.options.isMobileDevice = this.options.appearance.interfaceType === 'Auto' && !this.options.reportDesignerMode
            ? this.isTouchDevice() && this.isMobileDevice()
            : this.options.appearance.interfaceType === 'Mobile';
        if (this.options.isMobileDevice) {
            this.initializeMobile();
        }
        else {
            this.options.toolbar.showPinToolbarButton = false;
        }
        this.controls.toolbar.visible = this.options.toolbar.visible;
        this.options.menuAnimDuration = 150;
        this.options.formAnimDuration = 200;
        this.options.scrollDuration = 350;
        this.options.menuHideDelay = 250;
        this.options.server.timeoutAutoUpdateCache = 180000;
        this.options.toolbar.backgroundColor = this.getHTMLColor(this.options.toolbar.backgroundColor);
        this.options.toolbar.borderColor = this.getHTMLColor(this.options.toolbar.borderColor);
        this.options.toolbar.fontColor = this.getHTMLColor(this.options.toolbar.fontColor);
        this.options.appearance.pageBorderColor = this.getHTMLColor(this.options.appearance.pageBorderColor);
        this.options.parametersValues = {};
        this.options.parameterRowHeight = this.options.isTouchDevice ? 35 : 30;
        this.options.minParametersCountForMultiColumns = 5;
        // First Day Of Week
        if (this.options.appearance.datePickerFirstDayOfWeek === 'Sunday') {
            this.dayOfWeek.splice(6, 1);
            this.dayOfWeek.splice(0, 0, 'Sunday');
        }
        if (((_b = (_a = this.options) === null || _a === void 0 ? void 0 : _a.toolbar) === null || _b === void 0 ? void 0 : _b.zoom) === -1 || ((_d = (_c = this.options) === null || _c === void 0 ? void 0 : _c.toolbar) === null || _d === void 0 ? void 0 : _d.zoom) === -2) {
            this.reportParams.autoZoom = (_f = (_e = this.options) === null || _e === void 0 ? void 0 : _e.toolbar) === null || _f === void 0 ? void 0 : _f.zoom;
        }
        // Actions
        if (!this.options.actions.getReport) {
            this.options.actions.getReport = this.options.actions.viewerEvent;
        }
        if (!this.options.actions.printReport) {
            this.options.actions.printReport = this.options.actions.viewerEvent;
        }
        if (!this.options.actions.openReport) {
            this.options.actions.openReport = this.options.actions.viewerEvent;
        }
        if (!this.options.actions.exportReport) {
            this.options.actions.exportReport = this.options.actions.viewerEvent;
        }
        if (!this.options.actions.interaction) {
            this.options.actions.interaction = this.options.actions.viewerEvent;
        }
        if (!(window.File && window.FileReader && window.FileList && window.Blob)) {
            this.options.toolbar.showOpenButton = false;
        }
        // Render JsViewer styles into HEAD
        if (this.options.requestResourcesUrl || this.options.appearance.customStylesUrl) {
            const viewerStyles = document.createElement('link');
            viewerStyles.setAttribute('type', 'text/css');
            viewerStyles.setAttribute('rel', 'stylesheet');
            viewerStyles.setAttribute('href', this.options.appearance.customStylesUrl || this.getResourceUrl('styles'));
            this.controls.head.appendChild(viewerStyles);
        }
        this.options.viewerId = (Math.random() * 1000000).toString();
    }
    pagesNavigationIsActive() {
        return (this.options.appearance.fullScreenMode || this.options.appearance.scrollbarsMode) && this.reportParams.viewMode === 'Continuous';
    }
    get imagesForBookmark() {
        if (!this._imagesForBookmark) {
            const names = ['root', 'folder', 'folderOpen', 'node', 'empty', 'line', 'join', 'joinBottom', 'plus', 'plusBottom', 'minus', 'minusBottom'];
            const imagesForBookmarks = {};
            names.forEach(name => imagesForBookmarks[name] = this.images['Bookmarks' + name + '.png']);
            this._imagesForBookmark = imagesForBookmarks;
        }
        return this._imagesForBookmark;
    }
    isTouchDevice() {
        return ('ontouchstart' in document.documentElement);
    }
    isMobileDevice() {
        return /iPhone|iPad|iPod|Macintosh|Android|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
    }
    initializeMobile() {
        let isViewPortExist = false;
        const metas = this.controls.head.getElementsByTagName('meta');
        for (const meta of metas) {
            if (meta.name && meta.name.toLowerCase() === 'viewport') {
                isViewPortExist = true;
                break;
            }
        }
        if (!isViewPortExist) {
            const viewPortTag = document.createElement('meta');
            viewPortTag.id = 'viewport';
            viewPortTag.name = 'viewport';
            viewPortTag.content = 'initial-scale=1.0,width=device-width,user-scalable=0';
            this.controls.head.appendChild(viewPortTag);
        }
        this.options.appearance.fullScreenMode = true;
        this.options.appearance.scrollbarsMode = true;
        this.options.appearance.parametersPanelPosition = 'Left';
        this.options.appearance.parametersPanelColumnsCount = 1;
        this.options.toolbar.displayMode = 'Separated';
        this.options.toolbar.viewMode = 'SinglePage';
        this.options.toolbar.showZoomButton = false;
        const defaultZoom = this.options.toolbar.zoom === -2 ? -2 : -1; // PageWidth or PageHeight
        this.options.toolbar.zoom = this.reportParams.zoom = defaultZoom;
        this.options.toolbar.showButtonCaptions = false;
        this.options.toolbar.showOpenButton = false;
        this.options.toolbar.showFindButton = false;
        this.options.toolbar.showEditorButton = false;
        this.options.toolbar.showFullScreenButton = false;
        this.options.toolbar.showAboutButton = false;
        this.options.toolbar.showViewModeButton = false;
    }
    getImagesScalingFactor() {
        const wnd = window;
        const devicePixelRatio = window.devicePixelRatio || (wnd.deviceXDPI && wnd.logicalXDPI ? wnd.deviceXDPI / wnd.logicalXDPI : 1);
        if (!devicePixelRatio || devicePixelRatio <= 1) {
            return '1';
        }
        else {
            return devicePixelRatio.toString();
        }
    }
    getHTMLColor(color) {
        if (color.indexOf(',') > 0 && color.indexOf('rgb') < 0) {
            return `rgb(${color})`;
        }
        return color;
    }
    getResourceUrl(resourceParameter) {
        let url = this.getActionRequestUrl(this.options.requestResourcesUrl, this.options.actions.viewerEvent);
        url += url.indexOf('?') > 0 ? '&' : '?';
        url += 'stiweb_component=Viewer&stiweb_action=Resource&stiweb_data=' + resourceParameter + '&stiweb_theme=' + this.options.theme;
        url += '&stiweb_cachemode=' + (this.options.server.useCacheForResources
            ? this.options.server.cacheMode === 'ObjectSession' || this.options.server.cacheMode === 'StringSession'
                ? 'session'
                : 'cache'
            : 'none');
        url += '&stiweb_version=' + this.options.shortProductVersion;
        return url;
    }
    getActionRequestUrl(requestUrl, action) {
        if (!action) {
            return requestUrl;
        }
        if (action.indexOf('?') < 0) {
            return requestUrl.replace('{action}', action);
        }
        const query = action.substring(action.indexOf('?') + 1);
        action = action.substring(0, action.indexOf('?'));
        return requestUrl.replace('{action}', action) + (requestUrl.indexOf('?') > 0 ? '&' : '?') + query;
    }
};
ModelService = __decorate([
    Injectable()
], ModelService);
export { ModelService };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibW9kZWwuc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL3N0aW11bHNvZnQtdmlld2VyLWFuZ3VsYXIvIiwic291cmNlcyI6WyJsaWIvc2VydmljZXMvbW9kZWwuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUMzQyxPQUFPLEVBQUUsWUFBWSxFQUEyRixNQUFNLFdBQVcsQ0FBQztBQUdsSSxJQUFhLFlBQVksR0FBekIsTUFBYSxZQUFZO0lBbUN2QjtRQWpDUSxrQkFBYSxHQUFRLEVBQUUsQ0FBQztRQVF6QixhQUFRLEdBQWlCLElBQUksWUFBWSxFQUFFLENBQUM7UUFDNUMsVUFBSyxHQUFVLEVBQUUsQ0FBQztRQUNsQixXQUFNLEdBQWEsRUFBRSxDQUFDO1FBQ3RCLGNBQVMsR0FBYSxFQUFFLENBQUM7UUFDekIsZUFBVSxHQUFhLEVBQUUsQ0FBQztRQUMxQixpQkFBWSxHQUFVLEVBQUUsQ0FBQztRQUN6Qiw0QkFBdUIsR0FBVSxFQUFFLENBQUM7UUFDcEMsZUFBVSxHQUFhLEVBQUUsQ0FBQztRQUUxQixxQkFBZ0IsR0FBZ0IsRUFBRSxDQUFDO1FBU25DLGlCQUFZLEdBQUcsS0FBSyxDQUFDO0lBT1osQ0FBQztJQUVqQixJQUFXLFlBQVk7UUFDckIsT0FBTyxJQUFJLENBQUMsYUFBYSxDQUFDO0lBQzVCLENBQUM7SUFFRCxJQUFXLFlBQVksQ0FBQyxVQUFlO1FBQ3JDLElBQUksQ0FBQyxhQUFhLENBQUMsVUFBVSxHQUFHLFVBQVUsQ0FBQyxVQUFVLENBQUM7UUFFdEQsMERBQTBEO1FBQzFELElBQUksVUFBVSxDQUFDLE1BQU0sSUFBSSxVQUFVLENBQUMsTUFBTSxLQUFLLFVBQVUsRUFBRTtZQUN6RCxJQUFJLENBQUMsWUFBWSxDQUFDLElBQUksR0FBRyxVQUFVLENBQUMsVUFBVSxDQUFDO1lBQy9DLElBQUksQ0FBQyxZQUFZLENBQUMsYUFBYSxHQUFHLFVBQVUs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T0FBTyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsRUFBRTtZQUMzQixPQUFPLFVBQVUsQ0FBQyxPQUFPLENBQUMsVUFBVSxFQUFFLE1BQU0sQ0FBQyxDQUFDO1NBQy9DO1FBRUQsTUFBTSxLQUFLLEdBQUcsTUFBTSxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQ3hELE1BQU0sR0FBRyxNQUFNLENBQUMsU0FBUyxDQUFDLENBQUMsRUFBRSxNQUFNLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFFbEQsT0FBTyxVQUFVLENBQUMsT0FBTyxDQUFDLFVBQVUsRUFBRSxNQUFNLENBQUMsR0FBRyxDQUFDLFVBQVUsQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxHQUFHLEtBQUssQ0FBQztJQUNwRyxDQUFDO0NBQ0YsQ0FBQTtBQS9kWSxZQUFZO0lBRHhCLFVBQVUsRUFBRTtHQUNBLFlBQVksQ0ErZHhCO1NBL2RZLFlBQVkiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IENvbnRyb2xDbGFzcywgRHJpbGxEb3duLCBFcnJvck1lc3NhZ2UsIEludGVyYWN0aW9uT2JqZWN0LCBCb29rbWFya05vZGUsIEZvcm0sIE5vdGlmaWNhdGlvbkZvcm1PcHRpb25zIH0gZnJvbSAnLi9vYmplY3RzJztcclxuXHJcbkBJbmplY3RhYmxlKClcclxuZXhwb3J0IGNsYXNzIE1vZGVsU2VydmljZSB7XHJcbiAgcHJpdmF0ZSBfb3B0aW9uczogYW55O1xyXG4gIHByaXZhdGUgX3JlcG9ydFBhcmFtczogYW55ID0ge307XHJcbiAgcHJpdmF0ZSBfaW1hZ2VzRm9yQm9va21hcms6IGFueTtcclxuXHJcbiAgcHVibGljIHJlcXVlc3RVcmw6IHN0cmluZztcclxuICBwdWJsaWMgYWN0aW9uOiBzdHJpbmc7XHJcbiAgcHVibGljIHByb3BlcnRpZXM6IGFueTtcclxuXHJcbiAgcHVibGljIGxvY2FsaXphdGlvbjogYW55O1xyXG4gIHB1YmxpYyBjb250cm9sczogQ29udHJvbENsYXNzID0gbmV3IENvbnRyb2xDbGFzcygpO1xyXG4gIHB1YmxpYyBwYWdlczogYW55W10gPSBbXTtcclxuICBwdWJsaWMgbW9udGhzOiBzdHJpbmdbXSA9IFtdO1xyXG4gIHB1YmxpYyBkYXlPZldlZWs6IHN0cmluZ1tdID0gW107XHJcbiAgcHVibGljIGRhdGVSYW5nZXM6IHN0cmluZ1tdID0gW107XHJcbiAgcHVibGljIGVuY29kaW5nRGF0YTogYW55W10gPSBbXTtcclxuICBwdWJsaWMgcGRmU2VjdXJpdHlDZXJ0aWZpY2F0ZXM6IGFueVtdID0gW107XHJcbiAgcHVibGljIHBhcGVyU2l6ZXM6IHN0cmluZ1tdID0gW107XHJcbiAgcHVibGljIHZpZXdlclNpemU6IGFueTtcclxuICBwdWJsaWMgZHJpbGxEb3duQnV0dG9uczogRHJpbGxEb3duW10gPSBbXTtcclxuICBwdWJsaWMgb3BlbkRpYWxvZ0ZpbGVNYXNrOiBzdHJpbmc7XHJcbiAgcHVibGljIGltYWdlczogYW55O1xyXG4gIHB1YmxpYyBlcnJvck1lc3NhZ2U6IEVycm9yTWVzc2FnZTtcclxuICBwdWJsaWMgaHR0cEVycm9yOiBhbnk7XHJcbiAgcHVibGljIGludGVyYWN0aW9uczogSW50ZXJhY3Rpb25PYmplY3Q7XHJcbiAgcHVibGljIG5vZGVzOiBCb29rbWFya05vZGVbXTtcclxuICBwdWJsaWMgbmF2aWdhdGVOb2RlOiBCb29rbWFya05vZGU7XHJcbiAgcHVibGljIGZ1bGxTY3JlZW5PcHRpb25zOiBhbnk7XHJcbiAgcHVibGljIHNob3dQcm9ncmVzcyA9IGZhbHNlO1xyXG4gIHB1YmxpYyB0aW1lckF1dG9VcGRhdGVDYWNoZTogYW55O1xyXG4gIHB1YmxpYyByZWZyZXNoUmVwb3J0VGltZXI6IGFueTtcclxuICBwdWJsaWMgdG9vbGJhckhpZGVUaW1lcjogYW55O1xyXG4gIHB1YmxpYyBmb3JtOiBGb3JtO1xyXG4gIHB1YmxpYyBub3RpZmljYXRpb25Gb3JtT3B0aW9uczogTm90aWZpY2F0aW9uRm9ybU9wdGlvbnM7XHJcblxyXG4gIGNvbnN0cnVjdG9yKCkgeyB9XHJcblxyXG4gIHB1YmxpYyBnZXQgcmVwb3J0UGFyYW1zKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcG9ydFBhcmFtcztcclxuICB9XHJcblxyXG4gIHB1YmxpYyBzZXQgcmVwb3J0UGFyYW1zKHBhcmFtZXRlcnM6IGFueSkge1xyXG4gICAgdGhpcy5fcmVwb3J0UGFyYW1zLnBhZ2VzQXJyYXkgPSBwYXJhbWV0ZXJzLnBhZ2VzQXJyYXk7XHJcblxyXG4gICAgLy8gQXBwbHkgbmV3IHJlcG9ydCBwYXJhbWV0ZXJzLCBpZiBub3QgdXBkYXRlIGN1cnJlbnQgcGFnZVxyXG4gICAgaWYgKHBhcmFtZXRlcnMuYWN0aW9uICYmIHBhcmFtZXRlcnMuYWN0aW9uICE9PSAnR2V0UGFnZXMnKSB7XHJcbiAgICAgIHRoaXMucmVwb3J0UGFyYW1zLnR5cGUgPSBwYXJhbWV0ZXJzLnJlcG9ydFR5cGU7XHJcbiAgICAgIHRoaXMucmVwb3J0UGFyYW1zLmRyaWxsRG93bkd1aWQgPSBwYXJhbWV0ZXJzLmRyaWxsRG93bkd1aWQ7XHJcbiAgICAgIHRoaXMucmVwb3J0UGFyYW1zLmRhc2hib2FyZERyaWxsRG93bkd1aWQgPSBwYXJhbWV0ZXJzLmRhc2hib2FyZERyaWxsRG93bkd1aWQ7XHJcbiAgICAgIHRoaXMucmVwb3J0UGFyYW1zLnBhZ2VzQ291bnQgPSBwYXJhbWV0ZXJzLnBhZ2VzQ291bnQ7XHJcbiAgICAgIGlmIChwYXJhbWV0ZXJzLnBhZ2VOdW1iZXIgIT0gbnVsbCkgeyB0aGlzLnJlcG9ydFBhcmFtcy5wYWdlTnVtYmVyID0gcGFyYW1ldGVycy5wYWdlTnVtYmVyOyB9XHJcbiAgICAgIHRoaXMucmVwb3J0UGFyYW1zLnpvb20gPSBwYXJhbWV0ZXJzLnpvb207XHJcbiAgICAgIHRoaXMucmVwb3J0UGFyYW1zLnZpZXdNb2RlID0gcGFyYW1ldGVycy52aWV3TW9kZTtcclxuICAgICAgdGhpcy5yZXBvcnRQYXJhbXMucmVwb3J0RmlsZU5hbWUgPSBwYXJhbWV0ZXJzLnJlcG9ydEZpbGVOYW1lO1xyXG4gICAgICB0aGlzLnJlcG9ydFBhcmFtcy5jb2xsYXBzaW5nU3RhdGVzID0gcGFyYW1ldGVycy5jb2xsYXBzaW5nU3RhdGVzO1xyXG4gICAgICBpZiAocGFyYW1ldGVycy5ib29rbWFya3NDb250ZW50KSB7IHRoaXMucmVwb3J0UGFyYW1zLmJvb2ttYXJrc0NvbnRlbnQgPSBwYXJhbWV0ZXJzLmJvb2ttYXJrc0NvbnRlbnQ7IH1cclxuICAgICAgaWYgKHBhcmFtZXRlcnMucmVzb3VyY2VzKSB7IHRoaXMucmVwb3J0UGFyYW1zLnJlc291cmNlcyA9IHBhcmFtZXRlcnMucmVzb3VyY2VzOyB9XHJcbiAgICAgIHRoaXMucmVwb3J0UGFyYW1zLmlzQ29tcGlsYXRpb25Nb2RlID0gcGFyYW1ldGVycy5pc0NvbXBpbGF0aW9uTW9kZTtcclxuICAgICAgaWYgKHBhcmFtZXRlcnMudmFyaWFibGVzVmFsdWVzKSB7IHRoaXMucmVwb3J0UGFyYW1zLnZhcmlhYmxlc1ZhbHVlcyA9IHBhcmFtZXRlcnMudmFyaWFibGVzVmFsdWVzOyB9XHJcbiAgICAgIGlmIChwYXJhbWV0ZXJzLnBhcmFtZXRlcnNEYXRlRm9ybWF0KSB7IHRoaXMub3B0aW9ucy5hcHBlYXJhbmNlLnBhcmFtZXRlcnNQYW5lbERhdGVGb3JtYXQgPSBwYXJhbWV0ZXJzLnBhcmFtZXRlcnNEYXRlRm9ybWF0OyB9XHJcbiAgICAgIGlmIChwYXJhbWV0ZXJzLnRhYmxlT2ZDb250ZW50c1BvaW50ZXJzKSB0aGlzLnJlcG9ydFBhcmFtcy50YWJsZU9mQ29udGVudHNQb2ludGVycyA9IHBhcmFtZXRlcnMudGFibGVPZkNvbnRlbnRzUG9pbnRlcnM7XHJcbiAgICAgIHRoaXMucmVwb3J0UGFyYW1zLmlzRWRpdGFibGVSZXBvcnQgPSBwYXJhbWV0ZXJzLmlzRWRpdGFibGVSZXBvcnQ7XHJcbiAgICAgIGlmIChwYXJhbWV0ZXJzLnVzZXJWYWx1ZXMpIHsgdGhpcy5vcHRpb25zLnVzZXJWYWx1ZXMgPSBwYXJhbWV0ZXJzLnVzZXJWYWx1ZXM7IH1cclxuICAgICAgdGhpcy5yZXBvcnRQYXJhbXMuZGFzaGJvYXJkcyA9IHBhcmFtZXRlcnMuZGFzaGJvYXJkcztcclxuICAgICAgdGhpcy5yZXBvcnRQYXJhbXMucHJldmlld1NldHRpbmdzID0gcGFyYW1ldGVycy5wcmV2aWV3U2V0dGluZ3M7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgc2V0UmVwb3J0UGFyYW1zKHBhcmFtZXRlcnM6IGFueSkge1xyXG4gICAgdGhpcy5fcmVwb3J0UGFyYW1zID0gcGFyYW1ldGVycztcclxuICB9XHJcblxyXG4gIHB1YmxpYyBnZXRSZXBvcnRQYXJhbXMoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5jb3B5T2JqZWN0KHRoaXMuX3JlcG9ydFBhcmFtcyk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgY29weU9iamVjdChvOiBhbnkpOiBhbnkge1xyXG4gICAgaWYgKCFvIHx8ICdvYmplY3QnICE9PSB0eXBlb2Ygbykge1xyXG4gICAgICByZXR1cm4gbztcclxuICAgIH1cclxuICAgIGNvbnN0IGMgPSAnZnVuY3Rpb24nID09PSB0eXBlb2Ygby5wb3AgPyBbXSA6IHt9O1xyXG4gICAgbGV0IHA7XHJcbiAgICBsZXQgdjtcclxuICAgIGZvciAocCBpbiBvKSB7XHJcbiAgICAgIGlmIChvLmhhc093blByb3BlcnR5KHApICYmIHAgIT09ICdwYWdlc0FycmF5Jykge1xyXG4gICAgICAgIHYgPSBvW3BdO1xyXG4gICAgICAgIGlmICh2ICYmICdvYmplY3QnID09PSB0eXBlb2Ygdikge1xyXG4gICAgICAgICAgY1twXSA9IHRoaXMuY29weU9iamVjdCh2KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgY1twXSA9IHY7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gYztcclxuICB9XHJcblxyXG4gIHB1YmxpYyBzZXQgb3B0aW9ucyhkYXRhOiBhbnkpIHtcclxuICAgIHRoaXMuX29wdGlvbnMgPSB0aGlzLnRvTG93ZXIoZGF0YS5vcHRpb25zKTtcclxuICAgIGlmIChkYXRhLmpzT3B0aW9ucykge1xyXG4gICAgICBmb3IgKGNvbnN0IGtleSBpbiBkYXRhLmpzT3B0aW9ucykge1xyXG4gICAgICAgIGlmIChkYXRhLmpzT3B0aW9ucy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XHJcbiAgICAgICAgICB0aGlzLl9vcHRpb25zW2tleV0gPSBkYXRhLmpzT3B0aW9uc1trZXldO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuX29wdGlvbnMuZXhwb3J0cy5kZWZhdWx0U2V0dGluZ3MgPSBkYXRhLmRlZmF1bHRTZXR0aW5ncztcclxuICAgIHRoaXMubG9jYWxpemF0aW9uID0gZGF0YS5sb2M7XHJcbiAgICB0aGlzLm1vbnRocyA9IGRhdGEubW9udGhzO1xyXG4gICAgdGhpcy5kYXlPZldlZWsgPSBkYXRhLmRheU9mV2VlaztcclxuICAgIHRoaXMuaW1hZ2VzID0gZGF0YS5pbWFnZXM7XHJcbiAgICB0aGlzLmRhdGVSYW5nZXMgPSBkYXRhLmRhdGVSYW5nZXM7XHJcbiAgICB0aGlzLnBhcGVyU2l6ZXMgPSBkYXRhLnBhcGVyU2l6ZXM7XHJcbiAgICB0aGlzLmVuY29kaW5nRGF0YSA9IGRhdGEuZW5jb2RpbmdEYXRhO1xyXG4gICAgdGhpcy5wZGZTZWN1cml0eUNlcnRpZmljYXRlcyA9IGRhdGEucGRmU2VjdXJpdHlDZXJ0aWZpY2F0ZXM7XHJcbiAgICB0aGlzLmNsZWFyVmlld2VyU3RhdGUoKTtcclxuICAgIHRoaXMuc2V0dXBPcHRpb25zKCk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZ2V0IG9wdGlvbnMoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fb3B0aW9ucztcclxuICB9XHJcblxyXG4gIHB1YmxpYyBsb2MoYXR0cjogc3RyaW5nKTogc3RyaW5nIHtcclxuICAgIHJldHVybiB0aGlzLmxvY2FsaXphdGlvblthdHRyXSA/PyBhdHRyO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGltZyhuYW1lOiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gICAgaWYgKG5hbWUgIT0gbnVsbCAmJiBuYW1lLmxlbmd0aCA+IDAgJiYgIXRoaXMuaW1hZ2VzW25hbWVdKSB7XHJcbiAgICAgIC8vY29uc29sZS53YXJuKGBJbWFnZTogJHtuYW1lfSBub3QgZm91bmRgKTtcclxuICAgIH1cclxuICAgIHJldHVybiB0aGlzLmltYWdlc1tuYW1lXSA/PyAnJztcclxuICB9XHJcblxyXG4gIHByaXZhdGUgdG9Mb3dlcihvYmo6IGFueSk6IGFueSB7XHJcbiAgICBjb25zdCByZXN1bHQgPSB7fTtcclxuICAgIE9iamVjdC5rZXlzKG9iaikuZm9yRWFjaChrZXkgPT4ge1xyXG4gICAgICByZXN1bHRba2V5LnN1YnN0cigwLCAxKS50b0xvd2VyQ2FzZSgpICsga2V5LnN1YnN0cigxKV0gPSAodHlwZW9mIChvYmpba2V5XSkgPT09ICdvYmplY3QnICYmIG9ialtrZXldICE9PSBudWxsKSA/IHRoaXMudG9Mb3dlcihvYmpba2V5XSkgOiBvYmpba2V5XTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBjbGVhcigpIHtcclxuICAgIHRoaXMuX29wdGlvbnMgPSB1bmRlZmluZWQ7XHJcbiAgICB0aGlzLl9yZXBvcnRQYXJhbXMgPSB7fTtcclxuICAgIHRoaXMuX2ltYWdlc0ZvckJvb2ttYXJrID0gdW5kZWZpbmVkO1xyXG4gICAgdGhpcy5wYWdlcyA9IFtdO1xyXG4gICAgdGhpcy5mb3JtID0gbnVsbDtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBjbGVhclZpZXdlclN0YXRlKCkge1xyXG4gICAgdGhpcy5yZXBvcnRQYXJhbXMgPSB7fTtcclxuICAgIHRoaXMucmVwb3J0UGFyYW1zLnR5cGUgPSAnQXV0byc7XHJcbiAgICB0aGlzLnJlcG9ydFBhcmFtcy5wYWdlTnVtYmVyID0gMDtcclxuICAgIHRoaXMucmVwb3J0UGFyYW1zLm9yaWdpbmFsUGFnZU51bWJlciA9IDA7XHJcbiAgICB0aGlzLnJlcG9ydFBhcmFtcy5kcmlsbERvd25HdWlkID0gbnVsbDtcclxuICAgIHRoaXMucmVwb3J0UGFyYW1zLmRhc2hib2FyZERyaWxsRG93bkd1aWQgPSBudWxsO1xyXG4gICAgdGhpcy5yZXBvcnRQYXJhbXMuY29sbGFwc2luZ1N0YXRlcyA9IG51bGw7XHJcbiAgICB0aGlzLnJlcG9ydFBhcmFtcy5ib29rbWFya3NDb250ZW50ID0gbnVsbDtcclxuICAgIHRoaXMucmVwb3J0UGFyYW1zLmVkaXRhYmxlUGFyYW1ldGVycyA9IG51bGw7XHJcbiAgICB0aGlzLnJlcG9ydFBhcmFtcy5yZXNvdXJjZXMgPSBudWxsO1xyXG4gICAgdGhpcy5yZXBvcnRQYXJhbXMuZHJpbGxEb3duUGFyYW1ldGVycyA9IFtdO1xyXG4gICAgdGhpcy5yZXBvcnRQYXJhbXMuZWxlbWVudE5hbWUgPSBudWxsO1xyXG4gICAgdGhpcy5yZXBvcnRQYXJhbXMudmFyaWFibGVzVmFsdWVzID0gbnVsbDtcclxuICAgIHRoaXMucmVwb3J0UGFyYW1zLnRhYmxlT2ZDb250ZW50c1BvaW50ZXJzID0gW107XHJcbiAgICB0aGlzLnJlcG9ydFBhcmFtcy5pc0VkaXRhYmxlUmVwb3J0ID0gZmFsc2U7XHJcblxyXG4gICAgdGhpcy5vcHRpb25zLnZpZXdlcklkID0gdGhpcy5uZXdUb2tlbigpO1xyXG4gICAgdGhpcy5vcHRpb25zLmNsaWVudEd1aWQgPSB0aGlzLm5ld1Rva2VuKCk7XHJcbiAgICB0aGlzLm9wdGlvbnMucGFyYW1zVmFyaWFibGVzID0gbnVsbDtcclxuICAgIHRoaXMub3B0aW9ucy5tdWx0aUZpbHRlclN0YXRlcyA9IG51bGw7XHJcbiAgICB0aGlzLm9wdGlvbnMuaXNQYXJhbWV0ZXJzUmVjZWl2ZWQgPSBmYWxzZTtcclxuICAgIHRoaXMub3B0aW9ucy5kcmlsbERvd25JblByb2dyZXNzID0gZmFsc2U7XHJcbiAgICAvLyB0aGlzLmNvbnRyb2xzLm1haW5QYW5lbC5zdHlsZS5iYWNrZ3JvdW5kID0gJyc7XHJcbiAgICAvLyB0aGlzLnRhYmxlRWxlbWVudEdyaWRTdGF0ZXMgPSB7fTtcclxuXHJcbiAgICAvLyBSZXN0b3JlIGN1cnJlbnQgcGFnZSBudW1iZXIsIGlmIHJlbG9hZCBjdXJyZW50IHJlcG9ydFxyXG4gICAgaWYgKHRoaXMucmVwb3J0UGFyYW1zLnByZXZQYWdlTnVtYmVyKSB7XHJcbiAgICAgIHRoaXMucmVwb3J0UGFyYW1zLnBhZ2VOdW1iZXIgPSB0aGlzLnJlcG9ydFBhcmFtcy5wcmV2UGFnZU51bWJlcjtcclxuICAgICAgZGVsZXRlIHRoaXMucmVwb3J0UGFyYW1zLnByZXZQYWdlTnVtYmVyO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuZnVsbFNjcmVlbk9wdGlvbnMgPSBudWxsO1xyXG4gICAgdGhpcy5kcmlsbERvd25CdXR0b25zID0gW107XHJcbiAgICB0aGlzLmNvbnRyb2xzLnBhcmFtZXRlcnNQYW5lbC52aXNpYmxlID0gZmFsc2U7XHJcbiAgICB0aGlzLmNvbnRyb2xzLmJvb2ttYXJrc1BhbmVsLnZpc2libGUgPSBmYWxzZTtcclxuICAgIHRoaXMuaW50ZXJhY3Rpb25zID0gbnVsbDtcclxuICAgIC8qXHJcbiAgICB0aGlzLmNvbnRyb2xzLmRyaWxsRG93blBhbmVsLnZpc2libGUgPSBmYWxzZTtcclxuICAgIHRoaXMuY29udHJvbHMuZmluZFBhbmVsLnZpc2libGUgPSBmYWxzZTtcclxuICAgIHRoaXMuY29udHJvbHMucGFyYW1ldGVyc1BhbmVsLnZpc2libGUgPSBmYWxzZTtcclxuICAgIHRoaXMuY29udHJvbHMucmVzb3VyY2VzUGFuZWwudmlzaWJsZSA9IGZhbHNlOyovXHJcbiAgfVxyXG5cclxuICBwdWJsaWMgc3R5bGUodmFsdWU6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICByZXR1cm4gdmFsdWUgIT09ICcnICYmIHZhbHVlICE9IG51bGwgPyB2YWx1ZSA6ICcnO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGNyZWF0ZVBvc3RQYXJhbWV0ZXJzKGRhdGE/OiBhbnksIGFzT2JqZWN0OiBib29sZWFuID0gdHJ1ZSwgdXNlT3B0aW9uczogYm9vbGVhbiA9IHRydWUpOiBhbnkge1xyXG4gICAgbGV0IHBhcmFtczogYW55O1xyXG5cclxuICAgIC8vIE9iamVjdCBwYXJhbXNcclxuICAgIGNvbnN0IHBvc3RQYXJhbXMgPSB7XHJcbiAgICAgIHN0aXdlYl9jb21wb25lbnQ6ICdWaWV3ZXInLFxyXG4gICAgICBzdGl3ZWJfaW1hZ2VzU2NhbGluZ0ZhY3RvcjogdGhpcy5nZXRJbWFnZXNTY2FsaW5nRmFjdG9yKClcclxuICAgIH07XHJcblxyXG4gICAgaWYgKHRoaXMucHJvcGVydGllcykge1xyXG4gICAgICBwb3N0UGFyYW1zWydwcm9wZXJ0aWVzJ10gPSBidG9hKEpTT04uc3RyaW5naWZ5KHRoaXMucHJvcGVydGllcykpO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICh0aGlzLm9wdGlvbnMgJiYgdXNlT3B0aW9ucykge1xyXG4gICAgICBwYXJhbXMgPSB7XHJcbiAgICAgICAgdmlld2VySWQ6IHRoaXMub3B0aW9ucy52aWV3ZXJJZCxcclxuICAgICAgICByb3V0ZXM6IHRoaXMub3B0aW9ucy5yb3V0ZXMsXHJcbiAgICAgICAgZm9ybVZhbHVlczogdGhpcy5vcHRpb25zLmZvcm1WYWx1ZXMsXHJcbiAgICAgICAgY2xpZW50R3VpZDogdGhpcy5vcHRpb25zLmNsaWVudEd1aWQsXHJcbiAgICAgICAgZHJpbGxEb3duR3VpZDogdGhpcy5yZXBvcnRQYXJhbXMuZHJpbGxEb3duR3VpZCxcclxuICAgICAgICBkYXNoYm9hcmREcmlsbERvd25HdWlkOiB0aGlzLnJlcG9ydFBhcmFtcy5kYXNoYm9hcmREcmlsbERvd25HdWlkLFxyXG4gICAgICAgIGNhY2hlTW9kZTogdGhpcy5vcHRpb25zLnNlcnZlci5jYWNoZU1vZGUsXHJcbiAgICAgICAgY2FjaGVUaW1lb3V0OiB0aGlzLm9wdGlvbnMuc2VydmVyLmNhY2hlVGltZW91dCxcclxuICAgICAgICBjYWNoZUl0ZW1Qcmlvcml0eTogdGhpcy5vcHRpb25zLnNlcnZlci5jYWNoZUl0ZW1Qcmlvcml0eSxcclxuICAgICAgICBwYWdlTnVtYmVyOiB0aGlzLnJlcG9ydFBhcmFtcy5wYWdlTnVtYmVyLFxyXG4gICAgICAgIG9yaWdpbmFsUGFnZU51bWJlcjogdGhpcy5yZXBvcnRQYXJhbXMub3JpZ2luYWxQYWdlTnVtYmVyLFxyXG4gICAgICAgIHJlcG9ydFR5cGU6IHRoaXMucmVwb3J0UGFyYW1zLnR5cGUsXHJcbiAgICAgICAgem9vbTogKHRoaXMucmVwb3J0UGFyYW1zLnpvb20gJiYgdGhpcy5yZXBvcnRQYXJhbXMuem9vbSA+IDApID8gdGhpcy5yZXBvcnRQYXJhbXMuem9vbSA6ICh0aGlzLm9wdGlvbnM/LnRvb2xiYXI/Lnpvb20gPiAwID8gdGhpcy5vcHRpb25zPy50b29sYmFyPy56b29tIDogMTAwKSxcclxuICAgICAgICB2aWV3TW9kZTogdGhpcy5yZXBvcnRQYXJhbXMudmlld01vZGUgfHwgdGhpcy5vcHRpb25zLnRvb2xiYXIudmlld01vZGUsXHJcbiAgICAgICAgbXVsdGlQYWdlV2lkdGhDb3VudDogdGhpcy5yZXBvcnRQYXJhbXMubXVsdGlQYWdlV2lkdGhDb3VudCxcclxuICAgICAgICBtdWx0aVBhZ2VIZWlnaHRDb3VudDogdGhpcy5yZXBvcnRQYXJhbXMubXVsdGlQYWdlSGVpZ2h0Q291bnQsXHJcbiAgICAgICAgbXVsdGlQYWdlQ29udGFpbmVyV2lkdGg6IHRoaXMucmVwb3J0UGFyYW1zLm11bHRpUGFnZUNvbnRhaW5lcldpZHRoLFxyXG4gICAgICAgIG11bHRpUGFnZUNvbnRhaW5lckhlaWdodDogdGhpcy5yZXBvcnRQYXJhbXMubXVsdGlQYWdlQ29udGFpbmVySGVpZ2h0LFxyXG4gICAgICAgIG11bHRpUGFnZU1hcmdpbnM6IHRoaXMucmVwb3J0UGFyYW1zLm11bHRpUGFnZU1hcmdpbnMsXHJcbiAgICAgICAgc2hvd0Jvb2ttYXJrczogdGhpcy5vcHRpb25zLnRvb2xiYXIuc2hvd0Jvb2ttYXJrc0J1dHRvbixcclxuICAgICAgICBvcGVuTGlua3NXaW5kb3c6IHRoaXMub3B0aW9ucy5hcHBlYXJhbmNlLm9wZW5MaW5rc1dpbmRvdyxcclxuICAgICAgICBjaGFydFJlbmRlclR5cGU6IHRoaXMub3B0aW9ucy5hcHBlYXJhbmNlLmNoYXJ0UmVuZGVyVHlwZSxcclxuICAgICAgICByZXBvcnREaXNwbGF5TW9kZTogdGhpcy5vcHRpb25zLmFwcGVhcmFuY2UucmVwb3J0RGlzcGxheU1vZGUsXHJcbiAgICAgICAgZHJpbGxEb3duUGFyYW1ldGVyczogdGhpcy5yZXBvcnRQYXJhbXMuZHJpbGxEb3duUGFyYW1ldGVycyxcclxuICAgICAgICBlZGl0YWJsZVBhcmFtZXRlcnM6IHRoaXMucmVwb3J0UGFyYW1zLmVkaXRhYmxlUGFyYW1ldGVycyxcclxuICAgICAgICB1c2VSZWxhdGl2ZVVybHM6IHRoaXMub3B0aW9ucy5zZXJ2ZXIudXNlUmVsYXRpdmVVcmxzLFxyXG4gICAgICAgIHBhc3NRdWVyeVBhcmFtZXRlcnNGb3JSZXNvdXJjZXM6IHRoaXMub3B0aW9ucy5zZXJ2ZXIucGFzc1F1ZXJ5UGFyYW1ldGVyc0ZvclJlc291cmNlcyxcclxuICAgICAgICBwYXNzUXVlcnlQYXJhbWV0ZXJzVG9SZXBvcnQ6IHRoaXMub3B0aW9ucy5zZXJ2ZXIucGFzc1F1ZXJ5UGFyYW1ldGVyc1RvUmVwb3J0LFxyXG4gICAgICAgIHZlcnNpb246IHRoaXMub3B0aW9ucy5zaG9ydFByb2R1Y3RWZXJzaW9uLFxyXG4gICAgICAgIHJlcG9ydERlc2lnbmVyTW9kZTogdGhpcy5vcHRpb25zLnJlcG9ydERlc2lnbmVyTW9kZSxcclxuICAgICAgICBpbWFnZXNRdWFsaXR5OiB0aGlzLm9wdGlvbnMuYXBwZWFyYW5jZS5pbWFnZXNRdWFsaXR5LFxyXG4gICAgICAgIHBhcmFtZXRlcnNQYW5lbFNvcnREYXRhSXRlbXM6IHRoaXMub3B0aW9ucy5hcHBlYXJhbmNlLnBhcmFtZXRlcnNQYW5lbFNvcnREYXRhSXRlbXMsXHJcbiAgICAgICAgY29tYmluZVJlcG9ydFBhZ2VzOiB0aGlzLm9wdGlvbnMuYXBwZWFyYW5jZS5jb21iaW5lUmVwb3J0UGFnZXMsXHJcbiAgICAgICAgaXNBbmd1bGFyOiB0cnVlLFxyXG4gICAgICAgIGFsbG93QXV0b1VwZGF0ZUNvb2tpZXM6IHRoaXMub3B0aW9ucy5zZXJ2ZXIuYWxsb3dBdXRvVXBkYXRlQ29va2llc1xyXG4gICAgICB9O1xyXG5cclxuICAgICAgaWYgKHRoaXMub3B0aW9ucy5zZXJ2ZXIudXNlTG9jYWxpemVkQ2FjaGUgJiYgdGhpcy5vcHRpb25zLmxvY2FsaXphdGlvbikge1xyXG4gICAgICAgIHBhcmFtc1sndXNlTG9jYWxpemVkQ2FjaGUnXSA9IHRydWU7XHJcbiAgICAgICAgcGFyYW1zWydsb2NhbGl6YXRpb24nXSA9IHRoaXMub3B0aW9ucy5sb2NhbGl6YXRpb247XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmICh0aGlzLm9wdGlvbnMudXNlclZhbHVlcykge1xyXG4gICAgICAgIHBhcmFtc1sndXNlclZhbHVlcyddID0gdGhpcy5vcHRpb25zLnVzZXJWYWx1ZXM7XHJcbiAgICAgIH1cclxuXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBwYXJhbXMgPSB7fTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoZGF0YSkge1xyXG4gICAgICBPYmplY3Qua2V5cyhkYXRhKS5mb3JFYWNoKGtleSA9PiBwYXJhbXNba2V5XSA9IGRhdGFba2V5XSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gT2JqZWN0IHBhcmFtc1xyXG4gICAgaWYgKHBhcmFtcy5hY3Rpb24pIHtcclxuICAgICAgcG9zdFBhcmFtc1snc3Rpd2ViX2FjdGlvbiddID0gcGFyYW1zLmFjdGlvbjtcclxuICAgICAgZGVsZXRlIHBhcmFtcy5hY3Rpb247XHJcbiAgICB9XHJcbiAgICBpZiAocGFyYW1zLmJhc2U2NERhdGEpIHtcclxuICAgICAgcG9zdFBhcmFtc1snc3Rpd2ViX2RhdGEnXSA9IHBhcmFtcy5iYXNlNjREYXRhO1xyXG4gICAgICBkZWxldGUgcGFyYW1zLmJhc2U2NERhdGE7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHRoaXMub3B0aW9ucyAmJiB1c2VPcHRpb25zKSB7XHJcbiAgICAgIC8vIFBhcmFtc1xyXG4gICAgICBjb25zdCBqc29uUGFyYW1zID0gSlNPTi5zdHJpbmdpZnkocGFyYW1zKTtcclxuICAgICAgaWYgKHRoaXMub3B0aW9ucy5zZXJ2ZXIudXNlQ29tcHJlc3Npb24pIHtcclxuICAgICAgICAvLyBwb3N0UGFyYW1zWydzdGl3ZWJfcGFja2VkX3BhcmFtZXRlcnMnXSA9IFN0aUdaaXBIZWxwZXIucGFjayhqc29uUGFyYW1zKTtcclxuICAgICAgICBwb3N0UGFyYW1zWydzdGl3ZWJfcGFyYW1ldGVycyddID0gYnRvYShqc29uUGFyYW1zKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBwb3N0UGFyYW1zWydzdGl3ZWJfcGFyYW1ldGVycyddID0gYnRvYShqc29uUGFyYW1zKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGlmIChhc09iamVjdCkgeyByZXR1cm4gcG9zdFBhcmFtczsgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBuZXdUb2tlbigpOiBzdHJpbmcge1xyXG4gICAgY29uc3QgYSA9ICcxMjM0NTY3ODkwYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXonLnNwbGl0KCcnKTtcclxuICAgIGNvbnN0IGIgPSBbXTtcclxuICAgIGNvbnN0IGxlbmd0aCA9IDMyO1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xyXG4gICAgICBjb25zdCBqID0gKE1hdGgucmFuZG9tKCkgKiAoYS5sZW5ndGggLSAxKSkudG9GaXhlZCgwKTtcclxuICAgICAgYltpXSA9IGFbal07XHJcbiAgICB9XHJcbiAgICByZXR1cm4gYi5qb2luKCcnKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgc2V0dXBPcHRpb25zKCkge1xyXG4gICAgaWYgKCF0aGlzLm9wdGlvbnMuZXhwb3J0cy5zaG93RXhwb3J0VG9Qb3dlclBvaW50ICYmICF0aGlzLm9wdGlvbnMuZXhwb3J0cy5zaG93RXhwb3J0VG9QZGYgJiYgIXRoaXMub3B0aW9ucy5leHBvcnRzLnNob3dFeHBvcnRUb1hwcyAmJlxyXG4gICAgICAhdGhpcy5vcHRpb25zLmV4cG9ydHMuc2hvd0V4cG9ydFRvT3BlbkRvY3VtZW50V3JpdGVyICYmICF0aGlzLm9wdGlvbnMuZXhwb3J0cy5zaG93RXhwb3J0VG9PcGVuRG9jdW1lbnRDYWxjICYmICF0aGlzLm9wdGlvbnMuZXhwb3J0cy5zaG93RXhwb3J0VG9UZXh0ICYmXHJcbiAgICAgICF0aGlzLm9wdGlvbnMuZXhwb3J0cy5zaG93RXhwb3J0VG9SdGYgJiYgIXRoaXMub3B0aW9ucy5leHBvcnRzLnNob3dFeHBvcnRUb1dvcmQyMDA3ICYmICF0aGlzLm9wdGlvbnMuZXhwb3J0cy5zaG93RXhwb3J0VG9Dc3YgJiYgIXRoaXMub3B0aW9ucy5leHBvcnRzLnNob3dFeHBvcnRUb0pzb24gJiZcclxuICAgICAgIXRoaXMub3B0aW9ucy5leHBvcnRzLnNob3dFeHBvcnRUb0RiZiAmJiAhdGhpcy5vcHRpb25zLmV4cG9ydHMuc2hvd0V4cG9ydFRvWG1sICYmICF0aGlzLm9wdGlvbnMuZXhwb3J0cy5zaG93RXhwb3J0VG9EaWYgJiYgIXRoaXMub3B0aW9ucy5leHBvcnRzLnNob3dFeHBvcnRUb1N5bGsgJiZcclxuICAgICAgIXRoaXMub3B0aW9ucy5leHBvcnRzLnNob3dFeHBvcnRUb0V4Y2VsICYmICF0aGlzLm9wdGlvbnMuZXhwb3J0cy5zaG93RXhwb3J0VG9FeGNlbDIwMDcgJiYgIXRoaXMub3B0aW9ucy5leHBvcnRzLnNob3dFeHBvcnRUb0V4Y2VsWG1sICYmICF0aGlzLm9wdGlvbnMuZXhwb3J0cy5zaG93RXhwb3J0VG9IdG1sICYmXHJcbiAgICAgICF0aGlzLm9wdGlvbnMuZXhwb3J0cy5zaG93RXhwb3J0VG9IdG1sNSAmJiAhdGhpcy5vcHRpb25zLmV4cG9ydHMuc2hvd0V4cG9ydFRvTWh0ICYmICF0aGlzLm9wdGlvbnMuZXhwb3J0cy5zaG93RXhwb3J0VG9JbWFnZUJtcCAmJiAhdGhpcy5vcHRpb25zLmV4cG9ydHMuc2hvd0V4cG9ydFRvSW1hZ2VHaWYgJiZcclxuICAgICAgIXRoaXMub3B0aW9ucy5leHBvcnRzLnNob3dFeHBvcnRUb0ltYWdlSnBlZyAmJiAhdGhpcy5vcHRpb25zLmV4cG9ydHMuc2hvd0V4cG9ydFRvSW1hZ2VNZXRhZmlsZSAmJiAhdGhpcy5vcHRpb25zLmV4cG9ydHMuc2hvd0V4cG9ydFRvSW1hZ2VQY3ggJiZcclxuICAgICAgIXRoaXMub3B0aW9ucy5leHBvcnRzLnNob3dFeHBvcnRUb0ltYWdlUG5nICYmICF0aGlzLm9wdGlvbnMuZXhwb3J0cy5zaG93RXhwb3J0VG9JbWFnZVRpZmYgJiYgIXRoaXMub3B0aW9ucy5leHBvcnRzLnNob3dFeHBvcnRUb0ltYWdlU3ZnICYmICF0aGlzLm9wdGlvbnMuZXhwb3J0cy5zaG93RXhwb3J0VG9JbWFnZVN2Z3opIHtcclxuICAgICAgaWYgKCF0aGlzLm9wdGlvbnMuZXhwb3J0cy5zaG93RXhwb3J0VG9Eb2N1bWVudCkge1xyXG4gICAgICAgIHRoaXMub3B0aW9ucy50b29sYmFyLnNob3dTYXZlQnV0dG9uID0gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5vcHRpb25zLnRvb2xiYXIuc2hvd1NlbmRFbWFpbEJ1dHRvbiA9IGZhbHNlO1xyXG4gICAgfVxyXG4gICAgLy8gT3B0aW9uc1xyXG4gICAgdGhpcy5vcHRpb25zLmlzVG91Y2hEZXZpY2UgPSB0aGlzLm9wdGlvbnMuYXBwZWFyYW5jZS5pbnRlcmZhY2VUeXBlID09PSAnQXV0bydcclxuICAgICAgPyB0aGlzLmlzVG91Y2hEZXZpY2UoKSAmJiB0aGlzLmlzTW9iaWxlRGV2aWNlKClcclxuICAgICAgOiB0aGlzLm9wdGlvbnMuYXBwZWFyYW5jZS5pbnRlcmZhY2VUeXBlID09PSAnVG91Y2gnO1xyXG4gICAgdGhpcy5vcHRpb25zLmlzTW9iaWxlRGV2aWNlID0gdGhpcy5vcHRpb25zLmFwcGVhcmFuY2UuaW50ZXJmYWNlVHlwZSA9PT0gJ0F1dG8nICYmICF0aGlzLm9wdGlvbnMucmVwb3J0RGVzaWduZXJNb2RlXHJcbiAgICAgID8gdGhpcy5pc1RvdWNoRGV2aWNlKCkgJiYgdGhpcy5pc01vYmlsZURldmljZSgpXHJcbiAgICAgIDogdGhpcy5vcHRpb25zLmFwcGVhcmFuY2UuaW50ZXJmYWNlVHlwZSA9PT0gJ01vYmlsZSc7XHJcblxyXG4gICAgaWYgKHRoaXMub3B0aW9ucy5pc01vYmlsZURldmljZSkge1xyXG4gICAgICB0aGlzLmluaXRpYWxpemVNb2JpbGUoKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMub3B0aW9ucy50b29sYmFyLnNob3dQaW5Ub29sYmFyQnV0dG9uID0gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5jb250cm9scy50b29sYmFyLnZpc2libGUgPSB0aGlzLm9wdGlvbnMudG9vbGJhci52aXNpYmxlO1xyXG4gICAgdGhpcy5vcHRpb25zLm1lbnVBbmltRHVyYXRpb24gPSAxNTA7XHJcbiAgICB0aGlzLm9wdGlvbnMuZm9ybUFuaW1EdXJhdGlvbiA9IDIwMDtcclxuICAgIHRoaXMub3B0aW9ucy5zY3JvbGxEdXJhdGlvbiA9IDM1MDtcclxuICAgIHRoaXMub3B0aW9ucy5tZW51SGlkZURlbGF5ID0gMjUwO1xyXG5cclxuICAgIHRoaXMub3B0aW9ucy5zZXJ2ZXIudGltZW91dEF1dG9VcGRhdGVDYWNoZSA9IDE4MDAwMDtcclxuICAgIHRoaXMub3B0aW9ucy50b29sYmFyLmJhY2tncm91bmRDb2xvciA9IHRoaXMuZ2V0SFRNTENvbG9yKHRoaXMub3B0aW9ucy50b29sYmFyLmJhY2tncm91bmRDb2xvcik7XHJcbiAgICB0aGlzLm9wdGlvbnMudG9vbGJhci5ib3JkZXJDb2xvciA9IHRoaXMuZ2V0SFRNTENvbG9yKHRoaXMub3B0aW9ucy50b29sYmFyLmJvcmRlckNvbG9yKTtcclxuICAgIHRoaXMub3B0aW9ucy50b29sYmFyLmZvbnRDb2xvciA9IHRoaXMuZ2V0SFRNTENvbG9yKHRoaXMub3B0aW9ucy50b29sYmFyLmZvbnRDb2xvcik7XHJcbiAgICB0aGlzLm9wdGlvbnMuYXBwZWFyYW5jZS5wYWdlQm9yZGVyQ29sb3IgPSB0aGlzLmdldEhUTUxDb2xvcih0aGlzLm9wdGlvbnMuYXBwZWFyYW5jZS5wYWdlQm9yZGVyQ29sb3IpO1xyXG4gICAgdGhpcy5vcHRpb25zLnBhcmFtZXRlcnNWYWx1ZXMgPSB7fTtcclxuICAgIHRoaXMub3B0aW9ucy5wYXJhbWV0ZXJSb3dIZWlnaHQgPSB0aGlzLm9wdGlvbnMuaXNUb3VjaERldmljZSA/IDM1IDogMzA7XHJcbiAgICB0aGlzLm9wdGlvbnMubWluUGFyYW1ldGVyc0NvdW50Rm9yTXVsdGlDb2x1bW5zID0gNTtcclxuXHJcbiAgICAvLyBGaXJzdCBEYXkgT2YgV2Vla1xyXG4gICAgaWYgKHRoaXMub3B0aW9ucy5hcHBlYXJhbmNlLmRhdGVQaWNrZXJGaXJzdERheU9mV2VlayA9PT0gJ1N1bmRheScpIHtcclxuICAgICAgdGhpcy5kYXlPZldlZWsuc3BsaWNlKDYsIDEpO1xyXG4gICAgICB0aGlzLmRheU9mV2Vlay5zcGxpY2UoMCwgMCwgJ1N1bmRheScpO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICh0aGlzLm9wdGlvbnM/LnRvb2xiYXI/Lnpvb20gPT09IC0xIHx8IHRoaXMub3B0aW9ucz8udG9vbGJhcj8uem9vbSA9PT0gLTIpIHtcclxuICAgICAgdGhpcy5yZXBvcnRQYXJhbXMuYXV0b1pvb20gPSB0aGlzLm9wdGlvbnM/LnRvb2xiYXI/Lnpvb207XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQWN0aW9uc1xyXG4gICAgaWYgKCF0aGlzLm9wdGlvbnMuYWN0aW9ucy5nZXRSZXBvcnQpIHsgdGhpcy5vcHRpb25zLmFjdGlvbnMuZ2V0UmVwb3J0ID0gdGhpcy5vcHRpb25zLmFjdGlvbnMudmlld2VyRXZlbnQ7IH1cclxuICAgIGlmICghdGhpcy5vcHRpb25zLmFjdGlvbnMucHJpbnRSZXBvcnQpIHsgdGhpcy5vcHRpb25zLmFjdGlvbnMucHJpbnRSZXBvcnQgPSB0aGlzLm9wdGlvbnMuYWN0aW9ucy52aWV3ZXJFdmVudDsgfVxyXG4gICAgaWYgKCF0aGlzLm9wdGlvbnMuYWN0aW9ucy5vcGVuUmVwb3J0KSB7IHRoaXMub3B0aW9ucy5hY3Rpb25zLm9wZW5SZXBvcnQgPSB0aGlzLm9wdGlvbnMuYWN0aW9ucy52aWV3ZXJFdmVudDsgfVxyXG4gICAgaWYgKCF0aGlzLm9wdGlvbnMuYWN0aW9ucy5leHBvcnRSZXBvcnQpIHsgdGhpcy5vcHRpb25zLmFjdGlvbnMuZXhwb3J0UmVwb3J0ID0gdGhpcy5vcHRpb25zLmFjdGlvbnMudmlld2VyRXZlbnQ7IH1cclxuICAgIGlmICghdGhpcy5vcHRpb25zLmFjdGlvbnMuaW50ZXJhY3Rpb24pIHsgdGhpcy5vcHRpb25zLmFjdGlvbnMuaW50ZXJhY3Rpb24gPSB0aGlzLm9wdGlvbnMuYWN0aW9ucy52aWV3ZXJFdmVudDsgfVxyXG5cclxuICAgIGlmICghKHdpbmRvdy5GaWxlICYmIHdpbmRvdy5GaWxlUmVhZGVyICYmIHdpbmRvdy5GaWxlTGlzdCAmJiB3aW5kb3cuQmxvYikpIHsgdGhpcy5vcHRpb25zLnRvb2xiYXIuc2hvd09wZW5CdXR0b24gPSBmYWxzZTsgfVxyXG5cclxuICAgIC8vIFJlbmRlciBKc1ZpZXdlciBzdHlsZXMgaW50byBIRUFEXHJcbiAgICBpZiAodGhpcy5vcHRpb25zLnJlcXVlc3RSZXNvdXJjZXNVcmwgfHwgdGhpcy5vcHRpb25zLmFwcGVhcmFuY2UuY3VzdG9tU3R5bGVzVXJsKSB7XHJcbiAgICAgIGNvbnN0IHZpZXdlclN0eWxlcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpbmsnKTtcclxuICAgICAgdmlld2VyU3R5bGVzLnNldEF0dHJpYnV0ZSgndHlwZScsICd0ZXh0L2NzcycpO1xyXG4gICAgICB2aWV3ZXJTdHlsZXMuc2V0QXR0cmlidXRlKCdyZWwnLCAnc3R5bGVzaGVldCcpO1xyXG4gICAgICB2aWV3ZXJTdHlsZXMuc2V0QXR0cmlidXRlKCdocmVmJywgdGhpcy5vcHRpb25zLmFwcGVhcmFuY2UuY3VzdG9tU3R5bGVzVXJsIHx8IHRoaXMuZ2V0UmVzb3VyY2VVcmwoJ3N0eWxlcycpKTtcclxuICAgICAgdGhpcy5jb250cm9scy5oZWFkLmFwcGVuZENoaWxkKHZpZXdlclN0eWxlcyk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5vcHRpb25zLnZpZXdlcklkID0gKE1hdGgucmFuZG9tKCkgKiAxMDAwMDAwKS50b1N0cmluZygpO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHBhZ2VzTmF2aWdhdGlvbklzQWN0aXZlKCk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuICh0aGlzLm9wdGlvbnMuYXBwZWFyYW5jZS5mdWxsU2NyZWVuTW9kZSB8fCB0aGlzLm9wdGlvbnMuYXBwZWFyYW5jZS5zY3JvbGxiYXJzTW9kZSkgJiYgdGhpcy5yZXBvcnRQYXJhbXMudmlld01vZGUgPT09ICdDb250aW51b3VzJztcclxuICB9XHJcblxyXG4gIGdldCBpbWFnZXNGb3JCb29rbWFyaygpOiBhbnkge1xyXG4gICAgaWYgKCF0aGlzLl9pbWFnZXNGb3JCb29rbWFyaykge1xyXG4gICAgICBjb25zdCBuYW1lcyA9IFsncm9vdCcsICdmb2xkZXInLCAnZm9sZGVyT3BlbicsICdub2RlJywgJ2VtcHR5JywgJ2xpbmUnLCAnam9pbicsICdqb2luQm90dG9tJywgJ3BsdXMnLCAncGx1c0JvdHRvbScsICdtaW51cycsICdtaW51c0JvdHRvbSddO1xyXG4gICAgICBjb25zdCBpbWFnZXNGb3JCb29rbWFya3MgPSB7fTtcclxuICAgICAgbmFtZXMuZm9yRWFjaChuYW1lID0+IGltYWdlc0ZvckJvb2ttYXJrc1tuYW1lXSA9IHRoaXMuaW1hZ2VzWydCb29rbWFya3MnICsgbmFtZSArICcucG5nJ10pO1xyXG4gICAgICB0aGlzLl9pbWFnZXNGb3JCb29rbWFyayA9IGltYWdlc0ZvckJvb2ttYXJrcztcclxuICAgIH1cclxuICAgIHJldHVybiB0aGlzLl9pbWFnZXNGb3JCb29rbWFyaztcclxuICB9XHJcblxyXG4gIHB1YmxpYyBpc1RvdWNoRGV2aWNlKCkge1xyXG4gICAgcmV0dXJuICgnb250b3VjaHN0YXJ0JyBpbiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQpO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGlzTW9iaWxlRGV2aWNlKCkge1xyXG4gICAgcmV0dXJuIC9pUGhvbmV8aVBhZHxpUG9kfE1hY2ludG9zaHxBbmRyb2lkfEJsYWNrQmVycnl8SUVNb2JpbGV8T3BlcmEgTWluaS9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgaW5pdGlhbGl6ZU1vYmlsZSgpIHtcclxuICAgIGxldCBpc1ZpZXdQb3J0RXhpc3QgPSBmYWxzZTtcclxuICAgIGNvbnN0IG1ldGFzOiBhbnkgPSB0aGlzLmNvbnRyb2xzLmhlYWQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ21ldGEnKTtcclxuICAgIGZvciAoY29uc3QgbWV0YSBvZiBtZXRhcykge1xyXG4gICAgICBpZiAobWV0YS5uYW1lICYmIG1ldGEubmFtZS50b0xvd2VyQ2FzZSgpID09PSAndmlld3BvcnQnKSB7XHJcbiAgICAgICAgaXNWaWV3UG9ydEV4aXN0ID0gdHJ1ZTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGlmICghaXNWaWV3UG9ydEV4aXN0KSB7XHJcbiAgICAgIGNvbnN0IHZpZXdQb3J0VGFnID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbWV0YScpO1xyXG4gICAgICB2aWV3UG9ydFRhZy5pZCA9ICd2aWV3cG9ydCc7XHJcbiAgICAgIHZpZXdQb3J0VGFnLm5hbWUgPSAndmlld3BvcnQnO1xyXG4gICAgICB2aWV3UG9ydFRhZy5jb250ZW50ID0gJ2luaXRpYWwtc2NhbGU9MS4wLHdpZHRoPWRldmljZS13aWR0aCx1c2VyLXNjYWxhYmxlPTAnO1xyXG4gICAgICB0aGlzLmNvbnRyb2xzLmhlYWQuYXBwZW5kQ2hpbGQodmlld1BvcnRUYWcpO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMub3B0aW9ucy5hcHBlYXJhbmNlLmZ1bGxTY3JlZW5Nb2RlID0gdHJ1ZTtcclxuICAgIHRoaXMub3B0aW9ucy5hcHBlYXJhbmNlLnNjcm9sbGJhcnNNb2RlID0gdHJ1ZTtcclxuICAgIHRoaXMub3B0aW9ucy5hcHBlYXJhbmNlLnBhcmFtZXRlcnNQYW5lbFBvc2l0aW9uID0gJ0xlZnQnO1xyXG4gICAgdGhpcy5vcHRpb25zLmFwcGVhcmFuY2UucGFyYW1ldGVyc1BhbmVsQ29sdW1uc0NvdW50ID0gMTtcclxuICAgIHRoaXMub3B0aW9ucy50b29sYmFyLmRpc3BsYXlNb2RlID0gJ1NlcGFyYXRlZCc7XHJcbiAgICB0aGlzLm9wdGlvbnMudG9vbGJhci52aWV3TW9kZSA9ICdTaW5nbGVQYWdlJztcclxuICAgIHRoaXMub3B0aW9ucy50b29sYmFyLnNob3dab29tQnV0dG9uID0gZmFsc2U7XHJcbiAgICBjb25zdCBkZWZhdWx0Wm9vbSA9IHRoaXMub3B0aW9ucy50b29sYmFyLnpvb20gPT09IC0yID8gLTIgOiAtMTsgLy8gUGFnZVdpZHRoIG9yIFBhZ2VIZWlnaHRcclxuICAgIHRoaXMub3B0aW9ucy50b29sYmFyLnpvb20gPSB0aGlzLnJlcG9ydFBhcmFtcy56b29tID0gZGVmYXVsdFpvb207XHJcbiAgICB0aGlzLm9wdGlvbnMudG9vbGJhci5zaG93QnV0dG9uQ2FwdGlvbnMgPSBmYWxzZTtcclxuICAgIHRoaXMub3B0aW9ucy50b29sYmFyLnNob3dPcGVuQnV0dG9uID0gZmFsc2U7XHJcbiAgICB0aGlzLm9wdGlvbnMudG9vbGJhci5zaG93RmluZEJ1dHRvbiA9IGZhbHNlO1xyXG4gICAgdGhpcy5vcHRpb25zLnRvb2xiYXIuc2hvd0VkaXRvckJ1dHRvbiA9IGZhbHNlO1xyXG4gICAgdGhpcy5vcHRpb25zLnRvb2xiYXIuc2hvd0Z1bGxTY3JlZW5CdXR0b24gPSBmYWxzZTtcclxuICAgIHRoaXMub3B0aW9ucy50b29sYmFyLnNob3dBYm91dEJ1dHRvbiA9IGZhbHNlO1xyXG4gICAgdGhpcy5vcHRpb25zLnRvb2xiYXIuc2hvd1ZpZXdNb2RlQnV0dG9uID0gZmFsc2U7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZ2V0SW1hZ2VzU2NhbGluZ0ZhY3RvcigpIHtcclxuICAgIGNvbnN0IHduZDogYW55ID0gd2luZG93O1xyXG4gICAgY29uc3QgZGV2aWNlUGl4ZWxSYXRpbyA9IHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvIHx8ICh3bmQuZGV2aWNlWERQSSAmJiB3bmQubG9naWNhbFhEUEkgPyB3bmQuZGV2aWNlWERQSSAvIHduZC5sb2dpY2FsWERQSSA6IDEpO1xyXG4gICAgaWYgKCFkZXZpY2VQaXhlbFJhdGlvIHx8IGRldmljZVBpeGVsUmF0aW8gPD0gMSkge1xyXG4gICAgICByZXR1cm4gJzEnO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmV0dXJuIGRldmljZVBpeGVsUmF0aW8udG9TdHJpbmcoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHB1YmxpYyBnZXRIVE1MQ29sb3IoY29sb3I6IGFueSkge1xyXG4gICAgaWYgKGNvbG9yLmluZGV4T2YoJywnKSA+IDAgJiYgY29sb3IuaW5kZXhPZigncmdiJykgPCAwKSB7XHJcbiAgICAgIHJldHVybiBgcmdiKCR7Y29sb3J9KWA7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gY29sb3I7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZ2V0UmVzb3VyY2VVcmwocmVzb3VyY2VQYXJhbWV0ZXI6IHN0cmluZykge1xyXG4gICAgbGV0IHVybCA9IHRoaXMuZ2V0QWN0aW9uUmVxdWVzdFVybCh0aGlzLm9wdGlvbnMucmVxdWVzdFJlc291cmNlc1VybCwgdGhpcy5vcHRpb25zLmFjdGlvbnMudmlld2VyRXZlbnQpO1xyXG4gICAgdXJsICs9IHVybC5pbmRleE9mKCc/JykgPiAwID8gJyYnIDogJz8nO1xyXG4gICAgdXJsICs9ICdzdGl3ZWJfY29tcG9uZW50PVZpZXdlciZzdGl3ZWJfYWN0aW9uPVJlc291cmNlJnN0aXdlYl9kYXRhPScgKyByZXNvdXJjZVBhcmFtZXRlciArICcmc3Rpd2ViX3RoZW1lPScgKyB0aGlzLm9wdGlvbnMudGhlbWU7XHJcbiAgICB1cmwgKz0gJyZzdGl3ZWJfY2FjaGVtb2RlPScgKyAodGhpcy5vcHRpb25zLnNlcnZlci51c2VDYWNoZUZvclJlc291cmNlc1xyXG4gICAgICA/IHRoaXMub3B0aW9ucy5zZXJ2ZXIuY2FjaGVNb2RlID09PSAnT2JqZWN0U2Vzc2lvbicgfHwgdGhpcy5vcHRpb25zLnNlcnZlci5jYWNoZU1vZGUgPT09ICdTdHJpbmdTZXNzaW9uJ1xyXG4gICAgICAgID8gJ3Nlc3Npb24nXHJcbiAgICAgICAgOiAnY2FjaGUnXHJcbiAgICAgIDogJ25vbmUnKTtcclxuICAgIHVybCArPSAnJnN0aXdlYl92ZXJzaW9uPScgKyB0aGlzLm9wdGlvbnMuc2hvcnRQcm9kdWN0VmVyc2lvbjtcclxuXHJcbiAgICByZXR1cm4gdXJsO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGdldEFjdGlvblJlcXVlc3RVcmwocmVxdWVzdFVybDogc3RyaW5nLCBhY3Rpb24/OiBzdHJpbmcpIHtcclxuICAgIGlmICghYWN0aW9uKSB7XHJcbiAgICAgIHJldHVybiByZXF1ZXN0VXJsO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChhY3Rpb24uaW5kZXhPZignPycpIDwgMCkge1xyXG4gICAgICByZXR1cm4gcmVxdWVzdFVybC5yZXBsYWNlKCd7YWN0aW9ufScsIGFjdGlvbik7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgcXVlcnkgPSBhY3Rpb24uc3Vic3RyaW5nKGFjdGlvbi5pbmRleE9mKCc/JykgKyAxKTtcclxuICAgIGFjdGlvbiA9IGFjdGlvbi5zdWJzdHJpbmcoMCwgYWN0aW9uLmluZGV4T2YoJz8nKSk7XHJcblxyXG4gICAgcmV0dXJuIHJlcXVlc3RVcmwucmVwbGFjZSgne2FjdGlvbn0nLCBhY3Rpb24pICsgKHJlcXVlc3RVcmwuaW5kZXhPZignPycpID4gMCA/ICcmJyA6ICc/JykgKyBxdWVyeTtcclxuICB9XHJcbn1cclxuIl19