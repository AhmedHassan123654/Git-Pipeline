import { __decorate } from "tslib";
import { Injectable } from '@angular/core';
import { ModelService } from './model.service';
let AnimationService = class AnimationService {
    constructor(model) {
        this.model = model;
    }
    showAnimationForScroll(reportPanel, finishScrollTop, endTime, completeFunction) {
        if (!reportPanel) {
            return;
        }
        let currentScrollTop = 0;
        if (this.model.options.appearance.scrollbarsMode) {
            currentScrollTop = reportPanel.scrollTop;
        }
        else {
            currentScrollTop = document.documentElement.scrollTop;
            if (currentScrollTop === 0) {
                currentScrollTop = document.getElementsByTagName('BODY')[0].scrollTop;
            }
        }
        clearTimeout(reportPanel.animationTimer);
        const d = new Date();
        const t = d.getTime();
        let step = Math.round((finishScrollTop - currentScrollTop) / ((Math.abs(endTime - t) + 1) / 30));
        // Last step
        if (Math.abs(step) > Math.abs(finishScrollTop - currentScrollTop)) {
            step = finishScrollTop - currentScrollTop;
        }
        currentScrollTop += step;
        let resultScrollTop;
        if (t < endTime) {
            resultScrollTop = currentScrollTop;
            reportPanel.animationTimer = setTimeout(() => {
                this.showAnimationForScroll(reportPanel, finishScrollTop, endTime, completeFunction);
            }, 30);
        }
        else {
            resultScrollTop = finishScrollTop;
            if (completeFunction) {
                completeFunction();
            }
        }
        if (this.model.options.appearance.scrollbarsMode) {
            reportPanel.scrollTop = resultScrollTop;
        }
        else {
            window.scrollTo(0, resultScrollTop);
        }
    }
};
AnimationService.ctorParameters = () => [
    { type: ModelService }
];
AnimationService = __decorate([
    Injectable()
], AnimationService);
export { AnimationService };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYW5pbWF0aW9uLnNlcnZpY2UuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9zdGltdWxzb2Z0LXZpZXdlci1hbmd1bGFyLyIsInNvdXJjZXMiOlsibGliL3NlcnZpY2VzL2FuaW1hdGlvbi5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQzNDLE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUcvQyxJQUFhLGdCQUFnQixHQUE3QixNQUFhLGdCQUFnQjtJQUMzQixZQUFvQixLQUFtQjtRQUFuQixVQUFLLEdBQUwsS0FBSyxDQUFjO0lBQUksQ0FBQztJQUVyQyxzQkFBc0IsQ0FBQyxXQUFXLEVBQUUsZUFBZSxFQUFFLE9BQU8sRUFBRSxnQkFBZ0I7UUFDbkYsSUFBSSxDQUFDLFdBQVcsRUFBRTtZQUNoQixPQUFPO1NBQ1I7UUFDRCxJQUFJLGdCQUFnQixHQUFHLENBQUMsQ0FBQztRQUN6QixJQUFJLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQyxjQUFjLEVBQUU7WUFDaEQsZ0JBQWdCLEdBQUcsV0FBVyxDQUFDLFNBQVMsQ0FBQztTQUMxQzthQUFNO1lBQ0wsZ0JBQWdCLEdBQUcsUUFBUSxDQUFDLGVBQWUsQ0FBQyxTQUFTLENBQUM7WUFDdEQsSUFBSSxnQkFBZ0IsS0FBSyxDQUFDLEVBQUU7Z0JBQzFCLGdCQUFnQixHQUFHLFFBQVEsQ0FBQyxvQkFBb0IsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUM7YUFDdkU7U0FDRjtRQUVELFlBQVksQ0FBQyxXQUFXLENBQUMsY0FBYyxDQUFDLENBQUM7UUFDekMsTUFBTSxDQUFDLEdBQUcsSUFBSSxJQUFJLEVBQUUsQ0FBQztRQUNyQixNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsT0FBTyxFQUFFLENBQUM7UUFDdEIsSUFBSSxJQUFJLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLGVBQWUsR0FBRyxnQkFBZ0IsQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLE9BQU8sR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQyxDQUFDO1FBRWpHLFlBQVk7UUFDWixJQUFJLElBQUksQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxlQUFlLEdBQUcsZ0JBQWdCLENBQUMsRUFBRTtZQUNqRSxJQUFJLEdBQUcsZUFBZSxHQUFHLGdCQUFnQixDQUFDO1NBQzNDO1FBRUQsZ0JBQWdCLElBQUksSUFBSSxDQUFDO1FBQ3pCLElBQUksZUFBdUIsQ0FBQztRQUU1QixJQUFJLENBQUMsR0FBRyxPQUFPLEVBQUU7WUFDZixlQUFlLEdBQUcsZ0JBQWdCLENBQUM7WUFDbkMsV0FBVyxDQUFDLGNBQWMsR0FBRyxVQUFVLENBQUMsR0FBRyxFQUFFO2dCQUMzQyxJQUFJLENBQUMsc0JBQXNCLENBQUMsV0FBVyxFQUFFLGVBQWUsRUFBRSxPQUFPLEVBQUUsZ0JBQWdCLENBQUMsQ0FBQztZQUN2RixDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUM7U0FDUjthQUFNO1lBQ0wsZUFBZSxHQUFHLGVBQWUsQ0FBQztZQUNsQyxJQUFJLGdCQUFnQixFQUFFO2dCQUNwQixnQkFBZ0IsRUFBRSxDQUFDO2FBQ3BCO1NBQ0Y7UUFFRCxJQUFJLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQyxjQUFjLEVBQUU7WUFDaEQsV0FBVyxDQUFDLFNBQVMsR0FBRyxlQUFlLENBQUM7U0FDekM7YUFBTTtZQUNMLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxFQUFFLGVBQWUsQ0FBQyxDQUFDO1NBQ3JDO0lBQ0gsQ0FBQztDQUVGLENBQUE7O1lBaEQ0QixZQUFZOztBQUQ1QixnQkFBZ0I7SUFENUIsVUFBVSxFQUFFO0dBQ0EsZ0JBQWdCLENBaUQ1QjtTQWpEWSxnQkFBZ0IiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IE1vZGVsU2VydmljZSB9IGZyb20gJy4vbW9kZWwuc2VydmljZSc7XHJcblxyXG5ASW5qZWN0YWJsZSgpXHJcbmV4cG9ydCBjbGFzcyBBbmltYXRpb25TZXJ2aWNlIHtcclxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIG1vZGVsOiBNb2RlbFNlcnZpY2UpIHsgfVxyXG5cclxuICBwdWJsaWMgc2hvd0FuaW1hdGlvbkZvclNjcm9sbChyZXBvcnRQYW5lbCwgZmluaXNoU2Nyb2xsVG9wLCBlbmRUaW1lLCBjb21wbGV0ZUZ1bmN0aW9uKSB7XHJcbiAgICBpZiAoIXJlcG9ydFBhbmVsKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGxldCBjdXJyZW50U2Nyb2xsVG9wID0gMDtcclxuICAgIGlmICh0aGlzLm1vZGVsLm9wdGlvbnMuYXBwZWFyYW5jZS5zY3JvbGxiYXJzTW9kZSkge1xyXG4gICAgICBjdXJyZW50U2Nyb2xsVG9wID0gcmVwb3J0UGFuZWwuc2Nyb2xsVG9wO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgY3VycmVudFNjcm9sbFRvcCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3A7XHJcbiAgICAgIGlmIChjdXJyZW50U2Nyb2xsVG9wID09PSAwKSB7XHJcbiAgICAgICAgY3VycmVudFNjcm9sbFRvcCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdCT0RZJylbMF0uc2Nyb2xsVG9wO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgY2xlYXJUaW1lb3V0KHJlcG9ydFBhbmVsLmFuaW1hdGlvblRpbWVyKTtcclxuICAgIGNvbnN0IGQgPSBuZXcgRGF0ZSgpO1xyXG4gICAgY29uc3QgdCA9IGQuZ2V0VGltZSgpO1xyXG4gICAgbGV0IHN0ZXAgPSBNYXRoLnJvdW5kKChmaW5pc2hTY3JvbGxUb3AgLSBjdXJyZW50U2Nyb2xsVG9wKSAvICgoTWF0aC5hYnMoZW5kVGltZSAtIHQpICsgMSkgLyAzMCkpO1xyXG5cclxuICAgIC8vIExhc3Qgc3RlcFxyXG4gICAgaWYgKE1hdGguYWJzKHN0ZXApID4gTWF0aC5hYnMoZmluaXNoU2Nyb2xsVG9wIC0gY3VycmVudFNjcm9sbFRvcCkpIHtcclxuICAgICAgc3RlcCA9IGZpbmlzaFNjcm9sbFRvcCAtIGN1cnJlbnRTY3JvbGxUb3A7XHJcbiAgICB9XHJcblxyXG4gICAgY3VycmVudFNjcm9sbFRvcCArPSBzdGVwO1xyXG4gICAgbGV0IHJlc3VsdFNjcm9sbFRvcDogbnVtYmVyO1xyXG5cclxuICAgIGlmICh0IDwgZW5kVGltZSkge1xyXG4gICAgICByZXN1bHRTY3JvbGxUb3AgPSBjdXJyZW50U2Nyb2xsVG9wO1xyXG4gICAgICByZXBvcnRQYW5lbC5hbmltYXRpb25UaW1lciA9IHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuc2hvd0FuaW1hdGlvbkZvclNjcm9sbChyZXBvcnRQYW5lbCwgZmluaXNoU2Nyb2xsVG9wLCBlbmRUaW1lLCBjb21wbGV0ZUZ1bmN0aW9uKTtcclxuICAgICAgfSwgMzApO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmVzdWx0U2Nyb2xsVG9wID0gZmluaXNoU2Nyb2xsVG9wO1xyXG4gICAgICBpZiAoY29tcGxldGVGdW5jdGlvbikge1xyXG4gICAgICAgIGNvbXBsZXRlRnVuY3Rpb24oKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGlmICh0aGlzLm1vZGVsLm9wdGlvbnMuYXBwZWFyYW5jZS5zY3JvbGxiYXJzTW9kZSkge1xyXG4gICAgICByZXBvcnRQYW5lbC5zY3JvbGxUb3AgPSByZXN1bHRTY3JvbGxUb3A7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB3aW5kb3cuc2Nyb2xsVG8oMCwgcmVzdWx0U2Nyb2xsVG9wKTtcclxuICAgIH1cclxuICB9XHJcblxyXG59XHJcbiJdfQ==