import { __decorate } from "tslib";
import { Injectable } from '@angular/core';
import { ModelService } from './model.service';
import { Md5Service } from './md5.service';
import { HelperService } from './helper.service';
import { ControllerService } from './controller.service';
import { DrillDownService } from './drill-down.service';
let InteractionsService = class InteractionsService {
    constructor(model, md5, controller, helper, drillDownService) {
        this.model = model;
        this.md5 = md5;
        this.controller = controller;
        this.helper = helper;
        this.drillDownService = drillDownService;
        controller.getMessage().subscribe((message) => {
            if (message.action === 'InitVars') {
                this.showParametersPanel(message.data);
            }
        });
        controller.getActionMessage().subscribe((message) => {
            switch (message.action) {
                case 'Variables':
                    this.postInteraction({ action: 'Variables', variables: this.getParametersValues() });
                    break;
                case 'Reset':
                    this.showParametersPanel(this.model.options.paramsVariables);
                    break;
                default:
                    break;
            }
        });
    }
    postInteraction(params) {
        this.drillDownService.saveState();
        // Add new drill-down parameters to drill-down queue and calc guid
        if (params.action !== 'InitVars' && (params.action === 'DrillDown' || params.action === 'DashboardDrillDown')) {
            if (this.model.options.drillDownInProgress) {
                return;
            }
            if (params.action === 'DashboardDrillDown' && params.drillDownParameters) {
                params.drillDownParameters.isDashboardDrillDown = true; // add dbs flag
            }
            const drillDownParameters = this.model.reportParams.drillDownParameters || [];
            params.drillDownParameters = params.drillDownParameters ? drillDownParameters.concat(params.drillDownParameters) : drillDownParameters;
            if (params.action === 'DrillDown') {
                params.drillDownGuid = this.md5.hex_md5(JSON.stringify(this.sortPropsInDrillDownParameters(params.drillDownParameters)));
            }
            else {
                params.dashboardDrillDownGuid = this.md5.hex_md5(JSON.stringify(this.sortPropsInDrillDownParameters(params.drillDownParameters)));
            }
            this.model.options.drillDownInProgress = true;
        }
        this.controller.post(params.action, this.model.options.actions.interaction, params);
    }
    showParametersPanel(data) {
        if (!data) {
            return;
        }
        if (this.controller.showError(data)) {
            data = null;
        }
        this.model.options.isParametersReceived = true;
        this.model.options.paramsVariables = typeof data === 'string' ? JSON.parse(data) : data;
        this.model.controls.parametersPanel.visible = !this.model.options.isMobileDevice;
        // if (this.model.reportParams.type === 'Dashboard') jsObject.postAction('GetPages');
        const paramsVariables = this.helper.copyObject(this.model.options.paramsVariables);
        const countParameters = this.helper.getCountObjects(paramsVariables);
        const countColumns = (countParameters <= this.model.options.minParametersCountForMultiColumns)
            ? 1 : this.model.options.appearance.parametersPanelColumnsCount;
        let countInColumn = Math.trunc(countParameters / countColumns);
        if (countInColumn * countColumns < countParameters) {
            countInColumn++;
        }
        // setup lists
        for (let i = 0; i < countParameters; i++) {
            const variable = paramsVariables[i];
            if (variable.items) {
                variable.items.forEach((v) => {
                    v.isChecked = true;
                    v.visible = true;
                });
            }
            variable.isNull = (variable.type === 'DateTime' && variable.value === null && variable.basicType === 'NullableValue');
        }
        this.model.interactions = { paramsVariables, countColumns: new Array(countColumns), countInColumn: new Array(countInColumn) };
    }
    sortPropsInDrillDownParameters(inArray) {
        if (!inArray || !inArray.length) {
            return inArray;
        }
        const outArray = [];
        for (let i = 0; i < inArray.length; i++) {
            const propNames = [];
            const el = inArray[i];
            const copyEl = {};
            Object.keys(el).forEach(p => {
                if (el.hasOwnProperty(p)) {
                    propNames.push(p);
                }
            });
            propNames.sort();
            propNames.forEach(propName => copyEl[propName] = el[propName]);
            outArray[i] = copyEl;
        }
        return outArray;
    }
    getParametersValues() {
        const parametersValues = {};
        Object.keys(this.model.interactions.paramsVariables).forEach(i => {
            const parameter = this.model.interactions.paramsVariables[i];
            parametersValues[parameter.name] = this.getVariableValue(parameter);
        });
        return parametersValues;
    }
    getVariableValue(parameter) {
        if (parameter.isNull) {
            return null;
        }
        switch (parameter.basicType) {
            case 'Value':
            case 'NullableValue':
                return this.val(parameter.key, parameter, parameter.allowUserValues ? parameter.value : parameter.key);
            case 'Range':
                return { from: this.val(parameter.key, parameter), to: this.val(parameter.keyTo, parameter) };
            case 'List':
                const value = [];
                if (parameter.items) {
                    parameter.items.filter(i => parameter.allowUserValues || i.isChecked).forEach(item => value.push(this.val(item.key, parameter)));
                }
                return value;
        }
    }
    val(key, parameter, value) {
        return parameter.type === 'DateTime' ? this.helper.getStringDateTime(key, parameter.dateTimeType) : (value === undefined ? key : value);
    }
    initializeInteractions(page) {
        if (!page) {
            return;
        }
        const elems = page.querySelectorAll ? page.querySelectorAll('td,div,span,rect,path,ellipse') : page.getElementsByTagName('td');
        const collapsedHash = [];
        for (const elem of elems) {
            if (elem.getAttribute('interaction') && (elem.getAttribute('pageguid') ||
                elem.getAttribute('reportfile') ||
                elem.getAttribute('collapsed') ||
                elem.getAttribute('databandsort'))) {
                elem.style.cursor = 'pointer';
                const sort = elem.getAttribute('sort');
                if (sort) {
                    this.paintSortingArrow(elem, sort);
                }
                const collapsed = elem.getAttribute('collapsed');
                if (collapsed) {
                    const compId = elem.getAttribute('compindex') + '|' + elem.getAttribute('interaction');
                    if (collapsedHash.indexOf(compId) < 0) {
                        this.paintCollapsingIcon(elem, collapsed === 'true');
                        collapsedHash.push(compId);
                    }
                }
                elem.onclick = (e) => {
                    if (elem.getAttribute('pageguid') || elem.getAttribute('reportfile')) {
                        this.postInteractionDrillDown(elem);
                    }
                    else if (elem.getAttribute('collapsed')) {
                        this.postInteractionCollapsing(elem);
                    }
                    else {
                        this.postInteractionSorting(elem, e.ctrlKey);
                    }
                };
                if (elem.getAttribute('pageguid') || elem.getAttribute('reportfile')) {
                    elem.onmouseover = () => elem.style.opacity = 0.75;
                    elem.onmouseout = () => elem.style.opacity = 1;
                }
            }
        }
    }
    getComponentOffset(component) {
        let offsetX = 0;
        let offsetY = 0;
        const startComponent = component;
        while (component && !isNaN(component.offsetLeft) && !isNaN(component.offsetTop)
            && (component === startComponent || component.style.position === '' || component.style.position === 'static')) {
            offsetX += component.offsetLeft - component.scrollLeft;
            offsetY += component.offsetTop - component.scrollTop;
            component = component.offsetParent;
        }
        return { top: offsetY, left: offsetX };
    }
    paintSortingArrow(component, sort) {
        if (component.arrowImg) {
            return;
        }
        const arrowImg = document.createElement("div");
        let sortUpSrc = "<svg xmlns='http://www.w3.org/2000/svg' width='12' height='12'><path d='M1 9l5-4 5 4z' fill='#eeeeee' stroke='#666'/></svg>";
        let sortDownSrc = "<svg xmlns='http://www.w3.org/2000/svg' width='12' height='12'><path d='M1 5l5 4 5-4z' fill='#eeeeee' stroke='#666'/></svg>";
        arrowImg.innerHTML = sort == "asc" ? sortDownSrc : sortUpSrc;
        const arrowWidth = (this.model.reportParams.zoom / 100) * 16;
        const arrowHeight = (this.model.reportParams.zoom / 100) * 16;
        arrowImg.style.position = 'absolute';
        arrowImg.style.width = arrowWidth + 'px';
        arrowImg.style.height = arrowHeight + 'px';
        component.appendChild(arrowImg);
        component.arrowImg = arrowImg;
        const oldPosition = component.style.position;
        const oldClassName = component.className;
        component.style.position = 'relative';
        if (!oldClassName) {
            component.className = 'stiSortingParentElement';
        }
        const arrowLeftPos = this.helper.findPosX(arrowImg, component.className);
        const arrowTopPos = this.helper.findPosY(arrowImg, component.className);
        arrowImg.style.marginLeft = (component.offsetWidth - arrowLeftPos - arrowWidth - ((this.model.reportParams.zoom / 100) * 3)) + 'px';
        arrowImg.style.marginTop = (component.offsetHeight / 2 - arrowHeight / 2 - arrowTopPos) + 'px';
        if (oldPosition)
            component.style.position = oldPosition;
        component.className = oldClassName;
    }
    paintCollapsingIcon(component, collapsed) {
        if (component.collapsImg) {
            return;
        }
        const collapsImg = document.createElement('img');
        collapsImg.src = collapsed ? this.model.img('CollapsingPlus.png') : this.model.img('CollapsingMinus.png');
        collapsImg.style.position = 'absolute';
        const collapsWidth = (this.model.reportParams.zoom / 100) * 10;
        const collapsHeight = (this.model.reportParams.zoom / 100) * 10;
        collapsImg.style.width = collapsWidth + 'px';
        collapsImg.style.height = collapsHeight + 'px';
        component.appendChild(collapsImg);
        component.collapsImg = collapsImg;
        const componentOffset = this.getComponentOffset(component);
        const collapsOffset = this.getComponentOffset(collapsImg);
        collapsImg.style.marginLeft = (componentOffset.left - collapsOffset.left + collapsWidth / 3) + 'px';
        collapsImg.style.marginTop = (componentOffset.top - collapsOffset.top + collapsWidth / 3) + 'px';
    }
    postInteractionSorting(component, isCtrl) {
        const params = {
            action: 'Sorting',
            sortingParameters: {
                ComponentName: component.getAttribute('interaction') + ';' + isCtrl.toString(),
                DataBand: component.getAttribute('databandsort')
            }
        };
        if (this.model.options.isParametersReceived) {
            params.variables = this.getParametersValues();
        }
        this.postInteraction(params);
    }
    postInteractionDrillDown(component) {
        const params = {
            action: 'DrillDown',
            drillDownParameters: {
                ComponentIndex: component.getAttribute('compindex'),
                ElementIndex: component.getAttribute('elementindex'),
                PageIndex: component.getAttribute('pageindex'),
                PageGuid: component.getAttribute('pageguid'),
                ReportFile: component.getAttribute('reportfile')
            }
        };
        this.postInteraction(params);
    }
    postInteractionCollapsing(component) {
        const componentName = component.getAttribute('interaction');
        const collapsingIndex = component.getAttribute('compindex');
        const collapsed = component.getAttribute('collapsed') === 'true' ? false : true;
        if (!this.model.reportParams.collapsingStates) {
            this.model.reportParams.collapsingStates = {};
        }
        if (!this.model.reportParams.collapsingStates[componentName]) {
            this.model.reportParams.collapsingStates[componentName] = {};
        }
        this.model.reportParams.collapsingStates[componentName][collapsingIndex] = collapsed;
        const params = {
            action: 'Collapsing',
            collapsingParameters: {
                ComponentName: componentName,
                CollapsingStates: this.model.reportParams.collapsingStates
            }
        };
        if (this.model.options.isParametersReceived) {
            params.variables = this.getParametersValues();
        }
        this.postInteraction(params);
    }
    updateAllHyperLinks() {
        let pointers = this.model.reportParams.tableOfContentsPointers;
        //var bookmarksPanel = this.controls.bookmarksPanel;
        if (this.model.reportParams.bookmarksContent != null || (pointers && pointers.length > 0)) {
            this.model.pages.forEach(p => {
                const page = p.page;
                const aHyperlinks = page.getElementsByTagName('a');
                for (const aHyperlink of aHyperlinks) {
                    aHyperlink.hrefContent = aHyperlink.getAttribute('href');
                    if (aHyperlink.hrefContent) {
                        if (aHyperlink.hrefContent.indexOf("#") == 0) {
                            let anchorParams = aHyperlink.hrefContent.substring(1).split("#GUID#");
                            aHyperlink.anchorName = anchorParams[0];
                            aHyperlink.componentGuid = anchorParams.length > 1 ? anchorParams[1] : "";
                            aHyperlink.onclick = () => {
                                let currAnchorName = aHyperlink.anchorName;
                                let cuurCompGuid = aHyperlink.componentGuid;
                                try {
                                    currAnchorName = decodeURI(aHyperlink.anchorName);
                                }
                                catch (e) {
                                    currAnchorName = aHyperlink.anchorName;
                                }
                                if (pointers.length > 0) {
                                    let pageIndex = 1;
                                    for (let i = 0; i < pointers.length; i++) {
                                        if (cuurCompGuid) {
                                            if (pointers[i].componentGuid == cuurCompGuid) {
                                                pageIndex = pointers[i].pageIndex;
                                                break;
                                            }
                                        }
                                        else if (currAnchorName) {
                                            let pointerAnchor = pointers[i].anchor.indexOf("#") == 0 ? pointers[i].anchor.substring(1) : pointers[i].anchor;
                                            if (pointerAnchor == currAnchorName) {
                                                pageIndex = pointers[i].pageIndex;
                                                break;
                                            }
                                        }
                                    }
                                    let anchorName = "";
                                    if (currAnchorName)
                                        anchorName += currAnchorName;
                                    if (cuurCompGuid)
                                        anchorName += ("#GUID#" + cuurCompGuid);
                                    if (anchorName) {
                                        this.controller.action({ name: 'BookmarkAction', bookmarkPage: Math.max(pageIndex - 1, 0), bookmarkAnchor: anchorName, componentGuid: aHyperlink.compunentGuid });
                                        return false;
                                    }
                                }
                                if (this.model.reportParams.bookmarksContent != null) {
                                    const node = this.model.nodes.find(n => n.name === currAnchorName);
                                    if (node) {
                                        this.model.navigateNode = node;
                                    }
                                    else {
                                        for (let k = 0; k < document.anchors.length; k++) {
                                            if (document.anchors[k].name == currAnchorName) {
                                                //jsObject.scrollToAnchor(currAnchorName);
                                                this.helper.scrollToAnchor(currAnchorName);
                                                return;
                                            }
                                        }
                                    }
                                    this.controller.post('BookmarkAction', null, 0);
                                    /*let aBookmarks = bookmarksPanel.getElementsByTagName("a");
                                    for (let k = 0; k < aBookmarks.length; k++) {
                                      let clickFunc = aBookmarks[k].getAttribute("onclick");
                                      if (clickFunc && clickFunc.indexOf("'" + currAnchorName + "'") >= 0) {
                                        try {
                                          eval(clickFunc);
                                          return false;
                                        }
                                        catch (e) { }
                                      }
                                    }
                  
                                    this.controller.post('BookmarkAction', null, 0);*/
                                    return false;
                                }
                                //=================================
                                /*let pageIndex = 1;
                                for (let i = 0; i < pointers.length; i++) {
                                  if (aHyperlink.componentGuid) {
                                    if (pointers[i].componentGuid == aHyperlink.componentGuid) {
                                      pageIndex = pointers[i].pageIndex;
                                      break;
                                    }
                                  }
                                  else if (aHyperlink.bookmarkAnchor) {
                                    if (pointers[i].anchor == decodeURI(aHyperlink.bookmarkAnchor)) {
                                      pageIndex = pointers[i].pageIndex;
                                      break;
                                    }
                                  }
                                }
                                this.controller.action({ name: 'BookmarkAction', bookmarkPage: pageIndex - 1, bookmarkAnchor: decodeURI(aHyperlink.bookmarkAnchor), componentGuid: aHyperlink.compunentGuid });
                                return false;
                                };
                                } else if (this.model.reportParams.bookmarksContent != null) {
                                aHyperlink.anchorName = aHyperlink.hrefContent.replace('#', '');
                
                                aHyperlink.onclick = () => {
                                const node = this.model.nodes.find(n => n.url.replace(/\\\'/g, '\'').substr(1) === aHyperlink.anchorName);
                                if (node) {
                                  this.model.navigateNode = node;
                                } else if (aHyperlink.hrefContent.indexOf('#') === 0) {
                                  for (let i = 0; i < document.anchors.length; i++) {
                                    const anchor = document.anchors[i];
                                    if (anchor.name === aHyperlink.anchorName) {
                                      this.helper.scrollToAnchor(aHyperlink.anchorName);
                                      return;
                                    }
                                  }
                                  this.controller.post('BookmarkAction', null, 0);
                                }
                                return false;
                                };*/
                            };
                        }
                    }
                }
            });
        }
    }
};
InteractionsService.ctorParameters = () => [
    { type: ModelService },
    { type: Md5Service },
    { type: ControllerService },
    { type: HelperService },
    { type: DrillDownService }
];
InteractionsService = __decorate([
    Injectable()
], InteractionsService);
export { InteractionsService };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW50ZXJhY3Rpb25zLnNlcnZpY2UuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9zdGltdWxzb2Z0LXZpZXdlci1hbmd1bGFyLyIsInNvdXJjZXMiOlsibGliL3NlcnZpY2VzL2ludGVyYWN0aW9ucy5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQzNDLE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUMvQyxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBRTNDLE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQztBQUNqRCxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQUN6RCxPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQUd4RCxJQUFhLG1CQUFtQixHQUFoQyxNQUFhLG1CQUFtQjtJQUU5QixZQUFtQixLQUFtQixFQUFTLEdBQWUsRUFBUyxVQUE2QixFQUFTLE1BQXFCLEVBQ3pILGdCQUFrQztRQUR4QixVQUFLLEdBQUwsS0FBSyxDQUFjO1FBQVMsUUFBRyxHQUFILEdBQUcsQ0FBWTtRQUFTLGVBQVUsR0FBVixVQUFVLENBQW1CO1FBQVMsV0FBTSxHQUFOLE1BQU0sQ0FBZTtRQUN6SCxxQkFBZ0IsR0FBaEIsZ0JBQWdCLENBQWtCO1FBRXpDLFVBQVUsQ0FBQyxVQUFVLEVBQUUsQ0FBQyxTQUFTLENBQUMsQ0FBQyxPQUFnQixFQUFFLEVBQUU7WUFDckQsSUFBSSxPQUFPLENBQUMsTUFBTSxLQUFLLFVBQVUsRUFBRTtnQkFDakMsSUFBSSxDQUFDLG1CQUFtQixDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQzthQUN4QztRQUNILENBQUMsQ0FBQyxDQUFDO1FBRUgsVUFBVSxDQUFDLGdCQUFnQixFQUFFLENBQUMsU0FBUyxDQUFDLENBQUMsT0FBZ0IsRUFBRSxF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QUFZO1lBQWMsVUFBVTtZQUFxQixpQkFBaUI7WUFBaUIsYUFBYTtZQUN2RyxnQkFBZ0I7O0FBSGhDLG1CQUFtQjtJQUQvQixVQUFVLEVBQUU7R0FDQSxtQkFBbUIsQ0FxYy9CO1NBcmNZLG1CQUFtQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgTW9kZWxTZXJ2aWNlIH0gZnJvbSAnLi9tb2RlbC5zZXJ2aWNlJztcclxuaW1wb3J0IHsgTWQ1U2VydmljZSB9IGZyb20gJy4vbWQ1LnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBJbnRlcmFjdGlvblBhcmFtcywgSW50ZXJhY3Rpb25PYmplY3QsIFZhcmlhYmxlLCBNZXNzYWdlIH0gZnJvbSAnLi9vYmplY3RzJztcclxuaW1wb3J0IHsgSGVscGVyU2VydmljZSB9IGZyb20gJy4vaGVscGVyLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBDb250cm9sbGVyU2VydmljZSB9IGZyb20gJy4vY29udHJvbGxlci5zZXJ2aWNlJztcclxuaW1wb3J0IHsgRHJpbGxEb3duU2VydmljZSB9IGZyb20gJy4vZHJpbGwtZG93bi5zZXJ2aWNlJztcclxuXHJcbkBJbmplY3RhYmxlKClcclxuZXhwb3J0IGNsYXNzIEludGVyYWN0aW9uc1NlcnZpY2Uge1xyXG5cclxuICBjb25zdHJ1Y3RvcihwdWJsaWMgbW9kZWw6IE1vZGVsU2VydmljZSwgcHVibGljIG1kNTogTWQ1U2VydmljZSwgcHVibGljIGNvbnRyb2xsZXI6IENvbnRyb2xsZXJTZXJ2aWNlLCBwdWJsaWMgaGVscGVyOiBIZWxwZXJTZXJ2aWNlLFxyXG4gICAgcHVibGljIGRyaWxsRG93blNlcnZpY2U6IERyaWxsRG93blNlcnZpY2UpIHtcclxuXHJcbiAgICBjb250cm9sbGVyLmdldE1lc3NhZ2UoKS5zdWJzY3JpYmUoKG1lc3NhZ2U6IE1lc3NhZ2UpID0+IHtcclxuICAgICAgaWYgKG1lc3NhZ2UuYWN0aW9uID09PSAnSW5pdFZhcnMnKSB7XHJcbiAgICAgICAgdGhpcy5zaG93UGFyYW1ldGVyc1BhbmVsKG1lc3NhZ2UuZGF0YSk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGNvbnRyb2xsZXIuZ2V0QWN0aW9uTWVzc2FnZSgpLnN1YnNjcmliZSgobWVzc2FnZTogTWVzc2FnZSkgPT4ge1xyXG4gICAgICBzd2l0Y2ggKG1lc3NhZ2UuYWN0aW9uKSB7XHJcbiAgICAgICAgY2FzZSAnVmFyaWFibGVzJzpcclxuICAgICAgICAgIHRoaXMucG9zdEludGVyYWN0aW9uKHsgYWN0aW9uOiAnVmFyaWFibGVzJywgdmFyaWFibGVzOiB0aGlzLmdldFBhcmFtZXRlcnNWYWx1ZXMoKSB9KTtcclxuICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICBjYXNlICdSZXNldCc6XHJcbiAgICAgICAgICB0aGlzLnNob3dQYXJhbWV0ZXJzUGFuZWwodGhpcy5tb2RlbC5vcHRpb25zLnBhcmFtc1ZhcmlhYmxlcyk7XHJcbiAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBwb3N0SW50ZXJhY3Rpb24ocGFyYW1zOiBJbnRlcmFjdGlvblBhcmFtcykge1xyXG4gICAgdGhpcy5kcmlsbERvd25TZXJ2aWNlLnNhdmVTdGF0ZSgpO1xyXG4gICAgLy8gQWRkIG5ldyBkcmlsbC1kb3duIHBhcmFtZXRlcnMgdG8gZHJpbGwtZG93biBxdWV1ZSBhbmQgY2FsYyBndWlkXHJcbiAgICBpZiAocGFyYW1zLmFjdGlvbiAhPT0gJ0luaXRWYXJzJyAmJiAocGFyYW1zLmFjdGlvbiA9PT0gJ0RyaWxsRG93bicgfHwgcGFyYW1zLmFjdGlvbiA9PT0gJ0Rhc2hib2FyZERyaWxsRG93bicpKSB7XHJcbiAgICAgIGlmICh0aGlzLm1vZGVsLm9wdGlvbnMuZHJpbGxEb3duSW5Qcm9ncmVzcykge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKHBhcmFtcy5hY3Rpb24gPT09ICdEYXNoYm9hcmREcmlsbERvd24nICYmIHBhcmFtcy5kcmlsbERvd25QYXJhbWV0ZXJzKSB7XHJcbiAgICAgICAgcGFyYW1zLmRyaWxsRG93blBhcmFtZXRlcnMuaXNEYXNoYm9hcmREcmlsbERvd24gPSB0cnVlOyAvLyBhZGQgZGJzIGZsYWdcclxuICAgICAgfVxyXG4gICAgICBjb25zdCBkcmlsbERvd25QYXJhbWV0ZXJzID0gdGhpcy5tb2RlbC5yZXBvcnRQYXJhbXMuZHJpbGxEb3duUGFyYW1ldGVycyB8fCBbXTtcclxuICAgICAgcGFyYW1zLmRyaWxsRG93blBhcmFtZXRlcnMgPSBwYXJhbXMuZHJpbGxEb3duUGFyYW1ldGVycyA/IGRyaWxsRG93blBhcmFtZXRlcnMuY29uY2F0KHBhcmFtcy5kcmlsbERvd25QYXJhbWV0ZXJzKSA6IGRyaWxsRG93blBhcmFtZXRlcnM7XHJcblxyXG4gICAgICBpZiAocGFyYW1zLmFjdGlvbiA9PT0gJ0RyaWxsRG93bicpIHtcclxuICAgICAgICBwYXJhbXMuZHJpbGxEb3duR3VpZCA9IHRoaXMubWQ1LmhleF9tZDUoSlNPTi5zdHJpbmdpZnkodGhpcy5zb3J0UHJvcHNJbkRyaWxsRG93blBhcmFtZXRlcnMocGFyYW1zLmRyaWxsRG93blBhcmFtZXRlcnMpKSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcGFyYW1zLmRhc2hib2FyZERyaWxsRG93bkd1aWQgPSB0aGlzLm1kNS5oZXhfbWQ1KEpTT04uc3RyaW5naWZ5KHRoaXMuc29ydFByb3BzSW5EcmlsbERvd25QYXJhbWV0ZXJzKHBhcmFtcy5kcmlsbERvd25QYXJhbWV0ZXJzKSkpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICB0aGlzLm1vZGVsLm9wdGlvbnMuZHJpbGxEb3duSW5Qcm9ncmVzcyA9IHRydWU7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5jb250cm9sbGVyLnBvc3QocGFyYW1zLmFjdGlvbiwgdGhpcy5tb2RlbC5vcHRpb25zLmFjdGlvbnMuaW50ZXJhY3Rpb24sIHBhcmFtcyk7XHJcbiAgfVxyXG5cclxuICBzaG93UGFyYW1ldGVyc1BhbmVsKGRhdGE6IGFueSkge1xyXG4gICAgaWYgKCFkYXRhKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICBpZiAodGhpcy5jb250cm9sbGVyLnNob3dFcnJvcihkYXRhKSkge1xyXG4gICAgICBkYXRhID0gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLm1vZGVsLm9wdGlvbnMuaXNQYXJhbWV0ZXJzUmVjZWl2ZWQgPSB0cnVlO1xyXG4gICAgdGhpcy5tb2RlbC5vcHRpb25zLnBhcmFtc1ZhcmlhYmxlcyA9IHR5cGVvZiBkYXRhID09PSAnc3RyaW5nJyA/IEpTT04ucGFyc2UoZGF0YSkgOiBkYXRhO1xyXG4gICAgdGhpcy5tb2RlbC5jb250cm9scy5wYXJhbWV0ZXJzUGFuZWwudmlzaWJsZSA9ICF0aGlzLm1vZGVsLm9wdGlvbnMuaXNNb2JpbGVEZXZpY2U7XHJcblxyXG4gICAgLy8gaWYgKHRoaXMubW9kZWwucmVwb3J0UGFyYW1zLnR5cGUgPT09ICdEYXNoYm9hcmQnKSBqc09iamVjdC5wb3N0QWN0aW9uKCdHZXRQYWdlcycpO1xyXG5cclxuICAgIGNvbnN0IHBhcmFtc1ZhcmlhYmxlcyA9IHRoaXMuaGVscGVyLmNvcHlPYmplY3QodGhpcy5tb2RlbC5vcHRpb25zLnBhcmFtc1ZhcmlhYmxlcyk7XHJcbiAgICBjb25zdCBjb3VudFBhcmFtZXRlcnM6IG51bWJlciA9IHRoaXMuaGVscGVyLmdldENvdW50T2JqZWN0cyhwYXJhbXNWYXJpYWJsZXMpO1xyXG4gICAgY29uc3QgY291bnRDb2x1bW5zOiBudW1iZXIgPSAoY291bnRQYXJhbWV0ZXJzIDw9IHRoaXMubW9kZWwub3B0aW9ucy5taW5QYXJhbWV0ZXJzQ291bnRGb3JNdWx0aUNvbHVtbnMpXHJcbiAgICAgID8gMSA6IHRoaXMubW9kZWwub3B0aW9ucy5hcHBlYXJhbmNlLnBhcmFtZXRlcnNQYW5lbENvbHVtbnNDb3VudDtcclxuXHJcbiAgICBsZXQgY291bnRJbkNvbHVtbiA9IE1hdGgudHJ1bmMoY291bnRQYXJhbWV0ZXJzIC8gY291bnRDb2x1bW5zKTtcclxuICAgIGlmIChjb3VudEluQ29sdW1uICogY291bnRDb2x1bW5zIDwgY291bnRQYXJhbWV0ZXJzKSB7XHJcbiAgICAgIGNvdW50SW5Db2x1bW4rKztcclxuICAgIH1cclxuXHJcbiAgICAvLyBzZXR1cCBsaXN0c1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb3VudFBhcmFtZXRlcnM7IGkrKykge1xyXG4gICAgICBjb25zdCB2YXJpYWJsZSA9IHBhcmFtc1ZhcmlhYmxlc1tpXSBhcyBWYXJpYWJsZTtcclxuICAgICAgaWYgKHZhcmlhYmxlLml0ZW1zKSB7XHJcbiAgICAgICAgdmFyaWFibGUuaXRlbXMuZm9yRWFjaCgodikgPT4ge1xyXG4gICAgICAgICAgdi5pc0NoZWNrZWQgPSB0cnVlO1xyXG4gICAgICAgICAgdi52aXNpYmxlID0gdHJ1ZTtcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgdmFyaWFibGUuaXNOdWxsID0gKHZhcmlhYmxlLnR5cGUgPT09ICdEYXRlVGltZScgJiYgdmFyaWFibGUudmFsdWUgPT09IG51bGwgJiYgdmFyaWFibGUuYmFzaWNUeXBlID09PSAnTnVsbGFibGVWYWx1ZScpO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMubW9kZWwuaW50ZXJhY3Rpb25zID0geyBwYXJhbXNWYXJpYWJsZXMsIGNvdW50Q29sdW1uczogbmV3IEFycmF5KGNvdW50Q29sdW1ucyksIGNvdW50SW5Db2x1bW46IG5ldyBBcnJheShjb3VudEluQ29sdW1uKSB9O1xyXG4gIH1cclxuXHJcbiAgc29ydFByb3BzSW5EcmlsbERvd25QYXJhbWV0ZXJzKGluQXJyYXk6IFtdKTogYW55W10ge1xyXG4gICAgaWYgKCFpbkFycmF5IHx8ICFpbkFycmF5Lmxlbmd0aCkge1xyXG4gICAgICByZXR1cm4gaW5BcnJheTtcclxuICAgIH1cclxuICAgIGNvbnN0IG91dEFycmF5OiBhbnlbXSA9IFtdO1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpbkFycmF5Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIGNvbnN0IHByb3BOYW1lcyA9IFtdO1xyXG4gICAgICBjb25zdCBlbDogYW55ID0gaW5BcnJheVtpXTtcclxuICAgICAgY29uc3QgY29weUVsID0ge307XHJcbiAgICAgIE9iamVjdC5rZXlzKGVsKS5mb3JFYWNoKHAgPT4ge1xyXG4gICAgICAgIGlmIChlbC5oYXNPd25Qcm9wZXJ0eShwKSkge1xyXG4gICAgICAgICAgcHJvcE5hbWVzLnB1c2gocCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIHByb3BOYW1lcy5zb3J0KCk7XHJcbiAgICAgIHByb3BOYW1lcy5mb3JFYWNoKHByb3BOYW1lID0+IGNvcHlFbFtwcm9wTmFtZV0gPSBlbFtwcm9wTmFtZV0pO1xyXG4gICAgICBvdXRBcnJheVtpXSA9IGNvcHlFbDtcclxuICAgIH1cclxuICAgIHJldHVybiBvdXRBcnJheTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBnZXRQYXJhbWV0ZXJzVmFsdWVzKCk6IGFueSB7XHJcbiAgICBjb25zdCBwYXJhbWV0ZXJzVmFsdWVzID0ge307XHJcbiAgICBPYmplY3Qua2V5cyh0aGlzLm1vZGVsLmludGVyYWN0aW9ucy5wYXJhbXNWYXJpYWJsZXMpLmZvckVhY2goaSA9PiB7XHJcbiAgICAgIGNvbnN0IHBhcmFtZXRlcjogVmFyaWFibGUgPSB0aGlzLm1vZGVsLmludGVyYWN0aW9ucy5wYXJhbXNWYXJpYWJsZXNbaV07XHJcbiAgICAgIHBhcmFtZXRlcnNWYWx1ZXNbcGFyYW1ldGVyLm5hbWVdID0gdGhpcy5nZXRWYXJpYWJsZVZhbHVlKHBhcmFtZXRlcik7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBwYXJhbWV0ZXJzVmFsdWVzO1xyXG4gIH1cclxuXHJcbiAgZ2V0VmFyaWFibGVWYWx1ZShwYXJhbWV0ZXI6IFZhcmlhYmxlKTogYW55IHtcclxuICAgIGlmIChwYXJhbWV0ZXIuaXNOdWxsKSB7XHJcbiAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIHN3aXRjaCAocGFyYW1ldGVyLmJhc2ljVHlwZSkge1xyXG4gICAgICBjYXNlICdWYWx1ZSc6XHJcbiAgICAgIGNhc2UgJ051bGxhYmxlVmFsdWUnOlxyXG4gICAgICAgIHJldHVybiB0aGlzLnZhbChwYXJhbWV0ZXIua2V5LCBwYXJhbWV0ZXIsIHBhcmFtZXRlci5hbGxvd1VzZXJWYWx1ZXMgPyBwYXJhbWV0ZXIudmFsdWUgOiBwYXJhbWV0ZXIua2V5KTtcclxuXHJcbiAgICAgIGNhc2UgJ1JhbmdlJzpcclxuICAgICAgICByZXR1cm4geyBmcm9tOiB0aGlzLnZhbChwYXJhbWV0ZXIua2V5LCBwYXJhbWV0ZXIpLCB0bzogdGhpcy52YWwocGFyYW1ldGVyLmtleVRvLCBwYXJhbWV0ZXIpIH07XHJcblxyXG4gICAgICBjYXNlICdMaXN0JzpcclxuICAgICAgICBjb25zdCB2YWx1ZSA9IFtdO1xyXG4gICAgICAgIGlmIChwYXJhbWV0ZXIuaXRlbXMpIHtcclxuICAgICAgICAgIHBhcmFtZXRlci5pdGVtcy5maWx0ZXIoaSA9PiBwYXJhbWV0ZXIuYWxsb3dVc2VyVmFsdWVzIHx8IGkuaXNDaGVja2VkKS5mb3JFYWNoKGl0ZW0gPT4gdmFsdWUucHVzaCh0aGlzLnZhbChpdGVtLmtleSwgcGFyYW1ldGVyKSkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdmFsdWU7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICB2YWwoa2V5OiBhbnksIHBhcmFtZXRlcjogVmFyaWFibGUsIHZhbHVlPzogYW55KTogYW55IHtcclxuICAgIHJldHVybiBwYXJhbWV0ZXIudHlwZSA9PT0gJ0RhdGVUaW1lJyA/IHRoaXMuaGVscGVyLmdldFN0cmluZ0RhdGVUaW1lKGtleSwgcGFyYW1ldGVyLmRhdGVUaW1lVHlwZSkgOiAodmFsdWUgPT09IHVuZGVmaW5lZCA/IGtleSA6IHZhbHVlKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBpbml0aWFsaXplSW50ZXJhY3Rpb25zKHBhZ2U6IGFueSkge1xyXG4gICAgaWYgKCFwYWdlKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGNvbnN0IGVsZW1zID0gcGFnZS5xdWVyeVNlbGVjdG9yQWxsID8gcGFnZS5xdWVyeVNlbGVjdG9yQWxsKCd0ZCxkaXYsc3BhbixyZWN0LHBhdGgsZWxsaXBzZScpIDogcGFnZS5nZXRFbGVtZW50c0J5VGFnTmFtZSgndGQnKTtcclxuICAgIGNvbnN0IGNvbGxhcHNlZEhhc2ggPSBbXTtcclxuICAgIGZvciAoY29uc3QgZWxlbSBvZiBlbGVtcykge1xyXG4gICAgICBpZiAoZWxlbS5nZXRBdHRyaWJ1dGUoJ2ludGVyYWN0aW9uJykgJiYgKFxyXG4gICAgICAgIGVsZW0uZ2V0QXR0cmlidXRlKCdwYWdlZ3VpZCcpIHx8XHJcbiAgICAgICAgZWxlbS5nZXRBdHRyaWJ1dGUoJ3JlcG9ydGZpbGUnKSB8fFxyXG4gICAgICAgIGVsZW0uZ2V0QXR0cmlidXRlKCdjb2xsYXBzZWQnKSB8fFxyXG4gICAgICAgIGVsZW0uZ2V0QXR0cmlidXRlKCdkYXRhYmFuZHNvcnQnKSkpIHtcclxuXHJcbiAgICAgICAgZWxlbS5zdHlsZS5jdXJzb3IgPSAncG9pbnRlcic7XHJcblxyXG4gICAgICAgIGNvbnN0IHNvcnQgPSBlbGVtLmdldEF0dHJpYnV0ZSgnc29ydCcpO1xyXG4gICAgICAgIGlmIChzb3J0KSB7XHJcbiAgICAgICAgICB0aGlzLnBhaW50U29ydGluZ0Fycm93KGVsZW0sIHNvcnQpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgY29sbGFwc2VkID0gZWxlbS5nZXRBdHRyaWJ1dGUoJ2NvbGxhcHNlZCcpO1xyXG4gICAgICAgIGlmIChjb2xsYXBzZWQpIHtcclxuICAgICAgICAgIGNvbnN0IGNvbXBJZCA9IGVsZW0uZ2V0QXR0cmlidXRlKCdjb21waW5kZXgnKSArICd8JyArIGVsZW0uZ2V0QXR0cmlidXRlKCdpbnRlcmFjdGlvbicpO1xyXG4gICAgICAgICAgaWYgKGNvbGxhcHNlZEhhc2guaW5kZXhPZihjb21wSWQpIDwgMCkge1xyXG4gICAgICAgICAgICB0aGlzLnBhaW50Q29sbGFwc2luZ0ljb24oZWxlbSwgY29sbGFwc2VkID09PSAndHJ1ZScpO1xyXG4gICAgICAgICAgICBjb2xsYXBzZWRIYXNoLnB1c2goY29tcElkKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGVsZW0ub25jbGljayA9IChlOiBhbnkpID0+IHtcclxuICAgICAgICAgIGlmIChlbGVtLmdldEF0dHJpYnV0ZSgncGFnZWd1aWQnKSB8fCBlbGVtLmdldEF0dHJpYnV0ZSgncmVwb3J0ZmlsZScpKSB7XHJcbiAgICAgICAgICAgIHRoaXMucG9zdEludGVyYWN0aW9uRHJpbGxEb3duKGVsZW0pO1xyXG4gICAgICAgICAgfSBlbHNlIGlmIChlbGVtLmdldEF0dHJpYnV0ZSgnY29sbGFwc2VkJykpIHtcclxuICAgICAgICAgICAgdGhpcy5wb3N0SW50ZXJhY3Rpb25Db2xsYXBzaW5nKGVsZW0pO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5wb3N0SW50ZXJhY3Rpb25Tb3J0aW5nKGVsZW0sIGUuY3RybEtleSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgaWYgKGVsZW0uZ2V0QXR0cmlidXRlKCdwYWdlZ3VpZCcpIHx8IGVsZW0uZ2V0QXR0cmlidXRlKCdyZXBvcnRmaWxlJykpIHtcclxuICAgICAgICAgIGVsZW0ub25tb3VzZW92ZXIgPSAoKSA9PiBlbGVtLnN0eWxlLm9wYWNpdHkgPSAwLjc1O1xyXG4gICAgICAgICAgZWxlbS5vbm1vdXNlb3V0ID0gKCkgPT4gZWxlbS5zdHlsZS5vcGFjaXR5ID0gMTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZ2V0Q29tcG9uZW50T2Zmc2V0KGNvbXBvbmVudDogYW55KSB7XHJcbiAgICBsZXQgb2Zmc2V0WCA9IDA7XHJcbiAgICBsZXQgb2Zmc2V0WSA9IDA7XHJcbiAgICBjb25zdCBzdGFydENvbXBvbmVudCA9IGNvbXBvbmVudDtcclxuICAgIHdoaWxlIChjb21wb25lbnQgJiYgIWlzTmFOKGNvbXBvbmVudC5vZmZzZXRMZWZ0KSAmJiAhaXNOYU4oY29tcG9uZW50Lm9mZnNldFRvcClcclxuICAgICAgJiYgKGNvbXBvbmVudCA9PT0gc3RhcnRDb21wb25lbnQgfHwgY29tcG9uZW50LnN0eWxlLnBvc2l0aW9uID09PSAnJyB8fCBjb21wb25lbnQuc3R5bGUucG9zaXRpb24gPT09ICdzdGF0aWMnKSkge1xyXG4gICAgICBvZmZzZXRYICs9IGNvbXBvbmVudC5vZmZzZXRMZWZ0IC0gY29tcG9uZW50LnNjcm9sbExlZnQ7XHJcbiAgICAgIG9mZnNldFkgKz0gY29tcG9uZW50Lm9mZnNldFRvcCAtIGNvbXBvbmVudC5zY3JvbGxUb3A7XHJcbiAgICAgIGNvbXBvbmVudCA9IGNvbXBvbmVudC5vZmZzZXRQYXJlbnQ7XHJcbiAgICB9XHJcbiAgICByZXR1cm4geyB0b3A6IG9mZnNldFksIGxlZnQ6IG9mZnNldFggfTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBwYWludFNvcnRpbmdBcnJvdyhjb21wb25lbnQ6IGFueSwgc29ydDogc3RyaW5nKSB7XHJcbiAgICBpZiAoY29tcG9uZW50LmFycm93SW1nKSB7IHJldHVybjsgfVxyXG5cclxuICAgIGNvbnN0IGFycm93SW1nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgIGxldCBzb3J0VXBTcmMgPSBcIjxzdmcgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB3aWR0aD0nMTInIGhlaWdodD0nMTInPjxwYXRoIGQ9J00xIDlsNS00IDUgNHonIGZpbGw9JyNlZWVlZWUnIHN0cm9rZT0nIzY2NicvPjwvc3ZnPlwiO1xyXG4gICAgbGV0IHNvcnREb3duU3JjID0gXCI8c3ZnIHhtbG5zPSdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Zycgd2lkdGg9JzEyJyBoZWlnaHQ9JzEyJz48cGF0aCBkPSdNMSA1bDUgNCA1LTR6JyBmaWxsPScjZWVlZWVlJyBzdHJva2U9JyM2NjYnLz48L3N2Zz5cIjtcclxuICAgIGFycm93SW1nLmlubmVySFRNTCA9IHNvcnQgPT0gXCJhc2NcIiA/IHNvcnREb3duU3JjIDogc29ydFVwU3JjO1xyXG5cclxuICAgIGNvbnN0IGFycm93V2lkdGggPSAodGhpcy5tb2RlbC5yZXBvcnRQYXJhbXMuem9vbSAvIDEwMCkgKiAxNjtcclxuICAgIGNvbnN0IGFycm93SGVpZ2h0ID0gKHRoaXMubW9kZWwucmVwb3J0UGFyYW1zLnpvb20gLyAxMDApICogMTY7XHJcblxyXG4gICAgYXJyb3dJbWcuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnO1xyXG4gICAgYXJyb3dJbWcuc3R5bGUud2lkdGggPSBhcnJvd1dpZHRoICsgJ3B4JztcclxuICAgIGFycm93SW1nLnN0eWxlLmhlaWdodCA9IGFycm93SGVpZ2h0ICsgJ3B4JztcclxuICAgIGNvbXBvbmVudC5hcHBlbmRDaGlsZChhcnJvd0ltZyk7XHJcbiAgICBjb21wb25lbnQuYXJyb3dJbWcgPSBhcnJvd0ltZztcclxuXHJcbiAgICBjb25zdCBvbGRQb3NpdGlvbiA9IGNvbXBvbmVudC5zdHlsZS5wb3NpdGlvbjtcclxuICAgIGNvbnN0IG9sZENsYXNzTmFtZSA9IGNvbXBvbmVudC5jbGFzc05hbWU7XHJcbiAgICBjb21wb25lbnQuc3R5bGUucG9zaXRpb24gPSAncmVsYXRpdmUnO1xyXG4gICAgaWYgKCFvbGRDbGFzc05hbWUpIHsgY29tcG9uZW50LmNsYXNzTmFtZSA9ICdzdGlTb3J0aW5nUGFyZW50RWxlbWVudCc7IH1cclxuXHJcbiAgICBjb25zdCBhcnJvd0xlZnRQb3MgPSB0aGlzLmhlbHBlci5maW5kUG9zWChhcnJvd0ltZywgY29tcG9uZW50LmNsYXNzTmFtZSk7XHJcbiAgICBjb25zdCBhcnJvd1RvcFBvcyA9IHRoaXMuaGVscGVyLmZpbmRQb3NZKGFycm93SW1nLCBjb21wb25lbnQuY2xhc3NOYW1lKTtcclxuXHJcbiAgICBhcnJvd0ltZy5zdHlsZS5tYXJnaW5MZWZ0ID0gKGNvbXBvbmVudC5vZmZzZXRXaWR0aCAtIGFycm93TGVmdFBvcyAtIGFycm93V2lkdGggLSAoKHRoaXMubW9kZWwucmVwb3J0UGFyYW1zLnpvb20gLyAxMDApICogMykpICsgJ3B4JztcclxuICAgIGFycm93SW1nLnN0eWxlLm1hcmdpblRvcCA9IChjb21wb25lbnQub2Zmc2V0SGVpZ2h0IC8gMiAtIGFycm93SGVpZ2h0IC8gMiAtIGFycm93VG9wUG9zKSArICdweCc7XHJcbiAgICBpZiAob2xkUG9zaXRpb24pIGNvbXBvbmVudC5zdHlsZS5wb3NpdGlvbiA9IG9sZFBvc2l0aW9uO1xyXG4gICAgY29tcG9uZW50LmNsYXNzTmFtZSA9IG9sZENsYXNzTmFtZTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBwYWludENvbGxhcHNpbmdJY29uKGNvbXBvbmVudDogYW55LCBjb2xsYXBzZWQ6IGJvb2xlYW4pIHtcclxuICAgIGlmIChjb21wb25lbnQuY29sbGFwc0ltZykgeyByZXR1cm47IH1cclxuICAgIGNvbnN0IGNvbGxhcHNJbWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKTtcclxuICAgIGNvbGxhcHNJbWcuc3JjID0gY29sbGFwc2VkID8gdGhpcy5tb2RlbC5pbWcoJ0NvbGxhcHNpbmdQbHVzLnBuZycpIDogdGhpcy5tb2RlbC5pbWcoJ0NvbGxhcHNpbmdNaW51cy5wbmcnKTtcclxuICAgIGNvbGxhcHNJbWcuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnO1xyXG4gICAgY29uc3QgY29sbGFwc1dpZHRoID0gKHRoaXMubW9kZWwucmVwb3J0UGFyYW1zLnpvb20gLyAxMDApICogMTA7XHJcbiAgICBjb25zdCBjb2xsYXBzSGVpZ2h0ID0gKHRoaXMubW9kZWwucmVwb3J0UGFyYW1zLnpvb20gLyAxMDApICogMTA7XHJcbiAgICBjb2xsYXBzSW1nLnN0eWxlLndpZHRoID0gY29sbGFwc1dpZHRoICsgJ3B4JztcclxuICAgIGNvbGxhcHNJbWcuc3R5bGUuaGVpZ2h0ID0gY29sbGFwc0hlaWdodCArICdweCc7XHJcbiAgICBjb21wb25lbnQuYXBwZW5kQ2hpbGQoY29sbGFwc0ltZyk7XHJcbiAgICBjb21wb25lbnQuY29sbGFwc0ltZyA9IGNvbGxhcHNJbWc7XHJcblxyXG4gICAgY29uc3QgY29tcG9uZW50T2Zmc2V0ID0gdGhpcy5nZXRDb21wb25lbnRPZmZzZXQoY29tcG9uZW50KTtcclxuICAgIGNvbnN0IGNvbGxhcHNPZmZzZXQgPSB0aGlzLmdldENvbXBvbmVudE9mZnNldChjb2xsYXBzSW1nKTtcclxuICAgIGNvbGxhcHNJbWcuc3R5bGUubWFyZ2luTGVmdCA9IChjb21wb25lbnRPZmZzZXQubGVmdCAtIGNvbGxhcHNPZmZzZXQubGVmdCArIGNvbGxhcHNXaWR0aCAvIDMpICsgJ3B4JztcclxuICAgIGNvbGxhcHNJbWcuc3R5bGUubWFyZ2luVG9wID0gKGNvbXBvbmVudE9mZnNldC50b3AgLSBjb2xsYXBzT2Zmc2V0LnRvcCArIGNvbGxhcHNXaWR0aCAvIDMpICsgJ3B4JztcclxuICB9XHJcblxyXG4gIHB1YmxpYyBwb3N0SW50ZXJhY3Rpb25Tb3J0aW5nKGNvbXBvbmVudDogYW55LCBpc0N0cmw6IGJvb2xlYW4pIHtcclxuICAgIGNvbnN0IHBhcmFtczogSW50ZXJhY3Rpb25QYXJhbXMgPSB7XHJcbiAgICAgIGFjdGlvbjogJ1NvcnRpbmcnLFxyXG4gICAgICBzb3J0aW5nUGFyYW1ldGVyczoge1xyXG4gICAgICAgIENvbXBvbmVudE5hbWU6IGNvbXBvbmVudC5nZXRBdHRyaWJ1dGUoJ2ludGVyYWN0aW9uJykgKyAnOycgKyBpc0N0cmwudG9TdHJpbmcoKSxcclxuICAgICAgICBEYXRhQmFuZDogY29tcG9uZW50LmdldEF0dHJpYnV0ZSgnZGF0YWJhbmRzb3J0JylcclxuICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBpZiAodGhpcy5tb2RlbC5vcHRpb25zLmlzUGFyYW1ldGVyc1JlY2VpdmVkKSB7XHJcbiAgICAgIHBhcmFtcy52YXJpYWJsZXMgPSB0aGlzLmdldFBhcmFtZXRlcnNWYWx1ZXMoKTtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLnBvc3RJbnRlcmFjdGlvbihwYXJhbXMpO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHBvc3RJbnRlcmFjdGlvbkRyaWxsRG93bihjb21wb25lbnQ6IGFueSkge1xyXG4gICAgY29uc3QgcGFyYW1zOiBJbnRlcmFjdGlvblBhcmFtcyA9IHtcclxuICAgICAgYWN0aW9uOiAnRHJpbGxEb3duJyxcclxuICAgICAgZHJpbGxEb3duUGFyYW1ldGVyczoge1xyXG4gICAgICAgIENvbXBvbmVudEluZGV4OiBjb21wb25lbnQuZ2V0QXR0cmlidXRlKCdjb21waW5kZXgnKSxcclxuICAgICAgICBFbGVtZW50SW5kZXg6IGNvbXBvbmVudC5nZXRBdHRyaWJ1dGUoJ2VsZW1lbnRpbmRleCcpLFxyXG4gICAgICAgIFBhZ2VJbmRleDogY29tcG9uZW50LmdldEF0dHJpYnV0ZSgncGFnZWluZGV4JyksXHJcbiAgICAgICAgUGFnZUd1aWQ6IGNvbXBvbmVudC5nZXRBdHRyaWJ1dGUoJ3BhZ2VndWlkJyksXHJcbiAgICAgICAgUmVwb3J0RmlsZTogY29tcG9uZW50LmdldEF0dHJpYnV0ZSgncmVwb3J0ZmlsZScpXHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgdGhpcy5wb3N0SW50ZXJhY3Rpb24ocGFyYW1zKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBwb3N0SW50ZXJhY3Rpb25Db2xsYXBzaW5nKGNvbXBvbmVudDogYW55KSB7XHJcbiAgICBjb25zdCBjb21wb25lbnROYW1lID0gY29tcG9uZW50LmdldEF0dHJpYnV0ZSgnaW50ZXJhY3Rpb24nKTtcclxuICAgIGNvbnN0IGNvbGxhcHNpbmdJbmRleCA9IGNvbXBvbmVudC5nZXRBdHRyaWJ1dGUoJ2NvbXBpbmRleCcpO1xyXG4gICAgY29uc3QgY29sbGFwc2VkID0gY29tcG9uZW50LmdldEF0dHJpYnV0ZSgnY29sbGFwc2VkJykgPT09ICd0cnVlJyA/IGZhbHNlIDogdHJ1ZTtcclxuXHJcbiAgICBpZiAoIXRoaXMubW9kZWwucmVwb3J0UGFyYW1zLmNvbGxhcHNpbmdTdGF0ZXMpIHsgdGhpcy5tb2RlbC5yZXBvcnRQYXJhbXMuY29sbGFwc2luZ1N0YXRlcyA9IHt9OyB9XHJcbiAgICBpZiAoIXRoaXMubW9kZWwucmVwb3J0UGFyYW1zLmNvbGxhcHNpbmdTdGF0ZXNbY29tcG9uZW50TmFtZV0pIHsgdGhpcy5tb2RlbC5yZXBvcnRQYXJhbXMuY29sbGFwc2luZ1N0YXRlc1tjb21wb25lbnROYW1lXSA9IHt9OyB9XHJcbiAgICB0aGlzLm1vZGVsLnJlcG9ydFBhcmFtcy5jb2xsYXBzaW5nU3RhdGVzW2NvbXBvbmVudE5hbWVdW2NvbGxhcHNpbmdJbmRleF0gPSBjb2xsYXBzZWQ7XHJcblxyXG4gICAgY29uc3QgcGFyYW1zOiBJbnRlcmFjdGlvblBhcmFtcyA9IHtcclxuICAgICAgYWN0aW9uOiAnQ29sbGFwc2luZycsXHJcbiAgICAgIGNvbGxhcHNpbmdQYXJhbWV0ZXJzOiB7XHJcbiAgICAgICAgQ29tcG9uZW50TmFtZTogY29tcG9uZW50TmFtZSxcclxuICAgICAgICBDb2xsYXBzaW5nU3RhdGVzOiB0aGlzLm1vZGVsLnJlcG9ydFBhcmFtcy5jb2xsYXBzaW5nU3RhdGVzXHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgaWYgKHRoaXMubW9kZWwub3B0aW9ucy5pc1BhcmFtZXRlcnNSZWNlaXZlZCkge1xyXG4gICAgICBwYXJhbXMudmFyaWFibGVzID0gdGhpcy5nZXRQYXJhbWV0ZXJzVmFsdWVzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5wb3N0SW50ZXJhY3Rpb24ocGFyYW1zKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyB1cGRhdGVBbGxIeXBlckxpbmtzKCkge1xyXG4gICAgbGV0IHBvaW50ZXJzID0gdGhpcy5tb2RlbC5yZXBvcnRQYXJhbXMudGFibGVPZkNvbnRlbnRzUG9pbnRlcnM7XHJcbiAgICAvL3ZhciBib29rbWFya3NQYW5lbCA9IHRoaXMuY29udHJvbHMuYm9va21hcmtzUGFuZWw7XHJcbiAgICBpZiAodGhpcy5tb2RlbC5yZXBvcnRQYXJhbXMuYm9va21hcmtzQ29udGVudCAhPSBudWxsIHx8IChwb2ludGVycyAmJiBwb2ludGVycy5sZW5ndGggPiAwKSkge1xyXG4gICAgICB0aGlzLm1vZGVsLnBhZ2VzLmZvckVhY2gocCA9PiB7XHJcbiAgICAgICAgY29uc3QgcGFnZSA9IHAucGFnZTtcclxuXHJcbiAgICAgICAgY29uc3QgYUh5cGVybGlua3MgPSBwYWdlLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdhJyk7XHJcblxyXG4gICAgICAgIGZvciAoY29uc3QgYUh5cGVybGluayBvZiBhSHlwZXJsaW5rcykge1xyXG4gICAgICAgICAgYUh5cGVybGluay5ocmVmQ29udGVudCA9IGFIeXBlcmxpbmsuZ2V0QXR0cmlidXRlKCdocmVmJyk7XHJcblxyXG4gICAgICAgICAgaWYgKGFIeXBlcmxpbmsuaHJlZkNvbnRlbnQpIHtcclxuXHJcbiAgICAgICAgICAgIGlmIChhSHlwZXJsaW5rLmhyZWZDb250ZW50LmluZGV4T2YoXCIjXCIpID09IDApIHtcclxuICAgICAgICAgICAgICBsZXQgYW5jaG9yUGFyYW1zID0gYUh5cGVybGluay5ocmVmQ29udGVudC5zdWJzdHJpbmcoMSkuc3BsaXQoXCIjR1VJRCNcIik7XHJcbiAgICAgICAgICAgICAgYUh5cGVybGluay5hbmNob3JOYW1lID0gYW5jaG9yUGFyYW1zWzBdO1xyXG4gICAgICAgICAgICAgIGFIeXBlcmxpbmsuY29tcG9uZW50R3VpZCA9IGFuY2hvclBhcmFtcy5sZW5ndGggPiAxID8gYW5jaG9yUGFyYW1zWzFdIDogXCJcIjtcclxuXHJcbiAgICAgICAgICAgICAgYUh5cGVybGluay5vbmNsaWNrID0gKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgbGV0IGN1cnJBbmNob3JOYW1lID0gYUh5cGVybGluay5hbmNob3JOYW1lO1xyXG4gICAgICAgICAgICAgICAgbGV0IGN1dXJDb21wR3VpZCA9IGFIeXBlcmxpbmsuY29tcG9uZW50R3VpZDtcclxuXHJcbiAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICBjdXJyQW5jaG9yTmFtZSA9IGRlY29kZVVSSShhSHlwZXJsaW5rLmFuY2hvck5hbWUpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAgICAgICBjdXJyQW5jaG9yTmFtZSA9IGFIeXBlcmxpbmsuYW5jaG9yTmFtZTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAocG9pbnRlcnMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICBsZXQgcGFnZUluZGV4ID0gMTtcclxuXHJcbiAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcG9pbnRlcnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoY3V1ckNvbXBHdWlkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICBpZiAocG9pbnRlcnNbaV0uY29tcG9uZW50R3VpZCA9PSBjdXVyQ29tcEd1aWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFnZUluZGV4ID0gcG9pbnRlcnNbaV0ucGFnZUluZGV4O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoY3VyckFuY2hvck5hbWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgIGxldCBwb2ludGVyQW5jaG9yID0gcG9pbnRlcnNbaV0uYW5jaG9yLmluZGV4T2YoXCIjXCIpID09IDAgPyBwb2ludGVyc1tpXS5hbmNob3Iuc3Vic3RyaW5nKDEpIDogcG9pbnRlcnNbaV0uYW5jaG9yO1xyXG4gICAgICAgICAgICAgICAgICAgICAgaWYgKHBvaW50ZXJBbmNob3IgPT0gY3VyckFuY2hvck5hbWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFnZUluZGV4ID0gcG9pbnRlcnNbaV0ucGFnZUluZGV4O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgIGxldCBhbmNob3JOYW1lID0gXCJcIjtcclxuICAgICAgICAgICAgICAgICAgaWYgKGN1cnJBbmNob3JOYW1lKSBhbmNob3JOYW1lICs9IGN1cnJBbmNob3JOYW1lO1xyXG4gICAgICAgICAgICAgICAgICBpZiAoY3V1ckNvbXBHdWlkKSBhbmNob3JOYW1lICs9IChcIiNHVUlEI1wiICsgY3V1ckNvbXBHdWlkKTtcclxuICAgICAgICAgICAgICAgICAgaWYgKGFuY2hvck5hbWUpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbnRyb2xsZXIuYWN0aW9uKHsgbmFtZTogJ0Jvb2ttYXJrQWN0aW9uJywgYm9va21hcmtQYWdlOiBNYXRoLm1heChwYWdlSW5kZXggLSAxLCAwKSwgYm9va21hcmtBbmNob3I6IGFuY2hvck5hbWUsIGNvbXBvbmVudEd1aWQ6IGFIeXBlcmxpbmsuY29tcHVuZW50R3VpZCB9KTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5tb2RlbC5yZXBvcnRQYXJhbXMuYm9va21hcmtzQ29udGVudCAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgIGNvbnN0IG5vZGUgPSB0aGlzLm1vZGVsLm5vZGVzLmZpbmQobiA9PiBuLm5hbWUgPT09IGN1cnJBbmNob3JOYW1lKTtcclxuICAgICAgICAgICAgICAgICAgaWYgKG5vZGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm1vZGVsLm5hdmlnYXRlTm9kZSA9IG5vZGU7XHJcbiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgPCBkb2N1bWVudC5hbmNob3JzLmxlbmd0aDsgaysrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnQuYW5jaG9yc1trXS5uYW1lID09IGN1cnJBbmNob3JOYW1lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vanNPYmplY3Quc2Nyb2xsVG9BbmNob3IoY3VyckFuY2hvck5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhlbHBlci5zY3JvbGxUb0FuY2hvcihjdXJyQW5jaG9yTmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgdGhpcy5jb250cm9sbGVyLnBvc3QoJ0Jvb2ttYXJrQWN0aW9uJywgbnVsbCwgMCk7XHJcblxyXG5cclxuICAgICAgICAgICAgICAgICAgLypsZXQgYUJvb2ttYXJrcyA9IGJvb2ttYXJrc1BhbmVsLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiYVwiKTtcclxuICAgICAgICAgICAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgPCBhQm9va21hcmtzLmxlbmd0aDsgaysrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGNsaWNrRnVuYyA9IGFCb29rbWFya3Nba10uZ2V0QXR0cmlidXRlKFwib25jbGlja1wiKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoY2xpY2tGdW5jICYmIGNsaWNrRnVuYy5pbmRleE9mKFwiJ1wiICsgY3VyckFuY2hvck5hbWUgKyBcIidcIikgPj0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZXZhbChjbGlja0Z1bmMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZSkgeyB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICB0aGlzLmNvbnRyb2xsZXIucG9zdCgnQm9va21hcmtBY3Rpb24nLCBudWxsLCAwKTsqL1xyXG4gICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuICAgICAgICAgICAgICAgIC8qbGV0IHBhZ2VJbmRleCA9IDE7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBvaW50ZXJzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgIGlmIChhSHlwZXJsaW5rLmNvbXBvbmVudEd1aWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocG9pbnRlcnNbaV0uY29tcG9uZW50R3VpZCA9PSBhSHlwZXJsaW5rLmNvbXBvbmVudEd1aWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgIHBhZ2VJbmRleCA9IHBvaW50ZXJzW2ldLnBhZ2VJbmRleDtcclxuICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICBlbHNlIGlmIChhSHlwZXJsaW5rLmJvb2ttYXJrQW5jaG9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBvaW50ZXJzW2ldLmFuY2hvciA9PSBkZWNvZGVVUkkoYUh5cGVybGluay5ib29rbWFya0FuY2hvcikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgIHBhZ2VJbmRleCA9IHBvaW50ZXJzW2ldLnBhZ2VJbmRleDtcclxuICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5jb250cm9sbGVyLmFjdGlvbih7IG5hbWU6ICdCb29rbWFya0FjdGlvbicsIGJvb2ttYXJrUGFnZTogcGFnZUluZGV4IC0gMSwgYm9va21hcmtBbmNob3I6IGRlY29kZVVSSShhSHlwZXJsaW5rLmJvb2ttYXJrQW5jaG9yKSwgY29tcG9uZW50R3VpZDogYUh5cGVybGluay5jb21wdW5lbnRHdWlkIH0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5tb2RlbC5yZXBvcnRQYXJhbXMuYm9va21hcmtzQ29udGVudCAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBhSHlwZXJsaW5rLmFuY2hvck5hbWUgPSBhSHlwZXJsaW5rLmhyZWZDb250ZW50LnJlcGxhY2UoJyMnLCAnJyk7XHJcblxyXG4gICAgICAgICAgICAgICAgYUh5cGVybGluay5vbmNsaWNrID0gKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgbm9kZSA9IHRoaXMubW9kZWwubm9kZXMuZmluZChuID0+IG4udXJsLnJlcGxhY2UoL1xcXFxcXCcvZywgJ1xcJycpLnN1YnN0cigxKSA9PT0gYUh5cGVybGluay5hbmNob3JOYW1lKTtcclxuICAgICAgICAgICAgICAgIGlmIChub2RlKSB7XHJcbiAgICAgICAgICAgICAgICAgIHRoaXMubW9kZWwubmF2aWdhdGVOb2RlID0gbm9kZTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYUh5cGVybGluay5ocmVmQ29udGVudC5pbmRleE9mKCcjJykgPT09IDApIHtcclxuICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkb2N1bWVudC5hbmNob3JzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYW5jaG9yID0gZG9jdW1lbnQuYW5jaG9yc1tpXTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoYW5jaG9yLm5hbWUgPT09IGFIeXBlcmxpbmsuYW5jaG9yTmFtZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgdGhpcy5oZWxwZXIuc2Nyb2xsVG9BbmNob3IoYUh5cGVybGluay5hbmNob3JOYW1lKTtcclxuICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgdGhpcy5jb250cm9sbGVyLnBvc3QoJ0Jvb2ttYXJrQWN0aW9uJywgbnVsbCwgMCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9OyovXHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuXHJcbiAgICB9XHJcbiAgfVxyXG5cclxufVxyXG4iXX0=