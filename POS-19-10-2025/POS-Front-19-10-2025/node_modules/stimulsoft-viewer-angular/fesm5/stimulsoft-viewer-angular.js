import { __values, __decorate } from 'tslib';
import { Injectable, EventEmitter, ViewChild, Output, Input, Component, NgModule } from '@angular/core';
import { HttpClient } from '@angular/common/http';
import { Subject, throwError } from 'rxjs';
import { timeout, catchError } from 'rxjs/operators';
import { CommonModule } from '@angular/common';
import { trigger, state, style, transition, animate, keyframes } from '@angular/animations';

var ComponentDescription = /** @class */ (function () {
    function ComponentDescription(type, caption, img, action, tooltip, arrow, menuItems, margin, selected) {
        this.type = type;
        this.caption = caption;
        this.img = img;
        this.action = action;
        this.tooltip = tooltip;
        this.arrow = arrow;
        this.menuItems = menuItems;
        this.margin = margin;
        this.selected = selected;
        this.selected = false;
    }
    return ComponentDescription;
}());
var ViewerEvent = /** @class */ (function () {
    function ViewerEvent(name, value, bookmarkPage, bookmarkAnchor, componentGuid) {
        this.name = name;
        this.value = value;
        this.bookmarkPage = bookmarkPage;
        this.bookmarkAnchor = bookmarkAnchor;
        this.componentGuid = componentGuid;
    }
    return ViewerEvent;
}());
var ControlClass = /** @class */ (function () {
    function ControlClass() {
        this.toolbar = new ControlProps();
        this.reportPanel = new ControlProps();
        this.drillDownPanel = new ControlProps();
        this.findPanel = new ControlProps();
        this.resourcesPanel = new ControlProps();
        this.bookmarksPanel = new ControlProps();
        this.navigatePanel = new ControlProps();
        this.parametersPanel = new ControlProps();
        this.dashboardsPanel = new ControlProps();
        this.viewer = new ControlProps();
        this.tooltip = new ControlProps();
        this.aboutPanel = new ControlProps();
    }
    Object.defineProperty(ControlClass.prototype, "head", {
        get: function () {
            return document.getElementsByTagName('head')[0];
        },
        enumerable: true,
        configurable: true
    });
    return ControlClass;
}());
var ControlProps = /** @class */ (function () {
    function ControlProps(pageService, el) {
        this.pageService = pageService;
        this.el = el;
        this._visible = false;
        this.subject = new Subject();
        this.enabled = true;
        this.layout = new Rectangle();
    }
    Object.defineProperty(ControlProps.prototype, "offsetHeight", {
        get: function () {
            var _a;
            return ((_a = this.el) === null || _a === void 0 ? void 0 : _a.nativeElement.offsetHeight) || 0;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ControlProps.prototype, "offsetWidth", {
        get: function () {
            var _a;
            return ((_a = this.el) === null || _a === void 0 ? void 0 : _a.nativeElement.offsetWidth) || 0;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ControlProps.prototype, "visible", {
        get: function () {
            return this._visible;
        },
        set: function (value) {
            var _a;
            this._visible = value;
            this.subject.next(value);
            (_a = this.pageService) === null || _a === void 0 ? void 0 : _a.calculateLayout();
        },
        enumerable: true,
        configurable: true
    });
    ControlProps.prototype.getVisibility = function () {
        return this.subject.asObservable();
    };
    Object.defineProperty(ControlProps.prototype, "exists", {
        get: function () {
            return this.el != null;
        },
        enumerable: true,
        configurable: true
    });
    return ControlProps;
}());
var Rectangle = /** @class */ (function () {
    function Rectangle(width, height, left, bottom, right) {
        if (width === void 0) { width = 0; }
        if (height === void 0) { height = 0; }
        if (left === void 0) { left = 0; }
        if (bottom === void 0) { bottom = 0; }
        if (right === void 0) { right = 0; }
        this.width = width;
        this.height = height;
        this.left = left;
        this.bottom = bottom;
        this.right = right;
        this._top = 0;
    }
    Object.defineProperty(Rectangle.prototype, "top", {
        get: function () {
            return this._top;
        },
        set: function (value) {
            this._top = value;
        },
        enumerable: true,
        configurable: true
    });
    return Rectangle;
}());
var BookmarkNode = /** @class */ (function () {
    function BookmarkNode(name, url, page, compunentGuid, nodes, open, selected) {
        this.name = name;
        this.url = url;
        this.page = page;
        this.compunentGuid = compunentGuid;
        this.nodes = nodes;
        this.open = open;
        this.selected = selected;
    }
    return BookmarkNode;
}());
var InteractionParams = /** @class */ (function () {
    function InteractionParams(action, drillDownParameters, drillDownGuid, dashboardDrillDownGuid, variables, sortingParameters, collapsingParameters) {
        this.action = action;
        this.drillDownParameters = drillDownParameters;
        this.drillDownGuid = drillDownGuid;
        this.dashboardDrillDownGuid = dashboardDrillDownGuid;
        this.variables = variables;
        this.sortingParameters = sortingParameters;
        this.collapsingParameters = collapsingParameters;
    }
    return InteractionParams;
}());
var InteractionObject = /** @class */ (function () {
    function InteractionObject(paramsVariables, countColumns, countInColumn) {
        this.paramsVariables = paramsVariables;
        this.countColumns = countColumns;
        this.countInColumn = countInColumn;
    }
    return InteractionObject;
}());
var Variable = /** @class */ (function () {
    function Variable(name, alias, description, basicType, type, allowUserValues, dateTimeType, items, key, value, keyTo, isChecked, focusOnCreate, visible, binding, isNull) {
        if (isChecked === void 0) { isChecked = true; }
        if (visible === void 0) { visible = true; }
        this.name = name;
        this.alias = alias;
        this.description = description;
        this.basicType = basicType;
        this.type = type;
        this.allowUserValues = allowUserValues;
        this.dateTimeType = dateTimeType;
        this.items = items;
        this.key = key;
        this.value = value;
        this.keyTo = keyTo;
        this.isChecked = isChecked;
        this.focusOnCreate = focusOnCreate;
        this.visible = visible;
        this.binding = binding;
        this.isNull = isNull;
    }
    return Variable;
}());
var DateTimeObject = /** @class */ (function () {
    function DateTimeObject(year, month, day, hours, minutes, seconds) {
        this.year = year;
        this.month = month;
        this.day = day;
        this.hours = hours;
        this.minutes = minutes;
        this.seconds = seconds;
    }
    return DateTimeObject;
}());
var Item = /** @class */ (function () {
    function Item(name, caption, imageName, key, haveSubMenu, imageSizes, selected, type) {
        this.name = name;
        this.caption = caption;
        this.imageName = imageName;
        this.key = key;
        this.haveSubMenu = haveSubMenu;
        this.imageSizes = imageSizes;
        this.selected = selected;
        this.type = type;
    }
    return Item;
}());
var Message = /** @class */ (function () {
    function Message(action, data, subAction) {
        this.action = action;
        this.data = data;
        this.subAction = subAction;
    }
    return Message;
}());
var Form = /** @class */ (function () {
    function Form(name, left, top, isMooving, level, formData) {
        if (isMooving === void 0) { isMooving = false; }
        this.name = name;
        this.left = left;
        this.top = top;
        this.isMooving = isMooving;
        this.level = level;
        this.formData = formData;
    }
    return Form;
}());
var ExportFormSettings = /** @class */ (function () {
    function ExportFormSettings(components, cSettings, openAfterExport, groups, update) {
        this.components = components;
        this.cSettings = cSettings;
        this.openAfterExport = openAfterExport;
        this.groups = groups;
        this.update = update;
    }
    return ExportFormSettings;
}());
var ExportGroup = /** @class */ (function () {
    function ExportGroup(opened) {
        this.opened = opened;
    }
    return ExportGroup;
}());
var ExportComponent = /** @class */ (function () {
    function ExportComponent(name, type, margin, label, tooltip, caption, checked, width, disabled, items, key) {
        this.name = name;
        this.type = type;
        this.margin = margin;
        this.label = label;
        this.tooltip = tooltip;
        this.caption = caption;
        this.checked = checked;
        this.width = width;
        this.disabled = disabled;
        this.items = items;
        this.key = key;
    }
    return ExportComponent;
}());
var DrillDown = /** @class */ (function () {
    function DrillDown(caption, selected, reportParams, visible) {
        if (selected === void 0) { selected = false; }
        this.caption = caption;
        this.selected = selected;
        this.reportParams = reportParams;
        this.visible = visible;
    }
    return DrillDown;
}());
var ErrorMessage = /** @class */ (function () {
    function ErrorMessage(error, type) {
        this.error = error;
        this.type = type;
    }
    return ErrorMessage;
}());
var Resource = /** @class */ (function () {
    function Resource(name, type, alias, id) {
        this.name = name;
        this.type = type;
        this.alias = alias;
        this.id = id;
    }
    return Resource;
}());
var NotificationFormOptions = /** @class */ (function () {
    function NotificationFormOptions(image, message, description, buttonCaption, cancelAction, action) {
        this.image = image;
        this.message = message;
        this.description = description;
        this.buttonCaption = buttonCaption;
        this.cancelAction = cancelAction;
        this.action = action;
    }
    return NotificationFormOptions;
}());

var ModelService = /** @class */ (function () {
    function ModelService() {
        this._reportParams = {};
        this.controls = new ControlClass();
        this.pages = [];
        this.months = [];
        this.dayOfWeek = [];
        this.dateRanges = [];
        this.encodingData = [];
        this.pdfSecurityCertificates = [];
        this.paperSizes = [];
        this.drillDownButtons = [];
        this.showProgress = false;
    }
    Object.defineProperty(ModelService.prototype, "reportParams", {
        get: function () {
            return this._reportParams;
        },
        set: function (parameters) {
            this._reportParams.pagesArray = parameters.pagesArray;
            // Apply new report parameters, if not update current page
            if (parameters.action && parameters.action !== 'GetPages') {
                this.reportParams.type = parameters.reportType;
                this.reportParams.drillDownGuid = parameters.drillDownGuid;
                this.reportParams.dashboardDrillDownGuid = parameters.dashboardDrillDownGuid;
                this.reportParams.pagesCount = parameters.pagesCount;
                if (parameters.pageNumber != null) {
                    this.reportParams.pageNumber = parameters.pageNumber;
                }
                this.reportParams.zoom = parameters.zoom;
                this.reportParams.viewMode = parameters.viewMode;
                this.reportParams.reportFileName = parameters.reportFileName;
                this.reportParams.collapsingStates = parameters.collapsingStates;
                if (parameters.bookmarksContent) {
                    this.reportParams.bookmarksContent = parameters.bookmarksContent;
                }
                if (parameters.resources) {
                    this.reportParams.resources = parameters.resources;
                }
                this.reportParams.isCompilationMode = parameters.isCompilationMode;
                if (parameters.variablesValues) {
                    this.reportParams.variablesValues = parameters.variablesValues;
                }
                if (parameters.parametersDateFormat) {
                    this.options.appearance.parametersPanelDateFormat = parameters.parametersDateFormat;
                }
                if (parameters.tableOfContentsPointers)
                    this.reportParams.tableOfContentsPointers = parameters.tableOfContentsPointers;
                this.reportParams.isEditableReport = parameters.isEditableReport;
                if (parameters.userValues) {
                    this.options.userValues = parameters.userValues;
                }
                this.reportParams.dashboards = parameters.dashboards;
                this.reportParams.previewSettings = parameters.previewSettings;
            }
        },
        enumerable: true,
        configurable: true
    });
    ModelService.prototype.setReportParams = function (parameters) {
        this._reportParams = parameters;
    };
    ModelService.prototype.getReportParams = function () {
        return this.copyObject(this._reportParams);
    };
    ModelService.prototype.copyObject = function (o) {
        if (!o || 'object' !== typeof o) {
            return o;
        }
        var c = 'function' === typeof o.pop ? [] : {};
        var p;
        var v;
        for (p in o) {
            if (o.hasOwnProperty(p) && p !== 'pagesArray') {
                v = o[p];
                if (v && 'object' === typeof v) {
                    c[p] = this.copyObject(v);
                }
                else {
                    c[p] = v;
                }
            }
        }
        return c;
    };
    Object.defineProperty(ModelService.prototype, "options", {
        get: function () {
            return this._options;
        },
        set: function (data) {
            this._options = this.toLower(data.options);
            if (data.jsOptions) {
                for (var key in data.jsOptions) {
                    if (data.jsOptions.hasOwnProperty(key)) {
                        this._options[key] = data.jsOptions[key];
                    }
                }
            }
            this._options.exports.defaultSettings = data.defaultSettings;
            this.localization = data.loc;
            this.months = data.months;
            this.dayOfWeek = data.dayOfWeek;
            this.images = data.images;
            this.dateRanges = data.dateRanges;
            this.paperSizes = data.paperSizes;
            this.encodingData = data.encodingData;
            this.pdfSecurityCertificates = data.pdfSecurityCertificates;
            this.clearViewerState();
            this.setupOptions();
        },
        enumerable: true,
        configurable: true
    });
    ModelService.prototype.loc = function (attr) {
        var _a;
        return _a = this.localization[attr], (_a !== null && _a !== void 0 ? _a : attr);
    };
    ModelService.prototype.img = function (name) {
        var _a;
        if (name != null && name.length > 0 && !this.images[name]) {
            //console.warn(`Image: ${name} not found`);
        }
        return _a = this.images[name], (_a !== null && _a !== void 0 ? _a : '');
    };
    ModelService.prototype.toLower = function (obj) {
        var _this = this;
        var result = {};
        Object.keys(obj).forEach(function (key) {
            result[key.substr(0, 1).toLowerCase() + key.substr(1)] = (typeof (obj[key]) === 'object' && obj[key] !== null) ? _this.toLower(obj[key]) : obj[key];
        });
        return result;
    };
    ModelService.prototype.clear = function () {
        this._options = undefined;
        this._reportParams = {};
        this._imagesForBookmark = undefined;
        this.pages = [];
        this.form = null;
    };
    ModelService.prototype.clearViewerState = function () {
        this.reportParams = {};
        this.reportParams.type = 'Auto';
        this.reportParams.pageNumber = 0;
        this.reportParams.originalPageNumber = 0;
        this.reportParams.drillDownGuid = null;
        this.reportParams.dashboardDrillDownGuid = null;
        this.reportParams.collapsingStates = null;
        this.reportParams.bookmarksContent = null;
        this.reportParams.editableParameters = null;
        this.reportParams.resources = null;
        this.reportParams.drillDownParameters = [];
        this.reportParams.elementName = null;
        this.reportParams.variablesValues = null;
        this.reportParams.tableOfContentsPointers = [];
        this.reportParams.isEditableReport = false;
        this.options.viewerId = this.newToken();
        this.options.clientGuid = this.newToken();
        this.options.paramsVariables = null;
        this.options.multiFilterStates = null;
        this.options.isParametersReceived = false;
        this.options.drillDownInProgress = false;
        // this.controls.mainPanel.style.background = '';
        // this.tableElementGridStates = {};
        // Restore current page number, if reload current report
        if (this.reportParams.prevPageNumber) {
            this.reportParams.pageNumber = this.reportParams.prevPageNumber;
            delete this.reportParams.prevPageNumber;
        }
        this.fullScreenOptions = null;
        this.drillDownButtons = [];
        this.controls.parametersPanel.visible = false;
        this.controls.bookmarksPanel.visible = false;
        this.interactions = null;
        /*
        this.controls.drillDownPanel.visible = false;
        this.controls.findPanel.visible = false;
        this.controls.parametersPanel.visible = false;
        this.controls.resourcesPanel.visible = false;*/
    };
    ModelService.prototype.style = function (value) {
        return value !== '' && value != null ? value : '';
    };
    ModelService.prototype.createPostParameters = function (data, asObject, useOptions) {
        if (asObject === void 0) { asObject = true; }
        if (useOptions === void 0) { useOptions = true; }
        var _a, _b, _c, _d;
        var params;
        // Object params
        var postParams = {
            stiweb_component: 'Viewer',
            stiweb_imagesScalingFactor: this.getImagesScalingFactor()
        };
        if (this.properties) {
            postParams['properties'] = btoa(JSON.stringify(this.properties));
        }
        if (this.options && useOptions) {
            params = {
                viewerId: this.options.viewerId,
                routes: this.options.routes,
                formValues: this.options.formValues,
                clientGuid: this.options.clientGuid,
                drillDownGuid: this.reportParams.drillDownGuid,
                dashboardDrillDownGuid: this.reportParams.dashboardDrillDownGuid,
                cacheMode: this.options.server.cacheMode,
                cacheTimeout: this.options.server.cacheTimeout,
                cacheItemPriority: this.options.server.cacheItemPriority,
                pageNumber: this.reportParams.pageNumber,
                originalPageNumber: this.reportParams.originalPageNumber,
                reportType: this.reportParams.type,
                zoom: (this.reportParams.zoom && this.reportParams.zoom > 0) ? this.reportParams.zoom : (((_b = (_a = this.options) === null || _a === void 0 ? void 0 : _a.toolbar) === null || _b === void 0 ? void 0 : _b.zoom) > 0 ? (_d = (_c = this.options) === null || _c === void 0 ? void 0 : _c.toolbar) === null || _d === void 0 ? void 0 : _d.zoom : 100),
                viewMode: this.reportParams.viewMode || this.options.toolbar.viewMode,
                multiPageWidthCount: this.reportParams.multiPageWidthCount,
                multiPageHeightCount: this.reportParams.multiPageHeightCount,
                multiPageContainerWidth: this.reportParams.multiPageContainerWidth,
                multiPageContainerHeight: this.reportParams.multiPageContainerHeight,
                multiPageMargins: this.reportParams.multiPageMargins,
                showBookmarks: this.options.toolbar.showBookmarksButton,
                openLinksWindow: this.options.appearance.openLinksWindow,
                chartRenderType: this.options.appearance.chartRenderType,
                reportDisplayMode: this.options.appearance.reportDisplayMode,
                drillDownParameters: this.reportParams.drillDownParameters,
                editableParameters: this.reportParams.editableParameters,
                useRelativeUrls: this.options.server.useRelativeUrls,
                passQueryParametersForResources: this.options.server.passQueryParametersForResources,
                passQueryParametersToReport: this.options.server.passQueryParametersToReport,
                version: this.options.shortProductVersion,
                reportDesignerMode: this.options.reportDesignerMode,
                imagesQuality: this.options.appearance.imagesQuality,
                parametersPanelSortDataItems: this.options.appearance.parametersPanelSortDataItems,
                combineReportPages: this.options.appearance.combineReportPages,
                isAngular: true,
                allowAutoUpdateCookies: this.options.server.allowAutoUpdateCookies
            };
            if (this.options.server.useLocalizedCache && this.options.localization) {
                params['useLocalizedCache'] = true;
                params['localization'] = this.options.localization;
            }
            if (this.options.userValues) {
                params['userValues'] = this.options.userValues;
            }
        }
        else {
            params = {};
        }
        if (data) {
            Object.keys(data).forEach(function (key) { return params[key] = data[key]; });
        }
        // Object params
        if (params.action) {
            postParams['stiweb_action'] = params.action;
            delete params.action;
        }
        if (params.base64Data) {
            postParams['stiweb_data'] = params.base64Data;
            delete params.base64Data;
        }
        if (this.options && useOptions) {
            // Params
            var jsonParams = JSON.stringify(params);
            if (this.options.server.useCompression) {
                // postParams['stiweb_packed_parameters'] = StiGZipHelper.pack(jsonParams);
                postParams['stiweb_parameters'] = btoa(jsonParams);
            }
            else {
                postParams['stiweb_parameters'] = btoa(jsonParams);
            }
        }
        if (asObject) {
            return postParams;
        }
    };
    ModelService.prototype.newToken = function () {
        var a = '1234567890abcdefghijklmnopqrstuvwxyz'.split('');
        var b = [];
        var length = 32;
        for (var i = 0; i < length; i++) {
            var j = (Math.random() * (a.length - 1)).toFixed(0);
            b[i] = a[j];
        }
        return b.join('');
    };
    ModelService.prototype.setupOptions = function () {
        var _a, _b, _c, _d, _e, _f;
        if (!this.options.exports.showExportToPowerPoint && !this.options.exports.showExportToPdf && !this.options.exports.showExportToXps &&
            !this.options.exports.showExportToOpenDocumentWriter && !this.options.exports.showExportToOpenDocumentCalc && !this.options.exports.showExportToText &&
            !this.options.exports.showExportToRtf && !this.options.exports.showExportToWord2007 && !this.options.exports.showExportToCsv && !this.options.exports.showExportToJson &&
            !this.options.exports.showExportToDbf && !this.options.exports.showExportToXml && !this.options.exports.showExportToDif && !this.options.exports.showExportToSylk &&
            !this.options.exports.showExportToExcel && !this.options.exports.showExportToExcel2007 && !this.options.exports.showExportToExcelXml && !this.options.exports.showExportToHtml &&
            !this.options.exports.showExportToHtml5 && !this.options.exports.showExportToMht && !this.options.exports.showExportToImageBmp && !this.options.exports.showExportToImageGif &&
            !this.options.exports.showExportToImageJpeg && !this.options.exports.showExportToImageMetafile && !this.options.exports.showExportToImagePcx &&
            !this.options.exports.showExportToImagePng && !this.options.exports.showExportToImageTiff && !this.options.exports.showExportToImageSvg && !this.options.exports.showExportToImageSvgz) {
            if (!this.options.exports.showExportToDocument) {
                this.options.toolbar.showSaveButton = false;
            }
            this.options.toolbar.showSendEmailButton = false;
        }
        // Options
        this.options.isTouchDevice = this.options.appearance.interfaceType === 'Auto'
            ? this.isTouchDevice() && this.isMobileDevice()
            : this.options.appearance.interfaceType === 'Touch';
        this.options.isMobileDevice = this.options.appearance.interfaceType === 'Auto' && !this.options.reportDesignerMode
            ? this.isTouchDevice() && this.isMobileDevice()
            : this.options.appearance.interfaceType === 'Mobile';
        if (this.options.isMobileDevice) {
            this.initializeMobile();
        }
        else {
            this.options.toolbar.showPinToolbarButton = false;
        }
        this.controls.toolbar.visible = this.options.toolbar.visible;
        this.options.menuAnimDuration = 150;
        this.options.formAnimDuration = 200;
        this.options.scrollDuration = 350;
        this.options.menuHideDelay = 250;
        this.options.server.timeoutAutoUpdateCache = 180000;
        this.options.toolbar.backgroundColor = this.getHTMLColor(this.options.toolbar.backgroundColor);
        this.options.toolbar.borderColor = this.getHTMLColor(this.options.toolbar.borderColor);
        this.options.toolbar.fontColor = this.getHTMLColor(this.options.toolbar.fontColor);
        this.options.appearance.pageBorderColor = this.getHTMLColor(this.options.appearance.pageBorderColor);
        this.options.parametersValues = {};
        this.options.parameterRowHeight = this.options.isTouchDevice ? 35 : 30;
        this.options.minParametersCountForMultiColumns = 5;
        // First Day Of Week
        if (this.options.appearance.datePickerFirstDayOfWeek === 'Sunday') {
            this.dayOfWeek.splice(6, 1);
            this.dayOfWeek.splice(0, 0, 'Sunday');
        }
        if (((_b = (_a = this.options) === null || _a === void 0 ? void 0 : _a.toolbar) === null || _b === void 0 ? void 0 : _b.zoom) === -1 || ((_d = (_c = this.options) === null || _c === void 0 ? void 0 : _c.toolbar) === null || _d === void 0 ? void 0 : _d.zoom) === -2) {
            this.reportParams.autoZoom = (_f = (_e = this.options) === null || _e === void 0 ? void 0 : _e.toolbar) === null || _f === void 0 ? void 0 : _f.zoom;
        }
        // Actions
        if (!this.options.actions.getReport) {
            this.options.actions.getReport = this.options.actions.viewerEvent;
        }
        if (!this.options.actions.printReport) {
            this.options.actions.printReport = this.options.actions.viewerEvent;
        }
        if (!this.options.actions.openReport) {
            this.options.actions.openReport = this.options.actions.viewerEvent;
        }
        if (!this.options.actions.exportReport) {
            this.options.actions.exportReport = this.options.actions.viewerEvent;
        }
        if (!this.options.actions.interaction) {
            this.options.actions.interaction = this.options.actions.viewerEvent;
        }
        if (!(window.File && window.FileReader && window.FileList && window.Blob)) {
            this.options.toolbar.showOpenButton = false;
        }
        // Render JsViewer styles into HEAD
        if (this.options.requestResourcesUrl || this.options.appearance.customStylesUrl) {
            var viewerStyles = document.createElement('link');
            viewerStyles.setAttribute('type', 'text/css');
            viewerStyles.setAttribute('rel', 'stylesheet');
            viewerStyles.setAttribute('href', this.options.appearance.customStylesUrl || this.getResourceUrl('styles'));
            this.controls.head.appendChild(viewerStyles);
        }
        this.options.viewerId = (Math.random() * 1000000).toString();
    };
    ModelService.prototype.pagesNavigationIsActive = function () {
        return (this.options.appearance.fullScreenMode || this.options.appearance.scrollbarsMode) && this.reportParams.viewMode === 'Continuous';
    };
    Object.defineProperty(ModelService.prototype, "imagesForBookmark", {
        get: function () {
            var _this = this;
            if (!this._imagesForBookmark) {
                var names = ['root', 'folder', 'folderOpen', 'node', 'empty', 'line', 'join', 'joinBottom', 'plus', 'plusBottom', 'minus', 'minusBottom'];
                var imagesForBookmarks_1 = {};
                names.forEach(function (name) { return imagesForBookmarks_1[name] = _this.images['Bookmarks' + name + '.png']; });
                this._imagesForBookmark = imagesForBookmarks_1;
            }
            return this._imagesForBookmark;
        },
        enumerable: true,
        configurable: true
    });
    ModelService.prototype.isTouchDevice = function () {
        return ('ontouchstart' in document.documentElement);
    };
    ModelService.prototype.isMobileDevice = function () {
        return /iPhone|iPad|iPod|Macintosh|Android|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
    };
    ModelService.prototype.initializeMobile = function () {
        var e_1, _a;
        var isViewPortExist = false;
        var metas = this.controls.head.getElementsByTagName('meta');
        try {
            for (var metas_1 = __values(metas), metas_1_1 = metas_1.next(); !metas_1_1.done; metas_1_1 = metas_1.next()) {
                var meta = metas_1_1.value;
                if (meta.name && meta.name.toLowerCase() === 'viewport') {
                    isViewPortExist = true;
                    break;
                }
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (metas_1_1 && !metas_1_1.done && (_a = metas_1.return)) _a.call(metas_1);
            }
            finally { if (e_1) throw e_1.error; }
        }
        if (!isViewPortExist) {
            var viewPortTag = document.createElement('meta');
            viewPortTag.id = 'viewport';
            viewPortTag.name = 'viewport';
            viewPortTag.content = 'initial-scale=1.0,width=device-width,user-scalable=0';
            this.controls.head.appendChild(viewPortTag);
        }
        this.options.appearance.fullScreenMode = true;
        this.options.appearance.scrollbarsMode = true;
        this.options.appearance.parametersPanelPosition = 'Left';
        this.options.appearance.parametersPanelColumnsCount = 1;
        this.options.toolbar.displayMode = 'Separated';
        this.options.toolbar.viewMode = 'SinglePage';
        this.options.toolbar.showZoomButton = false;
        var defaultZoom = this.options.toolbar.zoom === -2 ? -2 : -1; // PageWidth or PageHeight
        this.options.toolbar.zoom = this.reportParams.zoom = defaultZoom;
        this.options.toolbar.showButtonCaptions = false;
        this.options.toolbar.showOpenButton = false;
        this.options.toolbar.showFindButton = false;
        this.options.toolbar.showEditorButton = false;
        this.options.toolbar.showFullScreenButton = false;
        this.options.toolbar.showAboutButton = false;
        this.options.toolbar.showViewModeButton = false;
    };
    ModelService.prototype.getImagesScalingFactor = function () {
        var wnd = window;
        var devicePixelRatio = window.devicePixelRatio || (wnd.deviceXDPI && wnd.logicalXDPI ? wnd.deviceXDPI / wnd.logicalXDPI : 1);
        if (!devicePixelRatio || devicePixelRatio <= 1) {
            return '1';
        }
        else {
            return devicePixelRatio.toString();
        }
    };
    ModelService.prototype.getHTMLColor = function (color) {
        if (color.indexOf(',') > 0 && color.indexOf('rgb') < 0) {
            return "rgb(" + color + ")";
        }
        return color;
    };
    ModelService.prototype.getResourceUrl = function (resourceParameter) {
        var url = this.getActionRequestUrl(this.options.requestResourcesUrl, this.options.actions.viewerEvent);
        url += url.indexOf('?') > 0 ? '&' : '?';
        url += 'stiweb_component=Viewer&stiweb_action=Resource&stiweb_data=' + resourceParameter + '&stiweb_theme=' + this.options.theme;
        url += '&stiweb_cachemode=' + (this.options.server.useCacheForResources
            ? this.options.server.cacheMode === 'ObjectSession' || this.options.server.cacheMode === 'StringSession'
                ? 'session'
                : 'cache'
            : 'none');
        url += '&stiweb_version=' + this.options.shortProductVersion;
        return url;
    };
    ModelService.prototype.getActionRequestUrl = function (requestUrl, action) {
        if (!action) {
            return requestUrl;
        }
        if (action.indexOf('?') < 0) {
            return requestUrl.replace('{action}', action);
        }
        var query = action.substring(action.indexOf('?') + 1);
        action = action.substring(0, action.indexOf('?'));
        return requestUrl.replace('{action}', action) + (requestUrl.indexOf('?') > 0 ? '&' : '?') + query;
    };
    ModelService = __decorate([
        Injectable()
    ], ModelService);
    return ModelService;
}());

var AnimationService = /** @class */ (function () {
    function AnimationService(model) {
        this.model = model;
    }
    AnimationService.prototype.showAnimationForScroll = function (reportPanel, finishScrollTop, endTime, completeFunction) {
        var _this = this;
        if (!reportPanel) {
            return;
        }
        var currentScrollTop = 0;
        if (this.model.options.appearance.scrollbarsMode) {
            currentScrollTop = reportPanel.scrollTop;
        }
        else {
            currentScrollTop = document.documentElement.scrollTop;
            if (currentScrollTop === 0) {
                currentScrollTop = document.getElementsByTagName('BODY')[0].scrollTop;
            }
        }
        clearTimeout(reportPanel.animationTimer);
        var d = new Date();
        var t = d.getTime();
        var step = Math.round((finishScrollTop - currentScrollTop) / ((Math.abs(endTime - t) + 1) / 30));
        // Last step
        if (Math.abs(step) > Math.abs(finishScrollTop - currentScrollTop)) {
            step = finishScrollTop - currentScrollTop;
        }
        currentScrollTop += step;
        var resultScrollTop;
        if (t < endTime) {
            resultScrollTop = currentScrollTop;
            reportPanel.animationTimer = setTimeout(function () {
                _this.showAnimationForScroll(reportPanel, finishScrollTop, endTime, completeFunction);
            }, 30);
        }
        else {
            resultScrollTop = finishScrollTop;
            if (completeFunction) {
                completeFunction();
            }
        }
        if (this.model.options.appearance.scrollbarsMode) {
            reportPanel.scrollTop = resultScrollTop;
        }
        else {
            window.scrollTo(0, resultScrollTop);
        }
    };
    AnimationService.ctorParameters = function () { return [
        { type: ModelService }
    ]; };
    AnimationService = __decorate([
        Injectable()
    ], AnimationService);
    return AnimationService;
}());

var HelperService = /** @class */ (function () {
    function HelperService(model, animationService) {
        this.model = model;
        this.animationService = animationService;
    }
    HelperService.prototype.val = function (value, def) {
        return value != null && value.trim() !== '' ? value : (def || '');
    };
    HelperService.prototype.findPosY = function (obj, mainClassName, noScroll) {
        var curtop = noScroll ? 0 : this.getScrollYOffset(obj, mainClassName);
        if (obj.offsetParent) {
            while (obj.className !== mainClassName) {
                curtop += obj.offsetTop;
                if (!obj.offsetParent) {
                    break;
                }
                obj = obj.offsetParent;
            }
        }
        else if (obj.y) {
            curtop += obj.y;
        }
        return curtop;
    };
    HelperService.prototype.getScrollYOffset = function (obj, mainClassName) {
        var scrolltop = 0;
        if (obj.parentElement) {
            while (obj.className !== mainClassName) {
                if ('scrollTop' in obj) {
                    scrolltop -= obj.scrollTop;
                }
                if (!obj.parentElement) {
                    break;
                }
                obj = obj.parentElement;
            }
        }
        return scrolltop;
    };
    HelperService.prototype.findPosX = function (obj, mainClassName, noScroll) {
        var curleft = noScroll ? 0 : this.getScrollXOffset(obj, mainClassName);
        if (obj.offsetParent) {
            while (obj.className !== mainClassName) {
                curleft += obj.offsetLeft;
                if (!obj.offsetParent) {
                    break;
                }
                obj = obj.offsetParent;
            }
        }
        else if (obj.x) {
            curleft += obj.x;
        }
        return curleft;
    };
    HelperService.prototype.getScrollXOffset = function (obj, mainClassName) {
        var scrollleft = 0;
        if (obj.parentElement) {
            while (obj.className !== mainClassName) {
                if ('scrollLeft' in obj) {
                    scrollleft -= obj.scrollLeft;
                }
                if (!obj.parentElement) {
                    break;
                }
                obj = obj.parentElement;
            }
        }
        return scrollleft;
    };
    HelperService.prototype.showHelpWindow = function (url) {
        var helpLanguage = 'en';
        switch (this.model.options.cultureName) {
            case 'ru': helpLanguage = 'ru';
            // case 'de': helpLanguage = 'de';
        }
        this.openNewWindow('https://www.stimulsoft.com/' + helpLanguage + '/documentation/online/' + url);
    };
    HelperService.prototype.openNewWindow = function (url, name, specs) {
        return window.open(url, name, specs);
    };
    HelperService.prototype.scrollToAnchor = function (anchorName, componentGuid) {
        var _this = this;
        var aHyperlinks = this.model.controls.reportPanel.el.nativeElement.getElementsByTagName("a");
        var identicalAnchors = [];
        if (anchorName) {
            anchorName = anchorName.replace(/!!#92/g, '\\');
        }
        if (componentGuid) {
            for (var i_1 = 0; i_1 < aHyperlinks.length; i_1++) {
                if (aHyperlinks[i_1].getAttribute('guid') === componentGuid) {
                    identicalAnchors.push(aHyperlinks[i_1]);
                }
            }
        }
        if (identicalAnchors.length === 0) {
            var guidIndex = anchorName.indexOf("#GUID#");
            if (identicalAnchors.length == 0) {
                var aHyperlinks_1 = this.model.controls.reportPanel.el.nativeElement.getElementsByTagName("a");
                for (var i = 0; i < aHyperlinks_1.length; i++) {
                    if (aHyperlinks_1[i].name && ((guidIndex >= 0 && (aHyperlinks_1[i].name.indexOf(anchorName.substring(guidIndex + 6)) >= 0 || anchorName.substring(0, guidIndex) == aHyperlinks_1[i].name)) || aHyperlinks_1[i].name == anchorName))
                        identicalAnchors.push(aHyperlinks_1[i]);
                }
            }
        }
        if (identicalAnchors.length > 0) {
            var anchor_1 = identicalAnchors[0];
            var anchorParent_1 = anchor_1.parentElement || anchor_1;
            var anchorHeight_1 = anchorParent_1.offsetHeight;
            var anchorOffsetTop_1 = anchorParent_1.offsetTop;
            identicalAnchors.forEach(function (identicalAnchor) {
                var nextAnchorParent = identicalAnchor.parentElement || identicalAnchor;
                if (nextAnchorParent.offsetTop > anchorOffsetTop_1) {
                    anchorHeight_1 = Math.max(anchorHeight_1, nextAnchorParent.offsetTop - anchorOffsetTop_1 + nextAnchorParent.offsetHeight);
                }
            });
            var date = new Date();
            var endTime = date.getTime() + this.model.options.scrollDuration;
            var targetTop = this.findPosY(anchor_1, this.model.options.appearance.scrollbarsMode ? 'stiJsViewerReportPanel' : null, true) - anchorParent_1.offsetHeight * 2;
            this.animationService.showAnimationForScroll(this.model.controls.reportPanel.el.nativeElement, targetTop, endTime, function () {
                var _a;
                var page = _this.getPageFromAnchorElement(anchor_1);
                var anchorParentTopPos = _this.findPosY(anchorParent_1, 'stiJsViewerReportPanel', true);
                var pageTopPos = page ? _this.findPosY(page, 'stiJsViewerReportPanel', true) : anchorParentTopPos;
                _this.removeBookmarksLabel();
                var label = document.createElement('div');
                _this.model.controls.bookmarksLabel = label;
                label.className = 'stiJsViewerBookmarksLabel';
                var labelMargin = 20 * (_this.model.reportParams.zoom / 100);
                var labelWidth = page ? page.offsetWidth - labelMargin - 6 : anchorParent_1.offsetWidth;
                var labelHeight = anchorHeight_1 - 2;
                label.style.width = labelWidth + 'px';
                label.style.height = labelHeight + 'px';
                var margins = (_a = page.pageAttributes.margins) === null || _a === void 0 ? void 0 : _a.replace('px', '').split(' ');
                var pageLeftMargin = page.pageAttributes.margins ? _this.strToInt(margins[3]) : 0;
                var pageTopMargin = page.pageAttributes.margins ? _this.strToInt(margins[0]) : 0;
                label.style.marginLeft = (labelMargin / 2 - pageLeftMargin) + 'px';
                label.style.marginTop = (anchorParentTopPos - pageTopPos - pageTopMargin - (_this.model.reportParams.zoom / 100) - 1) + 'px';
                page.insertBefore(label, page.childNodes[0]);
            });
        }
    };
    HelperService.prototype.removeBookmarksLabel = function () {
        if (this.model.controls.bookmarksLabel) {
            this.model.controls.bookmarksLabel.parentElement.removeChild(this.model.controls.bookmarksLabel);
            this.model.controls.bookmarksLabel = null;
        }
    };
    HelperService.prototype.getPageFromAnchorElement = function (anchorElement) {
        var obj = anchorElement;
        while (obj.parentElement) {
            if (obj.className && obj.className.indexOf('stiJsViewerPage') === 0) {
                return obj;
            }
            obj = obj.parentElement;
        }
        return obj;
    };
    HelperService.prototype.strToInt = function (value) {
        var result = parseInt(value, 10);
        return result || 0;
    };
    HelperService.prototype.strToDouble = function (value) {
        if (value === null) {
            return null;
        }
        var result = parseFloat(value.toString().replace(',', '.').trim());
        return result || 0;
    };
    HelperService.prototype.copyObject = function (o) {
        if (!o || 'object' !== typeof o) {
            return o;
        }
        var c = 'function' === typeof o.pop ? [] : {};
        var p;
        var v;
        for (p in o) {
            if (o.hasOwnProperty(p)) {
                v = o[p];
                if (v && 'object' === typeof v) {
                    c[p] = this.copyObject(v);
                }
                else {
                    c[p] = v;
                }
            }
        }
        return c;
    };
    HelperService.prototype.getCountObjects = function (objectArray) {
        var count = 0;
        if (objectArray) {
            for (var singleObject in objectArray) {
                count++;
            }
        }
        return count;
    };
    HelperService.prototype.replaceMonths = function (value) {
        for (var i = 1; i <= 12; i++) {
            var enName = '';
            var locName = '';
            switch (i) {
                case 1:
                    enName = 'January';
                    locName = this.model.loc('MonthJanuary');
                    break;
                case 2:
                    enName = 'February';
                    locName = this.model.loc('MonthFebruary');
                    break;
                case 3:
                    enName = 'March';
                    locName = this.model.loc('MonthMarch');
                    break;
                case 4:
                    enName = 'April';
                    locName = this.model.loc('MonthApril');
                    break;
                case 5:
                    enName = 'May';
                    locName = this.model.loc('MonthMay');
                    break;
                case 6:
                    enName = 'June';
                    locName = this.model.loc('MonthJune');
                    break;
                case 7:
                    enName = 'July';
                    locName = this.model.loc('MonthJuly');
                    break;
                case 8:
                    enName = 'August';
                    locName = this.model.loc('MonthAugust');
                    break;
                case 9:
                    enName = 'September';
                    locName = this.model.loc('MonthSeptember');
                    break;
                case 10:
                    enName = 'October';
                    locName = this.model.loc('MonthOctober');
                    break;
                case 11:
                    enName = 'November';
                    locName = this.model.loc('MonthNovember');
                    break;
                case 12:
                    enName = 'December';
                    locName = this.model.loc('MonthDecember');
                    break;
            }
            var enShortName = enName.substring(0, 3);
            var locShortName = locName.substring(0, 3);
            value = value.replace(enName, i).replace(enName.toLowerCase(), i).replace(enShortName, i).replace(enShortName.toLowerCase(), i);
            value = value.replace(locName, i).replace(locName.toLowerCase(), i).replace(locShortName, i).replace(locShortName.toLowerCase(), i);
        }
        return value;
    };
    HelperService.prototype.getDate = function (dateTimeObj) {
        return new Date(dateTimeObj.year, dateTimeObj.month - 1, dateTimeObj.day, dateTimeObj.hours, dateTimeObj.minutes, dateTimeObj.seconds);
    };
    HelperService.prototype.getDateTimeObject = function (date) {
        if (!date) {
            date = new Date();
        }
        var dateTimeObject = new DateTimeObject();
        dateTimeObject.year = date.getFullYear();
        dateTimeObject.month = date.getMonth() + 1;
        dateTimeObject.day = date.getDate();
        dateTimeObject.hours = date.getHours();
        dateTimeObject.minutes = date.getMinutes();
        dateTimeObject.seconds = date.getSeconds();
        return dateTimeObject;
    };
    HelperService.prototype.getDateTimeFromString = function (value, format) {
        var charIsDigit = function (ch) {
            return ('0123456789'.indexOf(ch) >= 0);
        };
        if (!value) {
            return new Date();
        }
        value = this.replaceMonths(value);
        var dateTime = new Date();
        // If the date format is not specified, then deserializator for getting date and time is applied
        if (format === null) {
            format = 'dd.MM.yyyy hh:mm:ss';
        }
        // Otherwise the format is parsed. Now only numeric date and time formats are supported
        var year = 1970;
        var month = 1;
        var day = 1;
        var hour = 0;
        var minute = 0;
        var second = 0;
        var millisecond = 0;
        var char = '';
        var pos = 0;
        var values = [];
        // Parse date and time into separate numeric values
        while (pos < value.length) {
            char = value.charAt(pos);
            if (charIsDigit(char)) {
                values.push(char);
                pos++;
                while (pos < value.length && charIsDigit(value.charAt(pos))) {
                    values[values.length - 1] += value.charAt(pos);
                    pos++;
                }
                values[values.length - 1] = this.strToInt(values[values.length - 1]);
            }
            pos++;
        }
        pos = 0;
        var charCount = 0;
        var index = -1;
        var is12hour = false;
        // Parsing format and replacement of appropriate values of date and time
        while (pos < format.length) {
            char = format.charAt(pos);
            charCount = 0;
            if (char === 'Y' || char === 'y' || char === 'M' || char === 'd' || char === 'h' || char === 'H' ||
                char === 'm' || char === 's' || char === 'f' || char === 'F' || char === 't' || char === 'z') {
                index++;
                while (pos < format.length && format.charAt(pos) === char) {
                    pos++;
                    charCount++;
                }
            }
            switch (char) {
                case 'Y': // full year
                    year = values[index];
                    break;
                case 'y': // year
                    if (values[index] < 1000) {
                        year = 2000 + values[index];
                    }
                    else {
                        year = values[index];
                    }
                    break;
                case 'M': // month
                    month = values[index];
                    break;
                case 'd': // day
                    day = values[index];
                    break;
                case 'h': // (hour 12)
                    is12hour = true;
                    hour = values[index];
                    break;
                case 'H': // (hour 24)
                    hour = values[index];
                    break;
                case 'm': // minute
                    minute = values[index];
                    break;
                case 's': // second
                    second = values[index];
                    break;
                case 'f': // second fraction
                case 'F': // second fraction, trailing zeroes are trimmed
                    millisecond = values[index];
                    break;
                case 't': // PM or AM
                    if (value.toLowerCase().indexOf('am') >= 0 && hour === 12) {
                        hour = 0;
                    }
                    if (value.toLowerCase().indexOf('pm') >= 0 && hour < 12) {
                        hour += 12;
                    }
                    break;
                default:
                    pos++;
                    break;
            }
        }
        dateTime = new Date(year || new Date().getFullYear(), month - 1 || 0, day || 1, hour || 0, minute || 0, second, millisecond || 0);
        if (!dateTime || isNaN(dateTime)) {
            return new Date();
        }
        return dateTime;
    };
    HelperService.prototype.getStringDateTime = function (object, dateTimeType) {
        if (dateTimeType === 'Date') {
            object.hours = 0;
            object.minutes = 0;
            object.seconds = 0;
        }
        return object.month + '/' + object.day + '/' + object.year + ' ' +
            (object.hours > 12 ? object.hours - 12 : object.hours) + ':' + object.minutes + ':' + object.seconds + ' ' +
            (object.hours < 12 ? 'AM' : 'PM');
    };
    HelperService.prototype.dateTimeObjectToString = function (dateTimeObject, typeDateTimeObject) {
        var date = new Date(dateTimeObject.year, dateTimeObject.month - 1, dateTimeObject.day, dateTimeObject.hours, dateTimeObject.minutes, dateTimeObject.seconds);
        if (this.model.options.appearance.parametersPanelDateFormat !== '') {
            return this.formatDate(date, this.model.options.appearance.parametersPanelDateFormat);
        }
        return this.dateToLocaleString(date, typeDateTimeObject);
    };
    HelperService.prototype.dateToLocaleString = function (date, dateTimeType) {
        var timeString = date.toLocaleTimeString();
        var isAmericanFormat = timeString.toLowerCase().indexOf('am') >= 0 || timeString.toLowerCase().indexOf('pm') >= 0;
        var formatDate = isAmericanFormat ? 'MM/dd/yyyy' : 'dd.MM.yyyy';
        var yyyy = date.getFullYear();
        var yy = yyyy.toString().substring(2);
        var M = date.getMonth() + 1;
        var MM = M < 10 ? '0' + M : M;
        var d = date.getDate();
        var dd = d < 10 ? '0' + d : d;
        formatDate = formatDate.replace(/yyyy/i, yyyy);
        formatDate = formatDate.replace(/yy/i, yy);
        formatDate = formatDate.replace(/MM/i, MM);
        formatDate = formatDate.replace(/M/i, M);
        formatDate = formatDate.replace(/dd/i, dd);
        formatDate = formatDate.replace(/d/i, d);
        var h = date.getHours();
        var tt = '';
        if (isAmericanFormat) {
            tt = h < 12 ? ' AM' : ' PM';
            h = h > 12 ? h - 12 : h;
            if (h === 0) {
                h = 12;
            }
        }
        else {
            h = h < 10 ? '0' + h : h;
        }
        var m = date.getMinutes();
        m = m < 10 ? '0' + m : m;
        var s = date.getSeconds();
        s = s < 10 ? '0' + s : s;
        var formatTime = h + ':' + m + ':' + s + tt;
        if (dateTimeType === 'Time') {
            return formatTime;
        }
        if (dateTimeType === 'Date') {
            return formatDate;
        }
        return formatDate + ' ' + formatTime;
    };
    HelperService.prototype.formatDate = function (formatDate, formatString) {
        var yyyy = formatDate.getFullYear();
        var yy = yyyy.toString().substring(2);
        var m = formatDate.getMonth() + 1;
        var mm = m < 10 ? '0' + m : m;
        var d = formatDate.getDate();
        var dd = d < 10 ? '0' + d : d;
        var h = formatDate.getHours();
        var hh = h < 10 ? '0' + h : h;
        var h12 = h > 12 ? h - 12 : (h > 0 ? h : 12);
        var hh12 = h12 < 10 ? '0' + h12 : h12;
        var n = formatDate.getMinutes();
        var nn = n < 10 ? '0' + n : n;
        var s = formatDate.getSeconds();
        var ss = s < 10 ? '0' + s : s;
        var tt = h < 12 ? 'AM' : 'PM';
        formatString = formatString.replace(/yyyy/gi, yyyy);
        formatString = formatString.replace(/yy/gi, yy);
        formatString = formatString.replace(/Y/, yyyy);
        formatString = formatString.replace(/MM/g, mm);
        formatString = formatString.replace(/M/g, m);
        formatString = formatString.replace(/dd/g, dd);
        formatString = formatString.replace(/d/g, d);
        formatString = formatString.replace(/hh/g, hh12);
        formatString = formatString.replace(/h/g, h12);
        formatString = formatString.replace(/HH/g, hh);
        formatString = formatString.replace(/H/g, h);
        formatString = formatString.replace(/mm/g, nn);
        formatString = formatString.replace(/m/g, n);
        formatString = formatString.replace(/ss/g, ss);
        formatString = formatString.replace(/s/g, s);
        formatString = formatString.replace(/tt/gi, tt);
        formatString = formatString.replace(/t/gi, tt.substr(0, 1));
        return formatString;
    };
    HelperService.prototype.getStringKey = function (key, params) {
        if (key === null) {
            return '';
        }
        return ((params.type === 'DateTime') ? this.dateTimeObjectToString(key, params.dateTimeType) : key);
    };
    HelperService.prototype.stringToTime = function (timeStr) {
        var timeArray = timeStr.split(':');
        var time = { hours: 0, minutes: 0, seconds: 0 };
        time.hours = this.strToInt(timeArray[0]);
        if (timeArray.length > 1) {
            time.minutes = this.strToInt(timeArray[1]);
        }
        if (timeArray.length > 2) {
            time.seconds = this.strToInt(timeArray[2]);
        }
        if (time.hours < 0) {
            time.hours = 0;
        }
        if (time.minutes < 0) {
            time.minutes = 0;
        }
        if (time.seconds < 0) {
            time.seconds = 0;
        }
        if (time.hours > 23) {
            time.hours = 23;
        }
        if (time.minutes > 59) {
            time.minutes = 59;
        }
        if (time.seconds > 59) {
            time.seconds = 59;
        }
        return time;
    };
    HelperService.prototype.newGuid = function () {
        var chars = '0123456789abcdefghijklmnopqrstuvwxyz'.split('');
        var uuid = [];
        var rnd = Math.random;
        var r;
        uuid[8] = uuid[13] = uuid[18] = uuid[23] = '-';
        uuid[14] = '4';
        for (var i = 0; i < 36; i++) {
            if (!uuid[i]) {
                r = 0 | rnd() * 16;
                uuid[i] = chars[(i === 19) ? (r & 0x3) | 0x8 : r & 0xf];
            }
        }
        return uuid.join('');
    };
    HelperService.prototype.getCountDaysOfMonth = function (year, month) {
        var countDaysInMonth = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
        var count = countDaysInMonth[month];
        if (month === 1) {
            if (year % 4 === 0 && (year % 100 !== 0 || year % 400 === 0)) {
                count = 29;
            }
            else {
                count = 28;
            }
        }
        return count;
    };
    HelperService.prototype.setObjectToCenter = function (object, defaultTop) {
        var leftPos = (this.model.viewerSize.width / 2 - object.offsetWidth / 2);
        var topPos = this.model.options.appearance.fullScreenMode ? (this.model.viewerSize.height / 2 - object.offsetHeight / 2) : (defaultTop ? defaultTop : 250);
        return { left: Math.max(leftPos, 0), top: Math.max(topPos, 0) };
    };
    HelperService.prototype.checkCloudAuthorization = function (action) {
        return true;
    };
    HelperService.prototype.getCookie_ = function (name) {
        var cookie = ' ' + document.cookie;
        var search = ' ' + name + '=';
        var setStr = null;
        var offset = 0;
        var end = 0;
        if (cookie.length > 0) {
            offset = cookie.indexOf(search);
            if (offset !== -1) {
                offset += search.length;
                end = cookie.indexOf(';', offset);
                if (end === -1) {
                    end = cookie.length;
                }
                setStr = unescape(cookie.substring(offset, end));
            }
        }
        return setStr;
    };
    HelperService.prototype.getCookie = function (name) {
        if (this.model.options.standaloneJsMode || typeof localStorage === 'undefined' || name.indexOf('sti_') == 0 || name.indexOf('login') == 0) {
            return this.getCookie_(name);
        }
        var value = localStorage.getItem(name);
        if (value != null) {
            return value;
        }
        else {
            value = this.getCookie_(name);
            if (value != null) {
                this.removeCookie(name);
                localStorage.setItem(name, value);
            }
            return value;
        }
    };
    HelperService.prototype.removeCookie = function (name) {
        document.cookie = name + '=;expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/';
    };
    HelperService.prototype.setCookie = function (name, value, path, domain, secure, expires) {
        if (this.model.options.standaloneJsMode || typeof localStorage === 'undefined' || name.indexOf('sti_') === 0 || name.indexOf('login') === 0) {
            // save to cookies
            if (value && typeof (value) === 'string' && value.length >= 4096) {
                return;
            }
            var pathName = location.pathname;
            var expDate = new Date();
            expDate.setTime(expDate.getTime() + (365 * 24 * 3600 * 1000));
            document.cookie = name + '=' + escape(value) +
                '; expires=' + (expires || expDate['toGMTString']()) +
                ((path) ? '; path=' + path : '; path=/') +
                ((domain) ? '; domain=' + domain : '') +
                ((secure) ? '; secure' : '');
        }
        else {
            // save to localstorage
            localStorage.setItem(name, value);
        }
    };
    HelperService.prototype.getNavigatorName = function () {
        if (!navigator) {
            return 'Unknown';
        }
        var userAgent = navigator.userAgent;
        if (userAgent.indexOf('Edge') >= 0) {
            return 'Edge';
        }
        if (userAgent.indexOf('MSIE') >= 0 || userAgent.indexOf('Trident') >= 0) {
            return 'MSIE';
        }
        if (userAgent.indexOf('Gecko') >= 0) {
            if (userAgent.indexOf('Chrome') >= 0) {
                return 'Chrome';
            }
            if (userAgent.indexOf('Safari') >= 0) {
                return 'Safari';
            }
            return 'Mozilla';
        }
        if (userAgent.indexOf('Opera') >= 0) {
            return 'Opera';
        }
    };
    HelperService.prototype.isTouchDevice = function () {
        return ('ontouchstart' in document.documentElement);
    };
    HelperService.prototype.isMobileDevice = function () {
        return /iPhone|iPad|iPod|Macintosh|Android|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
    };
    HelperService.prototype.getHumanFileSize = function (value, decimals) {
        var i = Math.floor(Math.log(value) / Math.log(1024));
        return ((value / Math.pow(1024, i)).toFixed(decimals)) + ' ' + ['B', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'][i];
    };
    HelperService.prototype.getZoomMenuItems = function () {
        var items = [{ name: 'Zoom25', caption: '25%', img: '' },
            { name: 'Zoom50', caption: '50%', img: '' },
            { name: 'Zoom75', caption: '75%', img: '' },
            { name: 'Zoom100', caption: '100%', img: '' },
            { name: 'Zoom150', caption: '150%', img: '' },
            { name: 'Zoom200', caption: '200%', img: '' }];
        if (this.model.options.toolbar.displayMode !== 'Separated') {
            items.push({ type: 'separator' });
            items.push({ name: 'ZoomOnePage', caption: this.model.loc('ZoomOnePage'), img: 'ZoomOnePage.png' });
            items.push({ name: 'ZoomPageWidth', caption: this.model.loc('ZoomPageWidth'), img: 'ZoomPageWidth.png' });
        }
        return items;
    };
    Object.defineProperty(HelperService.prototype, "helpLinks", {
        get: function () {
            return {
                Print: 'user-manual/index.html?viewer_reports.htm#toolbar',
                Save: 'user-manual/index.html?viewer_reports.htm#toolbar',
                SendEmail: 'user-manual/index.html?viewer_reports.htm#toolbar',
                Bookmarks: 'user-manual/index.html?viewer_reports.htm#toolbar',
                Parameters: 'user-manual/index.html?viewer_reports.htm#toolbar',
                FirstPage: 'user-manual/index.html?viewer_reports.htm#statusbar',
                PrevPage: 'user-manual/index.html?viewer_reports.htm#statusbar',
                NextPage: 'user-manual/index.html?viewer_reports.htm#statusbar',
                LastPage: 'user-manual/index.html?viewer_reports.htm#statusbar',
                FullScreen: 'user-manual/index.html?viewer_reports.htm#toolbar',
                Zoom: 'user-manual/index.html?viewer_reports.htm#statusbar',
                ViewMode: 'user-manual/index.html?viewer_reports.htm#displayingmode',
                Editor: 'user-manual/index.html?viewer_reports.htm#toolbar',
                Find: 'user-manual/index.html?viewer_reports.htm#searchpanel',
                DashboardToolbar: 'user-manual/index.html?viewer_dashboards.htm#controlbuttonsofthedashboard',
                DashboardElementToolbar: 'user-manual/index.html?viewer_dashboards.htm#elementcontrols',
                DashboardExport: 'user-manual/index.html?exports_dashboards.htm',
                DashboardPdfExport: 'user-manual/index.html?exports_dashboards.htm#pdfexportsettings',
                DashboardExcelExport: 'user-manual/index.html?exports_dashboards.htm#excelexportsettings',
                DashboardImageExport: 'user-manual/index.html?exports_dashboards.htm#imageexportsettings',
                DashboardDataExport: 'user-manual/index.html?exports_dashboards.htm#exportsettingsofdata'
            };
        },
        enumerable: true,
        configurable: true
    });
    HelperService.prototype.getBackText = function (withoutBrackets) {
        var backText = String.fromCharCode(84) + 'r' + String.fromCharCode(105) + 'a';
        if (withoutBrackets) {
            return backText + String.fromCharCode(108);
        }
        return String.fromCharCode(91) + backText + String.fromCharCode(108) + String.fromCharCode(93);
    };
    HelperService.ctorParameters = function () { return [
        { type: ModelService },
        { type: AnimationService }
    ]; };
    HelperService = __decorate([
        Injectable()
    ], HelperService);
    return HelperService;
}());

var StiHttpClientService = /** @class */ (function () {
    function StiHttpClientService(httpClient, model, helper) {
        this.httpClient = httpClient;
        this.model = model;
        this.helper = helper;
    }
    StiHttpClientService.prototype.post = function (url, data, responseType) {
        var _this = this;
        if (responseType === void 0) { responseType = 'json'; }
        var _a, _b, _c, _d;
        var model = this.model;
        model.showProgress = true;
        var reqTimeout = ((_b = (_a = this.model.options) === null || _a === void 0 ? void 0 : _a.server) === null || _b === void 0 ? void 0 : _b.requestTimeout) > 0 ? ((_d = (_c = this.model.options) === null || _c === void 0 ? void 0 : _c.server) === null || _d === void 0 ? void 0 : _d.requestTimeout) * 1000 : 1000 * 1000;
        if (responseType === 'json') {
            return this.httpClient.post(url, this.getFormData(data)).pipe(
            // retry(3),
            timeout(reqTimeout), catchError(function (error) {
                model.httpError = error;
                model.showProgress = false;
                _this.model.controls.navigatePanel.enabled = true;
                _this.model.controls.toolbar.enabled = true;
                return throwError('Something bad happened; please try again later.');
            }));
        }
        else {
            return this.httpClient.post(url, this.getFormData(data), { responseType: 'text' }).pipe(
            // retry(3),
            timeout(reqTimeout), catchError(function (error) {
                model.httpError = error;
                model.showProgress = false;
                _this.model.controls.navigatePanel.enabled = true;
                _this.model.controls.toolbar.enabled = true;
                return throwError('Something bad happened; please try again later.');
            }));
        }
    };
    StiHttpClientService.prototype.getFormData = function (data) {
        var formData = new FormData();
        Object.keys(data).forEach(function (key) { return formData.append(key, data[key]); });
        return formData;
    };
    StiHttpClientService.prototype.postForm = function (url, data, doc, postOnlyData) {
        var _this = this;
        if (postOnlyData === void 0) { postOnlyData = false; }
        if (!doc) {
            doc = document;
        }
        var form = doc.createElement('FORM');
        form.setAttribute('method', 'POST');
        form.setAttribute('action', url);
        var params = postOnlyData ? data : this.model.createPostParameters(data, true);
        Object.keys(params).forEach(function (key) {
            var paramsField = doc.createElement('INPUT');
            paramsField.setAttribute('type', 'hidden');
            paramsField.setAttribute('name', key);
            paramsField.setAttribute('value', params[key]);
            form.appendChild(paramsField);
        });
        if (this.model.options.jsDesigner) {
            this.model.options.jsDesigner.options.ignoreBeforeUnload = true;
        }
        doc.body.appendChild(form);
        form.submit();
        doc.body.removeChild(form);
        setTimeout(function () {
            if (_this.model.options.jsDesigner) {
                _this.model.options.jsDesigner.options.ignoreBeforeUnload = false;
            }
        }, 500);
    };
    StiHttpClientService.ctorParameters = function () { return [
        { type: HttpClient },
        { type: ModelService },
        { type: HelperService }
    ]; };
    StiHttpClientService = __decorate([
        Injectable()
    ], StiHttpClientService);
    return StiHttpClientService;
}());

var StylesService = /** @class */ (function () {
    function StylesService(model) {
        this.model = model;
        this.pagesCss = {};
    }
    StylesService.prototype.setupStyle = function (style, id) {
        var _a;
        if (this.pagesCss[id] == null) {
            this.pagesCss[id] = document.createElement('STYLE');
            this.pagesCss[id].id = ((_a = this.model.options) === null || _a === void 0 ? void 0 : _a.viewerId) + 'Styles';
            this.pagesCss[id].setAttribute('type', 'text/css');
            this.model.controls.head.appendChild(this.pagesCss[id]);
        }
        if (this.pagesCss[id].styleSheet) {
            this.pagesCss[id].styleSheet.cssText = style;
        }
        else {
            this.pagesCss[id].innerHTML = style;
        }
    };
    StylesService.prototype.addCustomFontStyles = function (customFonts) {
        if (!customFonts) {
            return;
        }
        var existsStyles = [];
        try {
            existsStyles = document.getElementsByTagName('head')[0].getElementsByTagName('style');
        }
        catch (e) { }
        customFonts.forEach(function (customFont) {
            var e_1, _a;
            if (customFont.contentForCss && customFont.originalFontFamily) {
                var style = document.createElement('style');
                style.innerHTML = "@font-face {\r\nfont-family: '" + customFont.originalFontFamily + "';\r\n src: url(" + customFont.contentForCss + ");\r\n }";
                var existsThisStyle = false;
                try {
                    for (var existsStyles_1 = __values(existsStyles), existsStyles_1_1 = existsStyles_1.next(); !existsStyles_1_1.done; existsStyles_1_1 = existsStyles_1.next()) {
                        var estyle = existsStyles_1_1.value;
                        if (estyle.innerHTML.indexOf("font-family: '" + customFont.originalFontFamily + "'") > 0) {
                            existsThisStyle = true;
                            break;
                        }
                    }
                }
                catch (e_1_1) { e_1 = { error: e_1_1 }; }
                finally {
                    try {
                        if (existsStyles_1_1 && !existsStyles_1_1.done && (_a = existsStyles_1.return)) _a.call(existsStyles_1);
                    }
                    finally { if (e_1) throw e_1.error; }
                }
                if (!existsThisStyle) {
                    document.getElementsByTagName('head')[0].appendChild(style);
                }
            }
        });
    };
    StylesService.prototype.addChartScript = function (script) {
        var currChartScripts = document.getElementById(this.model.options.viewerId + 'chartScriptJsViewer');
        if (currChartScripts) {
            this.model.controls.head.removeChild(currChartScripts);
        }
        if (script) {
            var chartScripts = document.createElement('Script');
            chartScripts.setAttribute('type', 'text/javascript');
            chartScripts.id = this.model.options.viewerId + 'chartScriptJsViewer';
            chartScripts.textContent = script;
            this.model.controls.head.appendChild(chartScripts);
        }
    };
    StylesService.ctorParameters = function () { return [
        { type: ModelService }
    ]; };
    StylesService = __decorate([
        Injectable()
    ], StylesService);
    return StylesService;
}());

var PageService = /** @class */ (function () {
    function PageService(model, helper) {
        var _this = this;
        this.model = model;
        this.helper = helper;
        Object.keys(model.controls).forEach(function (k) { return model.controls[k].pageService = _this; });
    }
    PageService.prototype.calculateLayout = function () {
        var _this = this;
        setTimeout(function () {
            _this.calculateLayoutInner();
        });
    };
    PageService.prototype.calculateLayoutInner = function () {
        var _a;
        var reportLayout = new Rectangle();
        var paramsLayout = new Rectangle();
        if (!this.model.controls.reportPanel.el) {
            return reportLayout;
        }
        if (this.model.controls.dashboardsPanel.el) {
            reportLayout.top += this.model.controls.dashboardsPanel.offsetHeight;
        }
        if (this.model.reportParams.type === 'Report') {
            if (this.model.controls.toolbar && this.model.controls.toolbar.visible && !(this.model.options.isMobileDevice && this.model.options.toolbar.autoHide)) {
                reportLayout.top += this.model.controls.toolbar.offsetHeight;
            }
            if (this.model.controls.drillDownPanel && this.model.controls.drillDownPanel.visible) {
                reportLayout.top += this.model.controls.drillDownPanel.offsetHeight;
            }
            if (this.model.controls.findPanel && this.model.controls.findPanel.visible) {
                reportLayout.top += this.model.controls.findPanel.offsetHeight;
            }
            if (this.model.controls.resourcesPanel && this.model.controls.resourcesPanel.visible) {
                reportLayout.top += this.model.controls.resourcesPanel.offsetHeight;
            }
            if (this.model.controls.bookmarksPanel && this.model.controls.bookmarksPanel.visible) {
                reportLayout.left += this.model.options.appearance.bookmarksTreeWidth;
                if (this.model.options.toolbar.displayMode === 'Simple') {
                    reportLayout.left += 2;
                }
            }
            if (this.model.controls.navigatePanel && this.model.controls.navigatePanel.visible && !(this.model.options.isMobileDevice && this.model.options.toolbar.autoHide)) {
                reportLayout.bottom = this.model.controls.navigatePanel.offsetHeight;
            }
        }
        if (this.model.controls.parametersPanel && this.model.controls.parametersPanel.visible) {
            this.model.controls.parametersPanel.layout = paramsLayout;
            paramsLayout.top = reportLayout.top;
            if (this.model.options.appearance.parametersPanelPosition === 'Left') {
                paramsLayout.left = reportLayout.left;
                paramsLayout.width = this.model.controls.parametersPanel.el.nativeElement.firstChild.offsetWidth;
                reportLayout.left += paramsLayout.width;
                if (this.model.options.toolbar.displayMode === 'Simple') {
                    reportLayout.left += 2;
                }
            }
            if (this.model.options.appearance.parametersPanelPosition === 'Top') {
                paramsLayout.height = this.model.controls.parametersPanel.offsetHeight;
                reportLayout.top += paramsLayout.height;
            }
        }
        if (this.model.controls.bookmarksPanel) {
            // this.model.controls.bookmarksPanel.layout = new Rectangle();
            var styleTop = this.model.options.toolbar.visible ? this.model.controls.toolbar.offsetHeight : 0;
            if (this.model.options.isMobileDevice && this.model.options.toolbar.autoHide) {
                styleTop = 0;
            }
            styleTop += this.model.controls.parametersPanel.exists && this.model.options.appearance.parametersPanelPosition === 'Top' ? this.model.controls.parametersPanel.offsetHeight : 0;
            styleTop += this.model.controls.findPanel.exists ? this.model.controls.findPanel.offsetHeight : 0;
            styleTop += this.model.controls.drillDownPanel.exists ? this.model.controls.drillDownPanel.offsetHeight : 0;
            styleTop += this.model.controls.resourcesPanel.exists ? this.model.controls.resourcesPanel.offsetHeight : 0;
            this.model.controls.bookmarksPanel.layout.top = styleTop; // reportLayout.top;
        }
        if (this.model.options.toolbar.displayMode === 'Simple' && reportLayout.top > 0) {
            reportLayout.top += 2;
        }
        if (((_a = this.model.controls.reportPanel.el) === null || _a === void 0 ? void 0 : _a.nativeElement.style.position) === 'relative') {
            reportLayout.top = paramsLayout.height;
        }
        var reportMargins = {
            top: parseInt(this.model.controls.reportPanel.el.nativeElement.style.marginTop ? this.model.controls.reportPanel.el.nativeElement.style.marginTop : 0),
            right: parseInt(this.model.controls.reportPanel.el.nativeElement.style.marginRight ? this.model.controls.reportPanel.el.nativeElement.style.marginRight : 0),
            bottom: parseInt(this.model.controls.reportPanel.el.nativeElement.style.marginBottom ? this.model.controls.reportPanel.el.nativeElement.style.marginBottom : 0),
            left: parseInt(this.model.controls.reportPanel.el.nativeElement.style.marginLeft ? this.model.controls.reportPanel.el.nativeElement.style.marginLeft : 0)
        };
        reportLayout.width = this.model.controls.reportPanel.offsetWidth - reportLayout.left - reportLayout.right + reportMargins.left + reportMargins.right;
        reportLayout.height = this.model.controls.reportPanel.el.nativeElement.style.position === 'absolute'
            ? this.model.controls.reportPanel.offsetHeight - reportLayout.top - reportLayout.bottom + reportMargins.top + reportMargins.bottom
            : Math.round(reportLayout.width * 0.56); // use 16:9 aspect ratio for automatic height
        this.model.controls.reportPanel.layout = reportLayout;
    };
    PageService.prototype.getZoomByPageWidth = function () {
        var _a, _b;
        var pageNumber = this.model.reportParams.viewMode === 'SinglePage' ? 0 : (this.model.reportParams.pageNumber || 0);
        return (this.model.controls.reportPanel.layout.width - 40) * this.getZoom() / (((_b = (_a = this.model.pages[pageNumber]) === null || _a === void 0 ? void 0 : _a.page) === null || _b === void 0 ? void 0 : _b.offsetWidth) || 1);
    };
    PageService.prototype.getZoomByPageHeight = function () {
        var _a, _b;
        var pageNumber = this.model.reportParams.viewMode === 'SinglePage' ? 0 : (this.model.reportParams.pageNumber || 0);
        return (this.model.controls.reportPanel.layout.height - 40) * this.getZoom() / (((_b = (_a = this.model.pages[pageNumber]) === null || _a === void 0 ? void 0 : _a.page) === null || _b === void 0 ? void 0 : _b.offsetHeight) || 1);
    };
    PageService.prototype.getZoom = function () {
        return this.model.reportParams.zoom < 0 ? 100 : this.model.reportParams.zoom;
    };
    PageService.ctorParameters = function () { return [
        { type: ModelService },
        { type: HelperService }
    ]; };
    PageService = __decorate([
        Injectable()
    ], PageService);
    return PageService;
}());

var MouseService = /** @class */ (function () {
    function MouseService() {
        var _this = this;
        this.documetMouseDown = new Subject();
        this.documetMouseMove = new Subject();
        this.documetMouseUp = new Subject();
        document.addEventListener('mouseup', function (event) {
            _this.documetMouseUp.next(event);
        });
        document.addEventListener('mousemove', function (event) {
            _this.documetMouseMove.next(event);
        });
        document.addEventListener('mousedown', function (event) {
            _this.documetMouseDown.next(event);
        });
    }
    MouseService.prototype.getDocumentMouseUp = function () {
        return this.documetMouseUp.asObservable();
    };
    MouseService.prototype.getDocumentMouseMove = function () {
        return this.documetMouseMove.asObservable();
    };
    MouseService.prototype.getDocumentMouseDown = function () {
        return this.documetMouseDown.asObservable();
    };
    MouseService = __decorate([
        Injectable()
    ], MouseService);
    return MouseService;
}());

var Menu = /** @class */ (function () {
    function Menu(name, items, parent, type, state, menuEl, top, left, innerContent, width, height, menuStyleName, params, verticalItems, action, itemStyleName, value, sizeStyle) {
        this.name = name;
        this.items = items;
        this.parent = parent;
        this.type = type;
        this.state = state;
        this.menuEl = menuEl;
        this.top = top;
        this.left = left;
        this.innerContent = innerContent;
        this.width = width;
        this.height = height;
        this.menuStyleName = menuStyleName;
        this.params = params;
        this.verticalItems = verticalItems;
        this.action = action;
        this.itemStyleName = itemStyleName;
        this.value = value;
        this.sizeStyle = sizeStyle;
    }
    return Menu;
}());
var MenuService = /** @class */ (function () {
    function MenuService(helper, model, mouseService) {
        var _this = this;
        this.helper = helper;
        this.model = model;
        this.mouseService = mouseService;
        this.VERTICAL_MENU_NAME = 'verticalMenu';
        this.menuMouseUp = '';
        this._menus = {};
        this.subject = new Subject();
        this.mouseService.getDocumentMouseUp().subscribe(function (event) {
            if (_this.menuMouseUp === '') {
                _this.closeAllMenus();
            }
            else if (_this.menuMouseUp !== 'datePickerMenu' && _this.menuMouseUp !== _this.VERTICAL_MENU_NAME) {
                var datePicker = Object.values(_this._menus).find(function (m) { return m.type === 'datePickerMenu'; });
                if (datePicker != null) {
                    datePicker.state = 'initialDown';
                }
            }
            _this.menuMouseUp = '';
        });
    }
    MenuService.prototype.getVisibility = function () {
        return this.subject.asObservable();
    };
    MenuService.prototype.addMenu = function (menu) {
        this._menus[menu.name] = menu;
    };
    MenuService.prototype.closeAllMenus = function () {
        var _this = this;
        Object.values(this._menus).forEach(function (m) { return m.state = m.type === 'buttonMenu' && _this.model.options.isMobileDevice ? 'initialLeft' : 'initialDown'; });
    };
    MenuService.prototype.isMenuVisible = function () {
        return Object.values(this._menus).find(function (m) { return m.state === 'expanded'; }) != null;
    };
    MenuService.prototype.showMenu = function (menuName) {
        var _this = this;
        var _a, _b;
        var menu = this._menus[menuName];
        if (((_a = menu) === null || _a === void 0 ? void 0 : _a.type) !== 'datePickerMenu' && ((_b = menu) === null || _b === void 0 ? void 0 : _b.type) !== this.VERTICAL_MENU_NAME) {
            this.closeAllMenus();
        }
        if (menu) {
            menu.sizeStyle = 'opacity: 0;';
            if (this.model.options.isMobileDevice && menu.type === 'buttonMenu') {
                setTimeout(function () {
                    var innerContent = menu.innerContent.nativeElement;
                    menu.left = 0;
                    menu.top = 0;
                    menu.width = innerContent.offsetWidth;
                    menu.height = innerContent.offsetHeight;
                    menu.state = 'initialLeft';
                    menu.sizeStyle = null;
                    setTimeout(function () {
                        menu.state = 'expanded';
                    });
                });
            }
            else {
                setTimeout(function () {
                    menu.sizeStyle = null;
                    _this.showMenuInternal(menu);
                });
            }
            this.subject.next(menu);
        }
    };
    MenuService.prototype.showMenuInternal = function (menu) {
        var isVertMenu = true;
        var parentButton = menu.parent.nativeElement;
        var innerContent = menu.innerContent.nativeElement;
        var offsetHeight = menu.menuEl.nativeElement.offsetHeight;
        var style = menu.menuEl.nativeElement.style;
        var coords = this.getMenuCoordinates(parentButton, innerContent, offsetHeight, style, isVertMenu);
        menu.left = coords.left;
        menu.top = coords.top;
        menu.width = menu.width || coords.width;
        menu.height = coords.height;
        menu.state = coords.state;
        setTimeout(function () {
            menu.state = 'expanded';
        });
    };
    MenuService.prototype.getMenuCoordinates = function (parentButton, innerContent, offsetHeight, style, isVertMenu) {
        var menu = {};
        var browserWidth = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;
        var browserHeight = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight;
        var rightAlign = false;
        var mainClassName = 'stiJsViewerMainPanel';
        var animDirect = 'Down';
        var leftOffset = 0;
        var left = (isVertMenu)
            ? (this.model.options.appearance.rightToLeft || rightAlign
                ? (this.helper.findPosX(parentButton, mainClassName) - innerContent.offsetWidth + parentButton.offsetWidth) - (leftOffset || 0)
                : this.helper.findPosX(parentButton, mainClassName) - (leftOffset || 0))
            : ((animDirect === 'Right')
                ? (this.helper.findPosX(parentButton, mainClassName) + parentButton.offsetWidth + 2)
                : (this.helper.findPosX(parentButton, mainClassName) - parentButton.offsetWidth - 2));
        if (left + innerContent.offsetWidth > browserWidth) {
            left = browserWidth - innerContent.offsetWidth - 15;
        }
        if (left < 0) {
            left = 10;
        }
        menu.left = left;
        if (animDirect === 'Down' &&
            this.helper.findPosY(parentButton) + parentButton.offsetHeight + innerContent.offsetHeight > browserHeight &&
            this.helper.findPosY(parentButton) - innerContent.offsetHeight > 0) {
            animDirect = 'Up';
        }
        menu.top = (isVertMenu)
            ? ((animDirect === 'Down')
                ? (this.helper.findPosY(parentButton, mainClassName) + parentButton.offsetHeight + 2)
                : (this.helper.findPosY(parentButton, mainClassName) - offsetHeight))
            : (this.helper.findPosY(parentButton, mainClassName) + parentButton.offsetHeight + innerContent.offsetHeight > browserHeight &&
                (browserHeight - innerContent.offsetHeight - 10) > 0)
                ? (browserHeight - innerContent.offsetHeight - 10)
                : this.helper.findPosY(parentButton, mainClassName);
        menu.width = innerContent.offsetWidth;
        menu.height = innerContent.offsetHeight;
        if (menu.top + innerContent.offsetHeight > browserHeight) {
            menu.top = (browserHeight - innerContent.offsetHeight - 10);
        }
        if (menu.top < 0) {
            menu.top = 10;
        }
        menu.state = animDirect === 'Down' ? 'initialDown' : 'initialUp';
        return menu;
    };
    Object.defineProperty(MenuService.prototype, "menus", {
        get: function () {
            return Object.values(this._menus);
        },
        enumerable: true,
        configurable: true
    });
    MenuService.prototype.getVerticalMenu = function () {
        return this._menus[this.VERTICAL_MENU_NAME];
    };
    MenuService.prototype.getMenu = function (name) {
        return this._menus[name];
    };
    MenuService.ctorParameters = function () { return [
        { type: HelperService },
        { type: ModelService },
        { type: MouseService }
    ]; };
    MenuService = __decorate([
        Injectable()
    ], MenuService);
    return MenuService;
}());

var FormService = /** @class */ (function () {
    function FormService(mouseService, menuService, helper, model) {
        var _this = this;
        this.mouseService = mouseService;
        this.menuService = menuService;
        this.helper = helper;
        this.model = model;
        this.mouseX = 0;
        this.mouseY = 0;
        this.formX = 0;
        this.formY = 0;
        mouseService.getDocumentMouseMove().subscribe(function (event) {
            _this.move(event);
        });
        mouseService.getDocumentMouseUp().subscribe(function (event) {
            _this.stopMove();
        });
    }
    Object.defineProperty(FormService.prototype, "form", {
        get: function () {
            return this.model.form;
        },
        set: function (form) {
            this.model.form = form;
        },
        enumerable: true,
        configurable: true
    });
    FormService.prototype.showForm = function (name, formData) {
        this.form = { name: name, left: 0, top: 0, isMooving: false, formData: formData };
    };
    FormService.prototype.closeForm = function (name) {
        var _a, _b;
        if (((_a = this.form) === null || _a === void 0 ? void 0 : _a.name) === 'notificationForm' && ((_b = this.model.notificationFormOptions) === null || _b === void 0 ? void 0 : _b.action)) {
            this.model.notificationFormOptions.action();
        }
        this.form = null;
    };
    FormService.prototype.centerForm = function (baseForm, defaultTop) {
        var _this = this;
        if (this.form != null) {
            setTimeout(function () {
                var position = _this.helper.setObjectToCenter(baseForm.element.nativeElement, defaultTop);
                _this.form.left = position.left;
                _this.form.top = position.top;
                _this.form.level = baseForm.level;
            });
        }
    };
    FormService.prototype.startMove = function (name, event, touchEvent) {
        var _a, _b;
        if (event || touchEvent && touchEvent.changedTouches.length > 0) {
            this.formX = this.form.left;
            this.formY = this.form.top;
            this.mouseX = ((_a = event) === null || _a === void 0 ? void 0 : _a.screenX) || touchEvent.changedTouches[0].screenX;
            this.mouseY = ((_b = event) === null || _b === void 0 ? void 0 : _b.screenY) || touchEvent.changedTouches[0].screenY;
            this.form.isMooving = true;
        }
    };
    FormService.prototype.move = function (event) {
        var _a;
        if ((_a = this.form) === null || _a === void 0 ? void 0 : _a.isMooving) {
            var screenX_1 = event.screenX || (event.changedTouches.length > 0 ? event.changedTouches[0].screenX : -1);
            var screenY_1 = event.screenY || (event.changedTouches.length > 0 ? event.changedTouches[0].screenY : -1);
            this.form.left = this.formX + (screenX_1 - this.mouseX);
            this.form.top = this.formY + (screenY_1 - this.mouseY);
            this.menuService.closeAllMenus();
        }
    };
    FormService.prototype.stopMove = function () {
        var _a;
        if ((_a = this.form) === null || _a === void 0 ? void 0 : _a.isMooving) {
            this.form.isMooving = false;
        }
    };
    FormService.ctorParameters = function () { return [
        { type: MouseService },
        { type: MenuService },
        { type: HelperService },
        { type: ModelService }
    ]; };
    FormService = __decorate([
        Injectable()
    ], FormService);
    return FormService;
}());

var FullScreenService = /** @class */ (function () {
    function FullScreenService(model, pageService) {
        this.model = model;
        this.pageService = pageService;
    }
    FullScreenService.prototype.changeFullScreenMode = function (fullScreenMode) {
        this.model.options.appearance.fullScreenMode = fullScreenMode;
        var viewer = this.model.controls.viewer.el.nativeElement;
        if (fullScreenMode) {
            this.model.fullScreenOptions = {
                scrollbarsMode: this.model.options.appearance.scrollbarsMode,
                zIndex: viewer.style.zIndex,
                position: viewer.style.position,
                width: viewer.style.width,
                height: viewer.style.height,
                overflow: document.body.style.overflow
            };
            this.model.options.appearance.scrollbarsMode = true;
            viewer.style.zIndex = '1000000';
            viewer.style.position = this.model.options.reportDesignerMode ? 'absolute' : 'fixed';
            viewer.style.width = null;
            viewer.style.height = null;
            document.body.style.overflow = 'hidden';
        }
        else if (this.model.fullScreenOptions) {
            this.model.options.appearance.scrollbarsMode = this.model.fullScreenOptions.scrollbarsMode;
            viewer.style.zIndex = this.model.fullScreenOptions.zIndex;
            viewer.style.position = this.model.fullScreenOptions.position;
            viewer.style.width = this.model.fullScreenOptions.width;
            viewer.style.height = this.model.fullScreenOptions.height;
            document.body.style.overflow = this.model.fullScreenOptions.overflow;
            this.model.fullScreenOptions = null;
        }
        this.pageService.calculateLayout();
    };
    FullScreenService.ctorParameters = function () { return [
        { type: ModelService },
        { type: PageService }
    ]; };
    FullScreenService = __decorate([
        Injectable()
    ], FullScreenService);
    return FullScreenService;
}());

var ControllerService = /** @class */ (function () {
    function ControllerService(httpClient, model, stylesService, pageService, helper, formService, fullScreenService, menuService, styleService) {
        var _this = this;
        this.httpClient = httpClient;
        this.model = model;
        this.stylesService = stylesService;
        this.pageService = pageService;
        this.helper = helper;
        this.formService = formService;
        this.fullScreenService = fullScreenService;
        this.menuService = menuService;
        this.styleService = styleService;
        this.subject = new Subject();
        this.actionSubject = new Subject();
        setInterval(function () {
            var _a, _b;
            if (_this.model.httpError) {
                if ((_a = _this.model.httpError.error) === null || _a === void 0 ? void 0 : _a.text) {
                    _this.showError((_b = _this.model.httpError.error) === null || _b === void 0 ? void 0 : _b.text);
                }
                else if (_this.model.httpError.message) {
                    _this.showError(null, _this.model.httpError.message);
                }
                else if (_this.model.httpError.error instanceof ErrorEvent) {
                    _this.showError(_this.model.httpError.error.message);
                }
                _this.model.httpError = null;
            }
            if (_this.model.navigateNode) {
                _this.postBookmarkNodeAction(_this.model.navigateNode);
                _this.model.navigateNode = null;
            }
        }, 250);
        this.setupHandlers();
    }
    ControllerService.prototype.setupHandlers = function () {
        var _this = this;
        this.getMessage().subscribe(function (message) {
            switch (message.action) {
                case 'GetReport':
                case 'OpenReport':
                    setTimeout(function () {
                        var _a, _b;
                        _this.styleService.addCustomFontStyles((_a = message.data) === null || _a === void 0 ? void 0 : _a.customFonts);
                        if (_this.model.options.appearance.fullScreenMode) {
                            _this.fullScreenService.changeFullScreenMode(true);
                        }
                        if (((_b = message.data) === null || _b === void 0 ? void 0 : _b.stimulsoftFontContent) && !_this.model.options.stimulsoftFontContent) {
                            _this.model.options.stimulsoftFontContent = message.data.stimulsoftFontContent;
                            _this.styleService.addCustomFontStyles([{
                                    contentForCss: message.data.stimulsoftFontContent,
                                    originalFontFamily: 'Stimulsoft'
                                }]);
                        }
                    });
                    break;
            }
        });
        this.model.controls.bookmarksPanel.getVisibility().subscribe(function (value) {
            if (value && _this.model.options.isMobileDevice) {
                _this.model.controls.parametersPanel.visible = false;
            }
            if (value) {
                _this.hideToolbar();
            }
            else {
                _this.showToolbar();
            }
        });
        this.model.controls.parametersPanel.getVisibility().subscribe(function (value) {
            if (value && _this.model.options.isMobileDevice) {
                _this.model.controls.bookmarksPanel.visible = false;
            }
            if (value) {
                _this.hideToolbar();
            }
            else {
                _this.showToolbar();
            }
        });
        this.menuService.getVisibility().subscribe(function (menu) {
            _this.hideToolbar();
        });
    };
    ControllerService.prototype.hideToolbar = function () {
        if (this.model.options.isMobileDevice && this.model.options.toolbar.autoHide) {
            this.model.controls.toolbar.visible = false;
            this.model.controls.navigatePanel.visible = false;
        }
    };
    ControllerService.prototype.showToolbar = function () {
        var _this = this;
        if (this.model.options.isMobileDevice && this.model.options.toolbar.autoHide) {
            this.model.controls.toolbar.visible = true;
            this.model.controls.navigatePanel.visible = true;
            setTimeout(function () {
                _this.keepToolbar();
            }, 300);
        }
    };
    ControllerService.prototype.keepToolbar = function () {
        var _this = this;
        if (this.model.options.isMobileDevice && this.model.options.toolbar.autoHide) {
            clearTimeout(this.model.toolbarHideTimer);
            this.model.toolbarHideTimer = setTimeout(function () {
                _this.hideToolbar();
            }, 4000);
        }
    };
    ControllerService.prototype.getMessage = function () {
        return this.subject.asObservable();
    };
    ControllerService.prototype.getActionMessage = function () {
        return this.actionSubject.asObservable();
    };
    ControllerService.prototype.post = function (action, cAction, postData, responseType, subAction) {
        var _this = this;
        if (responseType === void 0) { responseType = 'json'; }
        this.model.controls.navigatePanel.enabled = false;
        this.model.controls.toolbar.enabled = false;
        var url;
        if (!cAction) {
            url = this.model.requestUrl.replace('{action}', action === 'GetReport' || this.model.options.server.cacheMode === 'None' ? this.model.options.actions.getReport : this.model.options.actions.viewerEvent);
        }
        else {
            url = this.model.requestUrl.replace('{action}', cAction);
        }
        if (postData) {
            postData.action = action;
        }
        else {
            postData = { action: action };
        }
        this.httpClient.post(url, this.model.createPostParameters(postData), responseType).subscribe(function (data) {
            var _a;
            _this.model.showProgress = false;
            _this.model.controls.navigatePanel.enabled = true;
            _this.model.controls.toolbar.enabled = true;
            if (data === 'ServerError:The report is not specified.' && ((_a = _this.model.options) === null || _a === void 0 ? void 0 : _a.isReportRecieved)) {
                _this.model.options.isReportRecieved = false;
                _this.model.reportParams.prevPageNumber = _this.model.reportParams.pageNumber;
                _this.post('GetReport');
                return;
            }
            if (data) {
                _this.model.reportParams = data;
                _this.startRefreshReportTimer(data.refreshTime);
            }
            _this.subject.next({ action: action, data: data, subAction: subAction });
        });
    };
    ControllerService.prototype.loadViewer = function () {
        var _this = this;
        var url = this.model.requestUrl.replace('{action}', this.model.action);
        this.httpClient.post(url, this.model.createPostParameters({ action: 'AngularViewerData' }, true, false), 'json').subscribe(function (data) {
            _this.model.clear();
            _this.stylesService.setupStyle(atob(data['styles']), 'viewer');
            _this.model.options = data;
            _this.checkTrExp();
            _this.initAutoUpdateCache();
            _this.subject.next({ action: 'viewer_loaded' });
            _this.getReport();
        });
    };
    ControllerService.prototype.getReport = function () {
        this.model.options.paramsVariablesStartValues = null;
        this.post('GetReport');
    };
    ControllerService.prototype.getPages = function () {
        this.post('GetPages');
    };
    ControllerService.prototype.postExport = function (format, settings, elementName, isDashboardExport) {
        if (isDashboardExport === void 0) { isDashboardExport = false; }
        var data = {
            action: isDashboardExport ? 'ExportDashboard' : 'ExportReport',
            exportFormat: format,
            exportSettings: settings,
            elementName: elementName
        };
        var doc = settings && settings.OpenAfterExport && this.model.options.appearance.openExportedReportWindow === '_blank' ? this.helper.openNewWindow('about:blank', '_blank').document : null;
        var url = this.model.requestUrl;
        this.httpClient.postForm(url.replace('{action}', this.model.options.actions.exportReport), data, doc);
        this.actionSubject.next({ action: 'ExportReport', data: data });
    };
    ControllerService.prototype.loadFile = function (fileName, content) {
        if (typeof content !== 'string' || content === '') {
            return;
        }
        if (content.indexOf('<?xml') === 0 || content.indexOf('{') === 0) {
            content = btoa(content);
        }
        var data = {
            action: 'OpenReport',
            openingFileName: fileName || 'Report.mdc',
            base64Data: content.indexOf('base64,') > 0 ? content.substr(content.indexOf('base64,') + 7) : content
        };
        if (fileName && (fileName.toLowerCase().indexOf('.mdx') >= 0 || fileName.toLowerCase().indexOf('.mrx') >= 0)) {
            this.formService.showForm('passwordForm', data);
        }
        else {
            this.postOpen(data);
        }
    };
    ControllerService.prototype.postOpen = function (data) {
        this.model.clearViewerState();
        this.model.reportParams.reportFileName = data.openingFileName;
        this.post('OpenReport', this.model.options.actions.openReport, data);
    };
    ControllerService.prototype.action = function (event) {
        var _this = this;
        switch (event.name) {
            case 'Find':
                this.model.controls.findPanel.visible = !this.model.controls.findPanel.visible;
                return;
            case 'Bookmarks':
                this.model.controls.bookmarksPanel.visible = !this.model.controls.bookmarksPanel.visible;
                return;
            case 'Parameters':
                this.model.controls.parametersPanel.visible = !this.model.controls.parametersPanel.visible;
                return;
            case 'BookmarkAction':
                if (this.model.reportParams.pageNumber === event.bookmarkPage || this.model.reportParams.viewMode !== 'SinglePage') {
                    this.helper.scrollToAnchor(event.bookmarkAnchor, event.componentGuid);
                    return;
                }
                else {
                    this.model.reportParams.pageNumber = event.bookmarkPage;
                    this.model.options.bookmarkAnchor = event.bookmarkAnchor;
                    this.model.options.componentGuid = event.componentGuid;
                }
                break;
            case 'GoToPage':
                this.model.reportParams.pageNumber = event.value;
                break;
            case 'FirstPage':
                this.model.reportParams.pageNumber = 0;
                break;
            case 'PrevPage':
                this.model.reportParams.pageNumber = Math.max(0, this.model.reportParams.pageNumber - 1);
                break;
            case 'NextPage':
                this.model.reportParams.pageNumber = Math.min(this.model.reportParams.pagesCount - 1, this.model.reportParams.pageNumber + 1);
                break;
            case 'LastPage':
                this.model.reportParams.pageNumber = this.model.reportParams.pagesCount - 1;
                break;
            case 'ViewModeSinglePage':
                this.model.reportParams.viewMode = 'SinglePage';
                break;
            case 'ViewModeContinuous':
                this.model.reportParams.viewMode = 'Continuous';
                break;
            case 'ViewModeMultiplePages':
                this.model.reportParams.viewMode = 'MultiplePages';
                break;
            case 'Zoom25':
                this.model.reportParams.zoom = 25;
                break;
            case 'Zoom50':
                this.model.reportParams.zoom = 50;
                break;
            case 'Zoom75':
                this.model.reportParams.zoom = 75;
                break;
            case 'Zoom100':
                this.model.reportParams.zoom = 100;
                break;
            case 'Zoom150':
                this.model.reportParams.zoom = 150;
                break;
            case 'Zoom200':
                this.model.reportParams.zoom = 200;
                break;
            case 'ZoomOnePage':
            case 'ZoomPageWidth':
                this.model.reportParams.zoom = event.name === 'ZoomPageWidth' ? this.pageService.getZoomByPageWidth() : this.pageService.getZoomByPageHeight();
                break;
            case 'Submit':
                this.model.reportParams.editableParameters = null;
                if (this.model.reportParams.type === 'Report') {
                    this.model.reportParams.pageNumber = 0;
                }
                if (this.model.options.isMobileDevice) {
                    this.model.controls.parametersPanel.visible = false;
                }
                this.actionSubject.next({ action: 'Variables' });
                return;
            case 'Reset':
                if (this.model.options.paramsVariablesStartValues) {
                    this.model.options.paramsVariables = this.model.options.paramsVariablesStartValues;
                }
                this.actionSubject.next({ action: 'Reset' });
                return;
            case 'Editor':
                this.actionSubject.next({ action: 'Editor', data: {} });
                return;
            case 'Resources':
                this.model.controls.resourcesPanel.visible = !this.model.controls.resourcesPanel.visible;
                return;
            case 'PrintPdf':
            case 'PrintWithPreview':
            case 'PrintWithoutPreview':
                this.actionSubject.next({ action: 'Print', data: { format: event.name } });
                return;
            case 'Print':
                var format = 'PrintPdf';
                switch (this.model.options.toolbar.printDestination) {
                    case 'Pdf':
                        format = 'PrintPdf';
                        break;
                    case 'Direct':
                        format = 'PrintWithoutPreview';
                        break;
                    case 'WithPreview':
                        format = 'PrintWithPreview';
                        break;
                }
                this.actionSubject.next({ action: 'Print', data: { format: format } });
                return;
            case 'Open':
                this.model.openDialogFileMask = null;
                setTimeout(function () {
                    _this.model.openDialogFileMask = '.mdc,.mdz,.mdx,.mrt,.mrz,.mrx';
                });
                return;
            case 'ResourceView':
                this.postReportResource(event.value.name, 'View');
                return;
            case 'ResourceSaveFile':
                this.postReportResource(event.value.name, 'SaveFile');
                return;
            case 'FullScreen':
                this.fullScreenService.changeFullScreenMode(!this.model.options.appearance.fullScreenMode);
                return;
            case 'About':
                this.actionSubject.next({ action: 'About' });
                return;
            case 'Pin':
                this.model.options.toolbar.autoHide = !this.model.options.toolbar.autoHide;
                this.pageService.calculateLayout();
                if (this.model.options.toolbar.autoHide) {
                    setTimeout(function () {
                        _this.hideToolbar();
                    }, 200);
                }
                return;
            case 'Design':
                this.actionSubject.next({ action: 'Design' });
                break;
            default:
                if (event.name.indexOf('saveMenu') === 0) {
                    this.actionSubject.next({ action: 'Export', data: { format: event.name.substr(8) } });
                    return;
                }
                else if (event.name.indexOf('sendEmailMenu') === 0) {
                    this.actionSubject.next({ action: 'SendEmail', data: { format: event.name.substr(13) } });
                    return;
                }
        }
        this.getPages();
    };
    ControllerService.prototype.showError = function (message, messageText) {
        var type = 'Error';
        // Check for error in 'ServerError:' string format
        if (message != null && typeof (message) === 'string' && message.substr(0, 12) === 'ServerError:') {
            if (message.length <= 13) {
                messageText = 'An unknown error occurred (the server returned an empty value).';
            }
            else {
                messageText = message.substr(12);
            }
        }
        // Check for error in JSON format
        if (message != null && message.success === false && message.type && message.text) {
            type = message.type;
            messageText = message.text;
        }
        this.model.errorMessage = { error: 'Unknown error', type: type };
        if (messageText != null) {
            if (messageText === 'The report is not specified.' && !this.model.options.appearance.showReportIsNotSpecifiedMessage) {
                return true;
            }
            this.model.errorMessage = { error: messageText.replace('\n', '<br>'), type: type };
            if (this.model.images) {
                this.formService.showForm('errorMessageForm');
            }
            else {
                alert(messageText);
            }
            this.actionSubject.next({ action: 'Error' });
            return true;
        }
        return false;
    };
    ControllerService.prototype.postReportResource = function (resourceName, viewType) {
        var data = {
            action: 'ReportResource',
            reportResourceParams: {
                resourceName: resourceName,
                viewType: viewType
            }
        };
        var doc = viewType === 'View' ? this.helper.openNewWindow('about:blank', '_blank').document : null;
        var url = this.model.requestUrl;
        this.httpClient.postForm(url.replace('{action}', this.model.options.actions.viewerEvent), data, doc);
    };
    ControllerService.prototype.postBookmarkNodeAction = function (node) {
        node.selected = true;
        this.action({ name: 'BookmarkAction', bookmarkPage: node.page, bookmarkAnchor: node.url.replace(/\\\'/g, '\'').substr(1), componentGuid: node.compunentGuid });
    };
    ControllerService.prototype.viewerResized = function () {
        this.menuService.closeAllMenus();
    };
    ControllerService.prototype.initAutoUpdateCache = function () {
        var _this = this;
        if (this.model.options.server.allowAutoUpdateCache) {
            if (this.model.timerAutoUpdateCache) {
                clearInterval(this.model.timerAutoUpdateCache);
            }
            this.model.timerAutoUpdateCache = setInterval(function () { return _this.post('UpdateCache'); }, this.model.options.server.timeoutAutoUpdateCache);
        }
    };
    ControllerService.prototype.startRefreshReportTimer = function (timeout) {
        var _this = this;
        if (this.model.refreshReportTimer != null) {
            clearInterval(this.model.refreshReportTimer);
            this.model.refreshReportTimer = null;
        }
        if (timeout && timeout > 0) {
            this.model.refreshReportTimer = setInterval(function () {
                if (!_this.model.showProgress) {
                    _this.post('Refresh');
                }
            }, timeout * 1000);
        }
    };
    ControllerService.prototype.checkTrExp = function () {
        var _this = this;
        if (!this.model.options.cloudMode && !this.model.options.serverMode && !this.model.options.standaloneJsMode && !this.model.options.reportDesignerMode && !this.model.options.alternateValid) {
            var buildDate = new Date();
            try {
                /*if (this.model.options.jsMode && typeof Stimulsoft != 'undefined') {
                  let innerDate = Stimulsoft.StiVersion.created.innerDate;
                  if (innerDate['getFullYear'] && innerDate.getFullYear() > 2017)
                    buildDate = Stimulsoft.StiVersion.created.innerDate;
                }
                else*/ if (this.model.options.buildDate) {
                    buildDate = new Date(this.model.options.buildDate);
                }
            }
            catch (e) {
                buildDate = new Date();
            }
            var trDays_1 = Math.floor(((new Date()).getTime() - buildDate.getTime()) / 1000 / 60 / 60 / 24);
            if (trDays_1 > 60) {
                setTimeout(function () {
                    var message = trDays_1 > 120 ? _this.model.loc('NoticesYourTrialHasExpired') : _this.model.loc('NoticesYouUsingTrialVersion');
                    var image = 'Notifications.Warning.png';
                    var buttonCaption = _this.model.loc('ButtonOk');
                    var cancelAction;
                    var action;
                    if (trDays_1 > 120) {
                        action = cancelAction = function () { window.location.href = 'https://www.stimulsoft.com/en/online-store'; };
                    }
                    _this.model.notificationFormOptions = { message: message, image: image, buttonCaption: buttonCaption, cancelAction: cancelAction, action: action };
                    _this.formService.showForm('notificationForm');
                }, 3000);
            }
        }
    };
    ControllerService.ctorParameters = function () { return [
        { type: StiHttpClientService },
        { type: ModelService },
        { type: StylesService },
        { type: PageService },
        { type: HelperService },
        { type: FormService },
        { type: FullScreenService },
        { type: MenuService },
        { type: StylesService }
    ]; };
    ControllerService = __decorate([
        Injectable()
    ], ControllerService);
    return ControllerService;
}());

var CollectionsService = /** @class */ (function () {
    function CollectionsService(model) {
        this.model = model;
    }
    CollectionsService.prototype.getImageTypesItems = function () {
        var items = [];
        if (this.model.options.exports.showExportToImageBmp) {
            items.push(new Item('Bmp', 'Bmp', null, 'Bmp'));
        }
        if (this.model.options.exports.showExportToImageGif) {
            items.push(new Item('Gif', 'Gif', null, 'Gif'));
        }
        if (this.model.options.exports.showExportToImageJpeg) {
            items.push(new Item('Jpeg', 'Jpeg', null, 'Jpeg'));
        }
        if (this.model.options.exports.showExportToImagePcx) {
            items.push(new Item('Pcx', 'Pcx', null, 'Pcx'));
        }
        if (this.model.options.exports.showExportToImagePng) {
            items.push(new Item('Png', 'Png', null, 'Png'));
        }
        if (this.model.options.exports.showExportToImageTiff) {
            items.push(new Item('Tiff', 'Tiff', null, 'Tiff'));
        }
        if (this.model.options.exports.showExportToImageMetafile) {
            items.push(new Item('Emf', 'Emf', null, 'Emf'));
        }
        if (this.model.options.exports.showExportToImageSvg) {
            items.push(new Item('Svg', 'Svg', null, 'Svg'));
        }
        if (this.model.options.exports.showExportToImageSvgz) {
            items.push(new Item('Svgz', 'Svgz', null, 'Svgz'));
        }
        return items;
    };
    CollectionsService.prototype.getDataTypesItems = function () {
        var items = [];
        if (this.model.options.exports.showExportToCsv) {
            items.push(new Item('Csv', 'Csv', null, 'Csv'));
        }
        if (this.model.options.exports.showExportToDbf) {
            items.push(new Item('Dbf', 'Dbf', null, 'Dbf'));
        }
        if (this.model.options.exports.showExportToXml) {
            items.push(new Item('Xml', 'Xml', null, 'Xml'));
        }
        if (this.model.options.exports.showExportToDif) {
            items.push(new Item('Dif', 'Dif', null, 'Dif'));
        }
        if (this.model.options.exports.showExportToSylk) {
            items.push(new Item('Sylk', 'Sylk', null, 'Sylk'));
        }
        if (this.model.options.exports.showExportToJson) {
            items.push(new Item('Json', 'Json', null, 'Json'));
        }
        return items;
    };
    CollectionsService.prototype.getExcelTypesItems = function () {
        var items = [];
        if (this.model.options.exports.showExportToExcel2007) {
            items.push(new Item('Excel2007', 'Excel', null, 'Excel2007'));
        }
        if (this.model.options.exports.showExportToExcel) {
            items.push(new Item('ExcelBinary', 'Excel 97-2003', null, 'ExcelBinary'));
        }
        if (this.model.options.exports.showExportToExcelXml) {
            items.push(new Item('ExcelXml', 'Excel Xml 2003', null, 'ExcelXml'));
        }
        return items;
    };
    CollectionsService.prototype.getHtmlTypesItems = function () {
        var items = [];
        if (this.model.options.exports.showExportToHtml) {
            items.push(new Item('Html', 'Html', null, 'Html'));
        }
        if (this.model.options.exports.showExportToHtml5) {
            items.push(new Item('Html5', 'Html5', null, 'Html5'));
        }
        if (this.model.options.exports.showExportToMht) {
            items.push(new Item('Mht', 'Mht', null, 'Mht'));
        }
        return items;
    };
    CollectionsService.prototype.getZoomItems = function () {
        var items = [];
        [0.25, 0.5, 0.75, 1, 1.25, 1.5, 2].forEach(function (item, i) { return items.push(new Item('item' + i, (item * 100) + '%', null, item)); });
        return items;
    };
    CollectionsService.prototype.getImageFormatForHtmlItems = function () {
        var items = [];
        items.push(new Item('item0', 'Jpeg', null, 'Jpeg'));
        items.push(new Item('item1', 'Gif', null, 'Gif'));
        items.push(new Item('item2', 'Bmp', null, 'Bmp'));
        items.push(new Item('item3', 'Png', null, 'Png'));
        return items;
    };
    CollectionsService.prototype.getExportModeItems = function () {
        var items = [];
        items.push(new Item('item0', 'Table', null, 'Table'));
        items.push(new Item('item1', 'Span', null, 'Span'));
        items.push(new Item('item2', 'Div', null, 'Div'));
        return items;
    };
    CollectionsService.prototype.getImageResolutionItems = function () {
        var items = [];
        ['10', '25', '50', '75', '100', '200', '300', '400', '500'].forEach(function (item, i) { return items.push(new Item('item' + i, item, null, parseInt(item, 10))); });
        return items;
    };
    CollectionsService.prototype.getImageCompressionMethodItems = function () {
        var items = [];
        items.push(new Item('item0', 'Jpeg', null, 'Jpeg'));
        items.push(new Item('item1', 'Flate', null, 'Flate'));
        return items;
    };
    CollectionsService.prototype.getImageQualityItems = function () {
        var items = [];
        [0.25, 0.5, 0.75, 0.85, 0.9, 0.95, 1].forEach(function (item, i) { return items.push(new Item('item' + i, (item * 100).toString(), null, item)); });
        return items;
    };
    CollectionsService.prototype.getBorderTypeItems = function () {
        var items = [];
        items.push(new Item('item0', this.model.loc('BorderTypeSimple'), null, 'Simple'));
        items.push(new Item('item1', this.model.loc('BorderTypeSingle'), null, 'UnicodeSingle'));
        items.push(new Item('item2', this.model.loc('BorderTypeDouble'), null, 'UnicodeDouble'));
        return items;
    };
    CollectionsService.prototype.getEncodingDataItems = function () {
        var items = [];
        this.model.encodingData.forEach(function (item, i) { return items.push(new Item('item' + i, item.value, null, item.key)); });
        return items;
    };
    CollectionsService.prototype.getImageFormatItems = function (withoutMonochrome) {
        if (withoutMonochrome === void 0) { withoutMonochrome = false; }
        var items = [];
        items.push(new Item('item0', this.model.loc('ImageFormatColor'), null, 'Color'));
        items.push(new Item('item1', this.model.loc('ImageFormatGrayscale'), null, 'Grayscale'));
        if (!withoutMonochrome) {
            items.push(new Item('item2', this.model.loc('ImageFormatMonochrome'), null, 'Monochrome'));
        }
        return items;
    };
    CollectionsService.prototype.getMonochromeDitheringTypeItems = function () {
        var items = [];
        items.push(new Item('item0', 'None', null, 'None'));
        items.push(new Item('item1', 'FloydSteinberg', null, 'FloydSteinberg'));
        items.push(new Item('item2', 'Ordered', null, 'Ordered'));
        return items;
    };
    CollectionsService.prototype.getTiffCompressionSchemeItems = function () {
        var items = [];
        items.push(new Item('item0', 'Default', null, 'Default'));
        items.push(new Item('item1', 'CCITT3', null, 'CCITT3'));
        items.push(new Item('item2', 'CCITT4', null, 'CCITT4'));
        items.push(new Item('item3', 'LZW', null, 'LZW'));
        items.push(new Item('item4', 'None', null, 'None'));
        items.push(new Item('item5', 'Rle', null, 'Rle'));
        return items;
    };
    CollectionsService.prototype.getEncodingDifFileItems = function () {
        var items = [];
        items.push(new Item('item0', '437', null, '437'));
        items.push(new Item('item1', '850', null, '850'));
        items.push(new Item('item2', '852', null, '852'));
        items.push(new Item('item3', '857', null, '857'));
        items.push(new Item('item4', '860', null, '860'));
        items.push(new Item('item5', '861', null, '861'));
        items.push(new Item('item6', '862', null, '862'));
        items.push(new Item('item7', '863', null, '863'));
        items.push(new Item('item8', '865', null, '865'));
        items.push(new Item('item9', '866', null, '866'));
        items.push(new Item('item10', '869', null, '869'));
        return items;
    };
    CollectionsService.prototype.getExportModeRtfItems = function () {
        var items = [];
        items.push(new Item('item0', this.model.loc('ExportModeRtfTable'), null, 'Table'));
        items.push(new Item('item1', this.model.loc('ExportModeRtfFrame'), null, 'Frame'));
        return items;
    };
    CollectionsService.prototype.getEncodingDbfFileItems = function () {
        var items = [];
        items.push(new Item('item0', 'Default', null, 'Default'));
        items.push(new Item('item1', '437 U.S. MS-DOS', null, 'USDOS'));
        items.push(new Item('item2', '620 Mazovia(Polish) MS-DOS', null, 'MazoviaDOS'));
        items.push(new Item('item3', '737 Greek MS-DOS(437G)', null, 'GreekDOS'));
        items.push(new Item('item4', '850 International MS-DOS', null, 'InternationalDOS'));
        items.push(new Item('item5', '852 Eastern European MS-DOS', null, 'EasternEuropeanDOS'));
        items.push(new Item('item6', '857 Turkish MS-DOS', null, 'TurkishDOS'));
        items.push(new Item('item7', '861 Icelandic MS-DOS', null, 'IcelandicDOS'));
        items.push(new Item('item8', '865 Nordic MS-DOS', null, 'NordicDOS'));
        items.push(new Item('item9', '866 Russian MS-DOS', null, 'RussianDOS'));
        items.push(new Item('item10', '895 Kamenicky(Czech) MS-DOS', null, 'KamenickyDOS'));
        items.push(new Item('item11', '1250 Eastern European Windows', null, 'EasternEuropeanWindows'));
        items.push(new Item('item12', '1251 Russian Windows', null, 'RussianWindows'));
        items.push(new Item('item13', '1252 WindowsANSI', null, 'WindowsANSI'));
        items.push(new Item('item14', '1253 GreekWindows', null, 'GreekWindows'));
        items.push(new Item('item15', '1254 TurkishWindows', null, 'TurkishWindows'));
        items.push(new Item('item16', '10000 StandardMacintosh', null, 'StandardMacintosh'));
        items.push(new Item('item17', '10006 GreekMacintosh', null, 'GreekMacintosh'));
        items.push(new Item('item18', '10007 RussianMacintosh', null, 'RussianMacintosh'));
        items.push(new Item('item19', '10029 EasternEuropeanMacintosh', null, 'EasternEuropeanMacintosh'));
        return items;
    };
    CollectionsService.prototype.getAllowEditableItems = function () {
        var items = [];
        items.push(new Item('item0', this.model.loc('NameYes'), null, 'Yes'));
        items.push(new Item('item1', this.model.loc('NameNo'), null, 'No'));
        return items;
    };
    CollectionsService.prototype.getEncryptionKeyLengthItems = function () {
        var items = [];
        items.push(new Item('item0', '40 bit RC4 (Acrobat 3)', null, 'Bit40'));
        items.push(new Item('item1', '128 bit RC4 (Acrobat 5)', null, 'Bit128'));
        items.push(new Item('item2', '128 bit AES (Acrobat 7)', null, 'Bit128_r4'));
        items.push(new Item('item3', '256 bit AES (Acrobat 9)', null, 'Bit256_r5'));
        items.push(new Item('item4', '256 bit AES (Acrobat X)', null, 'Bit256_r6'));
        return items;
    };
    CollectionsService.prototype.getDataExportModeItems = function () {
        var items = [];
        items.push(new Item('item0', this.model.loc('BandsFilterDataOnly'), null, 'Data'));
        items.push(new Item('item1', this.model.loc('BandsFilterDataAndHeaders'), null, 'DataAndHeaders'));
        items.push(new Item('item2', this.model.loc('BandsFilterDataAndHeadersFooters'), null, 'DataAndHeadersFooters'));
        items.push(new Item('item3', this.model.loc('BandsFilterAllBands'), null, 'AllBands'));
        return items;
    };
    CollectionsService.prototype.getFilterConditionItems = function (dataType) {
        var items = [];
        switch (dataType) {
            case 'String':
                items.push(new Item('item0', this.model.loc('ConditionEqualTo'), '', 'EqualTo'));
                items.push(new Item('item1', this.model.loc('ConditionNotEqualTo'), '', 'NotEqualTo'));
                items.push('separator1');
                items.push(new Item('item2', this.model.loc('ConditionContaining'), '', 'Containing'));
                items.push(new Item('item3', this.model.loc('ConditionNotContaining'), '', 'NotContaining'));
                items.push('separator2');
                items.push(new Item('item4', this.model.loc('ConditionBeginningWith'), '', 'BeginningWith'));
                items.push(new Item('item5', this.model.loc('ConditionEndingWith'), '', 'EndingWith'));
                items.push('separator3');
                items.push(new Item('item2', this.model.loc('ConditionBetween'), '', 'Between'));
                items.push(new Item('item3', this.model.loc('ConditionNotBetween'), '', 'NotBetween'));
                items.push('separator4');
                items.push(new Item('item6', this.model.loc('ConditionGreaterThan'), '', 'GreaterThan'));
                items.push(new Item('item7', this.model.loc('ConditionGreaterThanOrEqualTo'), '', 'GreaterThanOrEqualTo'));
                items.push('separator5');
                items.push(new Item('item8', this.model.loc('ConditionLessThan'), '', 'LessThan'));
                items.push(new Item('item9', this.model.loc('ConditionLessThanOrEqualTo'), '', 'LessThanOrEqualTo'));
                items.push('separator6');
                items.push(new Item('item10', this.model.loc('ConditionIsNull'), '', 'IsNull'));
                items.push(new Item('item11', this.model.loc('ConditionIsNotNull'), '', 'IsNotNull'));
                items.push('separator7');
                items.push(new Item('item12', this.model.loc('ConditionIsBlank'), '', 'IsBlank'));
                items.push(new Item('item13', this.model.loc('ConditionIsNotBlank'), '', 'IsNotBlank'));
                break;
            case 'Numeric':
            case 'DateTime':
                {
                    items.push(new Item('item0', this.model.loc('ConditionEqualTo'), '', 'EqualTo'));
                }
                items.push(new Item('item1', this.model.loc('ConditionNotEqualTo'), '', 'NotEqualTo'));
                items.push('separator1');
                items.push(new Item('item2', this.model.loc('ConditionBetween'), '', 'Between'));
                items.push(new Item('item3', this.model.loc('ConditionNotBetween'), '', 'NotBetween'));
                items.push('separator2');
                items.push(new Item('item4', this.model.loc('ConditionGreaterThan'), '', 'GreaterThan'));
                items.push(new Item('item5', this.model.loc('ConditionGreaterThanOrEqualTo'), '', 'GreaterThanOrEqualTo'));
                items.push('separator3');
                items.push(new Item('item6', this.model.loc('ConditionLessThan'), '', 'LessThan'));
                items.push(new Item('item7', this.model.loc('ConditionLessThanOrEqualTo'), '', 'LessThanOrEqualTo'));
                items.push('separator4');
                items.push(new Item('item8', this.model.loc('ConditionIsNull'), '', 'IsNull'));
                items.push(new Item('item9', this.model.loc('ConditionIsNotNull'), '', 'IsNotNull'));
                break;
            case 'Boolean':
                {
                    items.push(new Item('item0', this.model.loc('ConditionEqualTo'), '', 'EqualTo'));
                }
                items.push(new Item('item1', this.model.loc('ConditionNotEqualTo'), '', 'NotEqualTo'));
                break;
        }
        return items;
    };
    CollectionsService.prototype.getBoolItems = function () {
        var items = [];
        items.push(new Item('item0', this.model.loc('NameTrue'), null, 'True'));
        items.push(new Item('item1', this.model.loc('NameFalse'), null, 'False'));
        return items;
    };
    CollectionsService.prototype.getPaperSizesItems = function () {
        var items = [];
        this.model.paperSizes.forEach(function (item, i) { return items.push(new Item('item' + i, item, null, item)); });
        return items;
    };
    CollectionsService.prototype.getOrientationItems = function () {
        var items = [];
        items.push(new Item('item0', this.model.loc('Portrait'), null, 'Portrait'));
        items.push(new Item('item1', this.model.loc('Landscape'), null, 'Landscape'));
        return items;
    };
    CollectionsService.prototype.getDashboardImageQualityItems = function () {
        var items = [];
        [50, 75, 100, 150, 200, 300, 500].forEach(function (item, i) { return items.push(new Item('item' + i, item + '%', null, item.toString())); });
        return items;
    };
    CollectionsService.prototype.getPdfSecurityCertificatesItems = function () {
        var items = [];
        if (this.model.pdfSecurityCertificates) {
            for (var i = 0; i < this.model.pdfSecurityCertificates.length; i++) {
                var item = this.model.pdfSecurityCertificates[i];
                items.push(new Item('item' + i, "Name: " + item.name + "<br>Issuer: " + item.issuer + "<br>Valid from: " + item.from + " to " + item.to, null, item.thumbprint, null, null, null, 'DigitalSignature'));
            }
        }
        return items;
    };
    CollectionsService.ctorParameters = function () { return [
        { type: ModelService }
    ]; };
    CollectionsService = __decorate([
        Injectable()
    ], CollectionsService);
    return CollectionsService;
}());

var ExportService = /** @class */ (function () {
    function ExportService(formService, helper, model, collections, controller) {
        var _this = this;
        this.formService = formService;
        this.helper = helper;
        this.model = model;
        this.collections = collections;
        this.controller = controller;
        this.exportSettings = {};
        this.sendMail = false;
        this.subject = new Subject();
        controller.getActionMessage().subscribe(function (message) {
            switch (message.action) {
                case 'Export':
                    _this.export(message.data.format);
                    break;
                case 'SendEmail':
                    _this.export(message.data.format, false, true);
                    break;
            }
        });
    }
    ExportService.prototype.getMessage = function () {
        return this.subject.asObservable();
    };
    ExportService.prototype.export = function (format, update, sendMail) {
        var _this = this;
        if (update === void 0) { update = false; }
        if (sendMail === void 0) { sendMail = false; }
        if (!this.helper.checkCloudAuthorization('export')) {
            return;
        }
        this.sendMail = sendMail;
        this.format = format;
        this.exportSettings = this.getDefaultExportSettings(this.format);
        if ((this.model.options.exports.showExportDialog && !sendMail) || (this.model.options.email.showExportDialog && sendMail)) {
            this.exportFormSettings = this.getExportSetings(update);
            if (!update) {
                this.formService.closeForm('exportForm');
                setTimeout(function () {
                    _this.formService.showForm('exportForm');
                });
            }
        }
        else {
            this.postExport();
        }
    };
    ExportService.prototype.postExport = function () {
        if (!this.sendMail) {
            this.controller.postExport(this.format, this.exportSettings);
        }
        else {
            this.subject.next('postMail');
        }
    };
    ExportService.prototype.getExportSetings = function (update) {
        var result;
        this.getDefaultSettings();
        switch (this.format) {
            case 'Document':
                result = { components: this.getComponents(['SaveReportMdc', 'SaveReportMdz', 'SaveReportMdx', 'SaveReportPassword']) };
                break;
            case 'Pdf':
                result = {
                    components: this.getComponents(['PageRangeGroup', 'PageRangeAll', 'PageRangeCurrentPage', 'PageRangePages', 'PageRangePagesText', 'SettingsGroup', 'ImageResolution', 'ImageCompressionMethod',
                        'AllowEditable', 'ImageQuality', /*'StandardPdfFonts',*/ 'EmbeddedFonts', /*'UseUnicode', 'Compressed',*/ 'ExportRtfTextAsImage', 'PdfACompliance', 'UseDigitalSignature', 'DocumentSecurityButton', 'DigitalSignatureButton',
                        'OpenAfterExport', 'PasswordInputUser', 'PasswordInputOwner', 'PrintDocument', 'ModifyContents', 'CopyTextAndGraphics',
                        'AddOrModifyTextAnnotations', 'KeyLength', 'GetCertificateFromCryptoUI', 'SubjectNameString']),
                    openAfterExport: true
                };
                break;
            case 'Xps':
                result = {
                    components: this.getComponents(['PageRangeGroup', 'PageRangeAll', 'PageRangeCurrentPage', 'PageRangePages', 'PageRangePagesText', 'SettingsGroup', 'ImageResolution', 'ImageQuality', 'OpenAfterExport',
                        'ExportRtfTextAsImage']),
                    openAfterExport: true
                };
                break;
            case 'Ppt2007':
                result = { components: this.getComponents(['PageRangeGroup', 'PageRangeAll', 'PageRangeCurrentPage', 'PageRangePages', 'PageRangePagesText', 'SettingsGroup', 'ImageResolution', 'ImageQuality']) };
                break;
            case 'Html':
                result = {
                    components: this.getComponents(['HtmlType', 'Zoom', 'ImageFormatForHtml', 'ExportMode', 'UseEmbeddedImages', 'AddPageBreaks']),
                    openAfterExport: true
                };
                break;
            case 'Html5':
                result = {
                    components: this.getComponents(['PageRangeGroup', 'PageRangeAll', 'PageRangeCurrentPage', 'PageRangePages', 'PageRangePagesText', 'SettingsGroup', 'HtmlType', 'ImageFormatForHtml', 'ImageResolution',
                        'ImageQuality', 'ContinuousPages', 'OpenAfterExport']),
                    openAfterExport: true
                };
                break;
            case 'Mht':
                result = {
                    components: this.getComponents(['PageRangeGroup', 'PageRangeAll', 'PageRangeCurrentPage', 'PageRangePages', 'PageRangePagesText', 'SettingsGroup', 'HtmlType', 'Zoom', 'ImageFormatForHtml',
                        'ExportMode', 'AddPageBreaks'])
                };
                break;
            case 'Text':
                result = {
                    components: this.getComponents(['PageRangeGroup', 'PageRangeAll', 'PageRangeCurrentPage', 'PageRangePages', 'PageRangePagesText', 'SettingsGroup', 'KillSpaceLines',
                        'PutFeedPageCode', 'DrawBorder', 'CutLongLines', 'BorderType', 'ZoomX', 'ZoomY', 'EncodingTextOrCsvFile'])
                };
                break;
            case 'Rtf':
                result = {
                    components: this.getComponents(['PageRangeGroup', 'PageRangeAll', 'PageRangeCurrentPage', 'PageRangePages', 'PageRangePagesText', 'SettingsGroup', 'ImageResolution',
                        'ImageQuality', 'ExportModeRtf', 'UsePageHeadersAndFooters', 'RemoveEmptySpaceAtBottom'])
                };
                break;
            case 'Word2007':
                result = {
                    components: this.getComponents(['PageRangeGroup', 'PageRangeAll', 'PageRangeCurrentPage', 'PageRangePages', 'PageRangePagesText', 'SettingsGroup', 'ImageResolution',
                        'ImageQuality', 'UsePageHeadersAndFooters', 'RemoveEmptySpaceAtBottom'])
                };
                break;
            case 'Odt':
                result = {
                    components: this.getComponents(['PageRangeGroup', 'PageRangeAll', 'PageRangeCurrentPage', 'PageRangePages', 'PageRangePagesText', 'SettingsGroup', 'ImageResolution',
                        'ImageQuality', 'RemoveEmptySpaceAtBottom'])
                };
                break;
            case 'Excel':
            case 'ExcelBinary':
                result = {
                    components: this.getComponents(['PageRangeGroup', 'PageRangeAll', 'PageRangeCurrentPage', 'PageRangePages', 'PageRangePagesText', 'SettingsGroup', 'ExcelType', 'ImageResolution',
                        'ImageQuality', 'DataExportMode', 'ExportObjectFormatting', 'UseOnePageHeaderAndFooter', 'ExportEachPageToSheet', 'ExportPageBreaks']),
                    openAfterExport: true
                };
                break;
            case 'ExcelXml':
                result = {
                    components: this.getComponents(['PageRangeGroup', 'PageRangeAll', 'PageRangeCurrentPage', 'PageRangePages', 'PageRangePagesText', 'SettingsGroup', 'ExcelType'])
                };
                break;
            case 'Excel2007':
                result = {
                    components: this.getComponents(['PageRangeGroup', 'PageRangeAll', 'PageRangeCurrentPage', 'PageRangePages', 'PageRangePagesText', 'SettingsGroup', 'ExcelType', 'ImageResolution',
                        'ImageQuality', 'DataExportMode', 'ExportObjectFormatting', 'UseOnePageHeaderAndFooter', 'ExportEachPageToSheet', 'ExportPageBreaks'])
                };
                break;
            case 'Ods':
                result = {
                    components: this.getComponents(['PageRangeGroup', 'PageRangeAll', 'PageRangeCurrentPage', 'PageRangePages', 'PageRangePagesText', 'SettingsGroup', 'ImageResolution',
                        'ImageQuality'])
                };
                break;
            case 'Csv':
                result = {
                    components: this.getComponents(['PageRangeGroup', 'PageRangeAll', 'PageRangeCurrentPage', 'PageRangePages', 'PageRangePagesText', 'SettingsGroup', 'DataType', 'EncodingTextOrCsvFile',
                        'Separator', 'DataExportMode', 'SkipColumnHeaders'])
                };
                break;
            case 'Dbf':
                result = {
                    components: this.getComponents(['PageRangeGroup', 'PageRangeAll', 'PageRangeCurrentPage', 'PageRangePages', 'PageRangePagesText', 'SettingsGroup', 'DataType', 'EncodingDbfFile'])
                };
                break;
            case 'Dif':
                result = {
                    components: this.getComponents(['PageRangeGroup', 'PageRangeAll', 'PageRangeCurrentPage', 'PageRangePages', 'PageRangePagesText', 'SettingsGroup', 'DataType', 'ExportDataOnly',
                        'UseDefaultSystemEncoding', 'EncodingDifFile'])
                };
                break;
            case 'Sylk':
                result = {
                    components: this.getComponents(['PageRangeGroup', 'PageRangeAll', 'PageRangeCurrentPage', 'PageRangePages', 'PageRangePagesText', 'SettingsGroup', 'DataType', 'ExportDataOnly',
                        'UseDefaultSystemEncoding', 'EncodingDifFile'])
                };
                break;
            case 'Json':
                result = {
                    components: this.getComponents(['PageRangeGroup', 'PageRangeAll', 'PageRangeCurrentPage', 'PageRangePages', 'PageRangePagesText', 'SettingsGroup', 'DataType', 'DataExportMode'])
                };
                break;
            case 'Xml':
                result = {
                    components: this.getComponents(['PageRangeGroup', 'PageRangeAll', 'PageRangeCurrentPage', 'PageRangePages', 'PageRangePagesText', 'SettingsGroup', 'DataType'])
                };
                break;
            case 'ImageBmp':
            case 'ImageGif':
            case 'ImageJpeg':
            case 'ImagePcx':
            case 'ImagePng':
            case 'ImageTiff':
            case 'ImageEmf':
            case 'ImageSvg':
            case 'ImageSvgz':
                result = {
                    components: this.getComponents(['PageRangeGroup', 'PageRangeAll', 'PageRangeCurrentPage', 'PageRangePages', 'PageRangePagesText', 'SettingsGroup', 'ImageType', 'ImageZoom', 'ImageResolution',
                        'ImageFormat', 'DitheringType', 'TiffCompressionScheme', 'CompressToArchive', 'CutEdges'])
                };
                break;
        }
        result.groups = this.getGroups(this.format);
        result.update = update;
        return result;
    };
    ExportService.prototype.getComponents = function (names) {
        var _this = this;
        var mrgn = '8px';
        var components = [];
        names.forEach(function (name) {
            switch (name) {
                case 'ImageType':
                    components.push({
                        name: name, type: 'DropDownListForExportForm', label: _this.model.loc('Type'), width: 160, tooltip: _this.model.loc('TypeTooltip'),
                        margin: '2px ' + mrgn + ' 2px ' + mrgn, items: _this.collections.getImageTypesItems()
                    });
                    break;
                case 'DataType':
                    components.push({
                        name: name, type: 'DropDownListForExportForm', label: _this.model.loc('Type'), width: 160, tooltip: _this.model.loc('TypeTooltip'),
                        margin: '2px ' + mrgn + ' 2px ' + mrgn, items: _this.collections.getDataTypesItems()
                    });
                    break;
                case 'ExcelType':
                    components.push({
                        name: name, type: 'DropDownListForExportForm', label: _this.model.loc('Type'), width: 160, tooltip: _this.model.loc('TypeTooltip'),
                        margin: '2px ' + mrgn + ' 2px ' + mrgn, items: _this.collections.getExcelTypesItems()
                    });
                    break;
                case 'HtmlType':
                    components.push({
                        name: name, type: 'DropDownListForExportForm', label: _this.model.loc('Type'), width: 160, tooltip: _this.model.loc('TypeTooltip'),
                        margin: '2px ' + mrgn + ' 2px ' + mrgn, items: _this.collections.getHtmlTypesItems()
                    });
                    break;
                case 'Zoom':
                    components.push({
                        name: name, type: 'DropDownListForExportForm', label: _this.model.loc('ZoomHtml'), width: 160, tooltip: _this.model.loc('ZoomHtmlTooltip'),
                        margin: '2px ' + mrgn + ' 2px ' + mrgn, items: _this.collections.getZoomItems()
                    });
                    break;
                case 'ImageZoom':
                    components.push({
                        name: name, type: 'DropDownListForExportForm', label: _this.model.loc('ZoomHtml'), width: 160, tooltip: _this.model.loc('ZoomHtmlTooltip'),
                        margin: '2px ' + mrgn + ' 2px ' + mrgn, items: _this.collections.getZoomItems()
                    });
                    break;
                case 'ImageFormatForHtml':
                    components.push({
                        name: name, type: 'DropDownListForExportForm', label: _this.model.loc('ImageFormatForHtml'), width: 160, tooltip: _this.model.loc('ImageFormatForHtmlTooltip'),
                        margin: '2px ' + mrgn + ' 2px ' + mrgn, items: _this.collections.getImageFormatForHtmlItems()
                    });
                    break;
                case 'ExportMode':
                    components.push({
                        name: name, type: 'DropDownListForExportForm', label: _this.model.loc('ExportMode'), width: 160, tooltip: _this.model.loc('ExportModeTooltip'),
                        margin: '2px ' + mrgn + ' 2px ' + mrgn, items: _this.collections.getExportModeItems()
                    });
                    break;
                case 'CompressToArchive':
                    components.push({
                        name: name, type: 'CheckBox', caption: _this.model.loc('CompressToArchive'), tooltip: _this.model.loc('CompressToArchiveTooltip'),
                        margin: '4px ' + mrgn + ' 4px ' + mrgn
                    });
                    break;
                case 'UseEmbeddedImages':
                    components.push({
                        name: name, type: 'CheckBox', caption: _this.model.loc('EmbeddedImageData'), tooltip: _this.model.loc('EmbeddedImageDataTooltip'),
                        margin: '4px ' + mrgn + ' 4px ' + mrgn
                    });
                    break;
                case 'AddPageBreaks':
                    components.push({
                        name: name, type: 'CheckBox', caption: _this.model.loc('AddPageBreaks'), tooltip: _this.model.loc('AddPageBreaksTooltip'),
                        margin: '4px ' + mrgn + ' 4px ' + mrgn
                    });
                    break;
                case 'ImageResolution':
                    components.push({
                        name: name, type: 'DropDownListForExportForm', label: _this.model.loc('ImageResolution'), width: 160, tooltip: _this.model.loc('ImageResolutionTooltip'),
                        margin: '2px 4px 2px ' + mrgn, items: _this.collections.getImageResolutionItems()
                    });
                    break;
                case 'ImageCompressionMethod':
                    components.push({
                        name: name, type: 'DropDownListForExportForm', label: _this.model.loc('ImageCompressionMethod'), width: 160, tooltip: _this.model.loc('ImageCompressionMethodTooltip'),
                        margin: '2px ' + mrgn + ' 2px ' + mrgn, items: _this.collections.getImageCompressionMethodItems()
                    });
                    break;
                case 'AllowEditable':
                    components.push({
                        name: name, type: 'DropDownListForExportForm', label: _this.model.loc('AllowEditable'), width: 160, tooltip: _this.model.loc('AllowEditableTooltip'),
                        margin: '2px ' + mrgn + ' 2px ' + mrgn, items: _this.collections.getAllowEditableItems()
                    });
                    break;
                case 'ImageQuality':
                    components.push({
                        name: name, type: 'DropDownListForExportForm', label: _this.model.loc('ImageQuality'), width: 160, tooltip: _this.model.loc('ImageQualityTooltip'),
                        margin: '2px 4px 2px ' + mrgn, items: _this.collections.getImageQualityItems()
                    });
                    break;
                case 'ContinuousPages':
                    components.push({
                        name: name, type: 'CheckBox', caption: _this.model.loc('ContinuousPages'), tooltip: _this.model.loc('ContinuousPagesTooltip'),
                        margin: '4px ' + mrgn + ' 4px ' + mrgn
                    });
                    break;
                case 'StandardPdfFonts':
                    components.push({
                        name: name, type: 'CheckBox', caption: _this.model.loc('StandardPDFFonts'), tooltip: _this.model.loc('StandardPDFFontsTooltip'),
                        margin: '4px ' + mrgn + ' 4px ' + mrgn
                    });
                    break;
                case 'EmbeddedFonts':
                    components.push({
                        name: name, type: 'CheckBox', caption: _this.model.loc('EmbeddedFonts'), tooltip: _this.model.loc('EmbeddedFontsTooltip'),
                        margin: '4px ' + mrgn + ' 4px ' + mrgn
                    });
                    break;
                case 'UseUnicode':
                    components.push({
                        name: name, type: 'CheckBox', caption: _this.model.loc('UseUnicode'), tooltip: _this.model.loc('UseUnicodeTooltip'),
                        margin: '4px ' + mrgn + ' 4px ' + mrgn
                    });
                    break;
                case 'Compressed':
                    components.push({
                        name: name, type: 'CheckBox', caption: _this.model.loc('Compressed'), tooltip: _this.model.loc('CompressedTooltip'),
                        margin: '4px ' + mrgn + ' 4px ' + mrgn
                    });
                    break;
                case 'ExportRtfTextAsImage':
                    components.push({
                        name: name, type: 'CheckBox', caption: _this.model.loc('ExportRtfTextAsImage'), tooltip: _this.model.loc('ExportRtfTextAsImageTooltip'),
                        margin: '4px ' + mrgn + ' 4px ' + mrgn
                    });
                    break;
                case 'PdfACompliance':
                    components.push({
                        name: name, type: 'CheckBox', caption: _this.model.loc('PdfACompliance'), tooltip: _this.model.loc('PdfAComplianceTooltip'),
                        margin: '4px ' + mrgn + ' 4px ' + mrgn
                    });
                    break;
                case 'KillSpaceLines':
                    components.push({
                        name: name, type: 'CheckBox', caption: _this.model.loc('KillSpaceLines'), tooltip: _this.model.loc('KillSpaceLinesTooltip'),
                        margin: '4px ' + mrgn + ' 4px ' + mrgn
                    });
                    break;
                case 'PutFeedPageCode':
                    components.push({
                        name: name, type: 'CheckBox', caption: _this.model.loc('PutFeedPageCode'), tooltip: _this.model.loc('PutFeedPageCodeTooltip'),
                        margin: '4px ' + mrgn + ' 4px ' + mrgn
                    });
                    break;
                case 'DrawBorder':
                    components.push({
                        name: name, type: 'CheckBox', caption: _this.model.loc('DrawBorder'), tooltip: _this.model.loc('DrawBorderTooltip'),
                        margin: '4px ' + mrgn + ' 4px ' + mrgn
                    });
                    break;
                case 'CutLongLines':
                    components.push({
                        name: name, type: 'CheckBox', caption: _this.model.loc('CutLongLines'), tooltip: _this.model.loc('CutLongLinesTooltip'),
                        margin: '4px ' + mrgn + ' 4px ' + mrgn
                    });
                    break;
                case 'BorderType':
                    components.push({
                        name: name, type: 'DropDownListForExportForm', label: _this.model.loc('BorderType'), width: 160, tooltip: _this.model.loc('BorderTypeTooltip'),
                        margin: '2px ' + mrgn + ' 2px ' + mrgn, items: _this.collections.getBorderTypeItems()
                    });
                    break;
                case 'ZoomX':
                    components.push({
                        name: name, type: 'DropDownListForExportForm', label: _this.model.loc('ZoomXY').replace(':', '') + ' X ', width: 160, tooltip: _this.model.loc('ZoomXYTooltip'),
                        margin: '2px ' + mrgn + ' 2px ' + mrgn, items: _this.collections.getZoomItems()
                    });
                    break;
                case 'ZoomY':
                    components.push({
                        name: name, type: 'DropDownListForExportForm', label: _this.model.loc('ZoomXY').replace(':', '') + ' Y ', width: 160, tooltip: _this.model.loc('ZoomXYTooltip'),
                        margin: '2px ' + mrgn + ' 2px ' + mrgn, items: _this.collections.getZoomItems()
                    });
                    break;
                case 'EncodingTextOrCsvFile':
                    components.push({
                        name: name, type: 'DropDownListForExportForm', label: _this.model.loc('EncodingData'), width: 160, tooltip: _this.model.loc('EncodingDataTooltip'),
                        margin: '2px ' + mrgn + ' 2px ' + mrgn, items: _this.collections.getEncodingDataItems()
                    });
                    break;
                case 'ImageFormat':
                    components.push({
                        name: name, type: 'DropDownListForExportForm', label: _this.model.loc('ImageFormat'), width: 160, tooltip: _this.model.loc('ImageFormatTooltip'),
                        margin: '2px ' + mrgn + ' 2px ' + mrgn, items: _this.collections.getImageFormatItems()
                    });
                    break;
                case 'DitheringType':
                    components.push({
                        name: name, type: 'DropDownListForExportForm', label: _this.model.loc('MonochromeDitheringType'), width: 160, tooltip: _this.model.loc('MonochromeDitheringTypeTooltip'),
                        margin: '2px ' + mrgn + ' 2px ' + mrgn, items: _this.collections.getMonochromeDitheringTypeItems()
                    });
                    break;
                case 'TiffCompressionScheme':
                    components.push({
                        name: name, type: 'DropDownListForExportForm', label: _this.model.loc('TiffCompressionScheme'), width: 160, tooltip: _this.model.loc('TiffCompressionSchemeTooltip'),
                        margin: '2px ' + mrgn + ' 2px ' + mrgn, items: _this.collections.getTiffCompressionSchemeItems()
                    });
                    break;
                case 'CutEdges':
                    components.push({
                        name: name, type: 'CheckBox', caption: _this.model.loc('CutEdges'), tooltip: _this.model.loc('CutEdgesTooltip'),
                        margin: '4px ' + mrgn + ' 4px ' + mrgn
                    });
                    break;
                case 'MultipleFiles':
                    components.push({
                        name: name, type: 'CheckBox', caption: _this.model.loc('MultipleFiles'), tooltip: _this.model.loc('MultipleFilesTooltip'),
                        margin: '4px ' + mrgn + ' 4px ' + mrgn
                    });
                    break;
                case 'ExportDataOnly':
                    components.push({
                        name: name, type: 'CheckBox', caption: _this.model.loc('ExportDataOnly'), tooltip: _this.model.loc('ExportDataOnlyTooltip'),
                        margin: '4px ' + mrgn + ' 4px ' + mrgn
                    });
                    break;
                case 'UseDefaultSystemEncoding':
                    components.push({
                        name: name, type: 'CheckBox', caption: _this.model.loc('UseDefaultSystemEncoding'), tooltip: _this.model.loc('UseDefaultSystemEncodingTooltip'),
                        margin: '4px ' + mrgn + ' 4px ' + mrgn
                    });
                    break;
                case 'EncodingDifFile':
                    components.push({
                        name: name, type: 'DropDownListForExportForm', label: _this.model.loc('EncodingDifFile'), width: 160, tooltip: _this.model.loc('EncodingDifFileTooltip'),
                        margin: '2px ' + mrgn + ' 2px ' + mrgn, items: _this.collections.getEncodingDifFileItems()
                    });
                    break;
                case 'ExportModeRtf':
                    components.push({
                        name: name, type: 'DropDownListForExportForm', label: _this.model.loc('ExportModeRtf'), width: 160, tooltip: _this.model.loc('ExportModeRtfTooltip'),
                        margin: '2px ' + mrgn + ' 2px ' + mrgn, items: _this.collections.getExportModeRtfItems()
                    });
                    break;
                case 'UsePageHeadersAndFooters':
                    components.push({
                        name: name, type: 'CheckBox', caption: _this.model.loc('UsePageHeadersFooters'), tooltip: _this.model.loc('UsePageHeadersFootersTooltip'),
                        margin: '4px ' + mrgn + ' 4px ' + mrgn
                    });
                    break;
                case 'RemoveEmptySpaceAtBottom':
                    components.push({
                        name: name, type: 'CheckBox', caption: _this.model.loc('RemoveEmptySpace'), tooltip: _this.model.loc('RemoveEmptySpaceTooltip'),
                        margin: '4px ' + mrgn + ' 4px ' + mrgn
                    });
                    break;
                case 'Separator':
                    components.push({
                        name: name, type: 'TextBox', label: _this.model.loc('Separator'), tooltip: _this.model.loc('SeparatorTooltip'), width: 160,
                        margin: '2px ' + mrgn + ' 2px ' + mrgn
                    });
                    break;
                case 'DataExportMode':
                    components.push({
                        name: name, type: 'DropDownListForExportForm', label: _this.model.loc('BandsFilter'), width: 160, tooltip: _this.model.loc('BandsFilterTooltip'),
                        margin: '2px ' + mrgn + ' 2px ' + mrgn, items: _this.collections.getDataExportModeItems()
                    });
                    break;
                case 'SkipColumnHeaders':
                    components.push({
                        name: name, type: 'CheckBox', caption: _this.model.loc('SkipColumnHeaders'), tooltip: _this.model.loc('SkipColumnHeadersTooltip'),
                        margin: '4px ' + mrgn + ' 4px ' + mrgn
                    });
                    break;
                case 'ExportObjectFormatting':
                    components.push({
                        name: name, type: 'CheckBox', caption: _this.model.loc('ExportObjectFormatting'), tooltip: _this.model.loc('ExportObjectFormattingTooltip'),
                        margin: '4px ' + mrgn + ' 4px ' + mrgn
                    });
                    break;
                case 'UseOnePageHeaderAndFooter':
                    components.push({
                        name: name, type: 'CheckBox', caption: _this.model.loc('UseOnePageHeaderFooter'), tooltip: _this.model.loc('UseOnePageHeaderFooterTooltip'),
                        margin: '4px ' + mrgn + ' 4px ' + mrgn
                    });
                    break;
                case 'ExportEachPageToSheet':
                    components.push({
                        name: name, type: 'CheckBox', caption: _this.model.loc('ExportEachPageToSheet'), tooltip: _this.model.loc('ExportEachPageToSheetTooltip'),
                        margin: '4px ' + mrgn + ' 4px ' + mrgn
                    });
                    break;
                case 'ExportPageBreaks':
                    components.push({
                        name: name, type: 'CheckBox', caption: _this.model.loc('ExportPageBreaks'), tooltip: _this.model.loc('ExportPageBreaksTooltip'),
                        margin: '4px ' + mrgn + ' 4px ' + mrgn
                    });
                    break;
                case 'EncodingDbfFile':
                    components.push({
                        name: name, type: 'DropDownListForExportForm', label: _this.model.loc('EncodingDbfFile'), width: 160, tooltip: _this.model.loc('EncodingDbfFileTooltip'),
                        margin: '2px ' + mrgn + ' 2px ' + mrgn, items: _this.collections.getEncodingDbfFileItems()
                    });
                    break;
                case 'DocumentSecurityButton':
                    components.push({
                        name: name, type: 'SmallButton', caption: _this.model.loc('DocumentSecurityButton'), width: 160,
                        margin: '2px ' + mrgn + ' 2px ' + mrgn, items: _this.collections.getEncodingDbfFileItems()
                    });
                    break;
                case 'UseDigitalSignature':
                    components.push({
                        name: name, caption: _this.model.loc('DigitalSignatureButton'), type: 'DropDownListForExportForm', tooltip: _this.model.loc('UseDigitalSignatureTooltip'), width: 160,
                        items: _this.collections.getPdfSecurityCertificatesItems(), margin: '4px ' + mrgn + ' 4px ' + mrgn
                    });
                    break;
                default:
                    break;
            }
        });
        return components;
    };
    ExportService.prototype.getGroups = function (format) {
        var openingGroupsStr = this.helper.getCookie('StimulsoftWebViewerExportSettingsOpeningGroups');
        var openingGroups = openingGroupsStr ? JSON.parse(openingGroupsStr) : null;
        var pageRangeAllIsDisabled = format.indexOf('Image') === 0 && format !== 'ImageTiff';
        return {
            savingReportGroup: { visible: format === 'Document', opened: openingGroups ? openingGroups.SavingReportGroup : true },
            pageRangeGroup: { visible: format !== 'Document', opened: openingGroups ? openingGroups.PageRangeGroup : true, pageRangeAllIsDisabled: pageRangeAllIsDisabled },
            settingsGroup: { visible: format !== 'Document', opened: openingGroups ? openingGroups.SettingsGroup : false }
        };
    };
    ExportService.prototype.getDefaultSettings = function () {
        var settings;
        if (this.model.options.exports.storeExportSettings && this.helper.getCookie('StimulsoftWebViewerExportSettings' + this.getCommonExportFormat())) {
            var exportSettingsStr = this.helper.getCookie('StimulsoftWebViewerExportSettings' + this.getCommonExportFormat());
            var exportSettings_1 = JSON.parse(exportSettingsStr);
            var exportFormat = exportSettings_1.ImageType || exportSettings_1.DataType || exportSettings_1.ExcelType || exportSettings_1.HtmlType;
            if (exportFormat === 'ExcelBinary') {
                exportFormat = 'Excel';
            }
            this.format = exportFormat ? (exportSettings_1.ImageType ? 'Image' + exportFormat : exportFormat) : this.format;
            var defSettings_1 = this.getDefaultExportSettings(this.format);
            var resultSettings_1 = {};
            Object.keys(defSettings_1).forEach(function (key) { return resultSettings_1[key] = exportSettings_1[key] || defSettings_1[key]; });
            Object.keys(exportSettings_1).forEach(function (key) { return resultSettings_1[key] = exportSettings_1[key] || defSettings_1[key]; });
            if (this.model.options.exports.showOpenAfterExport === false) {
                resultSettings_1.OpenAfterExport = true;
            }
            else if (!(this.format === 'Pdf' || this.format === 'Xps' || this.format === 'Html' || this.format === 'Excel' || this.format === 'ExcelBinary')) {
                resultSettings_1.OpenAfterExport = false;
            }
            if (this.model.options.exports.openAfterExport === true || this.model.options.exports.openAfterExport === false) {
                resultSettings_1.OpenAfterExport = this.model.options.exports.openAfterExport;
            }
            settings = resultSettings_1;
        }
        else {
            settings = this.getDefaultExportSettings(this.format);
        }
        this.updateTypes(settings);
        this.exportSettings = this.helper.copyObject(settings);
    };
    ExportService.prototype.updateTypes = function (defaultExportSettings) {
        var _this = this;
        var types = ['ImageType', 'DataType', 'ExcelType', 'HtmlType'];
        types.forEach(function (propertyName) {
            if (defaultExportSettings[propertyName]) {
                switch (propertyName) {
                    case 'ImageType':
                        if (!_this.model.options.exports.showExportToImageBmp && defaultExportSettings[propertyName] === 'Bmp') {
                            defaultExportSettings[propertyName] = 'Gif';
                        }
                        if (!_this.model.options.exports.showExportToImageGif && defaultExportSettings[propertyName] === 'Gif') {
                            defaultExportSettings[propertyName] = 'Jpeg';
                        }
                        if (!_this.model.options.exports.showExportToImageJpeg && defaultExportSettings[propertyName] === 'Jpeg') {
                            defaultExportSettings[propertyName] = 'Pcx';
                        }
                        if (!_this.model.options.exports.showExportToImagePcx && defaultExportSettings[propertyName] === 'Pcx') {
                            defaultExportSettings[propertyName] = 'Png';
                        }
                        if (!_this.model.options.exports.showExportToImagePng && defaultExportSettings[propertyName] === 'Png') {
                            defaultExportSettings[propertyName] = 'Tiff';
                        }
                        if (!_this.model.options.exports.showExportToImageTiff && defaultExportSettings[propertyName] === 'Tiff') {
                            defaultExportSettings[propertyName] = 'Emf';
                        }
                        if (!_this.model.options.exports.showExportToImageMetafile && defaultExportSettings[propertyName] === 'Emf') {
                            defaultExportSettings[propertyName] = 'Svg';
                        }
                        if (!_this.model.options.exports.showExportToImageSvg && defaultExportSettings[propertyName] === 'Svg') {
                            defaultExportSettings[propertyName] = 'Svgz';
                        }
                        if (!_this.model.options.exports.showExportToImageSvgz && defaultExportSettings[propertyName] === 'Svgz') {
                            defaultExportSettings[propertyName] = 'Bmp';
                        }
                        break;
                    case 'DataType':
                        if (!_this.model.options.exports.showExportToCsv && defaultExportSettings[propertyName] === 'Csv') {
                            defaultExportSettings[propertyName] = 'Dbf';
                        }
                        if (!_this.model.options.exports.showExportToDbf && defaultExportSettings[propertyName] === 'Dbf') {
                            defaultExportSettings[propertyName] = 'Xml';
                        }
                        if (!_this.model.options.exports.showExportToXml && defaultExportSettings[propertyName] === 'Xml') {
                            defaultExportSettings[propertyName] = 'Dif';
                        }
                        if (!_this.model.options.exports.showExportToDif && defaultExportSettings[propertyName] === 'Dif') {
                            defaultExportSettings[propertyName] = 'Sylk';
                        }
                        if (!_this.model.options.exports.showExportToSylk && defaultExportSettings[propertyName] === 'Sylk') {
                            defaultExportSettings[propertyName] = 'Csv';
                        }
                        if (!_this.model.options.exports.showExportToJson && defaultExportSettings[propertyName] === 'Json') {
                            defaultExportSettings[propertyName] = 'Json';
                        }
                        break;
                    case 'ExcelType':
                        if (!_this.model.options.exports.showExportToExcel2007 && defaultExportSettings[propertyName] === 'Excel2007') {
                            defaultExportSettings[propertyName] = 'ExcelBinary';
                        }
                        if (!_this.model.options.exports.showExportToExcel && defaultExportSettings[propertyName] === 'ExcelBinary') {
                            defaultExportSettings[propertyName] = 'ExcelXml';
                        }
                        if (!_this.model.options.exports.showExportToExcelXml && defaultExportSettings[propertyName] === 'ExcelXml') {
                            defaultExportSettings[propertyName] = 'Excel2007';
                        }
                        break;
                    case 'HtmlType':
                        if (!_this.model.options.exports.showExportToHtml && defaultExportSettings[propertyName] === 'Html') {
                            defaultExportSettings[propertyName] = 'Html5';
                        }
                        if (!_this.model.options.exports.showExportToHtml5 && defaultExportSettings[propertyName] === 'Html5') {
                            defaultExportSettings[propertyName] = 'Mht';
                        }
                        if (!_this.model.options.exports.showExportToMht && defaultExportSettings[propertyName] === 'Mht') {
                            defaultExportSettings[propertyName] = 'Html';
                        }
                        break;
                }
            }
        });
    };
    ExportService.prototype.getCommonExportFormat = function () {
        if (this.format === 'Html' || this.format === 'Html5' || this.format === 'Mht') {
            return 'Html';
        }
        if (this.format === 'Excel' || this.format === 'Excel2007' || this.format === 'ExcelXml') {
            return 'Excel';
        }
        if (this.format === 'Csv' || this.format === 'Dbf' || this.format === 'Xml' || this.format === 'Dif' || this.format === 'Sylk') {
            return 'Data';
        }
        if (this.format === 'ImageBmp' || this.format === 'ImageGif' || this.format === 'ImageJpeg' || this.format === 'ImagePcx' || this.format === 'ImagePng' ||
            this.format === 'ImageTiff' || this.format === 'ImageEmf' || this.format === 'ImageSvg' || this.format === 'ImageSvgz') {
            return 'Image';
        }
        return this.format;
    };
    ExportService.prototype.getDefaultExportSettings = function (format, isDashboardExport) {
        if (isDashboardExport === void 0) { isDashboardExport = false; }
        var exportSettings = null;
        if (isDashboardExport) {
            return this.model.options.exports.defaultSettings['Dashboard' + format];
        }
        switch (format) {
            case 'Document':
                exportSettings = { Format: 'Mdc' };
                break;
            case 'Pdf':
                exportSettings = this.model.options.exports.defaultSettings['StiPdfExportSettings'];
                break;
            case 'Xps':
                exportSettings = this.model.options.exports.defaultSettings['StiXpsExportSettings'];
                break;
            case 'Ppt2007':
                exportSettings = this.model.options.exports.defaultSettings['StiPpt2007ExportSettings'];
                break;
            case 'Html':
                exportSettings = this.model.options.exports.defaultSettings['StiHtmlExportSettings'];
                exportSettings.HtmlType = 'Html';
                break;
            case 'Html5':
                exportSettings = this.model.options.exports.defaultSettings['StiHtmlExportSettings'];
                exportSettings.HtmlType = 'Html5';
                break;
            case 'Mht':
                exportSettings = this.model.options.exports.defaultSettings['StiHtmlExportSettings'];
                exportSettings.HtmlType = 'Mht';
                break;
            case 'Text':
                exportSettings = this.model.options.exports.defaultSettings['StiTxtExportSettings'];
                break;
            case 'Rtf':
                exportSettings = this.model.options.exports.defaultSettings['StiRtfExportSettings'];
                break;
            case 'Word2007':
                exportSettings = this.model.options.exports.defaultSettings['StiWord2007ExportSettings'];
                break;
            case 'Odt':
                exportSettings = this.model.options.exports.defaultSettings['StiOdtExportSettings'];
                break;
            case 'Excel':
                exportSettings = this.model.options.exports.defaultSettings['StiExcelExportSettings'];
                exportSettings.ExcelType = 'ExcelBinary';
                break;
            case 'ExcelXml':
                exportSettings = this.model.options.exports.defaultSettings['StiExcelExportSettings'];
                exportSettings.ExcelType = 'ExcelXml';
                break;
            case 'Excel2007':
                exportSettings = this.model.options.exports.defaultSettings['StiExcelExportSettings'];
                exportSettings.ExcelType = 'Excel2007';
                break;
            case 'Ods':
                exportSettings = this.model.options.exports.defaultSettings['StiOdsExportSettings'];
                break;
            case 'ImageBmp':
                exportSettings = this.model.options.exports.defaultSettings['StiImageExportSettings'];
                exportSettings.ImageType = 'Bmp';
                break;
            case 'ImageGif':
                exportSettings = this.model.options.exports.defaultSettings['StiImageExportSettings'];
                exportSettings.ImageType = 'Gif';
                break;
            case 'ImageJpeg':
                exportSettings = this.model.options.exports.defaultSettings['StiImageExportSettings'];
                exportSettings.ImageType = 'Jpeg';
                break;
            case 'ImagePcx':
                exportSettings = this.model.options.exports.defaultSettings['StiImageExportSettings'];
                exportSettings.ImageType = 'Pcx';
                break;
            case 'ImagePng':
                exportSettings = this.model.options.exports.defaultSettings['StiImageExportSettings'];
                exportSettings.ImageType = 'Png';
                break;
            case 'ImageTiff':
                exportSettings = this.model.options.exports.defaultSettings['StiImageExportSettings'];
                exportSettings.ImageType = 'Tiff';
                break;
            case 'ImageSvg':
                exportSettings = this.model.options.exports.defaultSettings['StiImageExportSettings'];
                exportSettings.ImageType = 'Svg';
                break;
            case 'ImageSvgz':
                exportSettings = this.model.options.exports.defaultSettings['StiImageExportSettings'];
                exportSettings.ImageType = 'Svgz';
                break;
            case 'ImageEmf':
                exportSettings = this.model.options.exports.defaultSettings['StiImageExportSettings'];
                exportSettings.ImageType = 'Emf';
                break;
            case 'Xml':
                exportSettings = this.model.options.exports.defaultSettings['StiDataExportSettings'];
                exportSettings.DataType = 'Xml';
                break;
            case 'Csv':
                exportSettings = this.model.options.exports.defaultSettings['StiDataExportSettings'];
                exportSettings.DataType = 'Csv';
                break;
            case 'Dbf':
                exportSettings = this.model.options.exports.defaultSettings['StiDataExportSettings'];
                exportSettings.DataType = 'Dbf';
                break;
            case 'Dif':
                exportSettings = this.model.options.exports.defaultSettings['StiDataExportSettings'];
                exportSettings.DataType = 'Dif';
                break;
            case 'Sylk':
                exportSettings = this.model.options.exports.defaultSettings['StiDataExportSettings'];
                exportSettings.DataType = 'Sylk';
                break;
        }
        exportSettings.OpenAfterExport = !(this.model.options.exports.showOpenAfterExport === false);
        if (!(format === 'Pdf' || format === 'Xps' || format === 'Html' || format === 'Excel' || format === 'ExcelBinary')) {
            exportSettings.OpenAfterExport = false;
        }
        return exportSettings;
    };
    ExportService.ctorParameters = function () { return [
        { type: FormService },
        { type: HelperService },
        { type: ModelService },
        { type: CollectionsService },
        { type: ControllerService }
    ]; };
    ExportService = __decorate([
        Injectable()
    ], ExportService);
    return ExportService;
}());

var MailService = /** @class */ (function () {
    function MailService(model, exportService, formService, controller) {
        var _this = this;
        this.model = model;
        this.exportService = exportService;
        this.formService = formService;
        this.controller = controller;
        exportService.getMessage().subscribe(function (event) {
            if (event === 'postMail') {
                _this.postMail();
            }
        });
    }
    MailService.prototype.postMail = function () {
        this.fillDefaults();
        if (this.model.options.email.showEmailDialog) {
            this.formService.showForm('sendEmailForm');
        }
        else {
            this.sendMail();
        }
    };
    MailService.prototype.sendMail = function () {
        var data = {
            exportFormat: this.exportService.format,
            exportSettings: this.exportService.exportSettings
        };
        this.formService.closeForm('sendEmailForm');
        this.controller.post('EmailReport', this.model.options.actions.emailReport, data);
        this.controller.actionSubject.next({ action: 'Email', data: data });
    };
    MailService.prototype.fillDefaults = function () {
        this.exportService.exportSettings.Email = this.model.options.email.defaultEmailAddress;
        this.exportService.exportSettings.Message = this.model.options.email.defaultEmailMessage;
        this.exportService.exportSettings.Subject = this.model.options.email.defaultEmailSubject;
        var ext = this.exportService.format.toLowerCase().replace('image', '');
        switch (ext) {
            case 'excel':
                ext = 'xls';
                break;
            case 'excel2007':
                ext = 'xlsx';
                break;
            case 'excelxml':
                ext = 'xls';
                break;
            case 'html5':
                ext = 'html';
                break;
            case 'jpeg':
                ext = 'jpg';
                break;
            case 'ppt2007':
                ext = 'ppt';
                break;
            case 'text':
                ext = 'txt';
                break;
            case 'word2007':
                ext = 'docx';
                break;
        }
        this.exportService.exportSettings.Attachment = this.model.reportParams.reportFileName + '.' + ext;
    };
    MailService.ctorParameters = function () { return [
        { type: ModelService },
        { type: ExportService },
        { type: FormService },
        { type: ControllerService }
    ]; };
    MailService = __decorate([
        Injectable()
    ], MailService);
    return MailService;
}());

var ApiService = /** @class */ (function () {
    function ApiService(model, controller, exportService, helper, mailService) {
        this.model = model;
        this.controller = controller;
        this.exportService = exportService;
        this.helper = helper;
        this.mailService = mailService;
        this.EXPORT_FORMATS = ['Document', 'Pdf', 'Xps', 'Ppt2007', 'Html', 'Html5', 'Mht', 'Text', 'Rtf', 'Word2007', 'Odt', 'Excel',
            'ExcelBinary', 'ExcelXml', 'Excel2007', 'Ods', 'Csv', 'Dbf', 'Dif', 'Sylk', 'Json', 'Xml', 'ImageBmp',
            'ImageGif', 'ImageJpeg', 'ImagePcx', 'ImagePng', 'ImageTiff', 'ImageEmf', 'ImageSvg', 'ImageSvgz'];
    }
    Object.defineProperty(ApiService.prototype, "currentPage", {
        /**
         * The current page number
         */
        get: function () {
            return this.model.reportParams.pageNumber;
        },
        set: function (value) {
            if (value >= 0 && value < this.model.reportParams.pagesCount) {
                this.model.reportParams.pageNumber = value;
                this.controller.getPages();
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ApiService.prototype, "pageCount", {
        /**
         * The total pages count
         */
        get: function () {
            return this.model.reportParams.pageNumber;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ApiService.prototype, "viewMode", {
        /**
         * The view mode, can be 'SinglePage', 'Continuous' & 'MultiplePages'
         */
        get: function () {
            return this.model.reportParams.viewMode;
        },
        set: function (value) {
            if (value === 'SinglePage' || value === 'Continuous' || value === 'MultiplePages') {
                this.model.reportParams.viewMode = value;
                this.controller.getPages();
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ApiService.prototype, "zoom", {
        /**
         * The page zoom in percent
         * From 1 to 1000
         */
        get: function () {
            return this.model.reportParams.zoom;
        },
        set: function (value) {
            if (value >= 1 && value <= 1000) {
                this.model.reportParams.zoom = value;
                this.controller.getPages();
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * Zoom page in height
     */
    ApiService.prototype.zoomPageHeight = function () {
        this.controller.action({ name: 'ZoomOnePage' });
    };
    /**
     * Zoom page in width
     */
    ApiService.prototype.zoomPageWidth = function () {
        this.controller.action({ name: 'ZoomPageWidth' });
    };
    /**
     * Print to PDF
     */
    ApiService.prototype.printPdf = function () {
        this.controller.action({ name: 'PrintPdf' });
    };
    /**
     * Print with preview
     */
    ApiService.prototype.printWithPreview = function () {
        this.controller.action({ name: 'PrintWithPreview' });
    };
    /**
     * Print without preview
     */
    ApiService.prototype.printWithoutPreview = function () {
        this.controller.action({ name: 'PrintWithoutPreview' });
    };
    /**
     * Show export form
     *
     * @param format The format to export, can be 'Document', 'Pdf', 'Xps', 'Ppt2007', 'Html', 'Html5', 'Mht', 'Text', 'Rtf', 'Word2007', 'Odt', 'Excel',
     * 'ExcelBinary', 'ExcelXml', 'Excel2007', 'Ods', 'Csv', 'Dbf', 'Dif', 'Sylk', 'Json', 'Xml', 'ImageBmp',
     * 'ImageGif', 'ImageJpeg', 'ImagePcx', 'ImagePng', 'ImageTiff', 'ImageEmf', 'ImageSvg', 'ImageSvgz'
     */
    ApiService.prototype.showExportForm = function (format) {
        if (this.EXPORT_FORMATS.some(function (f) { return f === format; })) {
            this.controller.actionSubject.next({ action: 'Export', data: { format: format } });
        }
    };
    /**
     * Show export form & email
     *
     * @param format The format to export, can be 'Document', 'Pdf', 'Xps', 'Ppt2007', 'Html', 'Html5', 'Mht', 'Text', 'Rtf', 'Word2007', 'Odt', 'Excel',
     * 'ExcelBinary', 'ExcelXml', 'Excel2007', 'Ods', 'Csv', 'Dbf', 'Dif', 'Sylk', 'Json', 'Xml', 'ImageBmp',
     * 'ImageGif', 'ImageJpeg', 'ImagePcx', 'ImagePng', 'ImageTiff', 'ImageEmf', 'ImageSvg', 'ImageSvgz'
     */
    ApiService.prototype.showExportEmailForm = function (format) {
        if (this.EXPORT_FORMATS.some(function (f) { return f === format; })) {
            this.controller.actionSubject.next({ action: 'SendEmail', data: { format: format } });
        }
    };
    /**
     * Export report/dashboard to selected format
     * Use default settings if not specified
     *
     * @param format The format to export, can be 'Document', 'Pdf', 'Xps', 'Ppt2007', 'Html', 'Html5', 'Mht', 'Text', 'Rtf', 'Word2007', 'Odt', 'Excel',
     * 'ExcelBinary', 'ExcelXml', 'Excel2007', 'Ods', 'Csv', 'Dbf', 'Dif', 'Sylk', 'Json', 'Xml', 'ImageBmp',
     * 'ImageGif', 'ImageJpeg', 'ImagePcx', 'ImagePng', 'ImageTiff', 'ImageEmf', 'ImageSvg', 'ImageSvgz'
     *
     * @param settings The export settings
     */
    ApiService.prototype.export = function (format, settings) {
        if (this.EXPORT_FORMATS.some(function (f) { return f === format; })) {
            var exportSettings = this.getExportSettings(format, settings);
            this.controller.postExport(format, exportSettings);
        }
    };
    /**
     * Export report/dashboard to seleted format & email
     * Use default settings if not specified
     * Use default email settings if not specified
     *
     * @param format The format to export, can be 'Document', 'Pdf', 'Xps', 'Ppt2007', 'Html', 'Html5', 'Mht', 'Text', 'Rtf', 'Word2007', 'Odt', 'Excel',
     * 'ExcelBinary', 'ExcelXml', 'Excel2007', 'Ods', 'Csv', 'Dbf', 'Dif', 'Sylk', 'Json', 'Xml', 'ImageBmp',
     * 'ImageGif', 'ImageJpeg', 'ImagePcx', 'ImagePng', 'ImageTiff', 'ImageEmf', 'ImageSvg', 'ImageSvgz'
     *
     * @param settings The export settings
     *
     * @param email The email
     *
     * @param message The email message
     *
     * @param subject The email subject
     */
    ApiService.prototype.exportEmail = function (format, settings, email, subject, message) {
        if (this.EXPORT_FORMATS.some(function (f) { return f === format; })) {
            this.exportService.exportSettings = this.getExportSettings(format, settings);
            this.exportService.format = format;
            this.mailService.fillDefaults();
            if (email) {
                this.exportService.exportSettings.Email = email;
            }
            if (message) {
                this.exportService.exportSettings.Message = message;
            }
            if (subject) {
                this.exportService.exportSettings.Subject = subject;
            }
            this.mailService.sendMail();
        }
    };
    ApiService.prototype.getExportSettings = function (format, settings) {
        this.exportService.sendMail = false;
        this.exportService.format = format;
        var exportSettings = this.helper.copyObject(this.exportService.getDefaultExportSettings(format));
        if (settings) {
            Object.keys(settings).forEach(function (key) { return exportSettings[key] = settings[key]; });
        }
        return exportSettings;
    };
    ApiService.ctorParameters = function () { return [
        { type: ModelService },
        { type: ControllerService },
        { type: ExportService },
        { type: HelperService },
        { type: MailService }
    ]; };
    ApiService = __decorate([
        Injectable()
    ], ApiService);
    return ApiService;
}());

var PrintService = /** @class */ (function () {
    function PrintService(model, exportService, helper, httpClient, controller) {
        var _this = this;
        this.model = model;
        this.exportService = exportService;
        this.helper = helper;
        this.httpClient = httpClient;
        this.controller = controller;
        controller.getActionMessage().subscribe(function (message) {
            if (message.action === 'Print') {
                _this.postPrint(message.data.format);
            }
        });
        controller.getMessage().subscribe(function (message) {
            if (message.action === 'PrintReport') {
                switch (message.subAction) {
                    case 'PrintWithPreview':
                        _this.printAsPopup(message.data);
                        break;
                    case 'PrintWithoutPreview':
                        _this.printAsHtml(message.data);
                        break;
                }
            }
        });
    }
    PrintService.prototype.postPrint = function (printAction) {
        if (printAction === 'PrintPdf' && /iPhone|iPad|iPod|Macintosh/i.test(navigator.userAgent) && this.helper.isTouchDevice()) {
            var settings = this.exportService.getDefaultExportSettings('Pdf');
            settings.OpenAfterExport = true;
            this.postExport('Pdf', settings);
            return;
        }
        var data = {
            action: 'PrintReport',
            printAction: printAction,
            bookmarksPrint: this.model.options.appearance.bookmarksPrint
        };
        var url = ''; // this.model.options.requestUrl.replace('{action}', this.model.options.actions.printReport);
        switch (printAction) {
            case 'PrintPdf':
                if (this.model.options.appearance.printToPdfMode === 'Popup' || this.helper.getNavigatorName() == 'Safari' || this.helper.getNavigatorName() == 'iPad') {
                    this.printAsPdfPopup(data);
                }
                else {
                    this.printAsPdf(url, data);
                }
                break;
            default:
                this.controller.post('PrintReport', this.model.options.actions.printReport, data, 'text', printAction);
                break;
        }
    };
    PrintService.prototype.postExport = function (format, settings, elementName, isDashboardExport) {
        var data = {
            action: isDashboardExport ? 'ExportDashboard' : 'ExportReport',
            exportFormat: format,
            exportSettings: settings,
            elementName: elementName
        };
        var doc = settings && settings.OpenAfterExport && this.model.options.appearance.openExportedReportWindow === '_blank' ? this.helper.openNewWindow('about:blank', '_blank').document : null;
        var url = this.model.requestUrl;
        this.httpClient.postForm(url.replace('{action}', this.model.options.actions.exportReport), data, doc);
    };
    PrintService.prototype.printAsPdfPopup = function (data) {
        var url = this.model.requestUrl.replace('{action}', this.model.options.actions.printReport);
        var win = this.helper.openNewWindow('about:blank', '_blank');
        if (win != null) {
            this.httpClient.postForm(url, data, win.document);
        }
    };
    PrintService.prototype.printAsPdf = function (url, data) {
        data.responseType = 'blob';
        var viewer = this.model.controls.viewer.el.nativeElement;
        var printFrameId = this.model.options.viewerId + '_PdfPrintFrame';
        var printFrame = document.getElementById(printFrameId);
        if (printFrame) {
            viewer.removeChild(printFrame);
        }
        printFrame = document.createElement('iframe');
        printFrame.id = printFrameId;
        printFrame.name = printFrameId;
        printFrame.width = '0';
        printFrame.height = '0';
        printFrame.style.position = 'absolute';
        printFrame.style.border = 'none';
        // Firefox does not load the invisible content of the iframe
        if (this.helper.getNavigatorName() === 'Mozilla') {
            printFrame.width = '100px';
            printFrame.height = '100px';
            printFrame.style.visibility = 'hidden';
            printFrame.style.zIndex = '-100';
            printFrame.style.pointerEvents = 'none';
        }
        viewer.insertBefore(printFrame, viewer.firstChild);
        // Manual printing in browsers that do not support automatic PDF printing
        if (this.helper.getNavigatorName() !== 'Mozilla') {
            printFrame.onload = function () {
                printFrame.contentWindow.focus();
                printFrame.contentWindow.print();
            };
        }
        var form = document.createElement('FORM');
        form.setAttribute('id', 'printForm');
        form.setAttribute('method', 'POST');
        form.setAttribute('action', this.model.requestUrl.replace('{action}', this.model.options.actions.printReport));
        form.setAttribute('target', this.model.options.viewerId + '_PdfPrintFrame');
        var params = this.model.createPostParameters(data, true);
        Object.keys(params).forEach(function (key) {
            var paramsField = document.createElement('INPUT');
            paramsField.setAttribute('type', 'hidden');
            paramsField.setAttribute('name', key);
            paramsField.setAttribute('value', params[key]);
            form.appendChild(paramsField);
        });
        document.body.appendChild(form);
        form.submit();
        document.body.removeChild(form);
    };
    PrintService.prototype.printAsPopup = function (text) {
        var width = this.model.reportParams.pagesWidth || 790;
        var win = this.helper.openNewWindow('about:blank', 'PrintReport', 'height=900,width=' + width + ',toolbar=no,menubar=yes,scrollbars=yes,resizable=yes,location=no,directories=no,status=no');
        if (win != null) {
            win.document.open();
            win.document.write(text);
            win.document.close();
        }
    };
    PrintService.prototype.printAsHtml = function (text) {
        if (this.controller.showError(text)) {
            return;
        }
        var viewer = this.model.controls.viewer.el.nativeElement;
        // Remove '_PdfPrintFrame', this should fix IE strange error
        var printFrameId = this.model.options.viewerId + '_PdfPrintFrame';
        var printFrame = document.getElementById(printFrameId);
        if (printFrame) {
            viewer.removeChild(printFrame);
        }
        printFrameId = this.model.options.viewerId + '_HtmlPrintFrame';
        printFrame = document.getElementById(printFrameId);
        if (printFrame) {
            viewer.removeChild(printFrame);
        }
        printFrame = document.createElement('iframe');
        printFrame.id = printFrameId;
        printFrame.name = printFrameId;
        printFrame.width = '0';
        printFrame.height = '0';
        printFrame.style.position = 'absolute';
        printFrame.style.border = 'none';
        viewer.insertBefore(printFrame, viewer.firstChild);
        printFrame.contentWindow.document.open();
        printFrame.contentWindow.document.write(text);
        printFrame.contentWindow.document.close();
        setTimeout(function () {
            printFrame.contentWindow.focus();
            printFrame.contentWindow.print();
        });
    };
    PrintService.ctorParameters = function () { return [
        { type: ModelService },
        { type: ExportService },
        { type: HelperService },
        { type: StiHttpClientService },
        { type: ControllerService }
    ]; };
    PrintService = __decorate([
        Injectable()
    ], PrintService);
    return PrintService;
}());

var DashboardService = /** @class */ (function () {
    function DashboardService(controller, model) {
        var _this = this;
        this.controller = controller;
        this.model = model;
        controller.getMessage().subscribe(function (message) {
            if (message.action === 'GetReport' || message.action === 'OpenReport') {
                setTimeout(function () {
                    if (_this.model.reportParams.autoZoom) {
                    }
                });
            }
        });
    }
    DashboardService.ctorParameters = function () { return [
        { type: ControllerService },
        { type: ModelService }
    ]; };
    DashboardService = __decorate([
        Injectable()
    ], DashboardService);
    return DashboardService;
}());

var TooltipService = /** @class */ (function () {
    function TooltipService(model, menuService) {
        this.model = model;
        this.menuService = menuService;
        this.state = 'initial';
        this.caption = '';
        this.helpLink = '';
        this.top = 0;
        this.left = 0;
        this.innerState = 'initial';
    }
    TooltipService.prototype.show = function (left, top, caption, below, helpLink) {
        var _this = this;
        if (below === void 0) { below = true; }
        if (this.menuService.isMenuVisible() || !this.model.options.appearance.showTooltips) {
            this.hideImmediately();
            return;
        }
        if (this.caption === caption && this.helpLink === helpLink && this.state !== 'initial') {
            this.showInternal();
            return;
        }
        this.caption = caption;
        this.helpLink = helpLink;
        this.state = this.innerState = this.state !== 'expanded' ? 'preInitial' : 'preInitial2';
        setTimeout(function () {
            var tooltip = _this.model.controls.tooltip.el.nativeElement;
            var browserWidth = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;
            if (!below) {
                top -= tooltip.offsetHeight;
            }
            if (left + tooltip.offsetWidth > browserWidth) {
                left = browserWidth - tooltip.offsetWidth;
            }
            _this.left = left;
            _this.top = top;
            if (_this.innerState !== 'initial') {
                _this.showInternal();
            }
        });
    };
    TooltipService.prototype.showInternal = function () {
        this.state = 'expanded';
        this.innerState = 'expanded';
    };
    TooltipService.prototype.showFromTooltip = function () {
        if (this.state !== 'preInitial') {
            this.state = 'expanded';
            this.innerState = 'expanded';
        }
    };
    TooltipService.prototype.hideImmediately = function () {
        this.innerState = 'initial';
        this.state = 'initial';
    };
    TooltipService.prototype.hide = function () {
        var _this = this;
        this.innerState = 'initial';
        if (this.timeout) {
            clearTimeout(this.timeout);
        }
        this.timeout = setTimeout(function () {
            if (_this.innerState === 'initial') {
                _this.state = 'initial';
            }
            _this.timeout = null;
        }, 1000);
    };
    TooltipService.ctorParameters = function () { return [
        { type: ModelService },
        { type: MenuService }
    ]; };
    TooltipService = __decorate([
        Injectable()
    ], TooltipService);
    return TooltipService;
}());

var FindService = /** @class */ (function () {
    function FindService(model, helper, animationService) {
        var _this = this;
        this.model = model;
        this.helper = helper;
        this.animationService = animationService;
        this.symbols = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz1234567890';
        this.findLabels = [];
        this.text = '';
        this.lastFindText = '';
        this.matchCase = false;
        this.matchWholeWord = false;
        this.findMode = false;
        model.controls.findPanel.getVisibility().subscribe(function (value) {
            if (!value) {
                _this.hideFindLabels();
                _this.lastFindText = '';
            }
        });
    }
    FindService.prototype.hideFindLabels = function () {
        this.findLabels.forEach(function (findLabel) {
            var parentElement = findLabel.parentElement;
            parentElement.removeChild(findLabel);
            if (parentElement.oldPositionStyle) {
                parentElement.style.position = parentElement.oldPositionStyle;
            }
        });
        this.findLabels = [];
        this.findMode = false;
        this.lastFindText = '';
    };
    FindService.prototype.selectFindLabel = function (direction) {
        if (this.findLabels.length === 0) {
            return;
        }
        var selectedIndex = 0;
        var labels = this.findLabels;
        for (var i = 0; i < labels.length; i++) {
            if (labels[i].isSelected) {
                labels[i].setSelected(false);
                selectedIndex = i;
                break;
            }
        }
        if (direction === 'Next') {
            selectedIndex++;
            if (selectedIndex > labels.length - 1) {
                selectedIndex = 0;
            }
        }
        else {
            selectedIndex--;
            if (selectedIndex < 0) {
                selectedIndex = labels.length - 1;
            }
        }
        labels[selectedIndex].setSelected(true);
        this.goToFindedElement(labels[selectedIndex]);
    };
    FindService.prototype.showFindLabels = function () {
        var _this = this;
        this.hideFindLabels();
        this.findMode = true;
        this.lastFindText = this.text;
        var text = this.matchCase ? this.text : this.text.toLowerCase();
        this.model.pages.forEach(function (page) {
            var e_1, _a;
            var pageElements = page.page.getElementsByTagName('*');
            try {
                for (var pageElements_1 = __values(pageElements), pageElements_1_1 = pageElements_1.next(); !pageElements_1_1.done; pageElements_1_1 = pageElements_1.next()) {
                    var pageElement = pageElements_1_1.value;
                    var innerText = pageElement.innerHTML;
                    if (innerText && pageElement.childNodes.length === 1 && pageElement.childNodes[0].nodeName === '#text') {
                        if (!_this.matchCase) {
                            innerText = innerText.toLowerCase();
                        }
                        if (innerText.indexOf(text) >= 0) {
                            if (_this.matchWholeWord && !_this.isWholeWord(innerText, text)) {
                                continue;
                            }
                            var label = document.createElement('div');
                            label.ownerElement = pageElement;
                            label.className = 'stiJsViewerFindLabel';
                            label.style.width = (pageElement.offsetWidth - 4) + 'px';
                            var labelHeight = pageElement.offsetHeight - 4;
                            label.style.height = labelHeight + 'px';
                            label.style.top = '0px';
                            label.style.left = '0px';
                            label.ownerElement.oldPositionStyle = label.ownerElement.style.position;
                            if (label.ownerElement.style.position !== 'absolute' && label.ownerElement.style.position !== 'fixed') {
                                label.ownerElement.style.position = 'relative';
                            }
                            pageElement.insertBefore(label, pageElement.childNodes[0]);
                            label.setSelected = function (state) {
                                this.isSelected = state;
                                this.style.border = '2px solid ' + (state ? 'red' : '#8a8a8a');
                            };
                            if (_this.findLabels.length === 0) {
                                label.setSelected(true);
                            }
                            _this.findLabels.push(label);
                        }
                    }
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (pageElements_1_1 && !pageElements_1_1.done && (_a = pageElements_1.return)) _a.call(pageElements_1);
                }
                finally { if (e_1) throw e_1.error; }
            }
        });
        if (this.findLabels.length > 0) {
            this.goToFindedElement(this.findLabels[0]);
        }
    };
    FindService.prototype.goToFindedElement = function (findLabel) {
        if (findLabel && findLabel.ownerElement) {
            var targetTop = this.helper.findPosY(findLabel.ownerElement, this.model.options.appearance.scrollbarsMode ? 'stiJsViewerReportPanel' : null, true) - findLabel.ownerElement.offsetHeight - 50;
            var d = new Date();
            var endTime = d.getTime() + this.model.options.scrollDuration;
            this.animationService.showAnimationForScroll(this.model.controls.reportPanel.el.nativeElement, targetTop, endTime, function () { });
        }
    };
    FindService.prototype.isWholeWord = function (str, word) {
        var index = str.indexOf(word);
        var preSymbol = str.substring(index - 1, index);
        var nextSymbol = str.substring(index + word.length, index + word.length + 1);
        return ((preSymbol === '' || this.symbols.indexOf(preSymbol) === -1) && (nextSymbol === '' || this.symbols.indexOf(nextSymbol) === -1));
    };
    FindService.ctorParameters = function () { return [
        { type: ModelService },
        { type: HelperService },
        { type: AnimationService }
    ]; };
    FindService = __decorate([
        Injectable()
    ], FindService);
    return FindService;
}());

var Md5Service = /** @class */ (function () {
    function Md5Service() {
        this.hexcase = 0;
    }
    Md5Service.prototype.hex_md5 = function (a) { return this.rstr2hex(this.rstr_md5(this.str2rstr_utf8(a))); };
    Md5Service.prototype.hex_hmac_md5 = function (a, b) { return this.rstr2hex(this.rstr_hmac_md5(this.str2rstr_utf8(a), this.str2rstr_utf8(b))); };
    Md5Service.prototype.md5_vm_test = function () { return this.hex_md5('abc').toLowerCase() == '900150983cd24fb0d6963f7d28e17f72'; };
    Md5Service.prototype.rstr_md5 = function (a) { return this.binl2rstr(this.binl_md5(this.rstr2binl(a), a.length * 8)); };
    Md5Service.prototype.rstr_hmac_md5 = function (c, f) {
        var e = this.rstr2binl(c);
        if (e.length > 16) {
            e = this.binl_md5(e, c.length * 8);
        }
        var a = Array(16), d = Array(16);
        for (var b = 0; b < 16; b++) {
            a[b] = e[b] ^ 909522486;
            d[b] = e[b] ^ 1549556828;
        }
        var g = this.binl_md5(a.concat(this.rstr2binl(f)), 512 + f.length * 8);
        return this.binl2rstr(this.binl_md5(d.concat(g), 512 + 128));
    };
    Md5Service.prototype.rstr2hex = function (c) { try {
        this.hexcase;
    }
    catch (g) {
        this.hexcase = 0;
    } var f = this.hexcase ? '0123456789ABCDEF' : '0123456789abcdef'; var b = ''; var a; for (var d = 0; d < c.length; d++) {
        a = c.charCodeAt(d);
        b += f.charAt((a >>> 4) & 15) + f.charAt(a & 15);
    } return b; };
    Md5Service.prototype.str2rstr_utf8 = function (c) { var b = ''; var d = -1; var a, e; while (++d < c.length) {
        a = c.charCodeAt(d);
        e = d + 1 < c.length ? c.charCodeAt(d + 1) : 0;
        if (55296 <= a && a <= 56319 && 56320 <= e && e <= 57343) {
            a = 65536 + ((a & 1023) << 10) + (e & 1023);
            d++;
        }
        if (a <= 127) {
            b += String.fromCharCode(a);
        }
        else {
            if (a <= 2047) {
                b += String.fromCharCode(192 | ((a >>> 6) & 31), 128 | (a & 63));
            }
            else {
                if (a <= 65535) {
                    b += String.fromCharCode(224 | ((a >>> 12) & 15), 128 | ((a >>> 6) & 63), 128 | (a & 63));
                }
                else {
                    if (a <= 2097151) {
                        b += String.fromCharCode(240 | ((a >>> 18) & 7), 128 | ((a >>> 12) & 63), 128 | ((a >>> 6) & 63), 128 | (a & 63));
                    }
                }
            }
        }
    } return b; };
    Md5Service.prototype.rstr2binl = function (b) { var a = Array(b.length >> 2); for (var c = 0; c < a.length; c++) {
        a[c] = 0;
    } for (var c = 0; c < b.length * 8; c += 8) {
        a[c >> 5] |= (b.charCodeAt(c / 8) & 255) << (c % 32);
    } return a; };
    Md5Service.prototype.binl2rstr = function (b) { var a = ''; for (var c = 0; c < b.length * 32; c += 8) {
        a += String.fromCharCode((b[c >> 5] >>> (c % 32)) & 255);
    } return a; };
    Md5Service.prototype.binl_md5 = function (p, k) { p[k >> 5] |= 128 << ((k) % 32); p[(((k + 64) >>> 9) << 4) + 14] = k; var o = 1732584193; var n = -271733879; var m = -1732584194; var l = 271733878; for (var g = 0; g < p.length; g += 16) {
        var j = o;
        var h = n;
        var f = m;
        var e = l;
        o = this.md5_ff(o, n, m, l, p[g + 0], 7, -680876936);
        l = this.md5_ff(l, o, n, m, p[g + 1], 12, -389564586);
        m = this.md5_ff(m, l, o, n, p[g + 2], 17, 606105819);
        n = this.md5_ff(n, m, l, o, p[g + 3], 22, -1044525330);
        o = this.md5_ff(o, n, m, l, p[g + 4], 7, -176418897);
        l = this.md5_ff(l, o, n, m, p[g + 5], 12, 1200080426);
        m = this.md5_ff(m, l, o, n, p[g + 6], 17, -1473231341);
        n = this.md5_ff(n, m, l, o, p[g + 7], 22, -45705983);
        o = this.md5_ff(o, n, m, l, p[g + 8], 7, 1770035416);
        l = this.md5_ff(l, o, n, m, p[g + 9], 12, -1958414417);
        m = this.md5_ff(m, l, o, n, p[g + 10], 17, -42063);
        n = this.md5_ff(n, m, l, o, p[g + 11], 22, -1990404162);
        o = this.md5_ff(o, n, m, l, p[g + 12], 7, 1804603682);
        l = this.md5_ff(l, o, n, m, p[g + 13], 12, -40341101);
        m = this.md5_ff(m, l, o, n, p[g + 14], 17, -1502002290);
        n = this.md5_ff(n, m, l, o, p[g + 15], 22, 1236535329);
        o = this.md5_gg(o, n, m, l, p[g + 1], 5, -165796510);
        l = this.md5_gg(l, o, n, m, p[g + 6], 9, -1069501632);
        m = this.md5_gg(m, l, o, n, p[g + 11], 14, 643717713);
        n = this.md5_gg(n, m, l, o, p[g + 0], 20, -373897302);
        o = this.md5_gg(o, n, m, l, p[g + 5], 5, -701558691);
        l = this.md5_gg(l, o, n, m, p[g + 10], 9, 38016083);
        m = this.md5_gg(m, l, o, n, p[g + 15], 14, -660478335);
        n = this.md5_gg(n, m, l, o, p[g + 4], 20, -405537848);
        o = this.md5_gg(o, n, m, l, p[g + 9], 5, 568446438);
        l = this.md5_gg(l, o, n, m, p[g + 14], 9, -1019803690);
        m = this.md5_gg(m, l, o, n, p[g + 3], 14, -187363961);
        n = this.md5_gg(n, m, l, o, p[g + 8], 20, 1163531501);
        o = this.md5_gg(o, n, m, l, p[g + 13], 5, -1444681467);
        l = this.md5_gg(l, o, n, m, p[g + 2], 9, -51403784);
        m = this.md5_gg(m, l, o, n, p[g + 7], 14, 1735328473);
        n = this.md5_gg(n, m, l, o, p[g + 12], 20, -1926607734);
        o = this.md5_hh(o, n, m, l, p[g + 5], 4, -378558);
        l = this.md5_hh(l, o, n, m, p[g + 8], 11, -2022574463);
        m = this.md5_hh(m, l, o, n, p[g + 11], 16, 1839030562);
        n = this.md5_hh(n, m, l, o, p[g + 14], 23, -35309556);
        o = this.md5_hh(o, n, m, l, p[g + 1], 4, -1530992060);
        l = this.md5_hh(l, o, n, m, p[g + 4], 11, 1272893353);
        m = this.md5_hh(m, l, o, n, p[g + 7], 16, -155497632);
        n = this.md5_hh(n, m, l, o, p[g + 10], 23, -1094730640);
        o = this.md5_hh(o, n, m, l, p[g + 13], 4, 681279174);
        l = this.md5_hh(l, o, n, m, p[g + 0], 11, -358537222);
        m = this.md5_hh(m, l, o, n, p[g + 3], 16, -722521979);
        n = this.md5_hh(n, m, l, o, p[g + 6], 23, 76029189);
        o = this.md5_hh(o, n, m, l, p[g + 9], 4, -640364487);
        l = this.md5_hh(l, o, n, m, p[g + 12], 11, -421815835);
        m = this.md5_hh(m, l, o, n, p[g + 15], 16, 530742520);
        n = this.md5_hh(n, m, l, o, p[g + 2], 23, -995338651);
        o = this.md5_ii(o, n, m, l, p[g + 0], 6, -198630844);
        l = this.md5_ii(l, o, n, m, p[g + 7], 10, 1126891415);
        m = this.md5_ii(m, l, o, n, p[g + 14], 15, -1416354905);
        n = this.md5_ii(n, m, l, o, p[g + 5], 21, -57434055);
        o = this.md5_ii(o, n, m, l, p[g + 12], 6, 1700485571);
        l = this.md5_ii(l, o, n, m, p[g + 3], 10, -1894986606);
        m = this.md5_ii(m, l, o, n, p[g + 10], 15, -1051523);
        n = this.md5_ii(n, m, l, o, p[g + 1], 21, -2054922799);
        o = this.md5_ii(o, n, m, l, p[g + 8], 6, 1873313359);
        l = this.md5_ii(l, o, n, m, p[g + 15], 10, -30611744);
        m = this.md5_ii(m, l, o, n, p[g + 6], 15, -1560198380);
        n = this.md5_ii(n, m, l, o, p[g + 13], 21, 1309151649);
        o = this.md5_ii(o, n, m, l, p[g + 4], 6, -145523070);
        l = this.md5_ii(l, o, n, m, p[g + 11], 10, -1120210379);
        m = this.md5_ii(m, l, o, n, p[g + 2], 15, 718787259);
        n = this.md5_ii(n, m, l, o, p[g + 9], 21, -343485551);
        o = this.safe_add(o, j);
        n = this.safe_add(n, h);
        m = this.safe_add(m, f);
        l = this.safe_add(l, e);
    } return Array(o, n, m, l); };
    Md5Service.prototype.md5_cmn = function (h, e, d, c, g, f) { return this.safe_add(this.bit_rol(this.safe_add(this.safe_add(e, h), this.safe_add(c, f)), g), d); };
    Md5Service.prototype.md5_ff = function (g, f, k, j, e, i, h) { return this.md5_cmn((f & k) | ((~f) & j), g, f, e, i, h); };
    Md5Service.prototype.md5_gg = function (g, f, k, j, e, i, h) { return this.md5_cmn((f & j) | (k & (~j)), g, f, e, i, h); };
    Md5Service.prototype.md5_hh = function (g, f, k, j, e, i, h) { return this.md5_cmn(f ^ k ^ j, g, f, e, i, h); };
    Md5Service.prototype.md5_ii = function (g, f, k, j, e, i, h) { return this.md5_cmn(k ^ (f | (~j)), g, f, e, i, h); };
    Md5Service.prototype.safe_add = function (a, d) { var c = (a & 65535) + (d & 65535); var b = (a >> 16) + (d >> 16) + (c >> 16); return (b << 16) | (c & 65535); };
    Md5Service.prototype.bit_rol = function (a, b) { return (a << b) | (a >>> (32 - b)); };
    ;
    Md5Service = __decorate([
        Injectable()
    ], Md5Service);
    return Md5Service;
}());

var DrillDownService = /** @class */ (function () {
    function DrillDownService(controller, model, helper) {
        var _this = this;
        this.controller = controller;
        this.model = model;
        this.helper = helper;
        controller.getMessage().subscribe(function (message) {
            if (message.action !== 'InitVars' && message.action !== 'viewer_loaded') {
                _this.model.options.drillDownInProgress = false;
                var parameters = message.data;
                if (_this.model.drillDownButtons.length === 0) {
                    _this.addButton(parameters.reportFileName, {});
                }
                if (message.action === 'DrillDown') {
                    var useDbsDrillDownPanel = false; // jsObject.controls.dashboardsPanel && jsObject.controls.dashboardsPanel.visible && jsObject.controls.dashboardsPanel.selectedButton;
                    if (useDbsDrillDownPanel) {
                        // jsObject.controls.dashboardsPanel.addDrillDownButton(null, parameters.drillDownGuid, parameters.drillDownParameters, parameters.previewSettings, parameters.reportFileName);
                    }
                    _this.showDrillDownPage(parameters.reportFileName, parameters.drillDownGuid, parameters.drillDownParameters, useDbsDrillDownPanel);
                }
            }
        });
    }
    DrillDownService.prototype.showDrillDownPage = function (reportFileName, drillDownGuid, drillDownParameters, useDbsDrillDownPanel) {
        var _this = this;
        if (useDbsDrillDownPanel) {
            return;
        }
        var buttonExist = false;
        this.model.drillDownButtons.forEach(function (b) {
            if (b.reportParams.drillDownGuid === drillDownGuid) {
                _this.model.drillDownButtons.forEach(function (bt) { return bt.selected = false; });
                buttonExist = b.selected = b.visible = true;
            }
        });
        if (!buttonExist) {
            this.addButton(reportFileName);
            this.model.reportParams.drillDownParameters = drillDownParameters;
            this.model.reportParams.pageNumber = 0;
            this.model.reportParams.pagesWidth = 0;
            this.model.reportParams.pagesHeight = 0;
        }
    };
    DrillDownService.prototype.addButton = function (caption, reportParams) {
        if (reportParams === void 0) { reportParams = {}; }
        this.model.drillDownButtons.forEach(function (b) { return b.selected = false; });
        this.model.drillDownButtons.push({ caption: caption, selected: true, reportParams: reportParams, visible: true });
        this.updateVisibility();
    };
    DrillDownService.prototype.updateVisibility = function () {
        this.model.controls.drillDownPanel.visible = this.model.drillDownButtons.length > 1;
    };
    DrillDownService.prototype.saveState = function () {
        var sButton = this.model.drillDownButtons.find(function (b) { return b.selected; });
        if (sButton) {
            sButton.reportParams = this.model.getReportParams();
        }
    };
    DrillDownService.ctorParameters = function () { return [
        { type: ControllerService },
        { type: ModelService },
        { type: HelperService }
    ]; };
    DrillDownService = __decorate([
        Injectable()
    ], DrillDownService);
    return DrillDownService;
}());

var InteractionsService = /** @class */ (function () {
    function InteractionsService(model, md5, controller, helper, drillDownService) {
        var _this = this;
        this.model = model;
        this.md5 = md5;
        this.controller = controller;
        this.helper = helper;
        this.drillDownService = drillDownService;
        controller.getMessage().subscribe(function (message) {
            if (message.action === 'InitVars') {
                _this.showParametersPanel(message.data);
            }
        });
        controller.getActionMessage().subscribe(function (message) {
            switch (message.action) {
                case 'Variables':
                    _this.postInteraction({ action: 'Variables', variables: _this.getParametersValues() });
                    break;
                case 'Reset':
                    _this.showParametersPanel(_this.model.options.paramsVariables);
                    break;
                default:
                    break;
            }
        });
    }
    InteractionsService.prototype.postInteraction = function (params) {
        this.drillDownService.saveState();
        // Add new drill-down parameters to drill-down queue and calc guid
        if (params.action !== 'InitVars' && (params.action === 'DrillDown' || params.action === 'DashboardDrillDown')) {
            if (this.model.options.drillDownInProgress) {
                return;
            }
            if (params.action === 'DashboardDrillDown' && params.drillDownParameters) {
                params.drillDownParameters.isDashboardDrillDown = true; // add dbs flag
            }
            var drillDownParameters = this.model.reportParams.drillDownParameters || [];
            params.drillDownParameters = params.drillDownParameters ? drillDownParameters.concat(params.drillDownParameters) : drillDownParameters;
            if (params.action === 'DrillDown') {
                params.drillDownGuid = this.md5.hex_md5(JSON.stringify(this.sortPropsInDrillDownParameters(params.drillDownParameters)));
            }
            else {
                params.dashboardDrillDownGuid = this.md5.hex_md5(JSON.stringify(this.sortPropsInDrillDownParameters(params.drillDownParameters)));
            }
            this.model.options.drillDownInProgress = true;
        }
        this.controller.post(params.action, this.model.options.actions.interaction, params);
    };
    InteractionsService.prototype.showParametersPanel = function (data) {
        if (!data) {
            return;
        }
        if (this.controller.showError(data)) {
            data = null;
        }
        this.model.options.isParametersReceived = true;
        this.model.options.paramsVariables = typeof data === 'string' ? JSON.parse(data) : data;
        this.model.controls.parametersPanel.visible = !this.model.options.isMobileDevice;
        // if (this.model.reportParams.type === 'Dashboard') jsObject.postAction('GetPages');
        var paramsVariables = this.helper.copyObject(this.model.options.paramsVariables);
        var countParameters = this.helper.getCountObjects(paramsVariables);
        var countColumns = (countParameters <= this.model.options.minParametersCountForMultiColumns)
            ? 1 : this.model.options.appearance.parametersPanelColumnsCount;
        var countInColumn = Math.trunc(countParameters / countColumns);
        if (countInColumn * countColumns < countParameters) {
            countInColumn++;
        }
        // setup lists
        for (var i = 0; i < countParameters; i++) {
            var variable = paramsVariables[i];
            if (variable.items) {
                variable.items.forEach(function (v) {
                    v.isChecked = true;
                    v.visible = true;
                });
            }
            variable.isNull = (variable.type === 'DateTime' && variable.value === null && variable.basicType === 'NullableValue');
        }
        this.model.interactions = { paramsVariables: paramsVariables, countColumns: new Array(countColumns), countInColumn: new Array(countInColumn) };
    };
    InteractionsService.prototype.sortPropsInDrillDownParameters = function (inArray) {
        if (!inArray || !inArray.length) {
            return inArray;
        }
        var outArray = [];
        var _loop_1 = function (i) {
            var propNames = [];
            var el = inArray[i];
            var copyEl = {};
            Object.keys(el).forEach(function (p) {
                if (el.hasOwnProperty(p)) {
                    propNames.push(p);
                }
            });
            propNames.sort();
            propNames.forEach(function (propName) { return copyEl[propName] = el[propName]; });
            outArray[i] = copyEl;
        };
        for (var i = 0; i < inArray.length; i++) {
            _loop_1(i);
        }
        return outArray;
    };
    InteractionsService.prototype.getParametersValues = function () {
        var _this = this;
        var parametersValues = {};
        Object.keys(this.model.interactions.paramsVariables).forEach(function (i) {
            var parameter = _this.model.interactions.paramsVariables[i];
            parametersValues[parameter.name] = _this.getVariableValue(parameter);
        });
        return parametersValues;
    };
    InteractionsService.prototype.getVariableValue = function (parameter) {
        var _this = this;
        if (parameter.isNull) {
            return null;
        }
        switch (parameter.basicType) {
            case 'Value':
            case 'NullableValue':
                return this.val(parameter.key, parameter, parameter.allowUserValues ? parameter.value : parameter.key);
            case 'Range':
                return { from: this.val(parameter.key, parameter), to: this.val(parameter.keyTo, parameter) };
            case 'List':
                var value_1 = [];
                if (parameter.items) {
                    parameter.items.filter(function (i) { return parameter.allowUserValues || i.isChecked; }).forEach(function (item) { return value_1.push(_this.val(item.key, parameter)); });
                }
                return value_1;
        }
    };
    InteractionsService.prototype.val = function (key, parameter, value) {
        return parameter.type === 'DateTime' ? this.helper.getStringDateTime(key, parameter.dateTimeType) : (value === undefined ? key : value);
    };
    InteractionsService.prototype.initializeInteractions = function (page) {
        var e_1, _a;
        var _this = this;
        if (!page) {
            return;
        }
        var elems = page.querySelectorAll ? page.querySelectorAll('td,div,span,rect,path,ellipse') : page.getElementsByTagName('td');
        var collapsedHash = [];
        var _loop_2 = function (elem) {
            if (elem.getAttribute('interaction') && (elem.getAttribute('pageguid') ||
                elem.getAttribute('reportfile') ||
                elem.getAttribute('collapsed') ||
                elem.getAttribute('databandsort'))) {
                elem.style.cursor = 'pointer';
                var sort = elem.getAttribute('sort');
                if (sort) {
                    this_1.paintSortingArrow(elem, sort);
                }
                var collapsed = elem.getAttribute('collapsed');
                if (collapsed) {
                    var compId = elem.getAttribute('compindex') + '|' + elem.getAttribute('interaction');
                    if (collapsedHash.indexOf(compId) < 0) {
                        this_1.paintCollapsingIcon(elem, collapsed === 'true');
                        collapsedHash.push(compId);
                    }
                }
                elem.onclick = function (e) {
                    if (elem.getAttribute('pageguid') || elem.getAttribute('reportfile')) {
                        _this.postInteractionDrillDown(elem);
                    }
                    else if (elem.getAttribute('collapsed')) {
                        _this.postInteractionCollapsing(elem);
                    }
                    else {
                        _this.postInteractionSorting(elem, e.ctrlKey);
                    }
                };
                if (elem.getAttribute('pageguid') || elem.getAttribute('reportfile')) {
                    elem.onmouseover = function () { return elem.style.opacity = 0.75; };
                    elem.onmouseout = function () { return elem.style.opacity = 1; };
                }
            }
        };
        var this_1 = this;
        try {
            for (var elems_1 = __values(elems), elems_1_1 = elems_1.next(); !elems_1_1.done; elems_1_1 = elems_1.next()) {
                var elem = elems_1_1.value;
                _loop_2(elem);
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (elems_1_1 && !elems_1_1.done && (_a = elems_1.return)) _a.call(elems_1);
            }
            finally { if (e_1) throw e_1.error; }
        }
    };
    InteractionsService.prototype.getComponentOffset = function (component) {
        var offsetX = 0;
        var offsetY = 0;
        var startComponent = component;
        while (component && !isNaN(component.offsetLeft) && !isNaN(component.offsetTop)
            && (component === startComponent || component.style.position === '' || component.style.position === 'static')) {
            offsetX += component.offsetLeft - component.scrollLeft;
            offsetY += component.offsetTop - component.scrollTop;
            component = component.offsetParent;
        }
        return { top: offsetY, left: offsetX };
    };
    InteractionsService.prototype.paintSortingArrow = function (component, sort) {
        if (component.arrowImg) {
            return;
        }
        var arrowImg = document.createElement("div");
        var sortUpSrc = "<svg xmlns='http://www.w3.org/2000/svg' width='12' height='12'><path d='M1 9l5-4 5 4z' fill='#eeeeee' stroke='#666'/></svg>";
        var sortDownSrc = "<svg xmlns='http://www.w3.org/2000/svg' width='12' height='12'><path d='M1 5l5 4 5-4z' fill='#eeeeee' stroke='#666'/></svg>";
        arrowImg.innerHTML = sort == "asc" ? sortDownSrc : sortUpSrc;
        var arrowWidth = (this.model.reportParams.zoom / 100) * 16;
        var arrowHeight = (this.model.reportParams.zoom / 100) * 16;
        arrowImg.style.position = 'absolute';
        arrowImg.style.width = arrowWidth + 'px';
        arrowImg.style.height = arrowHeight + 'px';
        component.appendChild(arrowImg);
        component.arrowImg = arrowImg;
        var oldPosition = component.style.position;
        var oldClassName = component.className;
        component.style.position = 'relative';
        if (!oldClassName) {
            component.className = 'stiSortingParentElement';
        }
        var arrowLeftPos = this.helper.findPosX(arrowImg, component.className);
        var arrowTopPos = this.helper.findPosY(arrowImg, component.className);
        arrowImg.style.marginLeft = (component.offsetWidth - arrowLeftPos - arrowWidth - ((this.model.reportParams.zoom / 100) * 3)) + 'px';
        arrowImg.style.marginTop = (component.offsetHeight / 2 - arrowHeight / 2 - arrowTopPos) + 'px';
        if (oldPosition)
            component.style.position = oldPosition;
        component.className = oldClassName;
    };
    InteractionsService.prototype.paintCollapsingIcon = function (component, collapsed) {
        if (component.collapsImg) {
            return;
        }
        var collapsImg = document.createElement('img');
        collapsImg.src = collapsed ? this.model.img('CollapsingPlus.png') : this.model.img('CollapsingMinus.png');
        collapsImg.style.position = 'absolute';
        var collapsWidth = (this.model.reportParams.zoom / 100) * 10;
        var collapsHeight = (this.model.reportParams.zoom / 100) * 10;
        collapsImg.style.width = collapsWidth + 'px';
        collapsImg.style.height = collapsHeight + 'px';
        component.appendChild(collapsImg);
        component.collapsImg = collapsImg;
        var componentOffset = this.getComponentOffset(component);
        var collapsOffset = this.getComponentOffset(collapsImg);
        collapsImg.style.marginLeft = (componentOffset.left - collapsOffset.left + collapsWidth / 3) + 'px';
        collapsImg.style.marginTop = (componentOffset.top - collapsOffset.top + collapsWidth / 3) + 'px';
    };
    InteractionsService.prototype.postInteractionSorting = function (component, isCtrl) {
        var params = {
            action: 'Sorting',
            sortingParameters: {
                ComponentName: component.getAttribute('interaction') + ';' + isCtrl.toString(),
                DataBand: component.getAttribute('databandsort')
            }
        };
        if (this.model.options.isParametersReceived) {
            params.variables = this.getParametersValues();
        }
        this.postInteraction(params);
    };
    InteractionsService.prototype.postInteractionDrillDown = function (component) {
        var params = {
            action: 'DrillDown',
            drillDownParameters: {
                ComponentIndex: component.getAttribute('compindex'),
                ElementIndex: component.getAttribute('elementindex'),
                PageIndex: component.getAttribute('pageindex'),
                PageGuid: component.getAttribute('pageguid'),
                ReportFile: component.getAttribute('reportfile')
            }
        };
        this.postInteraction(params);
    };
    InteractionsService.prototype.postInteractionCollapsing = function (component) {
        var componentName = component.getAttribute('interaction');
        var collapsingIndex = component.getAttribute('compindex');
        var collapsed = component.getAttribute('collapsed') === 'true' ? false : true;
        if (!this.model.reportParams.collapsingStates) {
            this.model.reportParams.collapsingStates = {};
        }
        if (!this.model.reportParams.collapsingStates[componentName]) {
            this.model.reportParams.collapsingStates[componentName] = {};
        }
        this.model.reportParams.collapsingStates[componentName][collapsingIndex] = collapsed;
        var params = {
            action: 'Collapsing',
            collapsingParameters: {
                ComponentName: componentName,
                CollapsingStates: this.model.reportParams.collapsingStates
            }
        };
        if (this.model.options.isParametersReceived) {
            params.variables = this.getParametersValues();
        }
        this.postInteraction(params);
    };
    InteractionsService.prototype.updateAllHyperLinks = function () {
        var _this = this;
        var pointers = this.model.reportParams.tableOfContentsPointers;
        //var bookmarksPanel = this.controls.bookmarksPanel;
        if (this.model.reportParams.bookmarksContent != null || (pointers && pointers.length > 0)) {
            this.model.pages.forEach(function (p) {
                var e_2, _a;
                var page = p.page;
                var aHyperlinks = page.getElementsByTagName('a');
                var _loop_3 = function (aHyperlink) {
                    aHyperlink.hrefContent = aHyperlink.getAttribute('href');
                    if (aHyperlink.hrefContent) {
                        if (aHyperlink.hrefContent.indexOf("#") == 0) {
                            var anchorParams = aHyperlink.hrefContent.substring(1).split("#GUID#");
                            aHyperlink.anchorName = anchorParams[0];
                            aHyperlink.componentGuid = anchorParams.length > 1 ? anchorParams[1] : "";
                            aHyperlink.onclick = function () {
                                var currAnchorName = aHyperlink.anchorName;
                                var cuurCompGuid = aHyperlink.componentGuid;
                                try {
                                    currAnchorName = decodeURI(aHyperlink.anchorName);
                                }
                                catch (e) {
                                    currAnchorName = aHyperlink.anchorName;
                                }
                                if (pointers.length > 0) {
                                    var pageIndex = 1;
                                    for (var i = 0; i < pointers.length; i++) {
                                        if (cuurCompGuid) {
                                            if (pointers[i].componentGuid == cuurCompGuid) {
                                                pageIndex = pointers[i].pageIndex;
                                                break;
                                            }
                                        }
                                        else if (currAnchorName) {
                                            var pointerAnchor = pointers[i].anchor.indexOf("#") == 0 ? pointers[i].anchor.substring(1) : pointers[i].anchor;
                                            if (pointerAnchor == currAnchorName) {
                                                pageIndex = pointers[i].pageIndex;
                                                break;
                                            }
                                        }
                                    }
                                    var anchorName = "";
                                    if (currAnchorName)
                                        anchorName += currAnchorName;
                                    if (cuurCompGuid)
                                        anchorName += ("#GUID#" + cuurCompGuid);
                                    if (anchorName) {
                                        _this.controller.action({ name: 'BookmarkAction', bookmarkPage: Math.max(pageIndex - 1, 0), bookmarkAnchor: anchorName, componentGuid: aHyperlink.compunentGuid });
                                        return false;
                                    }
                                }
                                if (_this.model.reportParams.bookmarksContent != null) {
                                    var node = _this.model.nodes.find(function (n) { return n.name === currAnchorName; });
                                    if (node) {
                                        _this.model.navigateNode = node;
                                    }
                                    else {
                                        for (var k = 0; k < document.anchors.length; k++) {
                                            if (document.anchors[k].name == currAnchorName) {
                                                //jsObject.scrollToAnchor(currAnchorName);
                                                _this.helper.scrollToAnchor(currAnchorName);
                                                return;
                                            }
                                        }
                                    }
                                    _this.controller.post('BookmarkAction', null, 0);
                                    /*let aBookmarks = bookmarksPanel.getElementsByTagName("a");
                                    for (let k = 0; k < aBookmarks.length; k++) {
                                      let clickFunc = aBookmarks[k].getAttribute("onclick");
                                      if (clickFunc && clickFunc.indexOf("'" + currAnchorName + "'") >= 0) {
                                        try {
                                          eval(clickFunc);
                                          return false;
                                        }
                                        catch (e) { }
                                      }
                                    }
                  
                                    this.controller.post('BookmarkAction', null, 0);*/
                                    return false;
                                }
                                //=================================
                                /*let pageIndex = 1;
                                for (let i = 0; i < pointers.length; i++) {
                                  if (aHyperlink.componentGuid) {
                                    if (pointers[i].componentGuid == aHyperlink.componentGuid) {
                                      pageIndex = pointers[i].pageIndex;
                                      break;
                                    }
                                  }
                                  else if (aHyperlink.bookmarkAnchor) {
                                    if (pointers[i].anchor == decodeURI(aHyperlink.bookmarkAnchor)) {
                                      pageIndex = pointers[i].pageIndex;
                                      break;
                                    }
                                  }
                                }
                                this.controller.action({ name: 'BookmarkAction', bookmarkPage: pageIndex - 1, bookmarkAnchor: decodeURI(aHyperlink.bookmarkAnchor), componentGuid: aHyperlink.compunentGuid });
                                return false;
                                };
                                } else if (this.model.reportParams.bookmarksContent != null) {
                                aHyperlink.anchorName = aHyperlink.hrefContent.replace('#', '');
                
                                aHyperlink.onclick = () => {
                                const node = this.model.nodes.find(n => n.url.replace(/\\\'/g, '\'').substr(1) === aHyperlink.anchorName);
                                if (node) {
                                  this.model.navigateNode = node;
                                } else if (aHyperlink.hrefContent.indexOf('#') === 0) {
                                  for (let i = 0; i < document.anchors.length; i++) {
                                    const anchor = document.anchors[i];
                                    if (anchor.name === aHyperlink.anchorName) {
                                      this.helper.scrollToAnchor(aHyperlink.anchorName);
                                      return;
                                    }
                                  }
                                  this.controller.post('BookmarkAction', null, 0);
                                }
                                return false;
                                };*/
                            };
                        }
                    }
                };
                try {
                    for (var aHyperlinks_1 = __values(aHyperlinks), aHyperlinks_1_1 = aHyperlinks_1.next(); !aHyperlinks_1_1.done; aHyperlinks_1_1 = aHyperlinks_1.next()) {
                        var aHyperlink = aHyperlinks_1_1.value;
                        _loop_3(aHyperlink);
                    }
                }
                catch (e_2_1) { e_2 = { error: e_2_1 }; }
                finally {
                    try {
                        if (aHyperlinks_1_1 && !aHyperlinks_1_1.done && (_a = aHyperlinks_1.return)) _a.call(aHyperlinks_1);
                    }
                    finally { if (e_2) throw e_2.error; }
                }
            });
        }
    };
    InteractionsService.ctorParameters = function () { return [
        { type: ModelService },
        { type: Md5Service },
        { type: ControllerService },
        { type: HelperService },
        { type: DrillDownService }
    ]; };
    InteractionsService = __decorate([
        Injectable()
    ], InteractionsService);
    return InteractionsService;
}());

var RadioButtonService = /** @class */ (function () {
    function RadioButtonService() {
        this.groups = {};
    }
    RadioButtonService.prototype.addButton = function (button) {
        if (!this.groups[button.groupName]) {
            this.groups[button.groupName] = [];
        }
        this.groups[button.groupName].push(button);
    };
    RadioButtonService.prototype.removeButton = function (button) {
        var _a;
        var buttons = this.groups[button.groupName];
        (_a = buttons) === null || _a === void 0 ? void 0 : _a.splice(buttons.indexOf(button), 1);
    };
    RadioButtonService.prototype.check = function (button) {
        var _a;
        var buttons = this.groups[button.groupName];
        (_a = buttons) === null || _a === void 0 ? void 0 : _a.filter(function (b) { return b.name !== button.name; }).forEach(function (b) { return b.uncheck(); });
    };
    RadioButtonService = __decorate([
        Injectable()
    ], RadioButtonService);
    return RadioButtonService;
}());

var EditableFieldsService = /** @class */ (function () {
    function EditableFieldsService(controller, model, helper) {
        var _this = this;
        this.controller = controller;
        this.model = model;
        this.helper = helper;
        this.visible = false;
        this.editableFields = [];
        controller.getActionMessage().subscribe(function (message) {
            switch (message.action) {
                case 'Editor':
                    _this.visible = !_this.visible;
                    if (_this.visible) {
                        _this.showAllEditableFields();
                    }
                    else {
                        _this.hideAllEditableFields();
                    }
                    break;
            }
        });
        controller.getMessage().subscribe(function (message) {
            if (message.action === 'GetPages' && _this.visible) {
                setTimeout(function () { return _this.showAllEditableFields(); });
            }
            else {
                _this.visible = false;
            }
        });
    }
    EditableFieldsService.prototype.showAllEditableFields = function () {
        var _this = this;
        this.editableFields = [];
        this.model.pages.forEach(function (page, pageIndex) {
            var e_1, _a;
            var pageElements = page.page.getElementsByTagName('*');
            try {
                for (var pageElements_1 = __values(pageElements), pageElements_1_1 = pageElements_1.next(); !pageElements_1_1.done; pageElements_1_1 = pageElements_1.next()) {
                    var pageElement = pageElements_1_1.value;
                    var editableStrAttr = pageElement.getAttribute('editable');
                    if (editableStrAttr) {
                        var attrArray = editableStrAttr.split(';');
                        var params = {};
                        params.compIndex = attrArray[0];
                        params.pageIndex = _this.model.reportParams.viewMode === 'SinglePage' ? _this.model.reportParams.pageNumber : pageIndex.toString();
                        params.type = attrArray[1];
                        if (params.type === 'CheckBox') {
                            _this.showCheckBoxEditableField(pageElement, params, attrArray);
                        }
                        else if (params.type === 'Text') {
                            _this.showTextEditableField(pageElement, params);
                        }
                        else if (params.type === 'RichText') {
                            _this.showRichTextEditableField(pageElement, params);
                        }
                    }
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (pageElements_1_1 && !pageElements_1_1.done && (_a = pageElements_1.return)) _a.call(pageElements_1);
                }
                finally { if (e_1) throw e_1.error; }
            }
        });
    };
    EditableFieldsService.prototype.hideAllEditableFields = function () {
        if (this.currentEditableTextArea) {
            this.currentEditableTextArea.onblur();
        }
        this.editableFields.forEach(function (eField) {
            eField.className = eField.className.replace(' stiEditableField stiEditableFieldSelected', '');
            eField.onclick = null;
            eField.style.outline = '';
        });
    };
    EditableFieldsService.prototype.showCheckBoxEditableField = function (editableCell, params, attrArray) {
        var _this = this;
        if (!editableCell.sizes) {
            var imgElements = editableCell.getElementsByTagName('IMG');
            if (imgElements.length === 0) {
                imgElements = editableCell.getElementsByTagName('SVG');
            }
            if (imgElements.length === 0) {
                imgElements = editableCell.getElementsByTagName('svg');
            }
            var imgElement = (imgElements.length > 0) ? imgElements[0] : null;
            if (!imgElement) {
                return;
            }
            if (imgElement.offsetWidth) {
                editableCell.sizes = {
                    inPixels: imgElement.offsetWidth > imgElement.offsetHeight ? imgElement.offsetHeight : imgElement.offsetWidth,
                    widthStyle: imgElement.style.width,
                    heightStyle: imgElement.style.height
                };
            }
            else {
                editableCell.sizes = {
                    inPixels: imgElement.clientWidth > imgElement.clientHeight ? imgElement.clientHeight : imgElement.clientWidth,
                    widthStyle: imgElement.clientWidth + 'px',
                    heightStyle: imgElement.clientHeight + 'px'
                };
            }
        }
        if (this.helper.getNavigatorName() !== 'Google Chrome') {
            editableCell.style.outline = '1px solid gray';
        }
        editableCell.style.textAlign = 'center';
        editableCell.className += ' stiEditableField stiEditableFieldSelected';
        var trueSvgImage = this.getSvgCheckBox(attrArray[3], attrArray[5], this.helper.strToInt(attrArray[6]), attrArray[7], editableCell.sizes.inPixels);
        var falseSvgImage = this.getSvgCheckBox(attrArray[4], attrArray[5], this.helper.strToInt(attrArray[6]), attrArray[7], editableCell.sizes.inPixels);
        params.falseImage = "<div style=\"width: " + editableCell.sizes.widthStyle + "; height: " + editableCell.sizes.heightStyle + "; \"> " + trueSvgImage + "  </div>";
        params.trueImage = "<div style=\"width: " + editableCell.sizes.widthStyle + "; height: " + editableCell.sizes.heightStyle + "; \"> " + falseSvgImage + " </div>";
        params.checked = attrArray[2] === 'true' || attrArray[2] === 'True';
        editableCell.params = params;
        if (!editableCell.hasChanged) {
            editableCell.checked = params.checked;
            editableCell.innerHTML = params.checked ? params.trueImage : params.falseImage;
        }
        editableCell.onclick = function () {
            editableCell.checked = !editableCell.checked;
            editableCell.innerHTML = editableCell.checked ? params.trueImage : params.falseImage;
            editableCell.hasChanged = true;
            _this.addEditableParameters(editableCell);
        };
        this.editableFields.push(editableCell);
    };
    EditableFieldsService.prototype.showTextEditableField = function (editableCell, params) {
        var _this = this;
        editableCell.className += ' stiEditableField stiEditableFieldSelected';
        if (this.helper.getNavigatorName() !== 'Google Chrome') {
            editableCell.style.outline = '1px solid gray';
        }
        editableCell.params = params;
        editableCell.jsObject = this;
        editableCell.onclick = function () {
            if (editableCell.editMode) {
                return;
            }
            if (_this.currentEditableTextArea) {
                _this.currentEditableTextArea.onblur();
            }
            editableCell.editMode = true;
            var textArea = document.createElement('textarea');
            textArea.style.width = (editableCell.offsetWidth - 5) + 'px';
            textArea.style.height = (editableCell.offsetHeight - 5) + 'px';
            textArea.style.maxWidth = (editableCell.offsetWidth - 5) + 'px';
            textArea.style.maxHeight = (editableCell.offsetHeight - 5) + 'px';
            textArea.className = editableCell.className.replace(' stiEditableField stiEditableFieldSelected', '') + ' stiEditableTextArea';
            textArea.style.border = '0px';
            var textContainer = editableCell;
            if (textContainer.firstChild && textContainer.firstChild.nodeName && textContainer.firstChild.nodeName.toLowerCase() === 'div') {
                textContainer = textContainer.childNodes[0];
            }
            textArea.value = textContainer.innerHTML.replace(/<br>/g, '\n');
            editableCell.appendChild(textArea);
            textArea.focus();
            _this.currentEditableTextArea = textArea;
            textArea.onblur = function () {
                editableCell.editMode = false;
                var newText = textArea.value;
                textContainer.innerHTML = newText.replace(/\n/g, '<br>');
                if (_this && textArea.parentNode) {
                    textArea.parentNode.removeChild(textArea);
                }
                _this.currentEditableTextArea = null;
                _this.addEditableParameters(editableCell, newText);
            };
        };
        this.editableFields.push(editableCell);
    };
    EditableFieldsService.prototype.showRichTextEditableField = function (editableCell, params) {
    };
    EditableFieldsService.prototype.addEditableParameters = function (editableCell, newText) {
        if (!this.model.reportParams.editableParameters) {
            this.model.reportParams.editableParameters = {};
        }
        var params = {};
        params.type = editableCell.params.type;
        if (params.type === 'CheckBox') {
            params.checked = editableCell.checked;
        }
        if (params.type === 'Text') {
            params.text = newText != null ? newText : editableCell.innerHTML;
        }
        if (!this.model.reportParams.editableParameters[editableCell.params.pageIndex]) {
            this.model.reportParams.editableParameters[editableCell.params.pageIndex] = {};
        }
        this.model.reportParams.editableParameters[editableCell.params.pageIndex][editableCell.params.compIndex] = params;
    };
    EditableFieldsService.prototype.getSvgCheckBox = function (style, contourColor, size, backColor, width) {
        var head = "<svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0\" y=\"0\" width=\"" + width + "px\" height=\"" + width + "px\">";
        var path = "<path stroke=\"" + contourColor + "\" stroke-width=\"" + size + "\" fill=\"" + backColor + "\" stroke-linecap=\"round\" stroke-linejoin=\"round\" transform=\"scale(" + (1 / (200 / width)) + ")\" d=\"";
        var shape = '';
        switch (style) {
            case 'Cross':
                shape = 'm 62.567796,147.97593 c -0.55,-0.14223 -2.162828,-0.5128 -3.584062,-0.82348 -3.647667,-0.79738 -9.670499,-5.83775 -14.242817,-11.91949 l ' +
                    '-3.902341,-5.19058 5.080199,-1.13481 c 7.353071,-1.64253 13.640456,-5.71752 21.826811,-14.14646 l 7.208128,-7.42171 ' +
                    '-6.410736,-7.513354 c -11.773129,-13.79803 -14.346726,-23.01954 -8.627769,-30.91434 2.894109,-3.9952 11.818482,-12.369333 ' +
                    '13.182086,-12.369333 0.411356,0 1.063049,1.6875 1.448207,3.750003 0.980474,5.25038 6.456187,16.76587 10.936694,23 2.075266,2.8875 ' +
                    '3.991125,5.25 4.257464,5.25 0.266339,0 3.775242,-3.4875 7.797566,-7.75 16.397034,-17.37615 29.674184,-19.76481 38.280564,-6.88699 ' +
                    '4.15523,6.21753 4.18631,8.07093 0.14012,8.3552 -5.84833,0.41088 -17.16241,8.5342 -25.51465,18.319104 l -4.63153,5.42599 ' +
                    '4.87803,4.31529 c 6.55108,5.79533 18.8991,11.89272 25.84076,12.76002 3.0455,0.38051 5.53727,1.10582 5.53727,1.6118 0,2.7809 ' +
                    '-9.26611,14.41872 -13.03,16.36511 -7.96116,4.11687 -16.36991,0.71207 -32.764584,-13.26677 l -4.985957,-4.25125 -7.086791,8.97188 c ' +
                    '-3.897736,4.93454 -8.82141,10.1198 -10.9415,11.52281 -3.906121,2.58495 -8.86588,4.41339 -10.691162,3.94136 z';
                break;
            case 'Check':
                shape = 'M 60.972125,162.49704 C 51.172676,136.72254 43.561975,123.37669 35.370344,117.6027 l -4.45827,-3.14248 2.75159,-2.89559 c 3.875121,-4.07793 ' +
                    '10.034743,-7.49924 14.902472,-8.27747 3.859874,-0.61709 4.458306,-0.38024 8.535897,3.37835 2.660692,2.45254 6.265525,7.60856 9.167226,13.11196 ' +
                    '2.630218,4.98849 4.910542,9.06999 5.067388,9.06999 0.156846,0 2.31372,-3.0375 4.793052,-6.75 C 96.259164,91.956015 129.68299,58.786374 157.56485,41.281603 l ' +
                    '8.84913,-5.555656 2.2633,2.631238 2.26329,2.631237 -7.76266,6.294183 C 139.859,66.19023 108.01682,105.51363 89.042715,138.83563 c -6.680477,11.73214 ' +
                    '-7.172359,12.31296 -15.090788,17.81963 -4.501873,3.13071 -9.044031,6.30443 -10.093684,7.05271 -1.708923,1.21826 -2.010678,1.09165 -2.886118,-1.21093 z';
                break;
            case 'CrossRectangle':
                shape = 'm 24.152542,102.04237 0,-72.499996 74.5,0 74.499998,0 0,72.499996 0,72.5 -74.499998,0 -74.5,0 0,-72.5 z m 133.758188,0.25 -0.25819,-57.249996 ' +
                    '-58.999998,0 -59,0 -0.259695,55.999996 c -0.142833,30.8 -0.04446,56.5625 0.218615,57.25 0.375181,0.98048 13.207991,1.25 59.517885,1.25 l ' +
                    '59.039573,0 -0.25819,-57.25 z m -90.574091,43.18692 c -1.823747,-0.3912 -4.926397,-1.85716 -6.894778,-3.25768 -3.319254,-2.36169 -12.289319,-12.40741 ' +
                    '-12.289319,-13.76302 0,-0.32888 2.417494,-1.13897 5.372209,-1.80021 7.185193,-1.60797 13.747505,-5.93496 21.803114,-14.3763 l 6.675323,-6.99496 ' +
                    '-6.379078,-7.31436 C 64.931387,85.71231 61.643682,76.29465 65.471903,68.89169 67.054097,65.83207 78.56175,54.542374 80.098251,54.542374 c 0.45744,0 ' +
                    '1.146839,1.6875 1.531997,3.75 0.980474,5.250386 6.456187,16.765876 10.936694,22.999996 2.075266,2.8875 3.991125,5.25 4.257464,5.25 0.266339,0 ' +
                    '3.775244,-3.4875 7.797564,-7.75 16.39704,-17.376139 29.67419,-19.764806 38.28057,-6.88698 4.15523,6.21752 4.18631,8.07092 0.14012,8.35519 -5.82996,0.40959 ' +
                    '-18.23707,9.34942 -25.91566,18.67328 -3.90068,4.73647 -3.97203,4.95414 -2.2514,6.86861 3.19054,3.54997 13.7039,10.54321 18.97191,12.61967 2.83427,1.11716 ' +
                    '7.43737,2.33421 10.22912,2.70455 2.79175,0.37034 5.07591,0.9956 5.07591,1.38947 0,2.11419 -8.37504,13.20895 -11.6517,15.4355 -8.39423,5.70403 ' +
                    '-16.63203,2.77 -34.14289,-12.16054 l -4.985955,-4.25125 -7.086791,8.97188 c -9.722344,12.3085 -16.524852,16.55998 -23.948565,14.96754 z';
                break;
            case 'CheckRectangle':
                shape = 'm 19.915254,103.5 0,-72.5 71.942245,0 71.942241,0 6.55727,-4.11139 6.55726,-4.11139 1.96722,2.36139 c 1.08197,1.298765 1.98219,2.644166 2.00049,2.98978 ' +
                    '0.0183,0.345615 -2.44173,2.53784 -5.46673,4.87161 l -5.5,4.243219 0,69.378391 0,69.37839 -74.999991,0 -75.000005,0 0,-72.5 z m 133.999996,3.87756 c ' +
                    '0,-49.33933 -0.12953,-53.514947 -1.62169,-52.276568 -2.78014,2.307312 -15.68408,17.90053 -24.32871,29.399008 -10.4919,13.955575 -23.47926,33.53736 ' +
                    '-29.514025,44.5 -4.457326,8.09707 -5.134776,8.80812 -14.291256,15 -5.28667,3.575 -9.903486,6.62471 -10.259592,6.77712 -0.356107,0.15242 -1.912439,-2.99758 ' +
                    '-3.458515,-7 -1.546077,-4.00241 -5.258394,-12.41205 -8.249593,-18.68809 -4.285436,-8.99155 -6.676569,-12.64898 -11.27758,-17.25 C 47.70282,104.62757 ' +
                    '44.364254,102 43.495254,102 c -2.798369,0 -1.704872,-1.66044 3.983717,-6.049158 5.593548,-4.31539 13.183139,-7.091307 16.801313,-6.145133 3.559412,0.930807 ' +
                    '9.408491,8.154973 13.919775,17.192241 l 4.46286,8.94025 4.54378,-6.83321 C 95.518219,96.605618 108.21371,81.688517 125.80695,63.75 L 143.21531,46 l ' +
                    '-53.650021,0 -53.650035,0 0,57.5 0,57.5 59.000005,0 58.999991,0 0,-53.62244 z';
                break;
            case 'CrossCircle':
                shape = 'M 83.347458,173.13597 C 61.069754,168.04956 42.193415,152.8724 32.202285,132.01368 23.4014,113.63986 23.679644,89.965903 32.91889,71.042373 ' +
                    '41.881579,52.685283 60.867647,37.139882 80.847458,31.799452 c 10.235111,-2.735756 31.264662,-2.427393 40.964762,0.600679 26.18668,8.174684 ' +
                    '46.06876,28.926852 51.62012,53.879155 2.43666,10.952327 1.56754,28.058524 -1.98036,38.977594 -6.65679,20.48707 -25.64801,38.95163 -47.32647,46.01402 ' +
                    '-6.3909,2.08202 -10.18566,2.59644 -21.27805,2.88446 -9.033911,0.23456 -15.484931,-0.10267 -19.500002,-1.01939 z M 112.4138,158.45825 c 17.13137,-3.13002 ' +
                    '33.71724,-15.96081 41.41353,-32.03742 14.8975,-31.119027 -1.10807,-67.659584 -34.40232,-78.540141 -6.71328,-2.193899 -9.93541,-2.643501 ' +
                    '-19.07755,-2.661999 -9.354252,-0.01893 -12.16228,0.37753 -18.768532,2.649866 -17.155451,5.900919 -29.669426,17.531424 -36.438658,33.866137 ' +
                    '-2.152301,5.193678 -2.694658,8.35455 -3.070923,17.89744 -0.518057,13.139047 0.741843,19.201887 6.111644,29.410237 4.106815,7.80733 15.431893,19.09359 ' +
                    '23.36818,23.28808 12.061362,6.37467 27.138828,8.6356 40.864629,6.1278 z M 69.097458,133.41654 c -2.8875,-2.75881 -5.25,-5.35869 -5.25,-5.77751 ' +
                    '0,-0.41882 5.658529,-6.30954 12.57451,-13.0905 l 12.57451,-12.329 L 76.198053,89.392633 63.399628,76.565738 68.335951,71.554056 c 2.714978,-2.756426 ' +
                    '5.304859,-5.011683 5.75529,-5.011683 0.450432,0 6.574351,5.611554 13.608709,12.470121 l 12.78974,12.470119 4.42889,-4.553471 c 2.43588,-2.50441 ' +
                    '8.39186,-8.187924 13.23551,-12.630032 l 8.80663,-8.076559 5.34744,5.281006 5.34743,5.281007 -12.96155,12.557899 -12.96154,12.557897 13.13318,13.16027 ' +
                    '13.13319,13.16027 -5.18386,4.66074 c -2.85112,2.5634 -5.70472,4.66073 -6.34134,4.66073 -0.63661,0 -6.5434,-5.4 -13.12621,-12 -6.58281,-6.6 -12.3871,-12 ' +
                    '-12.89844,-12 -0.511329,0 -6.593363,5.60029 -13.515627,12.44509 l -12.585935,12.44508 -5.25,-5.016 z';
                break;
            case 'DotCircle':
                shape = 'M 81.652542,170.5936 C 59.374838,165.50719 40.498499,150.33003 30.507369,129.47131 21.706484,111.09749 21.984728,87.42353 31.223974,68.5 ' +
                    '40.186663,50.14291 59.172731,34.597509 79.152542,29.257079 89.387653,26.521323 110.4172,26.829686 120.1173,29.857758 c 26.18668,8.174684 ' +
                    '46.06876,28.926852 51.62012,53.879152 2.43666,10.95233 1.56754,28.05853 -1.98036,38.9776 -6.65679,20.48707 -25.64801,38.95163 -47.32647,46.01402 ' +
                    '-6.3909,2.08202 -10.18566,2.59644 -21.27805,2.88446 -9.033907,0.23456 -15.484927,-0.10267 -19.499998,-1.01939 z m 29.999998,-15.098 c 20.68862,-4.34363 ' +
                    '38.01874,-20.45437 44.09844,-40.9956 2.36228,-7.9813 2.36228,-22.0187 0,-30 C 150.08927,65.371023 134.63549,50.297336 114.65254,44.412396 ' +
                    '106.5531,42.027127 90.741304,42.026386 82.695253,44.4109 62.460276,50.407701 46.686742,66.039241 41.6053,85.13096 c -1.948821,7.32201 -1.86506,23.11641 ' +
                    '0.158766,29.93754 8.730326,29.42481 38.97193,46.91812 69.888474,40.4271 z M 90.004747,122.6703 C 76.550209,117.63801 69.825047,101.82445 ' +
                    '75.898143,89.5 c 2.136718,-4.33615 7.147144,-9.356192 11.754399,-11.776953 5.578622,-2.931141 16.413098,-2.927504 22.052908,0.0074 18.03,9.382663 ' +
                    '19.07573,32.784373 1.91442,42.841563 -5.57282,3.26589 -15.830952,4.2617 -21.615123,2.09829 z';
                break;
            case 'DotRectangle':
                shape = 'm 23.847458,101.19491 0,-72.499995 74.5,0 74.499992,0 0,72.499995 0,72.5 -74.499992,0 -74.5,0 0,-72.5 z m 133.999992,-0.008 0,-57.507925 ' +
                    '-59.249992,0.25793 -59.25,0.25793 -0.25819,57.249995 -0.258189,57.25 59.508189,0 59.508182,0 0,-57.50793 z m -94.320573,33.85402 c -0.37368,-0.37368 ' +
                    '-0.679419,-15.67942 -0.679419,-34.01275 l 0,-33.333335 35.513302,0 35.51329,0 -0.2633,33.749995 -0.2633,33.75 -34.570573,0.26275 c -19.013819,0.14452 ' +
                    '-34.876319,-0.043 -35.25,-0.41666 z';
                break;
            case 'NoneCircle':
                shape = 'M 83.5,170.5936 C 61.222296,165.50719 42.345957,150.33003 32.354827,129.47131 23.553942,111.09749 23.832186,87.423523 33.071432,68.5 ' +
                    '42.034121,50.14291 61.020189,34.597509 81,29.257079 c 10.235111,-2.735756 31.26466,-2.427393 40.96476,0.600679 26.18668,8.174684 46.06876,28.926852 ' +
                    '51.62012,53.879155 2.43666,10.95232 1.56754,28.058527 -1.98036,38.977597 -6.65679,20.48707 -25.64801,38.95163 -47.32647,46.01402 -6.3909,2.08202 ' +
                    '-10.18566,2.59644 -21.27805,2.88446 -9.033909,0.23456 -15.484929,-0.10267 -19.5,-1.01939 z m 30,-15.098 c 20.68862,-4.34363 38.01874,-20.45437 ' +
                    '44.09844,-40.9956 2.36228,-7.9813 2.36228,-22.018707 0,-29.999997 C 151.93673,65.371023 136.48295,50.297336 116.5,44.412396 108.40056,42.027127 ' +
                    '92.588762,42.026386 84.542711,44.410896 64.307734,50.407697 48.5342,66.039237 43.452758,85.130959 c -1.948821,7.322 -1.86506,23.116411 ' +
                    '0.158766,29.937541 8.730326,29.42481 38.97193,46.91812 69.888476,40.4271 z';
                break;
            case 'NoneRectangle':
                shape = 'm 24.152542,102.04237 0,-72.499997 74.5,0 74.500008,0 0,72.499997 0,72.5 -74.500008,0 -74.5,0 0,-72.5 z m 133.758198,0.25 ' +
                    '-0.25819,-57.249997 -59.000008,0 -59,0 -0.259695,55.999997 c -0.142833,30.8 -0.04446,56.5625 0.218615,57.25 0.375181,0.98048 ' +
                    '13.207991,1.25 59.517885,1.25 l 59.039583,0 -0.25819,-57.25 z';
                break;
        }
        return head + path + shape + '" /></svg>';
    };
    EditableFieldsService.ctorParameters = function () { return [
        { type: ControllerService },
        { type: ModelService },
        { type: HelperService }
    ]; };
    EditableFieldsService = __decorate([
        Injectable()
    ], EditableFieldsService);
    return EditableFieldsService;
}());

var ToolbarService = /** @class */ (function () {
    function ToolbarService(model, controller, editableFieldsService, interactionService, helper) {
        var _this = this;
        this.model = model;
        this.controller = controller;
        this.editableFieldsService = editableFieldsService;
        this.interactionService = interactionService;
        this.helper = helper;
        this.comps = [];
        this.dopComps = [];
        this.controller.getMessage().subscribe(function (message) {
            if (message.action !== 'viewer_loaded') {
                _this.updateButtons();
            }
        });
    }
    ToolbarService.prototype.updateButtons = function () {
        var _this = this;
        this.comps.filter(function (i) { return i.action === 'ViewMode'; }).forEach(function (m) { return m.caption = _this.model.loc(_this.model.reportParams.viewMode); });
        this.comps.filter(function (i) { return i.action === 'Zoom'; }).forEach(function (m) {
            m.menuItems.forEach(function (n) { return n.selected = n.name === ('Zoom' + _this.model.reportParams.zoom); });
            m.caption = _this.model.reportParams.zoom ? Math.round(_this.model.reportParams.zoom) + '%' : '';
        });
        this.comps.filter(function (i) { return i.action === 'ShowFind'; }).forEach(function (m) {
            m.selected = _this.model.controls.findPanel.visible;
        });
    };
    ToolbarService.prototype.initButtons = function () {
        var comps = [];
        var dopComps = [];
        var isFirst = false;
        if (this.model.options.toolbar.showAboutButton) {
            dopComps.push({ type: 'button', action: 'About', img: 'Help.png' });
        }
        if (this.model.options.toolbar.showAboutButton && this.model.options.toolbar.showDesignButton) {
            dopComps.push({ type: 'separator' });
        }
        if (this.model.options.toolbar.showDesignButton) {
            dopComps.push({ type: 'button', action: 'Design', caption: this.model.loc('Design'), img: 'Design.png' });
        }
        if (this.model.options.toolbar.showPinToolbarButton && this.model.options.toolbar.showDesignButton) {
            dopComps.push({ type: 'separator' });
        }
        if (this.model.options.toolbar.showPinToolbarButton) {
            dopComps.push({ type: 'button', action: 'Pin', img: 'Pin.png' });
        }
        if (this.model.options.toolbar.showPrintButton) {
            comps.push({
                type: 'button', action: 'Print', caption: this.model.loc('Print'), img: 'Print.png', tooltip: true,
                arrow: this.model.options.toolbar.printDestination === 'Default' ? 'Down' : null,
                menuItems: this.model.options.toolbar.printDestination === 'Default' ?
                    [{ name: 'PrintPdf', caption: this.model.loc('PrintPdf'), img: 'Save.Small.Pdf.png' },
                        { name: 'PrintWithPreview', caption: this.model.loc('PrintWithPreview'), img: 'ViewMode.png' },
                        { name: 'PrintWithoutPreview', caption: this.model.loc('PrintWithoutPreview'), img: 'Print.png' }] :
                    null
            });
            isFirst = false;
        }
        if (this.model.options.toolbar.showOpenButton) {
            comps.push({ type: 'button', action: 'Open', caption: this.model.loc('Open'), img: 'Open.png', tooltip: true });
            isFirst = false;
        }
        if (this.model.options.toolbar.showSaveButton) {
            comps.push({
                type: 'button', action: 'Save', caption: this.model.loc('Save'), img: 'Save.png', tooltip: true, arrow: 'Down',
                menuItems: this.getSaveMenuItems('saveMenu')
            });
            isFirst = false;
        }
        if (this.model.options.toolbar.showSendEmailButton) {
            comps.push({
                type: 'button', action: 'SendEmail', caption: this.model.loc('SendEmail'), img: 'SendEmail.png', tooltip: true, arrow: 'Down',
                menuItems: this.getSaveMenuItems('sendEmailMenu')
            });
            isFirst = false;
        }
        if (this.model.options.toolbar.showBookmarksButton || this.model.options.toolbar.showParametersButton) {
            if (!isFirst) {
                comps.push({ type: 'separator' });
            }
            isFirst = false;
        }
        if (this.model.options.toolbar.showBookmarksButton) {
            comps.push({ type: 'button', action: 'Bookmarks', caption: this.model.options.toolbar.displayMode === 'Separated' ? this.model.loc('Bookmarks') : null, img: 'Bookmarks.png', tooltip: true });
            isFirst = false;
        }
        if (this.model.options.toolbar.showParametersButton) {
            comps.push({ type: 'button', action: 'Parameters', caption: this.model.options.toolbar.displayMode === 'Separated' ? this.model.loc('Parameters') : null, img: 'Parameters.png', tooltip: true });
            isFirst = false;
        }
        if (this.model.options.toolbar.showResourcesButton) {
            comps.push({ type: 'button', action: 'Resources', caption: this.model.options.toolbar.displayMode === 'Separated' ? this.model.loc('Resources') : null, img: 'Resources.png', tooltip: true });
            isFirst = false;
        }
        if (this.model.options.toolbar.showFindButton || this.model.options.toolbar.showEditorButton) {
            if (!isFirst) {
                comps.push({ type: 'separator' });
            }
            isFirst = false;
        }
        if (this.model.options.toolbar.showFindButton) {
            comps.push({ type: 'button', action: 'Find', img: 'Find.png', tooltip: true });
            isFirst = false;
        }
        if (this.model.options.toolbar.showEditorButton) {
            comps.push({ type: 'button', action: 'Editor', img: 'Editor.png', tooltip: true });
            isFirst = false;
        }
        if (this.model.options.toolbar.displayMode !== 'Separated') {
            if (this.model.options.toolbar.showFirstPageButton || this.model.options.toolbar.showPreviousPageButton || this.model.options.toolbar.showNextPageButton ||
                this.model.options.toolbar.showLastPageButton || this.model.options.toolbar.showCurrentPageControl) {
                if (!isFirst) {
                    comps.push({ type: 'separator' });
                }
                isFirst = false;
            }
            if (this.model.options.toolbar.showFirstPageButton) {
                comps.push({ type: 'button', action: 'FirstPage', img: this.model.options.appearance.rightToLeft ? 'LastPage.png' : 'FirstPage.png', tooltip: true });
                isFirst = false;
            }
            if (this.model.options.toolbar.showPreviousPageButton) {
                comps.push({ type: 'button', action: 'PrevPage', img: this.model.options.appearance.rightToLeft ? 'NextPage.png' : 'PrevPage.png', tooltip: true });
                isFirst = false;
            }
            if (this.model.options.toolbar.showCurrentPageControl) {
                comps.push({ type: 'pageControl' });
                isFirst = false;
            }
            if (this.model.options.toolbar.showNextPageButton) {
                comps.push({ type: 'button', action: 'NextPage', img: this.model.options.appearance.rightToLeft ? 'PrevPage.png' : 'NextPage.png', tooltip: true });
                isFirst = false;
            }
            if (this.model.options.toolbar.showLastPageButton) {
                comps.push({ type: 'button', action: 'LastPage', img: this.model.options.appearance.rightToLeft ? 'FirstPage.png' : 'LastPage.png', tooltip: true });
                isFirst = false;
            }
            if (this.model.options.toolbar.showViewModeButton || this.model.options.toolbar.showZoomButton) {
                if (!isFirst) {
                    comps.push({ type: 'separator' });
                }
                isFirst = false;
            }
        }
        if (this.model.options.toolbar.showFullScreenButton) {
            comps.push({ type: 'button', action: 'FullScreen', img: 'FullScreen.png', tooltip: true });
            comps.push({ type: 'separator' });
            isFirst = false;
        }
        if (this.model.options.toolbar.showZoomButton && this.model.options.toolbar.displayMode !== 'Separated') {
            comps.push({
                type: 'button', action: 'Zoom', caption: '100%', img: 'Zoom.png', tooltip: true, arrow: 'Down',
                menuItems: this.helper.getZoomMenuItems()
            });
            isFirst = false;
        }
        if (this.model.options.toolbar.showViewModeButton) {
            comps.push({
                type: 'button', action: 'ViewMode', caption: this.model.loc('SinglePage'), img: 'SinglePage.png', tooltip: true, arrow: 'Down',
                menuItems: [{ name: 'ViewModeSinglePage', caption: this.model.loc('SinglePage'), img: 'SinglePage.png' },
                    { name: 'ViewModeContinuous', caption: this.model.loc('Continuous'), img: 'Continuous.png' },
                    { name: 'ViewModeMultiplePages', caption: this.model.loc('MultiplePages'), img: 'MultiplePages.png' }]
            });
            isFirst = false;
        }
        if (typeof (this.model.options.toolbar.multiPageWidthCount) !== 'undefined') {
            this.model.reportParams.multiPageWidthCount = this.model.options.toolbar.multiPageWidthCount;
        }
        if (typeof (this.model.options.toolbar.multiPageHeightCount) !== 'undefined') {
            this.model.reportParams.multiPageHeightCount = this.model.options.toolbar.multiPageHeightCount;
        }
        if (!this.model.options.appearance.rightToLeft && this.model.options.toolbar.alignment === 'right' &&
            (this.model.options.toolbar.showPinToolbarButton || this.model.options.toolbar.showAboutButton || this.model.options.toolbar.showDesignButton)) {
            comps.push({ type: 'separator6' });
        }
        this.comps = this.model.options.appearance.rightToLeft ? comps.reverse() : comps;
        this.dopComps = this.model.options.appearance.rightToLeft ? dopComps.reverse() : dopComps;
    };
    ToolbarService.prototype.disableNaviButtons = function () {
        return this.model.reportParams.viewMode === 'MultiplePages' || this.model.reportParams.viewMode === 'WholeReport' ||
            (this.model.reportParams.viewMode === 'Continuous' && !this.model.options.appearance.scrollbarsMode && !this.model.options.appearance.fullScreenMode);
    };
    ToolbarService.prototype.getImage = function (imageName) {
        switch (this.model.options.appearance.saveMenuImageSize) {
            case 'Big':
                return "Save.Big." + imageName + ".png";
            case 'None':
                return null;
            default:
                return "Save.Small." + imageName + ".png";
        }
    };
    ToolbarService.prototype.getSaveMenuItems = function (menuName) {
        var isFirst = true;
        var items = [];
        var imageSize = this.model.options.appearance.saveMenuImageSize;
        if (this.model.options.exports.showExportToDocument && menuName === 'saveMenu') {
            items.push({ name: menuName + 'Document', caption: this.model.loc('ReportSnapshot'), imageSize: imageSize, img: this.getImage('Document') });
            isFirst = false;
        }
        if (menuName === 'saveMenu' && this.model.options.exports.showExportToPdf || this.model.options.exports.showExportToXps || this.model.options.exports.showExportToPowerPoint) {
            if (!isFirst) {
                items.push({ imageSize: imageSize, type: 'separator' });
            }
            isFirst = false;
        }
        if (this.model.options.exports.showExportToPdf) {
            items.push({ name: menuName + 'Pdf', caption: 'Adobe PDF', imageSize: imageSize, img: this.getImage('Pdf') });
        }
        if (this.model.options.exports.showExportToXps) {
            items.push({ name: menuName + 'Xps', caption: 'Microsoft XPS', imageSize: imageSize, img: this.getImage('Xps') });
        }
        if (this.model.options.exports.showExportToPowerPoint) {
            items.push({ name: menuName + 'Ppt2007', caption: 'Microsoft PowerPoint', imageSize: imageSize, img: this.getImage('Ppt') });
        }
        if (this.model.options.exports.showExportToHtml || this.model.options.exports.showExportToHtml5 || this.model.options.exports.showExportToMht) {
            if (!isFirst) {
                items.push({ imageSize: imageSize, type: 'separator' });
            }
            isFirst = false;
            var htmlType = this.model.options.exports.defaultSettings['StiHtmlExportSettings'].HtmlType;
            if (!this.model.options.exports['showExportTo' + htmlType]) {
                if (this.model.options.exports.showExportToHtml) {
                    htmlType = 'Html';
                }
                else if (this.model.options.exports.showExportToHtml5) {
                    htmlType = 'Html5';
                }
                else if (this.model.options.exports.showExportToMht) {
                    htmlType = 'Mht';
                }
            }
            items.push({ name: menuName + htmlType, caption: 'HTML', imageSize: imageSize, img: this.getImage('Html') });
        }
        if (this.model.options.exports.showExportToText || this.model.options.exports.showExportToRtf || this.model.options.exports.showExportToWord2007 || this.model.options.exports.showExportToOdt) {
            if (!isFirst) {
                items.push({ imageSize: imageSize, type: 'separator' });
            }
            isFirst = false;
        }
        if (this.model.options.exports.showExportToText) {
            items.push({ name: menuName + 'Text', caption: this.model.loc('Text'), imageSize: imageSize, img: this.getImage('Text') });
        }
        if (this.model.options.exports.showExportToRtf) {
            items.push({ name: menuName + 'Rtf', caption: 'RTF', imageSize: imageSize, img: this.getImage('Rtf') });
        }
        if (this.model.options.exports.showExportToWord2007) {
            items.push({ name: menuName + 'Word2007', caption: 'Microsoft Word', imageSize: imageSize, img: this.getImage('Word') });
        }
        if (this.model.options.exports.showExportToOpenDocumentWriter) {
            items.push({ name: menuName + 'Odt', caption: 'OpenDocument Writer', imageSize: imageSize, img: this.getImage('Odt') });
        }
        if (this.model.options.exports.showExportToExcel || this.model.options.exports.showExportToExcel2007 || this.model.options.exports.showExportToExcelXml || this.model.options.exports.showExportToOpenDocumentWriter) {
            if (!isFirst) {
                items.push({ imageSize: imageSize, type: 'separator' });
            }
            isFirst = false;
        }
        if (this.model.options.exports.showExportToExcel || this.model.options.exports.showExportToExcelXml || this.model.options.exports.showExportToExcel2007) {
            var excelType = this.model.options.exports.defaultSettings['StiExcelExportSettings'].ExcelType;
            if (excelType === 'ExcelBinary') {
                excelType = 'Excel';
            }
            if (!this.model.options.exports['showExportTo' + excelType]) {
                if (this.model.options.exports.showExportToExcel) {
                    excelType = 'Excel';
                }
                else if (this.model.options.exports.showExportToExcel2007) {
                    excelType = 'Excel2007';
                }
                else if (this.model.options.exports.showExportToExcelXml) {
                    excelType = 'ExcelXml';
                }
            }
            items.push({ name: menuName + excelType, caption: 'Microsoft Excel', imageSize: imageSize, img: this.getImage('Excel') });
        }
        if (this.model.options.exports.showExportToOpenDocumentCalc) {
            items.push({ name: menuName + 'Ods', caption: 'OpenDocument Calc', imageSize: imageSize, img: this.getImage('Ods') });
        }
        if (this.model.options.exports.showExportToCsv || this.model.options.exports.showExportToDbf || this.model.options.exports.showExportToXml ||
            this.model.options.exports.showExportToDif || this.model.options.exports.showExportToSylk || this.model.options.exports.showExportToJson) {
            if (!isFirst) {
                items.push({ imageSize: imageSize, type: 'separator' });
            }
            isFirst = false;
            var dataType = this.model.options.exports.defaultSettings['StiDataExportSettings'].DataType;
            if (!this.model.options.exports['showExportTo' + dataType]) {
                if (this.model.options.exports.showExportToCsv) {
                    dataType = 'Csv';
                }
                else if (this.model.options.exports.showExportToDbf) {
                    dataType = 'Dbf';
                }
                else if (this.model.options.exports.showExportToXml) {
                    dataType = 'Xml';
                }
                else if (this.model.options.exports.showExportToDif) {
                    dataType = 'Dif';
                }
                else if (this.model.options.exports.showExportToSylk) {
                    dataType = 'Sylk';
                }
                else if (this.model.options.exports.showExportToJson) {
                    dataType = 'Json';
                }
            }
            items.push({ name: menuName + dataType, caption: this.model.loc('Data'), imageSize: imageSize, img: this.getImage('Data') });
        }
        if (this.model.options.exports.showExportToImageBmp || this.model.options.exports.showExportToImageGif || this.model.options.exports.showExportToImageJpeg || this.model.options.exports.showExportToImagePcx ||
            this.model.options.exports.showExportToImagePng || this.model.options.exports.showExportToImageTiff || this.model.options.exports.showExportToImageMetafile || this.model.options.exports.showExportToImageSvg || this.model.options.exports.showExportToImageSvgz) {
            if (!isFirst) {
                items.push({ imageSize: imageSize, type: 'separator' });
            }
            isFirst = false;
            var imageType = this.model.options.exports.defaultSettings['StiImageExportSettings'].ImageType;
            var imageType_ = imageType === 'Emf' ? 'Metafile' : imageType;
            if (!this.model.options.exports['showExportToImage' + imageType_]) {
                if (this.model.options.exports.showExportToImageBmp) {
                    imageType = 'Bmp';
                }
                else if (this.model.options.exports.showExportToImageGif) {
                    imageType = 'Gif';
                }
                else if (this.model.options.exports.showExportToImageJpeg) {
                    imageType = 'Jpeg';
                }
                else if (this.model.options.exports.showExportToImagePcx) {
                    imageType = 'Pcx';
                }
                else if (this.model.options.exports.showExportToImagePng) {
                    imageType = 'Png';
                }
                else if (this.model.options.exports.showExportToImageTiff) {
                    imageType = 'Tiff';
                }
                else if (this.model.options.exports.showExportToImageMetafile) {
                    imageType = 'Emf';
                }
                else if (this.model.options.exports.showExportToImageSvg) {
                    imageType = 'Svg';
                }
                else if (this.model.options.exports.showExportToImageSvgz) {
                    imageType = 'Svgz';
                }
            }
            items.push({ name: menuName + 'Image' + imageType, caption: this.model.loc('Image'), imageSize: imageSize, img: this.getImage('Image') });
        }
        return items;
    };
    ToolbarService.prototype.enabled = function (desc) {
        var _a, _b;
        var disableNaviButtons = this.disableNaviButtons();
        switch (desc.action) {
            case 'FirstPage':
            case 'PrevPage':
                return this.model.reportParams.pageNumber > 0 && !disableNaviButtons;
            case 'NextPage':
            case 'LastPage':
                return this.model.reportParams.pageNumber < this.model.reportParams.pagesCount - 1 && !disableNaviButtons;
            case 'Bookmarks':
                return this.model.reportParams.bookmarksContent != null;
            case 'Parameters':
                return ((_a = this.model.interactions) === null || _a === void 0 ? void 0 : _a.paramsVariables) != null;
            case 'Resources':
                return ((_b = this.model.reportParams.resources) === null || _b === void 0 ? void 0 : _b.length) > 0;
        }
        return true;
    };
    ToolbarService.prototype.selected = function (desc) {
        switch (desc.action) {
            case 'Find':
                return this.model.controls.findPanel.visible;
            case 'Bookmarks':
                return this.model.controls.bookmarksPanel.visible;
            case 'Parameters':
                return this.model.controls.parametersPanel.visible;
            case 'Editor':
                return this.editableFieldsService.visible;
            case 'Resources':
                return this.model.controls.resourcesPanel.visible;
            case 'FullScreen':
                return this.model.options.appearance.fullScreenMode;
            case 'Pin':
                return !this.model.options.toolbar.autoHide;
        }
        return false;
    };
    ToolbarService.prototype.display = function (desc) {
        switch (desc.action) {
            case 'Editor':
                return this.model.reportParams.isEditableReport ? '' : 'none';
        }
        return '';
    };
    ToolbarService.prototype.getButonWidth = function (comp) {
        if (this.model.options.toolbar.displayMode === 'Separated') {
            if (comp.action === 'Find' || comp.action === 'Editor' || comp.action === 'FullScreen' || comp.action === 'About') {
                return '28px';
            }
            if (this.model.options.isMobileDevice) {
                return '0.4in';
            }
        }
        return null;
    };
    ToolbarService.prototype.getInnerTableWidth = function (comp) {
        if (this.model.options.toolbar.displayMode === 'Separated' &&
            (this.model.options.isMobileDevice || comp.action === 'Find' || comp.action === 'Editor' || comp.action === 'FullScreen' || comp.action === 'About')) {
            return '100%';
        }
        return null;
    };
    ToolbarService.ctorParameters = function () { return [
        { type: ModelService },
        { type: ControllerService },
        { type: EditableFieldsService },
        { type: InteractionsService },
        { type: HelperService }
    ]; };
    ToolbarService = __decorate([
        Injectable()
    ], ToolbarService);
    return ToolbarService;
}());

//1bfb351c1add27b1537ffce9c723e3cb1f5b27bb 02.03.2021 17:29:20
var StimulsoftViewerComponent = /** @class */ (function () {
    function StimulsoftViewerComponent(controller, menuService, model, exportService, formService, api, printService, dashboardService) {
        var _this = this;
        this.controller = controller;
        this.menuService = menuService;
        this.model = model;
        this.exportService = exportService;
        this.formService = formService;
        this.api = api;
        this.printService = printService;
        this.dashboardService = dashboardService;
        /**
         * Occurs when report/dashboard loaded
         */
        this.loaded = new EventEmitter();
        /**
         * Occurs on error, $event is ErrorMessage object contains error: string & type: any  (if present)
         */
        this.error = new EventEmitter();
        /**
         * Occurs on export, $event object contains exportFormat: string & exportSettings: {}
         */
        this.export = new EventEmitter();
        /**
         * Occurs on export & email, $event object contains exportFormat: string & exportSettings: {}
         */
        this.email = new EventEmitter();
        /**
         * Occurs on export & email, $event object contains format: string : 'PrintPdf' or 'PrintWithoutPreview' or 'PrintWithPreview'
         */
        this.print = new EventEmitter();
        /**
         * Occurs on pressing 'Design' button
         */
        this.design = new EventEmitter();
        /**
         * Viewer background color
         */
        this.backgroundColor = 'White';
        this.initialized = false;
        this.viewInit = false;
        window.onresize = function () { return _this.resize(); };
        this.initEvents();
    }
    StimulsoftViewerComponent.prototype.ngOnChanges = function (changes) {
        this.loadViewer();
    };
    StimulsoftViewerComponent.prototype.ngOnInit = function () {
        var _this = this;
        this.controller.getMessage().subscribe(function (message) {
            switch (message.action) {
                case 'viewer_loaded':
                    _this.initialized = true;
                    break;
            }
        });
    };
    StimulsoftViewerComponent.prototype.ngAfterViewInit = function () {
        this.viewInit = true;
        this.loadViewer();
    };
    StimulsoftViewerComponent.prototype.initEvents = function () {
        var _this = this;
        this.controller.getMessage().subscribe(function (message) {
            switch (message.action) {
                case 'GetReport':
                case 'OpenReport':
                    setTimeout(function () {
                        _this.loaded.next();
                    });
                    break;
            }
        });
        this.controller.getActionMessage().subscribe(function (message) {
            switch (message.action) {
                case 'Error':
                    setTimeout(function () {
                        _this.error.next(_this.model.errorMessage);
                    });
                    break;
                case 'ExportReport':
                    setTimeout(function () {
                        _this.export.next(message.data);
                    });
                    break;
                case 'Email':
                    setTimeout(function () {
                        _this.email.next(message.data);
                    });
                    break;
                case 'Print':
                    setTimeout(function () {
                        _this.print.next(message.data);
                    });
                    break;
                case 'Design':
                    setTimeout(function () {
                        _this.design.next();
                    });
                    break;
            }
        });
    };
    StimulsoftViewerComponent.prototype.loadViewer = function () {
        if (this.viewInit) {
            this.model.requestUrl = this.requestUrl;
            this.model.action = this.action;
            this.model.properties = this.properties;
            this.controller.loadViewer();
            this.resize();
            this.model.controls.viewer.el = this.viewerElement;
        }
    };
    StimulsoftViewerComponent.prototype.resize = function () {
        var _a;
        if ((_a = this.viewerElement) === null || _a === void 0 ? void 0 : _a.nativeElement) {
            this.model.viewerSize = { width: this.viewerElement.nativeElement.offsetWidth, height: this.viewerElement.nativeElement.offsetHeight };
            this.controller.viewerResized();
        }
    };
    StimulsoftViewerComponent.ctorParameters = function () { return [
        { type: ControllerService },
        { type: MenuService },
        { type: ModelService },
        { type: ExportService },
        { type: FormService },
        { type: ApiService },
        { type: PrintService },
        { type: DashboardService }
    ]; };
    __decorate([
        ViewChild('viewer')
    ], StimulsoftViewerComponent.prototype, "viewerElement", void 0);
    __decorate([
        Output()
    ], StimulsoftViewerComponent.prototype, "loaded", void 0);
    __decorate([
        Output()
    ], StimulsoftViewerComponent.prototype, "error", void 0);
    __decorate([
        Output()
    ], StimulsoftViewerComponent.prototype, "export", void 0);
    __decorate([
        Output()
    ], StimulsoftViewerComponent.prototype, "email", void 0);
    __decorate([
        Output()
    ], StimulsoftViewerComponent.prototype, "print", void 0);
    __decorate([
        Output()
    ], StimulsoftViewerComponent.prototype, "design", void 0);
    __decorate([
        Input()
    ], StimulsoftViewerComponent.prototype, "requestUrl", void 0);
    __decorate([
        Input()
    ], StimulsoftViewerComponent.prototype, "action", void 0);
    __decorate([
        Input()
    ], StimulsoftViewerComponent.prototype, "properties", void 0);
    __decorate([
        Input()
    ], StimulsoftViewerComponent.prototype, "width", void 0);
    __decorate([
        Input()
    ], StimulsoftViewerComponent.prototype, "height", void 0);
    __decorate([
        Input()
    ], StimulsoftViewerComponent.prototype, "backgroundColor", void 0);
    __decorate([
        Input()
    ], StimulsoftViewerComponent.prototype, "style", void 0);
    StimulsoftViewerComponent = __decorate([
        Component({
            selector: 'stimulsoft-viewer-angular',
            template: "\n    <span #viewer [style]=\"style\"\n      [style.top.px]=\"0\"\n      [style.right.px]=\"0\"\n      [style.bottom.px]=\"0\"\n      [style.left.px]=\"0\"\n      [style.display]=\"'inline-block'\"\n      [style.backgroundColor]=\"backgroundColor\"\n      [style.width]=\"this.width != null ? this.width : '100%'\"\n      [style.height]=\"this.height != null ? this.height : (model.options?.appearance.scrollbarsMode ? '650px' : '100%')\">\n      <div class=\"stiJsViewerMainPanel\">\n        <sti-center-text *ngIf=\"initialized\"></sti-center-text>\n        <sti-toolbar *ngIf=\"initialized\"></sti-toolbar>\n        <div *ngFor=\"let i of [1,2,3,4,5]\" [style.zIndex]=\"i * 10\" [style.display]=\"formService.form?.level == i ? '' : 'none'\" class=\"stiJsViewerDisabledPanel\"></div>\n        <sti-about-panel *ngIf=\"initialized\"></sti-about-panel>\n\n        <sti-dashboards-panel *ngIf=\"initialized\"></sti-dashboards-panel>\n        <sti-report-panel *ngIf=\"initialized\"></sti-report-panel>\n        <sti-progress *ngIf=\"initialized\"></sti-progress>\n        <sti-find-panel *ngIf=\"initialized\"></sti-find-panel>\n        <sti-drill-down-panel *ngIf=\"initialized\"></sti-drill-down-panel>\n        <sti-resources-panel *ngIf=\"initialized\"></sti-resources-panel>\n        <sti-navigate-panel *ngIf=\"initialized\"></sti-navigate-panel>\n\n        <sti-export-form *ngIf=\"initialized\" [exportFormSettings]=\"exportService.exportFormSettings\"></sti-export-form>\n        <sti-send-email-form *ngIf=\"initialized\"></sti-send-email-form>\n        <sti-password-form *ngIf=\"initialized\"></sti-password-form>\n        <sti-error-message-form *ngIf=\"initialized\"></sti-error-message-form>\n        <sti-notification-form *ngIf=\"initialized\"></sti-notification-form>\n\n        <sti-tooltip *ngIf=\"initialized\"></sti-tooltip>\n        <sti-menu *ngFor=\"let menu of menuService.menus\" [menu]=\"menu\"></sti-menu>\n        <sti-bookmarks-panel *ngIf=\"initialized\"></sti-bookmarks-panel>\n        <sti-interactions-panel *ngIf=\"initialized\"></sti-interactions-panel>\n\n        <sti-open-dialog *ngIf=\"initialized\" [fileMask]=\"model.openDialogFileMask\"></sti-open-dialog>\n      </div>\n    </span>\n  ",
            providers: [ModelService, StiHttpClientService, ControllerService, StylesService, HelperService, MenuService,
                MouseService, PageService, TooltipService, FindService, AnimationService, Md5Service, InteractionsService, FormService, RadioButtonService, ExportService,
                CollectionsService, MailService, EditableFieldsService, DrillDownService, PrintService, FullScreenService, ToolbarService, ApiService, DashboardService]
        })
    ], StimulsoftViewerComponent);
    return StimulsoftViewerComponent;
}());

var ButtonComponent = /** @class */ (function () {
    function ButtonComponent(model, controller, menuService, tooltipService, helper) {
        this.model = model;
        this.controller = controller;
        this.menuService = menuService;
        this.tooltipService = tooltipService;
        this.helper = helper;
        this.margin = '1px';
        this.height = '23px';
        this.selected = false;
        this.imageCellTextAlign = 'center';
        this.imageSizesWidth = 16;
        this.imageSizesHeight = 16;
        this.closeButton = false;
        this.resourceButton = false;
        this.navagationPanelTooltip = false;
        this.helpLink = 'user-manual/index.html?viewer_reports.htm';
        this.action = new EventEmitter();
        this.closeButtonAction = new EventEmitter();
        this.over = false;
        this.showMenu = false;
        this.closeButtonPressed = false;
        this.resourceButtonPressed = false;
        this._enabled = true;
        this.canShowTooltip = true;
    }
    ButtonComponent.prototype.ngOnInit = function () {
        var _this = this;
        if (this.menuItems) {
            setTimeout(function () {
                _this.menuObj = { type: 'buttonMenu', name: _this.actionName, items: _this.menuItems, parent: !_this.resourceButton ? _this.button : _this.resButtonEl };
                _this.menuService.addMenu(_this.menuObj);
            }, 500);
        }
    };
    Object.defineProperty(ButtonComponent.prototype, "styleName", {
        get: function () {
            return this._styleName || 'stiJsViewerStandartSmallButton';
        },
        set: function (value) {
            this._styleName = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ButtonComponent.prototype, "enabled", {
        get: function () {
            return this._enabled;
        },
        set: function (value) {
            if (!value) {
                this.over = false;
            }
            this._enabled = value;
        },
        enumerable: true,
        configurable: true
    });
    ButtonComponent.prototype.mouseover = function () {
        var _this = this;
        if (!this.enabled) {
            return;
        }
        this.over = true;
        if (this.model.options.toolbar.showMenuMode === 'Hover' && ['Print', 'Save', 'SendEmail', 'Zoom', 'ViewMode'].some(function (a) { return a === _this.actionName; })) {
            this.tooltipService.hideImmediately();
            this.menuService.showMenu(this.actionName);
        }
        else if (this.tooltip && !this.menuService.menus.some(function (e) { return e.state === 'expanded'; }) && this.canShowTooltip) {
            var top_1 = !this.navagationPanelTooltip ? this.model.controls.toolbar.offsetHeight + this.model.controls.dashboardsPanel.offsetHeight :
                this.helper.findPosY(this.model.controls.navigatePanel.el.nativeElement, 'stiJsViewerMainPanel');
            var tooltip = this.tooltip === true ? (this.model.localization[this.actionName + 'ToolTip'] != null ? this.model.loc(this.actionName + 'ToolTip') : this.model.loc(this.actionName)) : this.tooltip;
            this.tooltipService.show(this.helper.findPosX(this.button.nativeElement, 'stiJsViewerMainPanel'), top_1, tooltip, !this.navagationPanelTooltip, this.helpLink);
        }
    };
    ButtonComponent.prototype.mouseout = function () {
        var _this = this;
        if (!this.enabled) {
            return;
        }
        this.over = false;
        this.tooltipService.hide();
        setTimeout(function () {
            _this.canShowTooltip = true;
        }, 1000);
    };
    ButtonComponent.prototype.click = function () {
        if (this.enabled && !this.closeButtonPressed) {
            this.tooltipService.hideImmediately();
            if (this.menuItems == null || (this.resourceButton && !this.resourceButtonPressed)) {
                this.action.emit();
            }
            else {
                this.menuService.showMenu(this.actionName);
            }
        }
        this.canShowTooltip = false;
        this.closeButtonPressed = false;
        this.resourceButtonPressed = false;
    };
    Object.defineProperty(ButtonComponent.prototype, "className", {
        get: function () {
            var _a;
            return this.styleName ? this.styleName + ' ' + (this.enabled ? (this.styleName + ((this.selected || ((_a = this.menuObj) === null || _a === void 0 ? void 0 : _a.state) === 'expanded') ? 'Selected' : (this.over ? 'Over' : 'Default'))) : this.styleName + 'Disabled') : '';
        },
        enumerable: true,
        configurable: true
    });
    ButtonComponent.ctorParameters = function () { return [
        { type: ModelService },
        { type: ControllerService },
        { type: MenuService },
        { type: TooltipService },
        { type: HelperService }
    ]; };
    __decorate([
        Input()
    ], ButtonComponent.prototype, "caption", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "caption2", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "captionAlign", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "captionPadding", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "captionPaddingLeft", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "captionWhiteSpace", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "captionOverflow", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "captionTextOverflow", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "captionWidth", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "captionMaxWidth", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "captionLineHeight", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "imageName", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "arrow", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "arrowMarginTop", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "margin", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "height", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "selected", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "minWidth", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "innerTableWidth", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "menuItems", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "actionName", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "tooltip", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "imageCellTextAlign", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "imageCellWidth", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "imageCellPadding", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "imageSizesWidth", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "imageSizesHeight", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "imageMargin", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "width", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "display", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "closeButton", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "resourceButton", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "styleColors", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "boxSizing", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "navagationPanelTooltip", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "cursor", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "fontSize", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "helpLink", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "borderColor", void 0);
    __decorate([
        Output()
    ], ButtonComponent.prototype, "action", void 0);
    __decorate([
        Output()
    ], ButtonComponent.prototype, "closeButtonAction", void 0);
    __decorate([
        ViewChild('button')
    ], ButtonComponent.prototype, "button", void 0);
    __decorate([
        ViewChild('resButtonEl')
    ], ButtonComponent.prototype, "resButtonEl", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "styleName", null);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "enabled", null);
    ButtonComponent = __decorate([
        Component({
            selector: 'sti-button',
            template: "\n  <div #button\n    [style.fontFamily]=\"model.options.toolbar.fontFamily\"\n    [style.cursor]=\"cursor\"\n    [style.borderColor]=\"borderColor\"\n    [class]=\"className\"\n    [style]=\"{height: helper.val(height, '23px'), boxSizing: helper.val(boxSizing, 'content-box'), margin: helper.val(margin, '1px'), minWidth: minWidth, width: width, display: display }\"\n    [style.fontSize]=\"fontSize\"\n    (mouseover)=\"mouseover()\"\n    (mouseout)=\"mouseout()\"\n    (click)=\"click()\" >\n    <table class=\"stiJsViewerClearAllStyles\" cellpadding=\"0\" cellspacing=\"0\" style=\"height: 100%;width:100%\" [style.width]=\"innerTableWidth\">\n      <tbody>\n        <tr class=\"stiJsViewerClearAllStyles\">\n          <td *ngIf=\"imageName != null\" [style]=\"{lineHeight:'0', padding:helper.val(imageCellPadding, '0 3px'), textAlign: imageCellTextAlign, width: imageCellWidth}\" class=\"stiJsViewerClearAllStyles\">\n            <img src=\"{{model.img(imageName)}}\" [style.opacity]=\"enabled ? '1' : '0.5'\"\n                [style.width.px]=\"imageSizesWidth\"\n                [style.height.px]=\"imageSizesHeight\"\n                [style.margin]=\"imageMargin\">\n          </td>\n          <td *ngIf=\"caption != null\"\n             [style]=\"{whiteSpace:'nowrap', textAlign: captionAlign || 'left', padding:captionPadding || ((arrow ? '1px 0' : '1px 5px') + (imageName ? ' 0 0' : ' 0 5px')), width: captionWidth}\"\n             [style.maxWidth]=\"captionMaxWidth\"\n             [style.lineHeight]=\"captionLineHeight\"\n             [style.paddingLeft]=\"captionPaddingLeft\"\n             [style.whiteSpace]=\"captionWhiteSpace\"\n             [style.overflow]=\"captionOverflow\"\n             [style.textOverflow]=\"captionTextOverflow\"\n             class=\"stiJsViewerClearAllStyles\">\n            {{caption}}\n            <div *ngIf=\"caption2 != null\">\n            {{caption2}}\n            </div>\n          </td>\n          <td *ngIf=\"arrow\" class=\"stiJsViewerClearAllStyles\">\n            <img src=\"{{arrow == 'Up' || arrow == 'Down' ? model.img('Arrows.SmallArrow' + arrow + (arrow == 'Down' && styleColors && styleColors.isDarkStyle ? 'White.png' : '.png')) : model.img(arrow)}}\"\n            [style]=\"{lineHeight:'0', width:'8px', height:'8px', verticalAlign:'baseline', padding:caption ? '0 5px 0 5px' : '0 5px 0 2px', marginTop: arrowMarginTop}\"\n            [style.opacity]=\"enabled ? '1' : '0.5'\"/>\n          </td>\n\n          <td *ngIf=\"closeButton\" class=\"stiJsViewerClearAllStyles\">\n            <sti-button [imageName]=\"'CloseForm.png'\"\n              [imageMargin]=\"'1px 0 0 -1px'\"\n              [margin]=\"'0 2px 0 0'\"\n              [imageCellPadding]=\"'0'\"\n              [width]=\"model.options.isTouchDevice ? '22px' : '17px'\"\n              [height]=\"model.options.isTouchDevice ? '22px' : '17px'\"\n              (action)=\"closeButtonPressed = true; closeButtonAction.emit()\">\n            </sti-button>\n          </td>\n\n          <td #resButtonEl *ngIf=\"resourceButton\" style=\"width: 1px;\">\n            <sti-button [imageName]=\"'Arrows.SmallArrowDown.png'\"\n              [styleName]=\"'stiJsViewerResourceDropDownButton'\"\n              [innerTableWidth]=\"'100%'\"\n              [margin]=\"'0 7px 0 3px'\"\n              [imageCellTextAlign]=\"'center'\"\n              [imageSizesWidth]=\"8\"\n              [imageSizesHeight]=\"8\"\n              [height]=\"model.options.isTouchDevice ? '23px' : '17px'\"\n              [width]=\"model.options.isTouchDevice ? '23px' : '17px'\"\n              (action)=\"resourceButtonPressed = true;\">>\n            </sti-button>\n          </td>\n\n        </tr>\n      </tbody>\n    </table>\n  </div>\n  "
        })
    ], ButtonComponent);
    return ButtonComponent;
}());

var PageComponent = /** @class */ (function () {
    function PageComponent(model, controller) {
        this.model = model;
        this.controller = controller;
        this.touchesLength = 0;
        this.lastTouches = [{ x: 0, y: 0, time: 0 }, { x: 0, y: 0, time: 0 }];
        this.touchAllowPageAction = false;
        this.touchAllowScroll = false;
    }
    PageComponent.prototype.ngOnInit = function () {
    };
    PageComponent.prototype.ngAfterViewInit = function () {
        var e_1, _a;
        var page = this.element.nativeElement;
        page.innerHTML = this.pageAttributes.content;
        this.pageAttributes.page = page;
        // Correct Watermark
        if (this.pageAttributes.existsWatermark) {
            page.style.position = 'relative';
            try {
                for (var _b = __values(page.childNodes), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var childNode = _c.value;
                    if (childNode.className === 'stiWatermarkImage') {
                        childNode.style.width = 'auto';
                        childNode.style.height = 'auto';
                        break;
                    }
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_1) throw e_1.error; }
            }
        }
        if (this.model.options.appearance.reportDisplayMode === 'Div' || this.model.options.appearance.reportDisplayMode === 'Span') {
            var childs = page.getElementsByClassName('StiPageContainer');
            if (childs && childs.length > 0) {
                var pageContainer = childs[0];
                pageContainer.style.position = 'relative';
                if (this.model.options.appearance.reportDisplayMode === 'Span') {
                    pageContainer.style.margin = '0 1px'; // fix Chrome bug with SPAN position
                }
                page.style.width = (page.pageWidth - page.margins[1] - page.margins[3]) + 'px';
                page.style.height = (page.pageHeight - page.margins[0] - page.margins[2]) + 'px';
            }
        }
        this.element.nativeElement.pageAttributes = this.pageAttributes;
        /*const pageHeight = this.pageHeight;
        if (pageHeight !== 0) {
          // fixed bug with long time execute
          if (this.model.options.appearance.reportDisplayMode !== 'Table' && this.model.reportParams.viewMode !== 'SinglePage') {
            setTimeout(() => {
              const currentPageHeight = page.offsetHeight - this.margins[0] - this.margins[2];
              if (this.reportPanel.maxHeights[pageHeight] == null || currentPageHeight > this.reportPanel.maxHeights[pageHeight]) {
                this.reportPanel.maxHeights[pageHeight] = currentPageHeight;
              }
            });
          } else {
            const currentPageHeight = page.offsetHeight - this.margins[0] - this.margins[2];
            if (this.reportPanel.maxHeights[pageHeight] === null || currentPageHeight > this.reportPanel.maxHeights[pageHeight]) {
              this.reportPanel.maxHeights[pageHeight] = currentPageHeight;
            }
          }
        }*/
    };
    Object.defineProperty(PageComponent.prototype, "margins", {
        get: function () {
            var margins = [0, 0, 0, 0];
            if (this.pageAttributes.margins) {
                var marginsPx = this.pageAttributes.margins.split(' ');
                for (var i = 0; i < marginsPx.length; i++) {
                    margins[i] = parseInt(marginsPx[i].replace('px', ''), 10);
                }
            }
            return margins;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PageComponent.prototype, "pageWidth", {
        get: function () {
            var pageSizes = this.pageAttributes.sizes ? this.pageAttributes.sizes.split(';') : null;
            if (pageSizes) {
                return parseInt(pageSizes[0], 10);
            }
            return 0;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PageComponent.prototype, "pageHeight", {
        get: function () {
            var pageSizes = this.pageAttributes.sizes ? this.pageAttributes.sizes.split(';') : null;
            if (pageSizes) {
                return parseInt(pageSizes[1], 10);
            }
            return 0;
        },
        enumerable: true,
        configurable: true
    });
    PageComponent.prototype.eventTouchStart = function (e) {
        var reportPanel = this.model.controls.reportPanel.el.nativeElement;
        this.touchAllowPageAction = this.touchesLength === 0 && Math.abs(reportPanel.offsetWidth - reportPanel.scrollWidth) <= 10;
        this.touchAllowScroll = reportPanel.offsetWidth === reportPanel.scrollWidth;
        this.touchesLength++;
        if (this.touchAllowPageAction) {
            this.touchStartX = parseInt(e.changedTouches[0].clientX, 10);
            this.touchStartScrollY = reportPanel.scrollTop;
        }
    };
    PageComponent.prototype.eventTouchMove = function (e) {
        var reportPanel = this.model.controls.reportPanel.el.nativeElement;
        if (this.touchAllowPageAction) {
            this.lastTouches.shift();
            this.lastTouches.push({
                x: e.changedTouches[0].clientX,
                y: e.changedTouches[0].clientY,
                time: new Date().getTime()
            });
            if (this.touchAllowScroll && this.touchStartScrollY === reportPanel.scrollTop) {
                this.touchPosX = Math.trunc(this.lastTouches[1].x - this.touchStartX);
                if (scrollX === 0) {
                    this.element.nativeElement.style.transform = "translateX(" + this.touchPosX + "px)";
                }
            }
        }
    };
    PageComponent.prototype.eventTouchEnd = function (e) {
        var reportPanel = this.model.controls.reportPanel.el.nativeElement;
        if (this.touchesLength > 0) {
            this.touchesLength--;
        }
        if (this.touchAllowPageAction && this.touchesLength === 0) {
            var dX = this.lastTouches[1].x - this.lastTouches[0].x;
            var dT = new Date().getTime() - this.lastTouches[1].time;
            if (this.touchStartScrollY !== reportPanel.scrollTop ||
                (dX <= 0 && this.model.reportParams.pageNumber >= this.model.reportParams.pagesCount - 1) ||
                (dX >= 0 && this.model.reportParams.pageNumber <= 0)) {
                this.translateX(0);
            }
            else if ((dX < -5 && dT <= 14 && this.lastTouches[1].x < this.touchStartX) ||
                (dX < 0 && this.touchPosX < -this.pageWidth / 3)) {
                this.controller.action({ name: 'NextPage' });
                this.translateX(-this.pageWidth);
            }
            else if ((dX > 5 && dT <= 14 && this.lastTouches[1].x > this.touchStartX) ||
                (dX > 0 && this.touchPosX > this.pageWidth / 3)) {
                this.controller.action({ name: 'PrevPage' });
                this.translateX(this.pageWidth);
            }
            else {
                this.translateX(0);
            }
        }
    };
    PageComponent.prototype.translateX = function (value) {
        var _this = this;
        this.element.nativeElement.style.transitionDuration = '300ms';
        this.element.nativeElement.style.transform = value === 0 ? '' : "translateX(" + value + "px)";
        setTimeout(function () {
            _this.element.nativeElement.style.transitionDuration = '';
        }, 300);
    };
    PageComponent.ctorParameters = function () { return [
        { type: ModelService },
        { type: ControllerService }
    ]; };
    __decorate([
        ViewChild('element')
    ], PageComponent.prototype, "element", void 0);
    __decorate([
        Input()
    ], PageComponent.prototype, "pageAttributes", void 0);
    __decorate([
        Input()
    ], PageComponent.prototype, "reportPanel", void 0);
    PageComponent = __decorate([
        Component({
            selector: 'sti-page',
            template: "\n    <div #element\n      style=\"overflow: hidden; text-align: left; vertical-align: top; color: #000000; box-sizing: content-box; display:inline-block\"\n      [style.margin]=\"model.reportParams.viewMode === 'Continuous' ? '10px auto 10px auto' : '10px'\"\n      [style.display]=\"this.model.reportParams.viewMode === 'Continuous' ? 'table' : 'inline-block'\"\n      [style.border]=\"'1px solid ' + this.model.options.appearance.pageBorderColor\"\n      [style.background]=\"pageAttributes['background'] == 'Transparent' || pageAttributes.background == 'rgba(255,255,255,0)' ? 'White' : pageAttributes['background']\"\n      [style.padding]=\"pageAttributes['margins']\"\n      [style.width]=\"!pageAttributes['content'] ? pageWidth + 'px' : ''\"\n      [style.height]=\"!pageAttributes['content'] ? pageHeight + 'px' : ''\"\n      [class]=\"model.options.appearance.showPageShadow ? 'stiJsViewerPageShadow' : 'stiJsViewerPage'\"\n      (touchstart)=\"eventTouchStart($event)\"\n      (touchmove)=\"eventTouchMove($event)\"\n      (touchend)=\"eventTouchEnd($event)\">\n      </div>\n  "
        })
    ], PageComponent);
    return PageComponent;
}());

var ReportPanelComponent = /** @class */ (function () {
    function ReportPanelComponent(controller, model, stylesService, interactionService) {
        var _this = this;
        this.controller = controller;
        this.model = model;
        this.stylesService = stylesService;
        this.interactionService = interactionService;
        this.touchZoomFirstDistance = 0;
        this.touchZoomSecondDistance = 0;
        this.touchZoomValue = 0;
        this.maxHeights = {};
        controller.getMessage().subscribe(function (message) {
            if (message.action !== 'viewer_loaded' && _this.model.reportParams.pagesArray) {
                if (_this.model.reportParams.repaintOnlyDashboardContent) {
                    // jsObject.controls.reportPanel.repaintDashboardContent(parameters);
                }
                else {
                    _this.loadPages();
                }
            }
            if (message.action === 'GetReport' || message.action === 'OpenReport') {
                setTimeout(function () {
                    if (!_this.model.options.isParametersReceived && ((_this.model.reportParams.type === 'Report' && _this.model.options.toolbar.showParametersButton) || _this.model.reportParams.type === 'Dashboard')) {
                        interactionService.postInteraction({ action: 'InitVars' });
                    }
                    if (_this.model.reportParams.autoZoom) {
                        _this.controller.action({ name: _this.model.reportParams.autoZoom === -1 ? 'ZoomPageWidth' : 'ZoomOnePage' });
                        _this.model.reportParams.autoZoom = null;
                    }
                });
            }
        });
    }
    ReportPanelComponent.prototype.ngOnInit = function () { };
    ReportPanelComponent.prototype.ngAfterViewInit = function () {
        this.model.controls.reportPanel.el = this.element;
    };
    ReportPanelComponent.prototype.loadPages = function () {
        var _this = this;
        this.maxHeights = {};
        var pagesArray = this.model.reportParams.pagesArray;
        this.stylesService.setupStyle(pagesArray[pagesArray.length - 2], 'page');
        var chartScript = pagesArray[pagesArray.length - 1];
        this.model.pages = pagesArray.slice(0, pagesArray.length - 2);
        setTimeout(function () {
            _this.model.pages.forEach(function (page) { return _this.interactionService.initializeInteractions(page.page); });
            _this.interactionService.updateAllHyperLinks();
            _this.stylesService.addChartScript(chartScript);
        });
    };
    Object.defineProperty(ReportPanelComponent.prototype, "position", {
        get: function () {
            return this.model.options.heightType !== 'Percentage' || this.model.options.appearance.scrollbarsMode ? 'absolute' : 'relative';
        },
        enumerable: true,
        configurable: true
    });
    ReportPanelComponent.prototype.scroll = function () {
        var _this = this;
        if (this.model.pagesNavigationIsActive()) {
            clearTimeout(this.scrollTimeout);
            // update current page number
            this.scrollTimeout = setTimeout(function () {
                var commonPagesHeight = 0;
                var index = 0;
                for (index = 0; index < _this.model.pages.length; index++) {
                    commonPagesHeight += _this.model.pages[index].page.offsetHeight + 10;
                    if (commonPagesHeight > _this.element.nativeElement.scrollTop) {
                        break;
                    }
                }
                if (index < _this.model.reportParams.pagesCount && index >= 0 && index !== _this.model.reportParams.pageNumber) {
                    _this.model.reportParams.pageNumber = index;
                }
            }, 300);
        }
    };
    ReportPanelComponent.prototype.eventTouchStart = function (e) {
        this.touchesLength++;
        this.touchStartX = parseInt(e.changedTouches[0].clientX, 10);
        if (this.model.options.appearance.allowTouchZoom && this.touchesLength === 1) {
            this.touchZoomFirstDistance = 0;
            this.touchZoomSecondDistance = 0;
            this.touchZoomValue = 0;
        }
    };
    ReportPanelComponent.prototype.eventTouchMove = function (e) {
        if (this.model.options.appearance.allowTouchZoom && e.touches.length > 1) {
            if ('preventDefault' in e) {
                e.preventDefault();
            }
            this.touchZoomSecondDistance = Math.sqrt(Math.pow(e.touches[0].pageX - e.touches[1].pageX, 2) + Math.pow(e.touches[0].pageY - e.touches[1].pageY, 2));
            if (this.touchZoomFirstDistance === 0) {
                this.touchZoomFirstDistance = Math.sqrt(Math.pow(e.touches[0].pageX - e.touches[1].pageX, 2) + Math.pow(e.touches[0].pageY - e.touches[1].pageY, 2));
            }
            var touchZoomOffset = Math.trunc((this.touchZoomSecondDistance - this.touchZoomFirstDistance) / 2.5);
            if (Math.abs(touchZoomOffset) >= 5) {
                this.touchZoomValue = Math.trunc((this.model.reportParams.zoom + touchZoomOffset) / 5) * 5;
                this.touchZoomValue = Math.min(Math.max(this.touchZoomValue, 20), 200);
                this.controller.actionSubject.next({ action: 'centerText', data: this.touchZoomValue.toString() });
            }
        }
    };
    ReportPanelComponent.prototype.eventTouchEnd = function (e) {
        if (this.touchesLength > 0) {
            this.touchesLength--;
        }
        if (this.model.options.isMobileDevice && this.model.options.toolbar.autoHide) {
            if (Math.trunc(this.touchStartX - e.changedTouches[0].clientX) !== 0) {
                this.controller.keepToolbar();
            }
            else {
                if (!this.model.controls.toolbar.visible) {
                    this.controller.showToolbar();
                }
                else {
                    this.controller.hideToolbar();
                }
            }
        }
        if (this.model.options.appearance.allowTouchZoom && this.touchZoomValue !== 0 && this.touchesLength === 0) {
            this.controller.actionSubject.next({ action: 'hideCenterText' });
            this.model.reportParams.zoom = this.touchZoomValue;
            this.controller.post('GetPages');
        }
    };
    ReportPanelComponent.ctorParameters = function () { return [
        { type: ControllerService },
        { type: ModelService },
        { type: StylesService },
        { type: InteractionsService }
    ]; };
    __decorate([
        ViewChild('element')
    ], ReportPanelComponent.prototype, "element", void 0);
    ReportPanelComponent = __decorate([
        Component({
            selector: 'sti-report-panel',
            template: "\n    <div #element\n         [style.textAlign]=\"model.options.appearance.pageAlignment == 'default' ? 'center' : model.options.appearance.pageAlignment\"\n         [style.top]=\"0\"\n         [style.bottom]=\"0\"\n         [style.position]=\"position\"\n         [style.height]=\"model.options.heightType != 'Percentage' || model.options.appearance.scrollbarsMode ? 'auto' : 'calc(100% - 35px)'\"\n         [style.overflow] = \"model.reportParams.type == 'Report' && model.options.appearance.scrollbarsMode ? 'auto' : 'hidden'\"\n         [style.marginTop.px]=\"model.controls.reportPanel.layout.top\"\n         [style.marginLeft.px]=\"model.controls.reportPanel.layout.left\"\n         [style.marginBottom.px]=\"position == 'absolute' ? model.controls.reportPanel.layout.bottom : 0\"\n         [style.paddingBottom.px]=\"position == 'relative' ? model.controls.reportPanel.layout.bottom : 0\"\n         [style.transition]=\"model.options.isMobileDevice ? 'margin 200ms ease' : null\"\n         (scroll)=\"scroll()\"\n         class=\"stiJsViewerReportPanel\"\n         (touchstart)=\"eventTouchStart($event)\"\n         (touchmove)=\"eventTouchMove($event)\"\n         (touchend)=\"eventTouchEnd($event)\">\n      <sti-page *ngFor=\"let page of model.pages\" [pageAttributes]=\"page\" [reportPanel]=\"this\"></sti-page>\n    </div>\n  "
        })
    ], ReportPanelComponent);
    return ReportPanelComponent;
}());

var ToolbarComponent = /** @class */ (function () {
    function ToolbarComponent(model, controller, toolbarService) {
        this.model = model;
        this.controller = controller;
        this.toolbarService = toolbarService;
    }
    ToolbarComponent.prototype.ngAfterViewInit = function () {
        this.model.controls.toolbar.el = this.element;
    };
    ToolbarComponent.prototype.ngOnInit = function () {
        this.toolbarService.initButtons();
    };
    ToolbarComponent.ctorParameters = function () { return [
        { type: ModelService },
        { type: ControllerService },
        { type: ToolbarService }
    ]; };
    __decorate([
        ViewChild('element')
    ], ToolbarComponent.prototype, "element", void 0);
    ToolbarComponent = __decorate([
        Component({
            selector: 'sti-toolbar',
            template: "\n    <div #element [class]=\"'stiJsViewerToolBar' + (model.options.toolbar.displayMode === 'Separated' ? '  stiJsViewerToolBarSeparated' : '')\" style=\"display: block\"\n         [style.width.px]=\"!model.controls.toolbar.visible ? '0px' : ''\"\n         [style.height.px]=\"!model.controls.toolbar.visible ? '0px' : ''\"\n         [style.display]=\"!model.options.isMobileDevice ? (this.model.controls.toolbar.visible ? '' : 'none') : ''\"\n         [style.transition]=\"model.options.isMobileDevice ? 'margin 300ms ease, opacity 300ms ease' : null\"\n         [style.zIndex]=\"model.options.toolbar.autoHide ? 5 : 2\"\n         [style.position]=\"model.options.toolbar.autoHide ? 'absolute' : 'relative'\"\n         [style.opacity]=\"model.options.isMobileDevice ? (model.controls.toolbar.visible ? (model.options.toolbar.autoHide ? 0.9 : 1) : 0) : 1\"\n         [style.marginTop]=\"model.options.isMobileDevice && !model.controls.toolbar.visible ? '-0.55in' : 0\">\n      <div [style]=\"model.options.toolbar.displayMode === 'Simple' ? 'paddingTop: 2px' : ''\">\n        <table class=\"stiJsViewerToolBarTable\" style=\"margin: 0px; box-sizing: border-box;\"\n               cellpadding=\"0\" cellspacing=\"0\"\n               [style.background]=\"model.options.toolbar.backgroundColor !== '' ? model.options.toolbar.backgroundColor : ''\"\n               [style.border]=\"model.options.toolbar.displayMode === 'Separated' ? '0px' : (model.options.toolbar.borderColor !== '' ?  '1px solid ' + model.options.toolbar.borderColor : '')\"\n               [style.color]=\"model.options.toolbar.fontColor !== '' ? model.options.toolbar.fontColor : ''\"\n               [style.fontFamily]=\"model.options.toolbar.fontFamily\">\n          <tbody>\n            <tr class=\"stiJsViewerClearAllStyles\">\n              <td *ngIf=\"model.options.appearance.rightToLeft\">\n              <sti-toolbar-dop [comps]=\"toolbarService.dopComps\" ></sti-toolbar-dop>\n              </td>\n\n              <td class=\"stiJsViewerClearAllStyles\" style=\"width: 100%\">\n                <sti-toolbar-dop\n                  [align]=\"model.options.appearance.rightToLeft ? 'right' : (model.options.toolbar.alignment === 'default' ? 'left' : model.options.toolbar.alignment)\"\n                  [comps]=\"toolbarService.comps\">\n                </sti-toolbar-dop>\n              </td>\n\n              <td *ngIf=\"!model.options.appearance.rightToLeft\">\n                <sti-toolbar-dop [comps]=\"toolbarService.dopComps\" ></sti-toolbar-dop>\n              </td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n      <div class=\"stiJsViewerDisabledPanel\" [style.display]=\"this.model.controls.toolbar.enabled ? 'none' : 'block'\"></div>\n    </div>\n  "
        })
    ], ToolbarComponent);
    return ToolbarComponent;
}());

var ToolbarSeparatorComponent = /** @class */ (function () {
    function ToolbarSeparatorComponent(model) {
        this.model = model;
    }
    ToolbarSeparatorComponent.prototype.ngOnInit = function () { };
    ToolbarSeparatorComponent.ctorParameters = function () { return [
        { type: ModelService }
    ]; };
    ToolbarSeparatorComponent = __decorate([
        Component({
            selector: 'sti-toolbar-separator',
            template: "\n    <div style=\"width:1px\" [style.height]=\"model.options.isMobileDevice ? '0.4in' : (model.options.isTouchDevice ? '26px' : '21px')\" class=\"stiJsViewerToolBarSeparator\"></div>\n  "
        })
    ], ToolbarSeparatorComponent);
    return ToolbarSeparatorComponent;
}());

var PageControlComponent = /** @class */ (function () {
    function PageControlComponent(model, controller, helper) {
        this.model = model;
        this.controller = controller;
        this.helper = helper;
        this.enabled = true;
        this.count = '?';
    }
    PageControlComponent.prototype.ngOnInit = function () { };
    PageControlComponent.prototype.textBoxAction = function (target) {
        if (this.model.reportParams.pagesCount > 0 && this.model.reportParams.pageNumber !== this.getCorrectValue(target.value) - 1) {
            this.controller.action({ name: 'GoToPage', value: this.getCorrectValue(target.value) - 1 });
        }
    };
    PageControlComponent.prototype.getCorrectValue = function (value) {
        value = parseInt(value, 10);
        if (value < 1 || !value) {
            value = 1;
        }
        if (value > this.model.reportParams.pagesCount) {
            value = this.model.reportParams.pagesCount;
        }
        return value;
    };
    Object.defineProperty(PageControlComponent.prototype, "textBoxColor", {
        get: function () {
            var toolbarFontColor = this.model.options.toolbar.fontColor;
            return this.enabled ? (toolbarFontColor && toolbarFontColor !== 'Empty' ? toolbarFontColor : '#444444')
                : (this.model.reportParams && this.model.reportParams.viewMode !== 'SinglePage' ? 'transparent' : toolbarFontColor);
        },
        enumerable: true,
        configurable: true
    });
    PageControlComponent.ctorParameters = function () { return [
        { type: ModelService },
        { type: ControllerService },
        { type: HelperService }
    ]; };
    __decorate([
        Input()
    ], PageControlComponent.prototype, "enabled", void 0);
    __decorate([
        Input()
    ], PageControlComponent.prototype, "count", void 0);
    __decorate([
        Input()
    ], PageControlComponent.prototype, "textBoxBorder", void 0);
    __decorate([
        Input()
    ], PageControlComponent.prototype, "margin", void 0);
    PageControlComponent = __decorate([
        Component({
            selector: 'sti-page-control',
            template: "\n    <table class=\"stiJsViewerClearAllStyles\" cellpadding=\"0\" cellspacing=\"0\" [style.margin]=\"helper.val(margin, '1px')\">\n      <tbody>\n          <tr class=\"stiJsViewerClearAllStyles\">\n            <td class=\"stiJsViewerClearAllStyles\" style=\"padding: '0 2px 0 2px' \">\n              {{model.loc('Page')}}\n            </td>\n            <td *ngIf=\"model.options.isMobileDevice\" class=\"stiJsViewerClearAllStyles\" style=\"padding: '0 2px 0 2px' \">\n              <span>{{model.reportParams.pageNumber + 1}}</span>\n            </td>\n            <td *ngIf=\"!model.options.isMobileDevice\" class=\"stiJsViewerClearAllStyles\" style=\"padding: '0 2px 0 2px' \">\n              <sti-text-box [width]=\"45\" [enabled]=\"enabled\" [style.color]=\"textBoxColor\" [style.opacity]=\"enabled ? 1 : 0.5\"\n              (action)=\"textBoxAction($event)\" [value]=\"model.reportParams.pageNumber + 1\" [border]=\"textBoxBorder\"></sti-text-box>\n            </td>\n            <td class=\"stiJsViewerClearAllStyles\" style=\"padding: '0 2px 0 2px' \">\n              {{model.loc('PageOf')}}\n            </td>\n            <td class=\"stiJsViewerClearAllStyles\" style=\"padding: '0 2px 0 2px' \">\n              {{count}}\n            </td>\n          </tr>\n      </tbody>\n    </table>\n  "
        })
    ], PageControlComponent);
    return PageControlComponent;
}());

var TextBoxComponent = /** @class */ (function () {
    function TextBoxComponent(model) {
        this.model = model;
        this.enabled = true;
        this.focusOnCreate = false;
        this.action = new EventEmitter();
        this.onchange = new EventEmitter();
        this.onblur = new EventEmitter();
        this.selected = false;
        this.focused = false;
        this.over = false;
        this._readOnly = false;
        this.styleName = 'stiJsViewerTextBox';
    }
    TextBoxComponent.prototype.ngAfterViewInit = function () {
        var _this = this;
        if (this.focusOnCreate) {
            setTimeout(function () {
                _this.element.nativeElement.focus();
            });
        }
    };
    TextBoxComponent.prototype.keypress = function (event) {
        if (!this.enabled) {
            return false;
        }
        if (event.keyCode === 13) {
            this.action.emit(event.target);
        }
    };
    TextBoxComponent.prototype.onchanged = function (event) {
        this.onchange.emit(event.target);
    };
    TextBoxComponent.prototype.focus = function () {
        this.oldValue = this.element.nativeElement.value;
    };
    Object.defineProperty(TextBoxComponent.prototype, "height", {
        get: function () {
            return this.model.options.isTouchDevice ? '26px' : '21px';
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBoxComponent.prototype, "className", {
        get: function () {
            if (this._readOnly) {
                return this.styleName + ' ' + this.styleName + 'Default';
            }
            return this.styleName + ' ' + this.styleName + (this.selected ? 'Over' : (this.enabled ? (this.over ? 'Over' : 'Default') : 'Disabled'));
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBoxComponent.prototype, "readOnly", {
        get: function () {
            return this._readOnly;
        },
        set: function (value) {
            var _this = this;
            this._readOnly = value;
            setTimeout(function () {
                try {
                    _this.element.nativeElement.setAttribute('unselectable', value ? 'on' : 'off');
                    _this.element.nativeElement.setAttribute('onselectstart', value ? 'return false' : '');
                    _this.element.nativeElement.readOnly = value;
                }
                catch (e) { }
            });
        },
        enumerable: true,
        configurable: true
    });
    TextBoxComponent.prototype.ngOnInit = function () { };
    TextBoxComponent.ctorParameters = function () { return [
        { type: ModelService }
    ]; };
    __decorate([
        ViewChild('element')
    ], TextBoxComponent.prototype, "element", void 0);
    __decorate([
        Input()
    ], TextBoxComponent.prototype, "width", void 0);
    __decorate([
        Input()
    ], TextBoxComponent.prototype, "actionLostFocus", void 0);
    __decorate([
        Input()
    ], TextBoxComponent.prototype, "tooltip", void 0);
    __decorate([
        Input()
    ], TextBoxComponent.prototype, "enabled", void 0);
    __decorate([
        Input()
    ], TextBoxComponent.prototype, "value", void 0);
    __decorate([
        Input()
    ], TextBoxComponent.prototype, "margin", void 0);
    __decorate([
        Input()
    ], TextBoxComponent.prototype, "focusOnCreate", void 0);
    __decorate([
        Input()
    ], TextBoxComponent.prototype, "maxLength", void 0);
    __decorate([
        Input()
    ], TextBoxComponent.prototype, "color", void 0);
    __decorate([
        Input()
    ], TextBoxComponent.prototype, "type", void 0);
    __decorate([
        Input()
    ], TextBoxComponent.prototype, "padding", void 0);
    __decorate([
        Input()
    ], TextBoxComponent.prototype, "border", void 0);
    __decorate([
        Output()
    ], TextBoxComponent.prototype, "action", void 0);
    __decorate([
        Output()
    ], TextBoxComponent.prototype, "onchange", void 0);
    __decorate([
        Output()
    ], TextBoxComponent.prototype, "onblur", void 0);
    __decorate([
        Input()
    ], TextBoxComponent.prototype, "readOnly", null);
    TextBoxComponent = __decorate([
        Component({
            selector: 'sti-text-box',
            template: "\n    <input #element\n    [style]=\"{fontFamily:model.options.toolbar.fontFamily, height: height, lineHeight: height, boxSizing:'content-box'}\"\n    [style.color]=\"color ? color : (model.options.toolbar.fontColor != '' ? model.options.toolbar.fontColor : '')\"\n    [style.width]=\"width != null ? width + 'px' : ''\"\n    [style.margin]=\"margin\"\n    [style.cursor]=\"readOnly ? 'default' : ''\"\n    [style.padding]=\"padding\"\n    [style.border]=\"border\"\n    [title]=\"tooltip || ''\"\n    [class]=\"className\"\n    [value]=\"value || ''\"\n    [attr.maxLength]=\"maxLength\"\n    [attr.type]=\"type\"\n    (mouseover)=\"over=true\"\n    (mouseleave)=\"over=false\"\n    (focused)=\"focused=true; selected=true\"\n    (blur)=\"focused=false; selected=false; onblur.emit($event.target)\"\n    (keypress)=\"keypress($event)\"\n    (keyup)=\"onchanged($event)\"\n    (focus)=\"focus()\"/>\n  "
        })
    ], TextBoxComponent);
    return TextBoxComponent;
}());

var MenuComponent = /** @class */ (function () {
    function MenuComponent(model, controller, helper, menuService) {
        this.model = model;
        this.controller = controller;
        this.helper = helper;
        this.menuService = menuService;
        this.style = 'display: none';
        this.overflow = 'hidden';
    }
    MenuComponent.prototype.ngAfterViewInit = function () {
        this.menu.menuEl = this.menuEl;
        this.menu.innerContent = this.innerContent;
    };
    MenuComponent.prototype.ngOnInit = function () {
    };
    MenuComponent.prototype.startAnimation = function (event) {
        if (event.toState === 'expanded') {
            this.style = 'width: 350px; overflow: hidden';
            this.overflow = 'hidden';
        }
    };
    MenuComponent.prototype.doneAnimation = function (event) {
        if (event.toState === 'expanded') {
            this.style = 'overflow: visible;';
            this.overflow = this.menu.type.indexOf('parameterMenu') === 0 || this.model.options.isMobileDevice ? 'auto' : 'hidden';
        }
        else if (event.toState === 'initialUp' || event.toState === 'initialDown') {
            this.style = 'display: none';
            this.overflow = 'hidden';
        }
    };
    MenuComponent.prototype.menuClick = function (item) {
        this.menuService.closeAllMenus();
        this.controller.action({ name: item.name, value: item.value });
    };
    MenuComponent.prototype.mouseup = function () {
        this.menuService.menuMouseUp = this.menu.type;
    };
    Object.defineProperty(MenuComponent.prototype, "zIndex", {
        get: function () {
            return this.menu.type === 'datePickerMenu' ? 36 : (this.menu.type === 'verticalMenu' ? 37 : 35);
        },
        enumerable: true,
        configurable: true
    });
    MenuComponent.ctorParameters = function () { return [
        { type: ModelService },
        { type: ControllerService },
        { type: HelperService },
        { type: MenuService }
    ]; };
    __decorate([
        Input()
    ], MenuComponent.prototype, "menu", void 0);
    __decorate([
        ViewChild('menuEl')
    ], MenuComponent.prototype, "menuEl", void 0);
    __decorate([
        ViewChild('innerContent')
    ], MenuComponent.prototype, "innerContent", void 0);
    MenuComponent = __decorate([
        Component({
            selector: 'sti-menu',
            template: "\n      <div #menuEl class=\"stiJsViewerParentMenu\"\n      [style]=\"menu.sizeStyle || style\"\n      [style.top.px]=\"menu.top\"\n      [style.left.px]=\"menu.left\"\n      [style.zIndex]=\"zIndex\"\n      [style.height]=\"menu.type=='buttonMenu' && model.options.isMobileDevice ? '100%' : menu.height + 'px'\"\n      [@.disabled]=\"!model.options.toolbar.menuAnimation\"\n      (mouseup)=\"mouseup()\">\n        <div #innerContent [style]=\"{overflowX: 'hidden', overflowY: overflow}\"\n        [style.color]=\"model.options.toolbar.fontColor\"\n        [style.fontFamily]=\"model.options.toolbar.fontFamily\"\n        [style.maxHeight]=\"menu.type=='buttonMenu' && model.options.isMobileDevice ? '100%' : '450px'\"\n        [style.height]=\"menu.type=='buttonMenu' && model.options.isMobileDevice ? '100%' : null\"\n        [@expand]=\"menu.state || 'initialDown'\"\n        (@expand.start)=\"startAnimation($event)\"\n        (@expand.done)=\"doneAnimation($event)\"\n        [class]=\"helper.val(menu.menuStyleName, 'stiJsViewerMenu')\">\n            <ng-container *ngIf=\"menu.type=='buttonMenu'\">\n              <sti-menu-item *ngFor=\"let item of menu.items\" [item]=\"item\" (click)=\"menuClick(item)\"></sti-menu-item>\n            </ng-container>\n\n            <sti-parameter-menu-edit-list *ngIf=\"menu.type=='parameterMenuForEditList'\" [menu]=\"menu\">\n            </sti-parameter-menu-edit-list>\n\n            <sti-parameter-menu-not-edit-list *ngIf=\"menu.type=='parameterMenuForNotEditList'\" [menu]=\"menu\">\n            </sti-parameter-menu-not-edit-list>\n\n            <sti-parameter-menu-for-value *ngIf=\"menu.type=='parameterMenuForValue'\" [menu]=\"menu\">\n            </sti-parameter-menu-for-value>\n\n            <sti-parameter-menu-for-range *ngIf=\"menu.type=='parameterMenuForRange'\" [menu]=\"menu\">\n            </sti-parameter-menu-for-range>\n\n            <sti-date-picker-menu *ngIf=\"menu.type=='datePickerMenu'\" [menu]=\"menu\">\n            </sti-date-picker-menu>\n\n            <sti-double-date-picker-menu *ngIf=\"menu.type=='doubleDatePickerMenu'\" [menu]=\"menu\">\n            </sti-double-date-picker-menu>\n\n            <sti-document-security-menu *ngIf=\"menu.type=='documentSecurityMenu'\">\n            </sti-document-security-menu>\n\n            <sti-digital-signature-menu *ngIf=\"menu.type=='useDigitalSignatureMenu'\">\n            </sti-digital-signature-menu>\n\n            <sti-vertical-menu *ngIf=\"menu.type=='verticalMenu'\" [menu]=\"menu\">\n            </sti-vertical-menu>\n        </div>\n      </div>\n  ",
            animations: [
                trigger('expand', [
                    state('initialDown', style({ transform: 'translateY(-100%)' })),
                    state('initialUp', style({ transform: 'translateY(100%)' })),
                    state('initialLeft', style({ transform: 'translateX(-100%)' })),
                    state('expanded', style({ transform: 'translateY(0) translateX(0)' })),
                    transition('initialUp => expanded', [
                        animate('150ms ease-in-out')
                    ]),
                    transition('initialDown => expanded', [
                        animate('150ms ease-in-out')
                    ]),
                    transition('initialLeft => expanded', [
                        animate('150ms ease-in-out')
                    ]),
                    transition('expanded => initialLeft', [
                        animate('150ms ease-in-out')
                    ])
                ])
            ]
        })
    ], MenuComponent);
    return MenuComponent;
}());

var MenuItem = /** @class */ (function () {
    function MenuItem(name, caption, img, type, selected, imageSize, value) {
        this.name = name;
        this.caption = caption;
        this.img = img;
        this.type = type;
        this.selected = selected;
        this.imageSize = imageSize;
        this.value = value;
    }
    return MenuItem;
}());
var MenuItemComponent = /** @class */ (function () {
    function MenuItemComponent(model) {
        this.model = model;
        this.styleName = 'stiJsViewerMenuStandartItem';
        this.selected = false;
        this.over = false;
        this._enabled = true;
    }
    MenuItemComponent.prototype.ngOnInit = function () { };
    Object.defineProperty(MenuItemComponent.prototype, "enabled", {
        get: function () {
            return this._enabled;
        },
        set: function (value) {
            if (!value) {
                this.over = false;
            }
            this._enabled = value;
        },
        enumerable: true,
        configurable: true
    });
    MenuItemComponent.prototype.mouseover = function () {
        if (!this.enabled || !this.enabled) {
            return;
        }
        this.over = true;
    };
    MenuItemComponent.prototype.mouseout = function () {
        if (!this.enabled || !this.enabled) {
            return;
        }
        this.over = false;
    };
    Object.defineProperty(MenuItemComponent.prototype, "height", {
        get: function () {
            if (this.item.imageSize === 'Big') {
                return '38px';
            }
            else {
                return this.model.options.isMobileDevice ? '0.4in' : (this.model.options.isTouchDevice ? '30px' : '24px');
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(MenuItemComponent.prototype, "className", {
        get: function () {
            return this.styleName ? this.styleName + ' ' + (this.enabled ? (this.styleName + ((this.selected || this.item.selected) ? 'Selected' : (this.over ? 'Over' : ''))) : this.styleName + 'Disabled') : '';
        },
        enumerable: true,
        configurable: true
    });
    MenuItemComponent.ctorParameters = function () { return [
        { type: ModelService }
    ]; };
    __decorate([
        Input()
    ], MenuItemComponent.prototype, "item", void 0);
    __decorate([
        Input()
    ], MenuItemComponent.prototype, "styleName", void 0);
    __decorate([
        Input()
    ], MenuItemComponent.prototype, "enabled", null);
    MenuItemComponent = __decorate([
        Component({
            selector: 'sti-menu-item',
            template: "\n    <div *ngIf=\"item.type!='separator'\" [class]=\"className\" (mouseover)=\"mouseover()\"\n         (mouseout)=\"mouseout()\" [style.height]=\"height\">\n         <table style=\"height: 100%; width: 100%\" class=\"stiJsViewerClearAllStyles\" cellpadding=\"0\" cellspacing=\"0\">\n            <tr class=\"stiJsViewerClearAllStyles\">\n                <td *ngIf=\"item.img != null && !model.options.appearance.rightToLeft\" class=\"stiJsViewerClearAllStyles\" style=\"width:22px; min-width:22px; padding: 0; text-align:center; line-height: 0;\">\n                  <img *ngIf=\"item.img != ''\" [style.height.px]=\"item.imageSize === 'Big' ? 32 : 16\" [style.width.px]=\"item.imageSize === 'Big' ? 32 : 16\" src=\"{{model.img(item.img)}}\" />\n                </td>\n\n                <td *ngIf=\"item.caption != null\" class=\"stiJsViewerClearAllStyles\" style=\"white-space:nowrap\"\n                  [style.textAlign]=\"model.options.appearance.rightToLeft ? 'right' : 'left'\"\n                  [style.padding]=\"item.imageSize == 'None' ? '0 20px 0 30px' : '0 20px 0 7px'\">\n                  {{item.caption}}\n                </td>\n\n                <td *ngIf=\"item.img != null && model.options.appearance.rightToLeft\" class=\"stiJsViewerClearAllStyles\" style=\"width:22px; min-width:22px; padding: 0; text-align:center; line-height: 0;\">\n                  <img *ngIf=\"item.img != ''\" [style.height.px]=\"item.imageSize === 'Big' ? 32 : 16\" [style.width.px]=\"item.imageSize === 'Big' ? 32 : 16\" src=\"{{model.img(item.img)}}\" />\n                </td>\n            </tr>\n         </table>\n    </div>\n    <div *ngIf=\"item.type=='separator'\" class=\"stiJsViewerVerticalMenuSeparator\" [style.margin]=\"item.imageSize == 'Big' ? '1px 2px 1px 2px' : ''\">\n    </div>\n  "
        })
    ], MenuItemComponent);
    return MenuItemComponent;
}());

var TooltipComponent = /** @class */ (function () {
    function TooltipComponent(model, tooltipService, helper) {
        this.model = model;
        this.tooltipService = tooltipService;
        this.helper = helper;
    }
    TooltipComponent.prototype.ngAfterViewInit = function () {
        this.model.controls.tooltip.el = this.element;
    };
    TooltipComponent.prototype.ngOnInit = function () { };
    TooltipComponent.prototype.action = function () {
        this.helper.showHelpWindow(this.tooltipService.helpLink);
    };
    TooltipComponent.ctorParameters = function () { return [
        { type: ModelService },
        { type: TooltipService },
        { type: HelperService }
    ]; };
    __decorate([
        ViewChild('element')
    ], TooltipComponent.prototype, "element", void 0);
    TooltipComponent = __decorate([
        Component({
            selector: 'sti-tooltip',
            template: "\n      <div #element class='stiJsViewerToolTip' [@expandDown]=\"tooltipService.state\"\n        [style.left.px]='tooltipService.left' [style.top.px]='tooltipService.top'\n        (mouseover)=\"tooltipService.showFromTooltip()\" (mouseout)=\"tooltipService.hide()\">\n        <table class=\"stiJsViewerClearAllStyles\" cellpadding=\"0\" cellspacing=\"0\" style=\"height: 100%;\"\n          [style.border]=\"model.options.appearance.showTooltipsHelp ? '' : 0\">\n          <tbody>\n            <tr class=\"stiJsViewerClearAllStyles\">\n              <td class=\"stiJsViewerToolTipTextCell\">\n                {{tooltipService.caption}}\n              </td>\n            </tr>\n            <tr *ngIf=\"model.options.appearance.showTooltipsHelp\" class=\"stiJsViewerClearAllStyles\">\n              <td  class=\"stiJsViewerClearAllStyles\">\n                <sti-button [caption]=\"model.loc('TellMeMore')\"\n                    [imageName]=\"'HelpIcon.png'\"\n                    [margin]=\"'4px 8px 4px 8px'\"\n                    (action)='action()'\n                    [styleName]=\"'stiJsViewerHyperlinkButton'\">\n                </sti-button>\n              </td>\n            </tr>\n          </tbody>\n        </table>\n    </div>\n  ",
            animations: [
                trigger('expandDown', [
                    state('initial', style({ opacity: 0, display: 'none' })),
                    state('preInitial', style({ opacity: 0, display: 'block' })),
                    state('preInitial2', style({ opacity: 0, display: 'block' })),
                    state('expanded', style({ opacity: 1, display: 'block' })),
                    transition('preInitial => expanded', [
                        animate('300ms 300ms ease-in-out', keyframes([
                            style({ display: 'block', opacity: 0, offset: 0 }),
                            style({ display: 'block', opacity: 1, offset: 1 }),
                        ]))
                    ])
                ])
            ]
        })
    ], TooltipComponent);
    return TooltipComponent;
}());

var FindPanelComponent = /** @class */ (function () {
    function FindPanelComponent(model, findService, controller) {
        var _this = this;
        this.model = model;
        this.findService = findService;
        this.controller = controller;
        this.changeFind = false;
        this.initItems();
        controller.getMessage().subscribe(function (message) {
            switch (message.action) {
                case 'GetReport':
                case 'GetPages':
                case 'OpenReport':
                case 'Variables':
                    if (model.controls.findPanel.visible) {
                        setTimeout(function () {
                            _this.findService.hideFindLabels();
                            _this.find('Next');
                        });
                    }
                    break;
            }
        });
    }
    FindPanelComponent.prototype.ngAfterViewInit = function () {
        var _this = this;
        this.model.controls.findPanel.el = this.element;
        this.model.controls.findPanel.getVisibility().subscribe(function () {
            if (_this.model.controls.findPanel.visible) {
                _this.findService.text = '';
                setTimeout(function () {
                    _this.textBox.element.nativeElement.focus();
                });
            }
        });
    };
    FindPanelComponent.prototype.ngOnInit = function () { };
    FindPanelComponent.prototype.selected = function (item) {
        switch (item.action) {
            case 'MatchCase':
                return this.findService.matchCase;
            case 'MatchWholeWord':
                return this.findService.matchWholeWord;
        }
        return false;
    };
    FindPanelComponent.prototype.textBoxAction = function (target) {
        this.findService.text = target.value;
        this.find('Next');
    };
    FindPanelComponent.prototype.find = function (direction) {
        if (this.findService.text === '') {
            this.findService.hideFindLabels();
            return;
        }
        if (this.findService.lastFindText !== this.findService.text || this.changeFind) {
            this.changeFind = false;
            this.findService.showFindLabels();
        }
        else {
            this.findService.selectFindLabel(direction);
        }
    };
    FindPanelComponent.prototype.initItems = function () {
        this.items = [
            { type: 'button', action: 'close', img: 'CloseForm.png', margin: '2px' },
            { type: 'textBlock', action: 'text', caption: this.model.loc('FindWhat').replace(":", ""), margin: '2px' },
            { type: 'textBox', action: 'findTextBox', margin: '2px' },
            { type: 'button', action: 'FindPreviows', caption: this.model.loc('FindPrevious'), img: 'Arrows.ArrowUpBlue.png', margin: '2px' },
            { type: 'button', action: 'FindNext', caption: this.model.loc('FindNext'), img: 'Arrows.ArrowDownBlue.png', margin: '2px' },
            { type: 'button', action: 'MatchCase', caption: this.model.loc('MatchCase').replace('&', ''), margin: '2px' },
            { type: 'button', action: 'MatchWholeWord', caption: this.model.loc('MatchWholeWord').replace('&', ''), margin: '2px' }
        ];
    };
    FindPanelComponent.prototype.action = function (action) {
        switch (action) {
            case 'close':
                this.model.controls.findPanel.visible = false;
                break;
            case 'MatchCase':
                this.findService.matchCase = !this.findService.matchCase;
                this.changeFind = true;
                break;
            case 'MatchWholeWord':
                this.findService.matchWholeWord = !this.findService.matchWholeWord;
                this.changeFind = true;
                break;
            case 'FindPreviows':
                this.findService.text = this.textBox.element.nativeElement.value;
                this.find('Previous');
                break;
            case 'FindNext':
                this.findService.text = this.textBox.element.nativeElement.value;
                this.find('Next');
                break;
        }
    };
    FindPanelComponent.ctorParameters = function () { return [
        { type: ModelService },
        { type: FindService },
        { type: ControllerService }
    ]; };
    __decorate([
        ViewChild('element')
    ], FindPanelComponent.prototype, "element", void 0);
    __decorate([
        ViewChild('textBox')
    ], FindPanelComponent.prototype, "textBox", void 0);
    FindPanelComponent = __decorate([
        Component({
            selector: 'sti-find-panel',
            template: "\n    <div #element [style.display]=\"model.controls.findPanel.visible ? '' : 'none'\"\n    [class]=\"'stiJsViewerToolBar' + (model.options.toolbar.displayMode == 'Separated' ? ' stiJsViewerToolBarSeparated' : '')\">\n      <div [style.paddingTop]=\"model.options.toolbar.displayMode == 'Simple' ? '2px' : ''\">\n        <div class=\"stiJsViewerToolBarTable\" [style.border]=\"model.options.toolbar.displayMode == 'Separated' ? '0px' : ''\" style=\"box-sizing: border-box\">\n          <table class=\"stiJsViewerClearAllStyles\" cellpadding=\"0\" cellspacing=\"0\" style=\"margin: 0\">\n            <tbody>\n                <tr class=\"stiJsViewerClearAllStyles\">\n                   <td *ngFor=\"let item of items\"  class=\"stiJsViewerClearAllStyles\">\n                      <sti-button *ngIf=\"item.type=='button'\"\n                        [actionName]=\"item.action\"\n                        [imageName]=\"item.img\"\n                        [caption]=\"item.caption\"\n                        [margin]=\"item.margin\"\n                        [height]=\"model.options.toolbar.displayMode == 'Separated' ? '28px' : ''\"\n                        (action)=\"action(item.action)\"\n                        [selected]=\"selected(item)\"\n                        ></sti-button>\n                      <sti-text-box #textBox *ngIf=\"item.type=='textBox'\" [width]=\"170\"\n                        [margin]=\"item.margin\"\n                        [focusOnCreate]=\"true\"\n                        (action)=\"textBoxAction($event)\"\n                        [value]=\"findService.text\"></sti-text-box>\n                      <sti-text-block *ngIf=\"item.type=='textBlock'\" [margin]=\"item.margin\" [text]=\"item.caption\"></sti-text-block>\n                  </td>\n                </tr>\n            </tbody>\n          </table>\n        </div>\n      </div>\n    </div>\n  "
        })
    ], FindPanelComponent);
    return FindPanelComponent;
}());

var TextBlockComponent = /** @class */ (function () {
    function TextBlockComponent(model) {
        this.model = model;
    }
    TextBlockComponent.prototype.ngOnInit = function () { };
    TextBlockComponent.ctorParameters = function () { return [
        { type: ModelService }
    ]; };
    __decorate([
        Input()
    ], TextBlockComponent.prototype, "text", void 0);
    __decorate([
        Input()
    ], TextBlockComponent.prototype, "margin", void 0);
    TextBlockComponent = __decorate([
        Component({
            selector: 'sti-text-block',
            template: "\n    <div [style]=\"{fontFamily: model.options.toolbar.fontFamily, fontSize: '12px', paddingTop: '2px', margin: margin}\">\n      {{text || ''}}\n    </div>\n  "
        })
    ], TextBlockComponent);
    return TextBlockComponent;
}());

var BookmarksPanelComponent = /** @class */ (function () {
    function BookmarksPanelComponent(model, helper, controller) {
        var _this = this;
        this.model = model;
        this.helper = helper;
        this.controller = controller;
        controller.getMessage().subscribe(function (message) {
            if (message.action === 'GetReport' || message.action === 'OpenReport') {
                setTimeout(function () {
                    if (_this.model.reportParams.bookmarksContent != null) {
                        _this.create();
                    }
                    _this.model.controls.bookmarksPanel.visible = _this.model.reportParams.bookmarksContent !== null && !_this.model.options.isMobileDevice;
                });
            }
            else {
                // Go to the bookmark, if it present
                setTimeout(function () {
                    if (_this.model.options.bookmarkAnchor != null) {
                        _this.helper.scrollToAnchor(_this.model.options.bookmarkAnchor, _this.model.options.componentGuid);
                        _this.model.options.bookmarkAnchor = null;
                        _this.model.options.componentGuid = null;
                    }
                });
            }
        });
        this.model.controls.bookmarksPanel.getVisibility().subscribe(function (value) {
            if (!value) {
                _this.helper.removeBookmarksLabel();
                _this.clearSelected();
            }
        });
    }
    BookmarksPanelComponent.prototype.ngAfterViewInit = function () {
        this.model.controls.bookmarksPanel.el = this.element;
    };
    BookmarksPanelComponent.prototype.ngOnInit = function () { };
    BookmarksPanelComponent.prototype.getImg1 = function (node, i) {
        var _a;
        if (((_a = node.nodes) === null || _a === void 0 ? void 0 : _a.length) === 0) {
            return i !== this.model.nodes.length - 1 ? this.model.imagesForBookmark['join'] : this.model.imagesForBookmark['joinBottom'];
        }
        return node.open ? (i === this.model.nodes.length - 1 ? this.model.imagesForBookmark['minusBottom'] : this.model.imagesForBookmark['minus']) :
            (i === this.model.nodes.length - 1 ? this.model.imagesForBookmark['plusBottom'] : this.model.imagesForBookmark['plus']);
    };
    BookmarksPanelComponent.prototype.postAction = function (node) {
        this.clearSelected();
        this.controller.postBookmarkNodeAction(node);
    };
    BookmarksPanelComponent.prototype.clearSelected = function () {
        var _a;
        (_a = this.model.nodes) === null || _a === void 0 ? void 0 : _a.forEach(function (n) {
            n.selected = false;
            n.nodes.forEach(function (element) { return element.selected = false; });
        });
    };
    BookmarksPanelComponent.prototype.create = function () {
        var bookmarks = this.model.reportParams.bookmarksContent.split('bookmarks.add(');
        var root = bookmarks[1].replace('0,-1,\'', '');
        this.rootName = root.substr(0, root.indexOf('\''));
        var nodes = [];
        this.parseNodes(bookmarks.splice(2), 0, nodes);
        this.model.nodes = nodes;
    };
    BookmarksPanelComponent.prototype.parseNodes = function (bookmarks, index, nodes) {
        var _this = this;
        var folder;
        bookmarks.forEach(function (bookmark) {
            var str = bookmark.substr(bookmark.indexOf(',') + 1);
            var nodeType = parseInt(str.substr(0, str.indexOf(',')), 10);
            var node = _this.parseNode(str);
            if (nodeType === 0) {
                nodes.push(node);
                folder = node;
            }
            else {
                folder.nodes.push(node);
            }
        });
    };
    BookmarksPanelComponent.prototype.parseNode = function (str) {
        str = str.substr(str.indexOf(',') + 2);
        var name = this.unescape(str.substr(0, str.indexOf('\',')));
        str = str.substr(str.indexOf('\',') + 3);
        var url = str.substr(0, str.indexOf('\','));
        str = str.substr(str.indexOf('\',') + 3);
        var pageTitle = str.substr(0, str.indexOf('\','));
        str = str.substr(str.indexOf('\',') + 3);
        var componentGuid = str.substr(0, str.length - 3);
        return { name: name, url: url, page: parseInt(pageTitle.substr(5), 10) - 1, compunentGuid: componentGuid, nodes: [], open: false, selected: false };
    };
    BookmarksPanelComponent.prototype.unescape = function (str) {
        return str.replace(/\\&apos;/g, '\'')
            .replace(/\\&quot;/g, '"')
            .replace(/\\&gt;/g, '>')
            .replace(/\\&lt;/g, '<')
            .replace(/\\&amp;/g, '&');
    };
    Object.defineProperty(BookmarksPanelComponent.prototype, "bottom", {
        get: function () {
            if (this.model.options.isMobileDevice) {
                return this.model.options.toolbar.autoHide ? '0' : '0.5in';
            }
            else {
                return this.model.options.toolbar.displayMode === 'Separated' && this.model.options.toolbar.visible ? '35px' : '0';
            }
        },
        enumerable: true,
        configurable: true
    });
    BookmarksPanelComponent.ctorParameters = function () { return [
        { type: ModelService },
        { type: HelperService },
        { type: ControllerService }
    ]; };
    __decorate([
        ViewChild('element')
    ], BookmarksPanelComponent.prototype, "element", void 0);
    __decorate([
        ViewChild('bookmarksPanel')
    ], BookmarksPanelComponent.prototype, "bookmarksPanel", void 0);
    BookmarksPanelComponent = __decorate([
        Component({
            selector: 'sti-bookmarks-panel',
            template: "\n    <div #element [style]=\"{fontFamily: model.options.toolbar.fontFamily, fontColor: helper.val(model.options.toolbar.fontColor)}\"\n      [class]=\"'stiJsViewerBookmarksPanel' + (model.options.toolbar.displayMode == 'Separated' ? ' stiJsViewerBookmarksPanelSeparated' : '')\"\n      [style.width.px]=\"model.options.appearance.bookmarksTreeWidth - (model.options.toolbar.displayMode == 'Simple' ? 0 : 1)\"\n      [style.bottom]=\"bottom\"\n      [style.top.px]=\"model.controls.bookmarksPanel.layout.top\"\n      [style.transition]=\"model.options.isMobileDevice ? 'opacity 300ms ease' : null\"\n      [style.display]=\"!this.model.options.isMobileDevice ? (model.controls.bookmarksPanel.visible ? '' : 'none') : null\"\n      [@visibility]=\"!this.model.options.isMobileDevice ? null : (model.controls.bookmarksPanel.visible ? 'visible' : 'hidden')\">\n      <div #bookmarksPanel [class]=\"'stiJsViewerBookmarksContainer' + (model.options.toolbar.displayMode == 'Simple' ? ' stiJsViewerBookmarksContainerSimple' : '')\"\n           [style.background]=\"helper.val(model.options.toolbar.backgroundColor)\"\n           [style.border]=\"helper.val(model.options.toolbar.borderColor) != '' ? '1px solid ' + helper.val(model.options.toolbar.borderColor): ''\">\n           <div class=\"stiTree\">\n              <div class=\"stiTreeNode\">\n                <img style=\"width: 16px; height: 16px;\" [src]=\"model.imagesForBookmark['root']\"/>\n                <a class=\"node\">{{rootName}}</a>\n              </div>\n              <div class=\"clip\" style=\"display:block;\">\n                <ng-container *ngFor=\"let node of model.nodes; index as i\">\n                    <div class=\"stiTreeNode\">\n                        <a (click)=\"node.open = !node.open\">\n                            <img style=\"width: 18px; height: 18px\"\n                             [src]=\"getImg1(node, i)\"/>\n                        </a>\n                        <img style=\"width: 16px; height: 16px;\" [src]=\"node.nodes?.length == 0 ? model.imagesForBookmark['node'] :(node.open ? model.imagesForBookmark['folderOpen'] : model.imagesForBookmark['folder'])\"/>\n                        <a [class]=\"node.selected ? 'nodeSel' : 'node'\" (click)=\"postAction(node)\">{{node.name}}</a>\n                    </div>\n                    <div class=\"clip\" [style.display]=\"node.open ? 'block' : 'none'\">\n                      <div *ngFor=\"let subNode of node.nodes; index as k\" class=\"stiTreeNode\">\n                        <img style=\"width: 18px; height: 18px;\" [src]=\"i != model.nodes.length - 1 ? model.imagesForBookmark['line'] : model.imagesForBookmark['empty']\"/>\n                        <img style=\"width: 18px; height: 18px;\" [src]=\"k == node.nodes.length - 1 ? model.imagesForBookmark['joinBottom'] : model.imagesForBookmark['join']\"/>\n                        <img style=\"width: 16px; height: 16px;\" [src]=\"model.imagesForBookmark['node']\" />\n                        <a [class]=\"subNode.selected ? 'nodeSel' : 'node'\" (click)=\"postAction(subNode)\">{{subNode.name}}</a>\n                      </div>\n                    </div>\n                </ng-container>\n              </div>\n          </div>\n      </div>\n    </div>\n  ",
            animations: [
                trigger('visibility', [
                    state('visible', style({ opacity: 1, display: 'block' })),
                    state('hidden', style({ opacity: 0, display: 'none' })),
                    transition('hidden => visible', [
                        animate('300ms ease-in-out', keyframes([
                            style({ display: 'block', opacity: 0, offset: 0 }),
                            style({ display: 'block', opacity: 1, offset: 1 }),
                        ]))
                    ]),
                    transition('visible => hidden', [
                        animate('300ms ease-in-out', keyframes([
                            style({ display: 'block', opacity: 1, offset: 0 }),
                            style({ display: 'none', opacity: 0, offset: 1 }),
                        ]))
                    ])
                ])
            ]
        })
    ], BookmarksPanelComponent);
    return BookmarksPanelComponent;
}());

var InteractionsPanelComponent = /** @class */ (function () {
    function InteractionsPanelComponent(model, helper, interactionService, menuService, controller) {
        this.model = model;
        this.helper = helper;
        this.interactionService = interactionService;
        this.menuService = menuService;
        this.controller = controller;
        this.currentOpeningParameter = null;
        this.dropDownButtonWasClicked = false;
        this.dateTimeButtonWasClicked = false;
    }
    InteractionsPanelComponent.prototype.ngAfterViewInit = function () {
        this.model.controls.parametersPanel.el = this.element;
    };
    InteractionsPanelComponent.prototype.ngOnInit = function () { };
    InteractionsPanelComponent.prototype.getNameAlign = function (indexRow, indexColumn) {
        var index = this.index(indexRow, indexColumn);
        if (index < this.length() &&
            this.model.interactions.paramsVariables[index].basicType === 'Range' &&
            this.model.options.appearance.parametersPanelPosition === 'Left') {
            return 'top';
        }
        return '';
    };
    InteractionsPanelComponent.prototype.getNamePadding = function (indexRow, indexColumn) {
        var index = this.index(indexRow, indexColumn);
        if (index < this.length() &&
            this.model.interactions.paramsVariables[index].basicType === 'Range' &&
            this.model.options.appearance.parametersPanelPosition === 'Left') {
            return this.model.options.isTouchDevice ? '11px' : '9px';
        }
        return '';
    };
    InteractionsPanelComponent.prototype.getCaption = function (indexRow, indexColumn, checkLeft) {
        if (checkLeft === void 0) { checkLeft = true; }
        var index = this.index(indexRow, indexColumn);
        if (checkLeft && this.ifLeftRange(indexRow, indexColumn)) {
            return '';
        }
        return index < this.length() ? this.model.interactions.paramsVariables[index].alias : '';
    };
    InteractionsPanelComponent.prototype.ifLeftRange = function (indexRow, indexColumn) {
        var index = this.index(indexRow, indexColumn);
        return this.model.interactions.paramsVariables[index].basicType === 'Range' && this.model.options.appearance.parametersPanelPosition === 'Left';
    };
    InteractionsPanelComponent.prototype.getTitle = function (indexRow, indexColumn) {
        var index = this.index(indexRow, indexColumn);
        return index < this.length() ? this.model.interactions.paramsVariables[index].description : '';
    };
    InteractionsPanelComponent.prototype.index = function (indexRow, indexColumn) {
        return indexColumn * this.model.interactions.countInColumn.length + indexRow;
    };
    InteractionsPanelComponent.prototype.length = function () {
        var _a, _b;
        return ((_a = this.model.interactions) === null || _a === void 0 ? void 0 : _a.paramsVariables) != null ? Object.keys((_b = this.model.interactions) === null || _b === void 0 ? void 0 : _b.paramsVariables).length : 0;
    };
    Object.defineProperty(InteractionsPanelComponent.prototype, "className", {
        get: function () {
            var className = 'stiJsViewerParametersPanel';
            if (this.model.options.appearance.parametersPanelPosition === 'Top') {
                className += ' stiJsViewerParametersPanelTop';
                if (this.model.options.toolbar.displayMode === 'Separated') {
                    className += ' stiJsViewerParametersPanelSeparatedTop';
                }
            }
            return className;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(InteractionsPanelComponent.prototype, "top", {
        get: function () {
            var styleTop = this.model.options.toolbar.visible ? this.model.controls.toolbar.offsetHeight : 0;
            if (this.model.options.isMobileDevice && this.model.options.toolbar.autoHide) {
                styleTop = 0;
            }
            styleTop += this.model.controls.drillDownPanel.exists ? this.model.controls.drillDownPanel.offsetHeight : 0;
            styleTop += this.model.controls.findPanel.exists ? this.model.controls.findPanel.offsetHeight : 0;
            styleTop += this.model.controls.resourcesPanel.exists ? this.model.controls.resourcesPanel.offsetHeight : 0;
            return styleTop;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(InteractionsPanelComponent.prototype, "bottom", {
        get: function () {
            if (this.model.options.appearance.parametersPanelPosition === 'Left') {
                if (this.model.options.isMobileDevice) {
                    return this.model.options.toolbar.autoHide ? '0' : '0.5in';
                }
                else {
                    return this.model.options.toolbar.displayMode === 'Separated' && this.model.options.toolbar.visible ? '35px' : '0';
                }
            }
            return '';
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(InteractionsPanelComponent.prototype, "innerClassName", {
        get: function () {
            var className = this.model.options.toolbar.displayMode === 'Simple' ? 'stiJsViewerInnerParametersPanelSimple' : '';
            if (this.model.options.appearance.parametersPanelPosition === 'Left') {
                className += ' stiJsViewerInnerParametersPanelLeft';
                if (this.model.options.toolbar.displayMode === 'Separated') {
                    className += ' stiJsViewerInnerParametersPanelSeparatedLeft';
                }
            }
            return className;
        },
        enumerable: true,
        configurable: true
    });
    InteractionsPanelComponent.ctorParameters = function () { return [
        { type: ModelService },
        { type: HelperService },
        { type: InteractionsService },
        { type: MenuService },
        { type: ControllerService }
    ]; };
    __decorate([
        ViewChild('element')
    ], InteractionsPanelComponent.prototype, "element", void 0);
    InteractionsPanelComponent = __decorate([
        Component({
            selector: 'sti-interactions-panel',
            template: "\n    <div #element [class]=\"className\"\n       [style.display]=\"!this.model.options.isMobileDevice ? (model.controls.parametersPanel.visible ? '' : 'none') : null\"\n       [style.fontFamily]=\"model.options.toolbar.fontFamily\"\n       [style.color]=\"model.options.toolbar.fontColor\"\n       [style.top.px]=\"top\"\n       [style.left.px]=\"model.controls.parametersPanel.layout.left\"\n       [style.bottom]=\"bottom\"\n       [style.transition]=\"model.options.isMobileDevice ? 'opacity 300ms ease' : null\"\n       [@visibility]=\"!this.model.options.isMobileDevice ? null : (model.controls.parametersPanel.visible ? 'visible' : 'hidden')\">\n       <div [class]=\"innerClassName\" [style.marginTop]=\"model.options.toolbar.displayMode == 'Simple' ? '2px' : ''\" (scroll)=\"menuService.closeAllMenus()\">\n         <div class=\"stiJsViewerInnerContainerParametersPanel\"\n              [style.background]=\"helper.val(model.options.toolbar.backgroundColor, '')\"\n              [style.border]=\"helper.val(model.options.toolbar.backgroundColor, '') != '' ? '1px solid ' + helper.val(model.options.toolbar.backgroundColor, '') : ''\"\n              [style.maxHeight]=\"model.options.appearance.parametersPanelPosition == 'Top' ? model.options.appearance.parametersPanelMaxHeight + 'px' : ''\"\n              (scroll)=\"menuService.closeAllMenus()\">\n            <table *ngIf=\"model.interactions\" class=\"stiJsViewerClearAllStyles\" cellpadding=\"0\" cellspacing=\"0\" style=\"border: 0px;\">\n              <tbody>\n                <tr *ngFor=\"let item of model.interactions.countInColumn; let indexRow=index\" >\n                  <ng-container *ngFor=\"let item2 of model.interactions.countColumns; let indexColumn=index\">\n                    <ng-container *ngIf=\"index(indexRow, indexColumn) <= length()\">\n                        <td [style.padding]=\"'0 10px 0 ' + (indexColumn > 0 ? '30px' : '0')\"\n                            [style.whiteSpace]=\"'nowrap'\"\n                            [style.verticalAlign]='getNameAlign(indexRow, indexColumn)'\n                            [style.paddingTop]='getNamePadding(indexRow, indexColumn)'\n                            [attr.title]='getTitle(indexRow, indexColumn)'>\n                            {{getCaption(indexRow, indexColumn)}}\n                              <table *ngIf=\"ifLeftRange(indexRow, indexColumn)\" class=\"stiJsViewerClearAllStyles\" cellpadding=\"0\" cellspacing=\"0\" style=\"height: 60px;\">\n                                <tbody>\n                                  <tr class=\"stiJsViewerClearAllStyles\">\n                                    <td class=\"stiJsViewerClearAllStyles\" rowspan=\"2\" style=\"vertical-align: top; padding-top: 9px;\">\n                                      {{getCaption(indexRow, indexColumn, false)}}\n                                    </td>\n                                    <td class=\"stiJsViewerClearAllStyles\" style=\"padding-left: 12px;\">\n                                      {{model.loc('RangeFrom')}}\n                                    </td>\n                                  </tr>\n                                  <tr class=\"stiJsViewerClearAllStyles\">\n                                    <td class=\"stiJsViewerClearAllStyles\" style=\"padding-left: 12px;\">\n                                      {{model.loc('RangeTo')}}\n                                    </td>\n                                  </tr>\n                                </tbody>\n                              </table>\n                            </td>\n                        <td [style.padding]=\"'0px'\">\n                          <sti-parameter *ngIf=\"index(indexRow, indexColumn) != length()\"  [params]=\"model.interactions.paramsVariables[index(indexRow, indexColumn)]\"></sti-parameter>\n\n                          <table *ngIf=\"index(indexRow, indexColumn) == length()\" class=\"stiJsViewerClearAllStyles\" cellpadding=\"0\" cellspacing=\"0\"\n                            align=\"right\" style=\"margin: 5px 2px 10px 0px;\">\n                            <tr class=\"stiJsViewerClearAllStyles\">\n                              <td class=\"stiJsViewerClearAllStyles\">\n                                <sti-form-button [caption]=\"model.loc('Reset')\" (action)=\"controller.action({name: 'Reset'})\"></sti-form-button>\n                              </td>\n                              <td class=\"stiJsViewerClearAllStyles\" style=\"padding-left: 10px;\">\n                                <sti-form-button [caption]=\"model.loc('Submit')\" (action)=\"controller.action({name: 'Submit'})\"></sti-form-button>\n                              </td>\n                            </tr>\n                          </table>\n                        </td>\n                    </ng-container>\n                  </ng-container>\n                </tr>\n                <tr *ngIf=\"length() == model.interactions.countInColumn.length * model.interactions.countColumns.length\">\n                  <td></td>\n                  <td *ngIf=\"model.interactions.countColumns.length > 1\"></td>\n                  <td *ngIf=\"model.interactions.countColumns.length > 1\"></td>\n                  <td [style.padding]=\"'0px'\">\n                      <table class=\"stiJsViewerClearAllStyles\" cellpadding=\"0\" cellspacing=\"0\"\n                         align=\"right\" style=\"margin: 5px 2px 10px 0px;\">\n                         <tr class=\"stiJsViewerClearAllStyles\">\n                           <td class=\"stiJsViewerClearAllStyles\">\n                             <sti-form-button [caption]=\"model.loc('Reset')\" (action)=\"controller.action({name: 'Reset'})\"></sti-form-button>\n                           </td>\n                           <td class=\"stiJsViewerClearAllStyles\" style=\"padding-left: 10px;\">\n                              <sti-form-button [caption]=\"model.loc('Submit')\" (action)=\"controller.action({name: 'Submit'})\"></sti-form-button>\n                           </td>\n                         </tr>\n                       </table>\n                  </td>\n                </tr>\n              </tbody>\n            </table>\n          </div>\n      </div>\n    </div>\n  ",
            animations: [
                trigger('visibility', [
                    state('visible', style({ opacity: 1, display: 'block' })),
                    state('hidden', style({ opacity: 0, display: 'none' })),
                    transition('hidden => visible', [
                        animate('300ms ease-in-out', keyframes([
                            style({ display: 'block', opacity: 0, offset: 0 }),
                            style({ display: 'block', opacity: 1, offset: 1 }),
                        ]))
                    ]),
                    transition('visible => hidden', [
                        animate('300ms ease-in-out', keyframes([
                            style({ display: 'block', opacity: 1, offset: 0 }),
                            style({ display: 'none', opacity: 0, offset: 1 }),
                        ]))
                    ])
                ])
            ]
        })
    ], InteractionsPanelComponent);
    return InteractionsPanelComponent;
}());

var FormButtonComponent = /** @class */ (function () {
    function FormButtonComponent() {
        this.captionAlign = 'center';
        this.action = new EventEmitter();
    }
    FormButtonComponent.prototype.ngOnInit = function () { };
    FormButtonComponent.prototype.onaction = function (event) {
        this.action.emit(event);
    };
    __decorate([
        Input()
    ], FormButtonComponent.prototype, "caption", void 0);
    __decorate([
        Input()
    ], FormButtonComponent.prototype, "actionName", void 0);
    __decorate([
        Input()
    ], FormButtonComponent.prototype, "imageName", void 0);
    __decorate([
        Input()
    ], FormButtonComponent.prototype, "imageCellWidth", void 0);
    __decorate([
        Input()
    ], FormButtonComponent.prototype, "captionPadding", void 0);
    __decorate([
        Input()
    ], FormButtonComponent.prototype, "margin", void 0);
    __decorate([
        Input()
    ], FormButtonComponent.prototype, "captionAlign", void 0);
    __decorate([
        Output()
    ], FormButtonComponent.prototype, "action", void 0);
    FormButtonComponent = __decorate([
        Component({
            selector: 'sti-form-button',
            template: "\n      <sti-button [styleName]=\"'stiJsViewerFormButton'\"\n                  [caption]=\"caption\"\n                  [actionName]=\"actionName\"\n                  [captionAlign]=\"captionAlign\"\n                  [innerTableWidth]=\"'100%'\"\n                  [minWidth]=\"'80px'\"\n                  [imageName]=\"imageName\"\n                  [imageCellWidth]=\"imageCellWidth\"\n                  [captionPadding]=\"captionPadding\"\n                  [margin]=\"margin\"\n                  (action)=\"onaction($event)\">\n      </sti-button>\n  "
        })
    ], FormButtonComponent);
    return FormButtonComponent;
}());

var ParameterComponent = /** @class */ (function () {
    function ParameterComponent(model, helper, menuService) {
        this.model = model;
        this.helper = helper;
        this.menuService = menuService;
    }
    ParameterComponent.prototype.ngOnInit = function () { };
    Object.defineProperty(ParameterComponent.prototype, "params", {
        get: function () {
            return this._params;
        },
        set: function (params) {
            this._params = params;
            if (params.basicType === 'Range') {
                if (params.type === 'DateTime' && params.keyTo && params.keyTo.isNull) {
                    params.keyTo = this.helper.getDateTimeObject(new Date());
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ParameterComponent.prototype, "showParameterInTwoRows", {
        get: function () {
            return this.params.basicType === 'Range' && this.model.options.appearance.parametersPanelPosition === 'Left';
        },
        enumerable: true,
        configurable: true
    });
    ParameterComponent.prototype.getReadOnlyCheckbox = function () {
        return this.params.basicType === 'List' || !this.params.allowUserValues;
    };
    ParameterComponent.prototype.getFirstTextBoxValue = function () {
        var _this = this;
        var value = '';
        if (this.params.basicType === 'Value' || this.params.basicType === 'NullableValue') {
            if (this.params.type === 'DateTime' && this.params.value === null) {
                this.params.value = new Date();
                this.params.key = this.helper.getDateTimeObject(this.params.value);
            }
            value = (this.params.type === 'DateTime') ? this.helper.getStringKey(this.params.key, this.params) : this.params.value;
        }
        // Range
        if (this.params.basicType === 'Range') {
            if (this.params.type === 'DateTime' && this.params.key && this.params.key.isNull) {
                this.params.key = this.helper.getDateTimeObject(new Date());
            }
            value = this.helper.getStringKey(this.params.key, this.params);
        }
        // List
        if (this.params.basicType === 'List' && this.params.items) {
            this.params.items.forEach(function (item) {
                if (item.isChecked) {
                    if (value !== '') {
                        value += (_this.model.options.listSeparator ? _this.model.options.listSeparator + " " : "; ");
                    }
                    if (_this.params.allowUserValues) {
                        value += _this.helper.getStringKey(item.key, _this.params);
                    }
                    else {
                        value += item.value !== '' ? item.value : _this.helper.getStringKey(item.key, _this.params);
                    }
                }
            });
        }
        return value != null ? value.toString() : value;
    };
    ParameterComponent.prototype.nullableAction = function (checked) {
        this.params.isNull = !this.params.isNull;
    };
    ParameterComponent.prototype.firstGuidAction = function () {
        if (this.params.basicType === 'Range') {
            this.params.key = this.helper.newGuid();
        }
        else {
            this.params.value = this.helper.newGuid();
        }
    };
    ParameterComponent.prototype.doubleDateTimeAction = function (event) {
        var _this = this;
        this.menuService.addMenu({
            type: 'doubleDatePickerMenu', name: 'doubleDatePickerMenu', items: [], parent: this.rangeFrom,
            params: this.params
        });
        setTimeout(function () {
            _this.menuService.showMenu('doubleDatePickerMenu');
        });
    };
    ParameterComponent.prototype.firstDateTimeAction = function (event) {
        var _this = this;
        this.menuService.addMenu({
            type: 'datePickerMenu', name: 'datePickerMenu', items: [], parent: this.firstDateTimeButton,
            params: this.params
        });
        setTimeout(function () {
            _this.menuService.showMenu('datePickerMenu');
        });
    };
    ParameterComponent.prototype.dropDownButtonAction = function (event) {
        var _this = this;
        var menuType = 'parameterMenuForValue';
        switch (this.params.basicType) {
            case 'Range':
                menuType = 'parameterMenuForRange';
                break;
            case 'List':
                menuType = this.params.allowUserValues ? 'parameterMenuForEditList' : 'parameterMenuForNotEditList';
                break;
        }
        if (this.params.items) {
            this.params.items.forEach(function (i) { return i.visible = true; });
        }
        this.menuService.addMenu({
            type: menuType, name: 'parameterMenu', items: [], parent: this.element,
            params: this.params
        });
        setTimeout(function () {
            _this.menuService.showMenu('parameterMenu');
        });
    };
    ParameterComponent.ctorParameters = function () { return [
        { type: ModelService },
        { type: HelperService },
        { type: MenuService }
    ]; };
    __decorate([
        ViewChild('element')
    ], ParameterComponent.prototype, "element", void 0);
    __decorate([
        ViewChild('firstDateTimeButton')
    ], ParameterComponent.prototype, "firstDateTimeButton", void 0);
    __decorate([
        ViewChild('doubleDateTimeButton')
    ], ParameterComponent.prototype, "doubleDateTimeButton", void 0);
    __decorate([
        ViewChild('rangeFrom')
    ], ParameterComponent.prototype, "rangeFrom", void 0);
    __decorate([
        Input()
    ], ParameterComponent.prototype, "params", null);
    ParameterComponent = __decorate([
        Component({
            selector: 'sti-parameter',
            template: "\n    <table #element class=\"stiJsViewerClearAllStyles\" cellpadding=\"0\" cellspacing=\"0\" #rangeFrom>\n       <tbody>\n          <tr class=\"stiJsViewerClearAllStyles\" >\n            <td *ngIf=\"params.type == 'Bool' && (params.basicType == 'Value' || params.basicType == 'NullableValue')\"\n                style=\"padding: 0px 2px;\" [style.height.px]=\"model.options.parameterRowHeight\">\n                <sti-parameter-checkbox [params]=\"params\" [isEnabled]=\"params.allowUserValues && !params.isNull\" (action)=\"params.value = $event\">\n                </sti-parameter-checkbox>\n            </td>\n\n            <td *ngIf=\"params.basicType == 'Range' && model.options.appearance.parametersPanelPosition === 'Top'\"  style=\"padding: 0px 2px;\" [style.height.px]=\"model.options.parameterRowHeight\">\n                {{model.loc('RangeFrom')}}\n            </td>\n\n            <td *ngIf=\"params.type != 'Bool' || params.basicType == 'List'\"\n                style=\"padding: 0px 2px;\" [style.height.px]=\"model.options.parameterRowHeight\">\n                <sti-parameter-text-box [variable]=\"params\"\n                    [readOnly]=\"getReadOnlyCheckbox()\"\n                    [value]=\"getFirstTextBoxValue()\">\n                </sti-parameter-text-box>\n            </td>\n\n            <td *ngIf=\"params.type == 'DateTime' && params.allowUserValues && params.basicType != 'List' && params.basicType != 'Range'\"\n                style=\"padding: 0px 2px;\" [style.height.px]=\"model.options.parameterRowHeight\" #firstDateTimeButton>\n                <sti-parameter-button [buttonType]=\"'DateTimeButton'\" [params]=\"params\"  (action)=\"firstDateTimeAction($event)\">\n                </sti-parameter-button>\n            </td>\n\n            <td *ngIf=\"params.type == 'Guid' && params.allowUserValues && params.basicType != 'List'\"\n                style=\"padding: 0px 2px;\" [style.height.px]=\"model.options.parameterRowHeight\">\n                <sti-parameter-button  [buttonType]=\"'GuidButton'\" [params]=\"params\" (action)=\"firstGuidAction()\">\n                </sti-parameter-button>\n            </td>\n\n            <td *ngIf=\"!showParameterInTwoRows && params.basicType == 'Range' && model.options.appearance.parametersPanelPosition === 'Top'\" style=\"padding: 0px 2px;\" [style.height.px]=\"model.options.parameterRowHeight\">\n              {{model.loc('RangeTo')}}\n            </td>\n\n            <!-- second -->\n            <td *ngIf=\"!showParameterInTwoRows && params.basicType == 'Range'\" style=\"padding: 0px 2px;\" [style.height.px]=\"model.options.parameterRowHeight\">\n              <sti-parameter-text-box [variable]=\"params\"\n                    [readOnly]=\"!params.allowUserValues\"\n                    [value]=\"helper.getStringKey(params.keyTo, params)\"\n                    [secondTextBox]=\"true\">\n              </sti-parameter-text-box>\n            </td>\n\n            <td *ngIf=\"!showParameterInTwoRows && params.basicType == 'Range' && params.type == 'DateTime' && params.allowUserValues\" #doubleDateTimeButton\n              style=\"padding: 0px 2px;\" [style.height.px]=\"model.options.parameterRowHeight\">\n              <sti-parameter-button  [buttonType]=\"'DateTimeButton'\" [params]=\"params\" (action)=\"doubleDateTimeAction($event)\">\n              </sti-parameter-button>\n            </td>\n\n            <td *ngIf=\"!showParameterInTwoRows && params.basicType == 'Range' && params.type == 'Guid' && params.allowUserValues\"\n              style=\"padding: 0px 2px;\" [style.height.px]=\"model.options.parameterRowHeight\">\n              <sti-parameter-button  [buttonType]=\"'GuidButton'\" [params]=\"params\" (action)=\"params.keyTo=helper.newGuid()\">\n              </sti-parameter-button>\n            </td>\n\n            <td *ngIf=\"!showParameterInTwoRows && params.items != null || (params.basicType == 'List' && params.allowUserValues)\"\n                style=\"padding: 0px 2px;\" [style.height.px]=\"model.options.parameterRowHeight\">\n              <sti-parameter-button [buttonType]=\"'DropDownButton'\" [params]=\"params\" (action)=\"dropDownButtonAction($event)\">\n              </sti-parameter-button>\n            </td>\n\n            <td *ngIf=\"!showParameterInTwoRows && params.basicType == 'NullableValue' && params.allowUserValues\"\n                style=\"padding: 0px 2px;\" [style.height.px]=\"model.options.parameterRowHeight\">\n                <sti-parameter-checkbox [params]=\"params\" [isEnabled]=\"params.allowUserValues\" (action)=\"nullableAction($event)\" [nullable]=\"true\" >\n                </sti-parameter-checkbox>\n            </td>\n\n            <td *ngIf=\"!showParameterInTwoRows && params.basicType == 'NullableValue' && params.allowUserValues\"\n                style=\"padding: 0px\" [style.height.px]=\"model.options.parameterRowHeight\">\n                {{model.loc('Null')}}\n            </td>\n          </tr>\n\n          <!-- NEW LINE -->\n          <tr *ngIf=\"showParameterInTwoRows\">\n            <td *ngIf=\"params.basicType == 'Range' && model.options.appearance.parametersPanelPosition === 'Top'\" style=\"padding: 0px 2px;\" [style.height.px]=\"model.options.parameterRowHeight\">\n              {{model.loc('RangeTo')}}\n            </td>\n\n            <!-- second -->\n            <td *ngIf=\"params.basicType == 'Range'\" style=\"padding: 0px 2px;\" [style.height.px]=\"model.options.parameterRowHeight\">\n              <sti-parameter-text-box [variable]=\"params\"\n                    [readOnly]=\"!params.allowUserValues\"\n                    [value]=\"helper.getStringKey(params.keyTo, params)\"\n                    [secondTextBox]=\"true\">\n              </sti-parameter-text-box>\n            </td>\n\n            <td *ngIf=\"params.basicType == 'Range' && params.type == 'DateTime' && params.allowUserValues\" #doubleDateTimeButton\n              style=\"padding: 0px 2px;\" [style.height.px]=\"model.options.parameterRowHeight\">\n              <sti-parameter-button  [buttonType]=\"'DateTimeButton'\" [params]=\"params\" (action)=\"doubleDateTimeAction($event)\">\n              </sti-parameter-button>\n            </td>\n\n            <td *ngIf=\"params.basicType == 'Range' && params.type == 'Guid' && params.allowUserValues\"\n              style=\"padding: 0px 2px;\" [style.height.px]=\"model.options.parameterRowHeight\">\n              <sti-parameter-button  [buttonType]=\"'GuidButton'\" [params]=\"params\" (action)=\"params.keyTo=helper.newGuid()\">\n              </sti-parameter-button>\n            </td>\n\n            <td *ngIf=\"params.items != null || (params.basicType == 'List' && params.allowUserValues)\"\n                style=\"padding: 0px 2px;\" [style.height.px]=\"model.options.parameterRowHeight\">\n              <sti-parameter-button [buttonType]=\"'DropDownButton'\" [params]=\"params\" (action)=\"dropDownButtonAction($event)\">\n              </sti-parameter-button>\n            </td>\n\n            <td *ngIf=\"params.basicType == 'NullableValue' && params.allowUserValues\"\n                style=\"padding: 0px 2px;\" [style.height.px]=\"model.options.parameterRowHeight\">\n                <sti-parameter-checkbox [params]=\"params\" [isEnabled]=\"params.allowUserValues\" (action)=\"nullableAction($event)\" [nullable]=\"true\" >\n                </sti-parameter-checkbox>\n            </td>\n\n            <td *ngIf=\"params.basicType == 'NullableValue' && params.allowUserValues\"\n                style=\"padding: 0px\" [style.height.px]=\"model.options.parameterRowHeight\">\n                {{model.loc('Null')}}\n            </td>\n\n          </tr>\n       </tbody>\n    </table>\n  "
        })
    ], ParameterComponent);
    return ParameterComponent;
}());

var ParameterTextBoxComponent = /** @class */ (function () {
    function ParameterTextBoxComponent(helper, model) {
        this.helper = helper;
        this.model = model;
        this.focusOnCreate = false;
        this.isMenu = false;
        this.value = '';
        this.secondTextBox = false;
    }
    ParameterTextBoxComponent.prototype.ngOnInit = function () { };
    ParameterTextBoxComponent.prototype.onchange = function (target) {
        if (this.element.oldValue === target.value) {
            return;
        }
        var value = this.getValue(target);
        if (this.isMenu) {
            if (!this.secondTextBox) {
                this.item.key = value;
            }
            else {
                this.item.keyTo = value;
            }
        }
        else {
            if (!this.secondTextBox) {
                if (this.variable.basicType === 'Range' || this.variable.type === 'DateTime') {
                    this.variable.key = value;
                }
                else {
                    this.variable.value = value;
                }
            }
            else {
                this.variable.keyTo = value;
            }
        }
    };
    ParameterTextBoxComponent.prototype.getValue = function (target) {
        if (this.variable.type === 'DateTime') {
            if (this.element.oldValue === target.value) {
                return;
            }
            try {
                var timeString = new Date().toLocaleTimeString();
                var isAmericanFormat = timeString.toLowerCase().indexOf('am') >= 0 || timeString.toLowerCase().indexOf('pm') >= 0;
                var formatDate = isAmericanFormat ? 'MM/dd/yyyy' : 'dd.MM.yyyy';
                var format = formatDate + (isAmericanFormat ? ' h:mm:ss tt' : ' hh:mm:ss');
                if (this.variable.dateTimeType === 'Date') {
                    format = formatDate;
                }
                if (this.variable.dateTimeType === 'Time') {
                    format = 'hh:mm:ss';
                }
                var date = this.helper.getDateTimeFromString(target.value, this.model.options.appearance.parametersPanelDateFormat || format);
                return this.helper.getDateTimeObject(date);
            }
            catch (e) {
                alert(e);
            }
        }
        else {
            return target.value;
        }
    };
    Object.defineProperty(ParameterTextBoxComponent.prototype, "width", {
        get: function () {
            var width = 210;
            if (this.variable.basicType === 'Range') {
                width = 140;
                if (this.variable.type === 'Guid' || this.variable.type === 'String') {
                    width = 190;
                }
                if (this.variable.type === 'DateTime') {
                    width = 235;
                }
                if (this.variable.type === 'Char') {
                    width = 60;
                }
            }
            else {
                if (this.variable.type === 'Guid') {
                    width = 265;
                }
                else {
                    width = 210;
                }
            }
            return width;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ParameterTextBoxComponent.prototype, "color", {
        get: function () {
            return !this.variable.isNull
                ? (this.model.options.toolbar.fontColor && this.model.options.toolbar.fontColor !== 'Empty' ? this.model.options.toolbar.fontColor : '#444444')
                : this.variable.type === 'DateTime' ? 'transparent' : '#c6c6c6';
        },
        enumerable: true,
        configurable: true
    });
    ParameterTextBoxComponent.ctorParameters = function () { return [
        { type: HelperService },
        { type: ModelService }
    ]; };
    __decorate([
        ViewChild('element')
    ], ParameterTextBoxComponent.prototype, "element", void 0);
    __decorate([
        Input()
    ], ParameterTextBoxComponent.prototype, "item", void 0);
    __decorate([
        Input()
    ], ParameterTextBoxComponent.prototype, "variable", void 0);
    __decorate([
        Input()
    ], ParameterTextBoxComponent.prototype, "readOnly", void 0);
    __decorate([
        Input()
    ], ParameterTextBoxComponent.prototype, "focusOnCreate", void 0);
    __decorate([
        Input()
    ], ParameterTextBoxComponent.prototype, "isMenu", void 0);
    __decorate([
        Input()
    ], ParameterTextBoxComponent.prototype, "value", void 0);
    __decorate([
        Input()
    ], ParameterTextBoxComponent.prototype, "secondTextBox", void 0);
    ParameterTextBoxComponent = __decorate([
        Component({
            selector: 'sti-parameter-text-box',
            template: "\n    <sti-text-box #element\n      [maxLength]=\"variable.type === 'Char' ? 1 : ''\"\n      [value]=\"isMenu ? helper.getStringKey(item.key, variable): value\"\n      [width]=\"width\"\n      [readOnly]=\"readOnly\"\n      [focusOnCreate]=\"focusOnCreate\"\n      [enabled]=\"!variable?.isNull\"\n      [color]=\"color\"\n      (onchange)=\"onchange($event)\">\n    </sti-text-box>\n  "
        })
    ], ParameterTextBoxComponent);
    return ParameterTextBoxComponent;
}());

var CheckboxComponent = /** @class */ (function () {
    function CheckboxComponent(model) {
        this.model = model;
        this.isEnabled = true;
        this.isChecked = false;
        this.indeterminate = false;
        this.action = new EventEmitter();
        this.over = false;
    }
    CheckboxComponent.prototype.ngOnInit = function () { };
    CheckboxComponent.prototype.mouseover = function () {
        this.over = true;
    };
    CheckboxComponent.prototype.mouseleave = function () {
        this.over = false;
    };
    CheckboxComponent.prototype.click = function () {
        if (this.isEnabled) {
            this.isChecked = !this.isChecked;
            this.action.emit(this.isChecked);
        }
    };
    CheckboxComponent.ctorParameters = function () { return [
        { type: ModelService }
    ]; };
    __decorate([
        Input()
    ], CheckboxComponent.prototype, "isEnabled", void 0);
    __decorate([
        Input()
    ], CheckboxComponent.prototype, "isChecked", void 0);
    __decorate([
        Input()
    ], CheckboxComponent.prototype, "indeterminate", void 0);
    __decorate([
        Input()
    ], CheckboxComponent.prototype, "captionText", void 0);
    __decorate([
        Input()
    ], CheckboxComponent.prototype, "tooltip", void 0);
    __decorate([
        Input()
    ], CheckboxComponent.prototype, "margin", void 0);
    __decorate([
        Input()
    ], CheckboxComponent.prototype, "width", void 0);
    __decorate([
        Input()
    ], CheckboxComponent.prototype, "styleColors", void 0);
    __decorate([
        Input()
    ], CheckboxComponent.prototype, "imageBlockParentWidth", void 0);
    __decorate([
        Output()
    ], CheckboxComponent.prototype, "action", void 0);
    CheckboxComponent = __decorate([
        Component({
            selector: 'sti-check-box',
            template: "\n    <table cellpadding=\"0\" cellspacing=\"0\"\n      [class]=\"isEnabled ? 'stiJsViewerCheckBox' : 'stiJsViewerCheckBoxDisabled'\"\n      [style.fontFamily]=\"model.options.toolbar.fontFamily\"\n      [style.color]=\"model.options.toolbar.fontColor\"\n      [attr.title]=\"tooltip\"\n      [style.margin]=\"margin\"\n      [style.width]=\"width\"\n      style=\"box-sizing:content-box\"\n      (mouseover)=\"mouseover()\"\n      (mouseleave)=\"mouseleave()\"\n      (click)=\"click()\">\n       <tbody>\n          <tr class=\"stiJsViewerClearAllStyles\">\n             <td style=\"line-height: 0\"\n                 [style.padding]=\"model.options.isTouchDevice ? '1px 3px 1px 1px' : ''\"\n                 [style.width]=\"imageBlockParentWidth\"\n                 class=\"stiJsViewerClearAllStyles\">\n                <div [style.width.px]=\"model.options.isTouchDevice ? 16 : 13\"\n                     [style.height.px]=\"model.options.isTouchDevice ? 16 : 13\"\n                     [class]=\"isEnabled ? (over ? 'stiJsViewerCheckBoxImageBlockOver' : 'stiJsViewerCheckBoxImageBlock') : 'stiJsViewerCheckBoxImageBlockDisabled'\"\n                     style=\"box-sizing: content-box\">\n                     <table class=\"stiJsViewerClearAllStyles\" cellpadding=\"0\" cellspacing=\"0\" style=\"width: 100%; height: 100%;\">\n                        <tbody>\n                          <tr class=\"stiJsViewerClearAllStyles\">\n                            <td [style.textAlign]=\"model.options.isTouchDevice ? 'center' : 'right'\"\n                                [style.verticalAlign]=\"model.options.isTouchDevice ? 'middle' : 'top'\">\n                                <img [src]=\"model.img((indeterminate ? 'CheckBoxIndeterminate' : 'CheckBox') + (styleColors && styleColors.isDarkStyle ? 'White.png' : '.png'))\"\n                                    [style.visibility]=\"isChecked ? 'visible' : 'hidden'\"\n                                    [style.width.px]=\"indeterminate ? 13 : 12\"\n                                    [style.height.px]=\"indeterminate ? 13 : 12\"\n                                    [style.opacity]=\"isEnabled ? 1 : 0.5\"\n                                    style=\"vertical-align: baseline\"/>\n                            </td>\n                          </tr>\n                        </tbody>\n                      </table>\n                </div>\n             </td>\n             <td *ngIf=\"captionText != null\"\n                 [style.padding]=\"!model.options.isTouchDevice ? '1px 0 0 4px' : ''\"\n                 style=\"white-space: nowrap\">\n                 {{captionText}}\n             </td>\n          </tr>\n       </tbody>\n    </table>\n  "
        })
    ], CheckboxComponent);
    return CheckboxComponent;
}());

var ParameterCheckboxComponent = /** @class */ (function () {
    function ParameterCheckboxComponent() {
        this.isEnabled = true;
        this.isMenuParameter = false;
        this.nullable = false;
        this.action = new EventEmitter();
    }
    ParameterCheckboxComponent.prototype.ngOnInit = function () { };
    ParameterCheckboxComponent.prototype.onAction = function (checked) {
        this.action.emit(checked);
    };
    Object.defineProperty(ParameterCheckboxComponent.prototype, "checked", {
        get: function () {
            if (this.nullable) {
                return this.params.isNull;
            }
            else {
                return this.isMenuParameter ? this.params.isChecked : (typeof (this.params.value) === 'boolean' && this.params.value) || this.params.value === 'true' || this.params.value === 'True';
            }
        },
        enumerable: true,
        configurable: true
    });
    __decorate([
        Input()
    ], ParameterCheckboxComponent.prototype, "params", void 0);
    __decorate([
        Input()
    ], ParameterCheckboxComponent.prototype, "captionText", void 0);
    __decorate([
        Input()
    ], ParameterCheckboxComponent.prototype, "margin", void 0);
    __decorate([
        Input()
    ], ParameterCheckboxComponent.prototype, "width", void 0);
    __decorate([
        Input()
    ], ParameterCheckboxComponent.prototype, "imageBlockParentWidth", void 0);
    __decorate([
        Input()
    ], ParameterCheckboxComponent.prototype, "isEnabled", void 0);
    __decorate([
        Input()
    ], ParameterCheckboxComponent.prototype, "isMenuParameter", void 0);
    __decorate([
        Input()
    ], ParameterCheckboxComponent.prototype, "nullable", void 0);
    __decorate([
        Output()
    ], ParameterCheckboxComponent.prototype, "action", void 0);
    ParameterCheckboxComponent = __decorate([
        Component({
            selector: 'sti-parameter-checkbox',
            template: "\n    <sti-check-box [isEnabled]=\"isEnabled\"\n                   [isChecked]=\"checked\"\n                   [captionText]=\"captionText\"\n                   [margin]=\"margin\"\n                   [width]=\"width\"\n                   [imageBlockParentWidth]=\"imageBlockParentWidth\"\n                   (action)=\"onAction($event)\">\n    </sti-check-box>\n    "
        })
    ], ParameterCheckboxComponent);
    return ParameterCheckboxComponent;
}());

var ParameterButtonComponent = /** @class */ (function () {
    function ParameterButtonComponent(model) {
        this.model = model;
        this.action = new EventEmitter();
    }
    ParameterButtonComponent.prototype.ngOnInit = function () { };
    ParameterButtonComponent.prototype.onaction = function () {
        this.action.emit(this.params);
    };
    ParameterButtonComponent.ctorParameters = function () { return [
        { type: ModelService }
    ]; };
    __decorate([
        Input()
    ], ParameterButtonComponent.prototype, "params", void 0);
    __decorate([
        Input()
    ], ParameterButtonComponent.prototype, "buttonType", void 0);
    __decorate([
        Output()
    ], ParameterButtonComponent.prototype, "action", void 0);
    ParameterButtonComponent = __decorate([
        Component({
            selector: 'sti-parameter-button',
            template: "\n    <sti-button [imageName]=\"buttonType + '.png'\"\n        [styleName]=\"'stiJsViewerFormButton'\"\n        [height]=\"model.options.isTouchDevice ? '26px' : '21px'\"\n        [innerTableWidth]=\"'100%'\"\n        [enabled]=\"!params?.isNull\"\n        (action)=\"onaction()\">\n    </sti-button>\n  "
        })
    ], ParameterButtonComponent);
    return ParameterButtonComponent;
}());

var ParameterMenuEditListComponent = /** @class */ (function () {
    function ParameterMenuEditListComponent(model, helper, menuService) {
        this.model = model;
        this.helper = helper;
        this.menuService = menuService;
    }
    ParameterMenuEditListComponent.prototype.ngOnInit = function () { };
    ParameterMenuEditListComponent.prototype.newItem = function (event) {
        var item = new Variable();
        if (this.menu.params.type === 'DateTime') {
            item.key = this.helper.getDateTimeObject();
            item.value = this.helper.dateTimeObjectToString(item.key);
        }
        else if (this.menu.params.type === 'TimeSpan') {
            item.key = '00:00:00';
            item.value = '00:00:00';
        }
        else if (this.menu.params.type === 'Bool') {
            item.key = 'False';
            item.value = 'False';
        }
        else {
            item.key = '';
            item.value = '';
        }
        item.focusOnCreate = true;
        if (!this.menu.params.items) {
            this.menu.params.items = [];
        }
        this.menu.params.items.push(item);
        setTimeout(function () {
            item.focusOnCreate = false;
        });
    };
    ParameterMenuEditListComponent.prototype.dateTimeButtonAction = function (item) {
        var _this = this;
        this.menuService.addMenu({
            type: 'datePickerMenu', name: 'datePickerMenu', items: [], parent: this.dateTimeButton,
            params: item
        });
        setTimeout(function () {
            _this.menuService.showMenu('datePickerMenu');
        });
    };
    ParameterMenuEditListComponent.prototype.guidButtonAction = function (item) {
        item.key = this.helper.newGuid();
    };
    ParameterMenuEditListComponent.prototype.removeButtonAction = function (item) {
        this.menu.params.items.splice(this.menu.params.items.indexOf(item), 1);
    };
    ParameterMenuEditListComponent.prototype.removeAllAction = function () {
        this.menu.params.items.splice(0, this.menu.params.items.length);
    };
    ParameterMenuEditListComponent.prototype.closeAction = function () {
        this.menu.state = 'initialDown';
    };
    ParameterMenuEditListComponent.ctorParameters = function () { return [
        { type: ModelService },
        { type: HelperService },
        { type: MenuService }
    ]; };
    __decorate([
        ViewChild('dateTimeButton')
    ], ParameterMenuEditListComponent.prototype, "dateTimeButton", void 0);
    __decorate([
        Input()
    ], ParameterMenuEditListComponent.prototype, "menu", void 0);
    ParameterMenuEditListComponent = __decorate([
        Component({
            selector: 'sti-parameter-menu-edit-list',
            template: "\n        <table class=\"stiJsViewerClearAllStyles stiJsViewerParametersMenuInnerTable\" cellpadding=\"0\" cellspacing=\"0\"\n        [style.fontFamily]=\"model.options.toolbar.fontFamily\"\n        [style.color]=\"model.options.toolbar.fontColor\"\n        [style.fontSize]=\"'12px'\"\n        [style.width]=\"(menu.parent.nativeElement.offsetWidth - 5) + 'px'\">\n          <tbody>\n            <tr class=\"stiJsViewerClearAllStyles\">\n              <td class=\"stiJsViewerClearAllStyles\">\n                <!--New Item Button -->\n                <sti-parameter-menu-item (action)=\"newItem($event)\">\n                  {{model.loc('NewItem')}}\n                </sti-parameter-menu-item>\n              </td>\n            </tr>\n            <tr class=\"stiJsViewerClearAllStyles\">\n              <td class=\"stiJsViewerClearAllStyles\">\n                <sti-parameter-menu-item *ngFor=\"let item of menu.params.items\" [active]=\"false\">\n                  <table class=\"stiJsViewerClearAllStyles\" cellpadding=\"0\" cellspacing=\"0\">\n                    <tbody>\n                      <tr class=\"stiJsViewerClearAllStyles\">\n                         <td class=\"stiJsViewerClearAllStyles\" style=\"padding: 0px 1px 0px 0px;\">\n                            <sti-parameter-text-box [item]=\"item\" [isMenu]=\"true\"\n                              [variable]=\"menu.params\" [focusOnCreate]=\"item.focusOnCreate\">\n                            </sti-parameter-text-box>\n                         </td>\n\n                         <td *ngIf=\"menu.params.type == 'DateTime'\" class=\"stiJsViewerClearAllStyles\" style=\"padding: 0 1px 0 1px;\" #dateTimeButton>\n                           <sti-parameter-button [buttonType]=\"'DateTimeButton'\" (action)=\"dateTimeButtonAction(item)\">\n                           </sti-parameter-button>\n                         </td>\n\n                         <td *ngIf=\"menu.params.type == 'Guid'\" class=\"stiJsViewerClearAllStyles\" style=\"padding: 0 1px 0 1px;\">\n                           <sti-parameter-button [buttonType]=\"'GuidButton'\" (action)=\"guidButtonAction(item)\">\n                           </sti-parameter-button>\n                         </td>\n\n                         <td class=\"stiJsViewerClearAllStyles\" style=\"padding: 0 1px 0 1px;\">\n                           <sti-parameter-button [buttonType]=\"'RemoveItemButton'\" (action)=\"removeButtonAction(item)\" [params]=\"item\">\n                           </sti-parameter-button>\n                         </td>\n                       </tr>\n                     </tbody>\n                  </table>\n                </sti-parameter-menu-item>\n              </td>\n            </tr>\n\n            <tr class=\"stiJsViewerClearAllStyles\">\n              <td class=\"stiJsViewerClearAllStyles\">\n                  <sti-parameter-menu-item (action)=\"removeAllAction()\">\n                      {{model.loc('RemoveAll')}}\n                  </sti-parameter-menu-item>\n\n                  <sti-parameter-menu-separator></sti-parameter-menu-separator>\n\n                  <sti-parameter-menu-item (action)=\"closeAction()\">\n                      {{model.loc('Close')}}\n                  </sti-parameter-menu-item>\n              </td>\n            </tr>\n          </tbody>\n        </table>\n  "
        })
    ], ParameterMenuEditListComponent);
    return ParameterMenuEditListComponent;
}());

var ParameterMenuItemComponent = /** @class */ (function () {
    function ParameterMenuItemComponent(model) {
        this.model = model;
        this.action = new EventEmitter();
        this.active = true;
        this.padding = '0px 5px';
        this.isOver = false;
        this.mouseDown = false;
    }
    ParameterMenuItemComponent.prototype.ngOnInit = function () { };
    ParameterMenuItemComponent.prototype.mouseover = function () {
        this.isOver = true;
    };
    ParameterMenuItemComponent.prototype.mouseout = function () {
        this.isOver = false;
        this.mouseDown = false;
    };
    ParameterMenuItemComponent.prototype.mousedown = function () {
        this.mouseDown = true;
    };
    ParameterMenuItemComponent.prototype.mouseup = function () {
        this.mouseDown = false;
        this.action.emit();
    };
    Object.defineProperty(ParameterMenuItemComponent.prototype, "className", {
        get: function () {
            return this.active ? this.mouseDown ? 'stiJsViewerParametersMenuItemPressed' : (this.isOver ? 'stiJsViewerParametersMenuItemOver' : 'stiJsViewerParametersMenuItem') : 'stiJsViewerParametersMenuItem';
        },
        enumerable: true,
        configurable: true
    });
    ParameterMenuItemComponent.ctorParameters = function () { return [
        { type: ModelService }
    ]; };
    __decorate([
        Output()
    ], ParameterMenuItemComponent.prototype, "action", void 0);
    __decorate([
        Input()
    ], ParameterMenuItemComponent.prototype, "active", void 0);
    __decorate([
        Input()
    ], ParameterMenuItemComponent.prototype, "padding", void 0);
    ParameterMenuItemComponent = __decorate([
        Component({
            selector: 'sti-parameter-menu-item',
            template: "\n      <div [class]=\"className\"\n        [style.height.px]=\"model.options.isTouchDevice ? 30 : 24\"\n        (mouseover)=\"mouseover()\"\n        (mouseout)=\"mouseout()\"\n        (mousedown)=\"mousedown()\"\n        (mouseup)=\"mouseup()\">\n        <table class=\"stiJsViewerClearAllStyles stiJsViewerParametersMenuItemInnerTable\" cellpadding=\"0\" cellspacing=\"0\">\n          <tbody>\n            <tr class=\"stiJsViewerClearAllStyles\">\n              <td class=\"stiJsViewerClearAllStyles\" [style.padding]=\"padding\">\n                <ng-content>\n                </ng-content>\n              </td>\n            </tr>\n          </tbody>\n        </table>\n\n      </div>\n  "
        })
    ], ParameterMenuItemComponent);
    return ParameterMenuItemComponent;
}());

var ParameterMenuSeparatorComponent = /** @class */ (function () {
    function ParameterMenuSeparatorComponent() {
    }
    ParameterMenuSeparatorComponent.prototype.ngOnInit = function () { };
    ParameterMenuSeparatorComponent = __decorate([
        Component({
            selector: 'sti-parameter-menu-separator',
            template: "\n        <div class=\"stiJsViewerParametersMenuSeparator\">\n        </div>\n  "
        })
    ], ParameterMenuSeparatorComponent);
    return ParameterMenuSeparatorComponent;
}());

var ParameterFindComponent = /** @class */ (function () {
    function ParameterFindComponent(model, helper) {
        this.model = model;
        this.helper = helper;
    }
    ParameterFindComponent.prototype.ngOnInit = function () { };
    ParameterFindComponent.prototype.onchange = function (event) {
        var _this = this;
        var text = event.value.toLowerCase();
        this.variable.items.forEach(function (item) {
            var itemText = _this.helper.val(item.value, _this.helper.getStringKey(item.key, _this.variable)).toLowerCase();
            item.visible = itemText.indexOf(text) >= 0;
        });
    };
    ParameterFindComponent.ctorParameters = function () { return [
        { type: ModelService },
        { type: HelperService }
    ]; };
    __decorate([
        Input()
    ], ParameterFindComponent.prototype, "variable", void 0);
    ParameterFindComponent = __decorate([
        Component({
            selector: 'sti-parameter-find',
            template: "\n      <table class=\"stiJsViewerClearAllStyles\" cellpadding=\"0\" cellspacing=\"0\">\n          <tbody>\n            <tr class=\"stiJsViewerClearAllStyles\">\n              <td class=\"stiJsViewerClearAllStyles\" style=\"padding-left: 8px;\">\n                <sti-text-block [text]=\"model.loc('FindWhat')\"></sti-text-block>\n              </td>\n\n              <td class=\"stiJsViewerClearAllStyles\" style=\"padding-left: 8px;\">\n                <sti-text-box [width]=\"80\"\n                  [margin]=\"'4px'\"\n                  [focusOnCreate]=\"true\"\n                  (onchange)=\"onchange($event)\">\n                </sti-text-box>\n              </td>\n            </tr>\n          </tbody>\n      </table>\n\n  "
        })
    ], ParameterFindComponent);
    return ParameterFindComponent;
}());

var ParameterMenuNotEditListComponent = /** @class */ (function () {
    function ParameterMenuNotEditListComponent(model, helper) {
        this.model = model;
        this.helper = helper;
    }
    ParameterMenuNotEditListComponent.prototype.ngOnInit = function () { };
    ParameterMenuNotEditListComponent.prototype.selectAll = function () {
        var isAllSelected = this.isAllSelected();
        if (this.menu.params.items) {
            this.menu.params.items.forEach(function (e) { return e.isChecked = !isAllSelected; });
        }
    };
    ParameterMenuNotEditListComponent.prototype.isAllSelected = function () {
        return this.menu.params.items.every(function (e) { return e.isChecked; });
    };
    ParameterMenuNotEditListComponent.prototype.check = function (item) {
        item.isChecked = !item.isChecked;
    };
    ParameterMenuNotEditListComponent.prototype.closeAction = function () {
        this.menu.state = 'initialDown';
    };
    ParameterMenuNotEditListComponent.ctorParameters = function () { return [
        { type: ModelService },
        { type: HelperService }
    ]; };
    __decorate([
        Input()
    ], ParameterMenuNotEditListComponent.prototype, "menu", void 0);
    ParameterMenuNotEditListComponent = __decorate([
        Component({
            selector: 'sti-parameter-menu-not-edit-list',
            template: "\n      <sti-parameter-find *ngIf=\"menu.params.items.length > 10\" [variable]=\"menu.params\"></sti-parameter-find>\n\n      <sti-parameter-menu-separator *ngIf=\"menu.params.items.length > 10\"></sti-parameter-menu-separator>\n\n      <div style=\"max-height: 400px; overflow: hidden auto;\">\n        <table class=\"stiJsViewerClearAllStyles stiJsViewerParametersMenuInnerTable\" cellpadding=\"0\" cellspacing=\"0\"\n          [style.fontFamily]=\"model.options.toolbar.fontFamily\"\n          [style.color]=\"model.options.toolbar.fontColor\"\n          [style.fontSize]=\"'12px'\"\n          [style.width]=\"(menu.parent.nativeElement.offsetWidth - 5) + 'px'\">\n            <tbody>\n              <tr class=\"stiJsViewerClearAllStyles\">\n                <td class=\"stiJsViewerClearAllStyles\">\n                  <sti-check-box [captionText]=\"model.loc('SelectAll')\"\n                    [margin]=\"'8px 7px 8px 7px'\"\n                    [isChecked]=\"isAllSelected()\"\n                    (action)=\"selectAll()\" >\n                  </sti-check-box>\n                </td>\n              </tr>\n\n              <tr class=\"stiJsViewerClearAllStyles\">\n                <td class=\"stiJsViewerClearAllStyles\">\n                  <sti-parameter-menu-separator></sti-parameter-menu-separator>\n                </td>\n              </tr>\n\n              <tr *ngFor=\"let item of menu.params.items\" class=\"stiJsViewerClearAllStyles\" [style.display]=\"item.visible ? '' : 'none'\">\n                <td class=\"stiJsViewerClearAllStyles\">\n                  <sti-parameter-menu-item>\n                      <table class=\"stiJsViewerClearAllStyles\" cellpadding=\"0\" cellspacing=\"0\" style=\"width: 100%\">\n                          <tbody>\n                            <tr class=\"stiJsViewerClearAllStyles\">\n                              <td class=\"stiJsViewerClearAllStyles\">\n                                  <sti-parameter-checkbox [params]=\"item\"\n                                      [captionText]=\"helper.val(item.value, helper.getStringKey(item.key, menu.params))\"\n                                      [margin]=\"'0 5px 0 0'\"\n                                      [width]=\"'100%'\"\n                                      [imageBlockParentWidth]=\"'1px'\"\n                                      [isMenuParameter]=\"true\"\n                                      (action)=\"check(item)\">\n                                  </sti-parameter-checkbox>\n                              </td>\n                            </tr>\n                          </tbody>\n                      </table>\n                  </sti-parameter-menu-item>\n                </td>\n              </tr>\n\n              <tr class=\"stiJsViewerClearAllStyles\">\n                <td class=\"stiJsViewerClearAllStyles\">\n                  <sti-parameter-menu-separator></sti-parameter-menu-separator>\n                </td>\n              </tr>\n\n              <tr class=\"stiJsViewerClearAllStyles\">\n                <td class=\"stiJsViewerClearAllStyles\">\n                    <sti-parameter-menu-item [padding]=\"'0px 5px 0px 13px'\" (action)=\"closeAction()\">\n                      {{model.loc('Close')}}\n                    </sti-parameter-menu-item>\n                </td>\n              </tr>\n            </tbody>\n          </table>\n      </div>\n  "
        })
    ], ParameterMenuNotEditListComponent);
    return ParameterMenuNotEditListComponent;
}());

var ParameterMenuForValueComponent = /** @class */ (function () {
    function ParameterMenuForValueComponent(model, helper, intearctionService) {
        this.model = model;
        this.helper = helper;
        this.intearctionService = intearctionService;
    }
    ParameterMenuForValueComponent.prototype.ngOnInit = function () { };
    ParameterMenuForValueComponent.prototype.action = function (item) {
        this.menu.params.value = this.menu.params.key = item.key;
        this.menu.state = 'initialDown';
        if (this.menu.params.binding) {
            if (!this.model.options.paramsVariablesStartValues) {
                this.model.options.paramsVariablesStartValues = this.helper.copyObject(this.model.options.paramsVariables);
            }
            this.intearctionService.postInteraction({ action: 'InitVars', variables: this.intearctionService.getParametersValues() });
        }
    };
    ParameterMenuForValueComponent.prototype.getValue = function (item) {
        return (item.value !== '' && this.menu.params.type !== 'DateTime' && this.menu.params.type !== 'TimeSpan')
            ? item.value
            : this.helper.getStringKey(item.key, this.menu.params);
    };
    ParameterMenuForValueComponent.ctorParameters = function () { return [
        { type: ModelService },
        { type: HelperService },
        { type: InteractionsService }
    ]; };
    __decorate([
        Input()
    ], ParameterMenuForValueComponent.prototype, "menu", void 0);
    ParameterMenuForValueComponent = __decorate([
        Component({
            selector: 'sti-parameter-menu-for-value',
            template: "\n      <sti-parameter-find *ngIf=\"menu.params.items.length > 10\" [variable]=\"menu.params\"></sti-parameter-find>\n\n      <sti-parameter-menu-separator *ngIf=\"menu.params.items.length > 10\"></sti-parameter-menu-separator>\n\n      <div style=\"max-height: 400px\" [style.overflow]=\"menu.params.items.length > 10 ? 'hidden auto' : 'hidden'\">\n        <table class=\"stiJsViewerClearAllStyles stiJsViewerParametersMenuInnerTable\" cellpadding=\"0\" cellspacing=\"0\"\n          [style.fontFamily]=\"model.options.toolbar.fontFamily\"\n          [style.color]=\"model.options.toolbar.fontColor\"\n          [style.fontSize]=\"'12px'\"\n          [style.width]=\"(menu.parent.nativeElement.offsetWidth - 5) + 'px'\">\n            <tbody>\n              <tr *ngFor=\"let item of menu.params.items\" class=\"stiJsViewerClearAllStyles\" [style.display]=\"item.visible ? '' : 'none'\">\n                <td class=\"stiJsViewerClearAllStyles\">\n                  <sti-parameter-menu-item>\n                      <table class=\"stiJsViewerClearAllStyles\" cellpadding=\"0\" cellspacing=\"0\" style=\"width: 100%\">\n                          <tbody>\n                            <tr class=\"stiJsViewerClearAllStyles\">\n                              <td class=\"stiJsViewerClearAllStyles\">\n                                  <sti-parameter-menu-item (action)=\"action(item)\">\n                                    {{getValue(item)}}\n                                  </sti-parameter-menu-item>\n                              </td>\n                            </tr>\n                          </tbody>\n                      </table>\n                  </sti-parameter-menu-item>\n                </td>\n              </tr>\n            </tbody>\n          </table>\n      </div>\n  "
        })
    ], ParameterMenuForValueComponent);
    return ParameterMenuForValueComponent;
}());

var ParameterMenuForRangeComponent = /** @class */ (function () {
    function ParameterMenuForRangeComponent(model, helper) {
        this.model = model;
        this.helper = helper;
    }
    ParameterMenuForRangeComponent.prototype.ngOnInit = function () { };
    ParameterMenuForRangeComponent.prototype.action = function (item) {
        this.menu.params.key = item.key;
        this.menu.params.keyTo = item.keyTo;
        this.menu.state = 'initialDown';
    };
    ParameterMenuForRangeComponent.prototype.getValue = function (item) {
        return item.value + " [" + this.helper.getStringKey(item.key, this.menu.params) + " - " + this.helper.getStringKey(item.keyTo, this.menu.params) + "]";
    };
    ParameterMenuForRangeComponent.ctorParameters = function () { return [
        { type: ModelService },
        { type: HelperService }
    ]; };
    __decorate([
        Input()
    ], ParameterMenuForRangeComponent.prototype, "menu", void 0);
    ParameterMenuForRangeComponent = __decorate([
        Component({
            selector: 'sti-parameter-menu-for-range',
            template: "\n      <sti-parameter-find *ngIf=\"menu.params.items.length > 10\" [variable]=\"menu.params\"></sti-parameter-find>\n\n      <sti-parameter-menu-separator *ngIf=\"menu.params.items.length > 10\"></sti-parameter-menu-separator>\n\n      <div style=\"max-height: 400px\" [style.overflow]=\"menu.params.items.length > 10 ? 'hidden auto' : 'hidden'\">\n        <table class=\"stiJsViewerClearAllStyles stiJsViewerParametersMenuInnerTable\" cellpadding=\"0\" cellspacing=\"0\"\n          [style.fontFamily]=\"model.options.toolbar.fontFamily\"\n          [style.color]=\"model.options.toolbar.fontColor\"\n          [style.fontSize]=\"'12px'\"\n          [style.width]=\"(menu.parent.nativeElement.offsetWidth - 5) + 'px'\">\n            <tbody>\n              <tr *ngFor=\"let item of menu.params.items\" class=\"stiJsViewerClearAllStyles\" [style.display]=\"item.visible ? '' : 'none'\">\n                <td class=\"stiJsViewerClearAllStyles\">\n                  <sti-parameter-menu-item>\n                      <table class=\"stiJsViewerClearAllStyles\" cellpadding=\"0\" cellspacing=\"0\" style=\"width: 100%\">\n                          <tbody>\n                            <tr class=\"stiJsViewerClearAllStyles\">\n                              <td class=\"stiJsViewerClearAllStyles\">\n                                  <sti-parameter-menu-item (action)=\"action(item)\">\n                                    {{getValue(item)}}\n                                  </sti-parameter-menu-item>\n                              </td>\n                            </tr>\n                          </tbody>\n                      </table>\n                  </sti-parameter-menu-item>\n                </td>\n              </tr>\n            </tbody>\n          </table>\n      </div>\n  "
        })
    ], ParameterMenuForRangeComponent);
    return ParameterMenuForRangeComponent;
}());

var DatePickerMenuComponent = /** @class */ (function () {
    function DatePickerMenuComponent(model, helper) {
        var _this = this;
        this.model = model;
        this.helper = helper;
        this.keyTo = false;
        this.closeOnAction = true;
        this.monthesForDatePickerItems = [];
        this.cols = [0, 1, 2, 3, 4, 5, 6];
        this.rows = [0, 1, 2, 3, 4, 5];
        this.model.months.forEach(function (m, i) { return _this.monthesForDatePickerItems.push({ name: 'Month' + i, caption: _this.model.loc('Month' + m), key: i }); });
        var firstLetters = {};
        this.model.dayOfWeek.forEach(function (d) {
            var dayName = _this.model.loc('Day' + d);
            firstLetters[dayName.toString().substring(0, 1).toUpperCase()] = true;
        });
        this.countLetters = Object.keys(firstLetters).length < 5 ? 2 : 1;
    }
    DatePickerMenuComponent.prototype.ngOnInit = function () { };
    DatePickerMenuComponent.prototype.getButtonSelected = function (col, row) {
        var firstDay = this.getFirstDay();
        var curDay = row * 7 + col;
        var day = curDay - firstDay + 1;
        return day === this.key.day;
    };
    DatePickerMenuComponent.prototype.getButtonCaption = function (col, row) {
        var firstDay = this.getFirstDay();
        var daysInMonth = this.helper.getCountDaysOfMonth(this.key.year, this.key.month - 1);
        var curDay = row * 7 + col;
        var day = curDay - firstDay + 1;
        if (curDay >= firstDay && day <= daysInMonth) {
            return day.toString();
        }
        return '';
    };
    DatePickerMenuComponent.prototype.getTime = function () {
        return this.helper.formatDate(this.helper.getDate(this.key), 'H:mm:ss');
    };
    DatePickerMenuComponent.prototype.getFirstDay = function () {
        var firstDay = new Date(this.key.year, this.key.month - 1, 1).getDay();
        if (firstDay === 0) {
            firstDay = 7;
        }
        if (this.model.options.appearance.datePickerFirstDayOfWeek !== 'Sunday') {
            firstDay--;
        }
        return firstDay;
    };
    Object.defineProperty(DatePickerMenuComponent.prototype, "showTime", {
        get: function () {
            var _a, _b;
            return ((_b = (_a = this.menu) === null || _a === void 0 ? void 0 : _a.params) === null || _b === void 0 ? void 0 : _b.dateTimeType) !== 'Date';
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DatePickerMenuComponent.prototype, "key", {
        get: function () {
            return this.keyTo ? this.menu.params.keyTo : this.menu.params.key;
        },
        enumerable: true,
        configurable: true
    });
    DatePickerMenuComponent.prototype.yearAction = function (input) {
        try {
            this.key.year = parseInt(input.value, 10);
        }
        catch (_a) { }
    };
    DatePickerMenuComponent.prototype.timeAction = function (input) {
        var time = this.helper.stringToTime(input.value);
        this.key.seconds = time.seconds;
        this.key.minutes = time.minutes;
        this.key.hours = time.hours;
    };
    DatePickerMenuComponent.prototype.getShortDayName = function (index) {
        var dayName = this.model.loc('Day' + this.model.dayOfWeek[index]);
        if (dayName) {
            return dayName.toString().substring(0, this.countLetters <= dayName.length ? this.countLetters : 1).toUpperCase();
        }
        return '';
    };
    DatePickerMenuComponent.prototype.getShortDayColor = function (index) {
        if (index === (this.model.options.appearance.datePickerFirstDayOfWeek === 'Sunday' ? 6 : 5)) {
            return '#0000ff';
        }
        if (index === (this.model.options.appearance.datePickerFirstDayOfWeek === 'Sunday' ? 0 : 6)) {
            return '#ff0000';
        }
        return '';
    };
    DatePickerMenuComponent.prototype.prevMonthButtonAction = function () {
        var month = this.key.month;
        var year = this.key.year;
        month--;
        if (month === 0) {
            month = 12;
            year--;
        }
        var countDaysInMonth = this.helper.getCountDaysOfMonth(year, month - 1);
        if (countDaysInMonth < this.key.day) {
            this.key.day = countDaysInMonth;
        }
        this.key.month = month;
        this.key.year = year;
    };
    DatePickerMenuComponent.prototype.nextMonthButtonAction = function () {
        var month = this.key.month;
        var year = this.key.year;
        month++;
        if (month === 13) {
            month = 1;
            year++;
        }
        var countDaysInMonth = this.helper.getCountDaysOfMonth(year, month - 1);
        if (countDaysInMonth < this.key.day) {
            this.key.day = countDaysInMonth;
        }
        this.key.month = month;
        this.key.year = year;
    };
    DatePickerMenuComponent.ctorParameters = function () { return [
        { type: ModelService },
        { type: HelperService }
    ]; };
    __decorate([
        Input()
    ], DatePickerMenuComponent.prototype, "menu", void 0);
    __decorate([
        Input()
    ], DatePickerMenuComponent.prototype, "keyTo", void 0);
    __decorate([
        Input()
    ], DatePickerMenuComponent.prototype, "closeOnAction", void 0);
    DatePickerMenuComponent = __decorate([
        Component({
            selector: 'sti-date-picker-menu',
            template: "\n        <table class=\"stiJsViewerClearAllStyles\" cellpadding=\"0\" cellspacing=\"0\">\n          <tbody>\n            <tr class=\"stiJsViewerClearAllStyles\">\n              <td class=\"stiJsViewerClearAllStyles\">\n                <sti-button [imageName]=\"'Arrows.BigArrowLeft.png'\" [margin]=\"'1px 2px 0 1px'\" (action)=\"prevMonthButtonAction()\">\n                </sti-button>\n              </td>\n\n              <td class=\"stiJsViewerClearAllStyles\">\n                <sti-drop-down-list\n                  [width]=\"model.options.isTouchDevice ? 79 : 81\"\n                  [readOnly]=\"true\"\n                  [margin]=\"'1px 2px 0 0'\"\n                  [items]=\"monthesForDatePickerItems\"\n                  [key]=\"key.month - 1\"\n                  (action)=\"key.month = $event.key + 1\">\n                </sti-drop-down-list>\n              </td>\n\n              <td class=\"stiJsViewerClearAllStyles\">\n                <sti-text-box [width]=\"40\" [margin]=\"'1px 2px 0 0'\" [value]=\"key.year\" (action)=\"yearAction($event)\">\n                </sti-text-box>\n              </td>\n\n              <td class=\"stiJsViewerClearAllStyles\">\n                <sti-button [imageName]=\"'Arrows.BigArrowRight.png'\" [margin]=\"'1px 1px 0 0'\" (action)=\"nextMonthButtonAction()\">\n                </sti-button>\n              </td>\n            </tr>\n          </tbody>\n        </table>\n        <div class=\"stiJsViewerDatePickerSeparator\" style=\"margin: 2px 0px;\"></div>\n\n        <table class=\"stiJsViewerClearAllStyles\" cellpadding=\"0\" cellspacing=\"0\">\n          <tbody>\n            <tr class=\"stiJsViewerClearAllStyles\">\n              <td *ngFor=\"let item of model.dayOfWeek; let i = index\" class=\"stiJsViewerDatePickerDayOfWeekCell\"\n                  [style.fontSize]=\"countLetters == 2 ? '11px' : ''\"\n                  [style.color]=\"getShortDayColor(i)\">\n                  {{getShortDayName(i)}}\n              </td>\n            </tr>\n            <tr *ngFor=\"let row of rows\" class=\"stiJsViewerClearAllStyles\">\n                <td *ngFor=\"let col of cols\" class=\"stiJsViewerClearAllStyles\">\n                  <sti-date-picker-day-button\n                      [col]=\"col\"\n                      [row]=\"row\"\n                      [date]=\"key\"\n                      [selected]=\"getButtonSelected(col, row)\"\n                      [caption]=\"getButtonCaption(col, row)\"\n                      [enabled]=\"getButtonCaption(col, row) != ''\">\n                      [closeOnAction]=\"closeOnAction\"\n                  </sti-date-picker-day-button>\n                </td>\n            </tr>\n          </tbody>\n        </table>\n\n        <div *ngIf=\"showTime\" class=\"stiJsViewerDatePickerSeparator\" style=\"margin: 2px 0px;\"></div>\n        <table *ngIf=\"showTime\" class=\"stiJsViewerClearAllStyles\" cellpadding=\"0\" cellspacing=\"0\" style=\"width:100%\">\n          <tbody>\n            <tr class=\"stiJsViewerClearAllStyles\">\n              <td class=\"stiJsViewerClearAllStyles\" style=\"padding: 0 4px 0 4px; white-space: nowrap;\">\n                {{this.model.loc('Time') + ':'}}\n              </td>\n\n              <td class=\"stiJsViewerClearAllStyles\" style=\"text-align: right;\">\n                <sti-text-box [width]=\"90\"\n                    [margin]=\"'1px 2px 2px 2px'\"\n                    [value]=\"getTime()\"\n                    (action)=\"timeAction($event)\">\n                </sti-text-box>\n              </td>\n            </tr>\n          </tbody>\n        </table>\n  "
        })
    ], DatePickerMenuComponent);
    return DatePickerMenuComponent;
}());

var DropDownListComponent = /** @class */ (function () {
    function DropDownListComponent(model, mouseService, menuService) {
        var _this = this;
        this.model = model;
        this.mouseService = mouseService;
        this.menuService = menuService;
        this.showImage = false;
        this.action = new EventEmitter();
        this.over = false;
        this._readOnly = false;
        this._enabled = true;
        this.mouseService.getDocumentMouseUp().subscribe(function () {
            _this.hideListMenu();
        });
    }
    DropDownListComponent.prototype.ngOnInit = function () { };
    Object.defineProperty(DropDownListComponent.prototype, "readOnly", {
        get: function () {
            return this._readOnly;
        },
        set: function (value) {
            var _this = this;
            this._readOnly = value;
            setTimeout(function () {
                try {
                    _this.input.nativeElement.setAttribute('unselectable', value ? 'on' : 'off');
                    _this.input.nativeElement.setAttribute('onselectstart', value ? 'return false' : '');
                    _this.input.nativeElement.readOnly = value;
                }
                catch (e) { }
            });
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DropDownListComponent.prototype, "enabled", {
        get: function () {
            return this._enabled;
        },
        set: function (value) {
            if (!value) {
                this.over = false;
            }
            this._enabled = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DropDownListComponent.prototype, "key", {
        get: function () {
            return this._key;
        },
        set: function (key) {
            if (this.items != null) {
                this.items.forEach(function (i) { return i.selected = i.key === key; });
            }
            this._key = key;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DropDownListComponent.prototype, "inputValue", {
        get: function () {
            var _this = this;
            var _a;
            if (this.items != null) {
                return ((_a = this.items.find(function (i) { return i.key === _this._key; })) === null || _a === void 0 ? void 0 : _a.caption) || '';
            }
            return '';
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DropDownListComponent.prototype, "selected", {
        get: function () {
            var _a, _b;
            var vm = this.menuService.getVerticalMenu();
            return ((_a = vm) === null || _a === void 0 ? void 0 : _a.state) === 'expanded' && ((_b = vm) === null || _b === void 0 ? void 0 : _b.parent) === this.element;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DropDownListComponent.prototype, "className", {
        get: function () {
            return this.selected ? 'stiJsViewerDropDownListOver' : (this.enabled ? (this.over ? 'stiJsViewerDropDownListOver' : 'stiJsViewerDropDownList') : 'stiJsViewerDropDownListDisabled');
        },
        enumerable: true,
        configurable: true
    });
    DropDownListComponent.prototype.mouseover = function () {
        if (!this.enabled) {
            return;
        }
        this.over = true;
    };
    DropDownListComponent.prototype.mouseout = function () {
        if (!this.enabled) {
            return;
        }
        this.over = false;
    };
    DropDownListComponent.prototype.inputClick = function () {
        if (this.readOnly) {
            this.showListMenu();
        }
    };
    DropDownListComponent.prototype.showListMenu = function () {
        var _this = this;
        this.menuService.addMenu({
            type: this.menuService.VERTICAL_MENU_NAME, name: this.menuService.VERTICAL_MENU_NAME, items: [], parent: this.element,
            verticalItems: this.items, itemStyleName: 'stiJsViewerMenuStandartItem', menuStyleName: 'stiJsViewerDropdownMenu',
            action: this.action, width: this.element.nativeElement.offsetWidth
        });
        setTimeout(function () {
            _this.menuService.showMenu(_this.menuService.VERTICAL_MENU_NAME);
        });
    };
    DropDownListComponent.prototype.hideListMenu = function () {
        if (this.menuService.getVerticalMenu()) {
            this.menuService.getVerticalMenu().state = 'initialDown';
        }
    };
    DropDownListComponent.ctorParameters = function () { return [
        { type: ModelService },
        { type: MouseService },
        { type: MenuService }
    ]; };
    __decorate([
        ViewChild('input')
    ], DropDownListComponent.prototype, "input", void 0);
    __decorate([
        ViewChild('element')
    ], DropDownListComponent.prototype, "element", void 0);
    __decorate([
        Input()
    ], DropDownListComponent.prototype, "toolTip", void 0);
    __decorate([
        Input()
    ], DropDownListComponent.prototype, "showImage", void 0);
    __decorate([
        Input()
    ], DropDownListComponent.prototype, "width", void 0);
    __decorate([
        Input()
    ], DropDownListComponent.prototype, "margin", void 0);
    __decorate([
        Input()
    ], DropDownListComponent.prototype, "items", void 0);
    __decorate([
        Input()
    ], DropDownListComponent.prototype, "styleDisplay", void 0);
    __decorate([
        Input()
    ], DropDownListComponent.prototype, "verticalAlign", void 0);
    __decorate([
        Output()
    ], DropDownListComponent.prototype, "action", void 0);
    __decorate([
        Input()
    ], DropDownListComponent.prototype, "readOnly", null);
    __decorate([
        Input()
    ], DropDownListComponent.prototype, "enabled", null);
    __decorate([
        Input()
    ], DropDownListComponent.prototype, "key", null);
    DropDownListComponent = __decorate([
        Component({
            selector: 'sti-drop-down-list',
            template: "\n        <table #element [class]=\"className\" cellpadding=\"0\" cellspacing=\"0\"\n              [style.fontFamily]=\"model.options.toolbar.fontFamily\"\n              [style.color]=\"model.options.toolbar.fontColor\"\n              [style.margin]=\"margin\"\n              [style.verticalAlign]=\"verticalAlign\"\n              [style.display]=\"styleDisplay\"\n              [attr.title]=\"toolTip\"\n              (mouseover)=\"mouseover()\"\n              (mouseout)=\"mouseout()\">\n          <tbody>\n            <tr class=\"stiJsViewerClearAllStyles\">\n              <td class=\"stiJsViewerClearAllStyles\">\n                <input #input\n                [style.width.px]=\"width - (model.options.isTouchDevice ? 23 : 15) - (showImage ? 38 : 0)\"\n                [style.border]=\"0\"\n                [style.cursor]=\"readOnly ? 'default' : 'text'\"\n                [style.fontFamily]=\"model.options.toolbar.fontFamily\"\n                [style.color]=\"model.options.toolbar.fontColor\"\n                [style.height]=\"model.options.isTouchDevice ? '23px' : '18px'\"\n                [style.lineHeight]=\"model.options.isTouchDevice ? '23px' : '18px'\"\n                [style.visibility]=\"enabled ? 'visible' : 'hidden'\"\n                [value]=\"inputValue\"\n                (click)=\"inputClick()\"\n                class=\"stiJsViewerDropDownList_TextBox\">\n              </td>\n\n              <td class=\"stiJsViewerClearAllStyles\">\n                  <sti-button [imageName]=\"'Arrows.' + (model.options.isTouchDevice ? 'Big' : 'Small') + 'ArrowDown.png'\"\n                     [styleName]=\"'stiJsViewerDropDownListButton'\"\n                     [imageSizesWidth]=\"model.options.isTouchDevice ? 16 : 8\"\n                     [imageSizesHeight]=\"model.options.isTouchDevice ? 16 : 8\"\n                     [height]=\"model.options.isTouchDevice ? '26px' : '21px'\"\n                     [enabled]=\"enabled\"\n                     [selected]=\"selected\"\n                     [margin]=\"'0'\"\n                     (action)=\"showListMenu()\">\n                  </sti-button>\n              </td>\n            </tr>\n          </tbody>\n        </table>\n\n  "
        })
    ], DropDownListComponent);
    return DropDownListComponent;
}());

var VerticalMenuComponent = /** @class */ (function () {
    function VerticalMenuComponent() {
    }
    VerticalMenuComponent.prototype.ngOnInit = function () { };
    VerticalMenuComponent.prototype.action = function (item) {
        var _a, _b;
        (_b = (_a = this.menu) === null || _a === void 0 ? void 0 : _a.action) === null || _b === void 0 ? void 0 : _b.emit(item);
    };
    __decorate([
        Input()
    ], VerticalMenuComponent.prototype, "menu", void 0);
    VerticalMenuComponent = __decorate([
        Component({
            selector: 'sti-vertical-menu',
            template: "\n    <sti-vertical-menu-item *ngFor=\"let item of menu.verticalItems\" [item]=\"item\" [styleName]=\"menu.itemStyleName\" (action)=\"action(item)\">\n    </sti-vertical-menu-item>\n  "
        })
    ], VerticalMenuComponent);
    return VerticalMenuComponent;
}());

var VerticalMenuItemComponent = /** @class */ (function () {
    function VerticalMenuItemComponent(model, menuService) {
        this.model = model;
        this.menuService = menuService;
        this.styleName = 'stiJsViewerMenuStandartItem';
        this.action = new EventEmitter();
        this.over = false;
        this._enabled = true;
    }
    VerticalMenuItemComponent.prototype.ngOnInit = function () { };
    Object.defineProperty(VerticalMenuItemComponent.prototype, "enabled", {
        get: function () {
            return this._enabled;
        },
        set: function (value) {
            if (!value) {
                this.over = false;
            }
            this._enabled = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(VerticalMenuItemComponent.prototype, "className", {
        get: function () {
            var _a;
            return this.styleName ? this.styleName + ' ' + (this.enabled ? (this.styleName + (this.over ? 'Over' : (((_a = this.item) === null || _a === void 0 ? void 0 : _a.selected) ? 'Selected' : 'Default'))) : this.styleName + 'Disabled') : '';
        },
        enumerable: true,
        configurable: true
    });
    VerticalMenuItemComponent.prototype.mouseover = function () {
        if (!this.enabled) {
            return;
        }
        this.over = true;
    };
    VerticalMenuItemComponent.prototype.mouseout = function () {
        if (!this.enabled) {
            return;
        }
        this.over = false;
    };
    VerticalMenuItemComponent.prototype.click = function () {
        if (this._enabled) {
            this.action.emit(this.item);
        }
    };
    Object.defineProperty(VerticalMenuItemComponent.prototype, "isSmallItem", {
        get: function () {
            return this.styleName && this.styleName.indexOf('MenuStandartItem') >= 0;
        },
        enumerable: true,
        configurable: true
    });
    VerticalMenuItemComponent.ctorParameters = function () { return [
        { type: ModelService },
        { type: MenuService }
    ]; };
    __decorate([
        Input()
    ], VerticalMenuItemComponent.prototype, "styleName", void 0);
    __decorate([
        Input()
    ], VerticalMenuItemComponent.prototype, "item", void 0);
    __decorate([
        Input()
    ], VerticalMenuItemComponent.prototype, "imageSizesWidth", void 0);
    __decorate([
        Input()
    ], VerticalMenuItemComponent.prototype, "imageSizesHeight", void 0);
    __decorate([
        Output()
    ], VerticalMenuItemComponent.prototype, "action", void 0);
    __decorate([
        Input()
    ], VerticalMenuItemComponent.prototype, "enabled", null);
    VerticalMenuItemComponent = __decorate([
        Component({
            selector: 'sti-vertical-menu-item',
            template: "\n    <div [style.height]=\"item?.type == 'DigitalSignature' ? 'auto' :(model.options.isMobileDevice ? '0.4in' : (model.options.isTouchDevice ? '30px' : '24px'))\"\n         [class]=\"className\"\n         [style.width]=\"item?.type == 'DigitalSignature' ? '100%' :  menuService.getVerticalMenu().width + 'px'\"\n         [style.lineHeight]=\"item?.type == 'DigitalSignature' ? 1.3 : null\"\n         (mouseover)=\"mouseover()\"\n         (mouseout)=\"mouseout()\"\n         (click)=\"click()\">\n         <table class=\"stiJsViewerClearAllStyles\" cellpadding=\"0\" cellspacing=\"0\" style=\"height: 100%; width: 100%\">\n            <tbody>\n              <tr class=\"stiJsViewerClearAllStyles\">\n                 <td *ngIf=\"item?.imageName != null && !model.options.appearance.rightToLeft\"\n                     style=\"width:22px; min-width = 22px; padding: 0; textAlign: center; lineHeight: 0\"\n                     class=\"stiJsViewerClearAllStyles\">\n                     <img [style.width.px]=\"(imageSizesWidth ? imageSizesWidth : (isSmallItem ? 16 : 32))\"\n                          [style.height.px]=\"(imageSizesHeight ? imageSizesHeight : (isSmallItem ? 16 : 32))\"\n                          [src]=\"model.img(item?.imageName)\"\n                          [style.visible]=\"model.img(item?.imageName) === '' ? 'none' : ''\" />\n                </td>\n\n                <td *ngIf=\"item?.caption != null && !model.options.appearance.rightToLeft && item?.type != 'DigitalSignature'\"\n                     style=\"padding: 0px 20px 0px 7px; text-align: left; white-space: nowrap;\"\n                     [style.fontSize]=\"model.options.isMobileDevice ? '0.16in' : ''\"\n                     class=\"stiJsViewerClearAllStyles\">\n                     {{item?.caption}}\n                </td>\n\n                <td *ngIf=\"item?.caption != null && !model.options.appearance.rightToLeft && item?.type == 'DigitalSignature'\"\n                     style=\"padding: 8px 20px 8px 8px ; text-align: left; white-space: nowrap;\"\n                     [style.fontSize]=\"model.options.isMobileDevice ? '0.16in' : ''\"\n                     class=\"stiJsViewerClearAllStyles\" [innerHtml]=\"item?.caption\">\n                </td>\n\n                <!-- right-to-left -->\n                <td *ngIf=\"item?.caption != null && model.options.appearance.rightToLeft && item?.type == 'DigitalSignature'\"\n                     style=\"padding: 8px 20px 8px 8px; text-align: right; white-space: nowrap;\"\n                     [style.fontSize]=\"model.options.isMobileDevice ? '0.16in' : ''\"\n                     class=\"stiJsViewerClearAllStyles\" [innerHtml]=\"item?.caption\">\n                </td>\n\n                <td *ngIf=\"item?.caption != null && model.options.appearance.rightToLeft && item?.type != 'DigitalSignature'\"\n                     style=\"padding: 0 7px 0 20px; text-align: right; white-space: nowrap;\"\n                     [style.fontSize]=\"model.options.isMobileDevice ? '0.16in' : ''\"\n                     class=\"stiJsViewerClearAllStyles\">\n                     {{item?.caption}}\n                </td>\n\n                <td *ngIf=\"item?.imageName != null && model.options.appearance.rightToLeft\"\n                     style=\"width:22px; min-width = 22px; padding: 0; textAlign: center; lineHeight: 0\"\n                     class=\"stiJsViewerClearAllStyles\">\n                     <img [style.width.px]=\"(imageSizesWidth ? imageSizesWidth : (isSmallItem ? 16 : 32))\"\n                          [style.height.px]=\"(imageSizesHeight ? imageSizesHeight : (isSmallItem ? 16 : 32))\"\n                          [src]=\"model.img(item?.imageName)\"\n                          [style.visible]=\"model.img(item?.imageName) === '' ? 'none' : ''\" />\n                </td>\n              </tr>\n            </tbody>\n          </table>\n    </div>\n  "
        })
    ], VerticalMenuItemComponent);
    return VerticalMenuItemComponent;
}());

var DatePickerDayButtonComponent = /** @class */ (function () {
    function DatePickerDayButtonComponent(model, helper, menuService) {
        this.model = model;
        this.helper = helper;
        this.menuService = menuService;
        this.caption = '';
        this.enabled = false;
        this.selected = false;
        this.closeOnAction = true;
    }
    DatePickerDayButtonComponent.prototype.action = function () {
        this.date.day = this.row * 7 + this.col - this.getFirstDay() + 1;
        if (this.closeOnAction && this.menuService.getMenu('datePickerMenu') != null) {
            this.menuService.getMenu('datePickerMenu').state = 'initialUp';
        }
    };
    DatePickerDayButtonComponent.prototype.getFirstDay = function () {
        var firstDay = new Date(this.date.year, this.date.month - 1, 1).getDay();
        if (firstDay === 0) {
            firstDay = 7;
        }
        if (this.model.options.appearance.datePickerFirstDayOfWeek !== 'Sunday') {
            firstDay--;
        }
        return firstDay;
    };
    DatePickerDayButtonComponent.prototype.ngOnInit = function () { };
    DatePickerDayButtonComponent.ctorParameters = function () { return [
        { type: ModelService },
        { type: HelperService },
        { type: MenuService }
    ]; };
    __decorate([
        Input()
    ], DatePickerDayButtonComponent.prototype, "col", void 0);
    __decorate([
        Input()
    ], DatePickerDayButtonComponent.prototype, "row", void 0);
    __decorate([
        Input()
    ], DatePickerDayButtonComponent.prototype, "caption", void 0);
    __decorate([
        Input()
    ], DatePickerDayButtonComponent.prototype, "enabled", void 0);
    __decorate([
        Input()
    ], DatePickerDayButtonComponent.prototype, "selected", void 0);
    __decorate([
        Input()
    ], DatePickerDayButtonComponent.prototype, "date", void 0);
    __decorate([
        Input()
    ], DatePickerDayButtonComponent.prototype, "closeOnAction", void 0);
    DatePickerDayButtonComponent = __decorate([
        Component({
            selector: 'sti-date-picker-day-button',
            template: "\n    <sti-button [styleName]=\"'stiJsViewerDatePickerDayButton'\"\n                [width]=\"model.options.isTouchDevice ? '25px' : '23px'\"\n                [height]=\"model.options.isTouchDevice ? '25px' : '23px'\"\n                [captionAlign]=\"'center'\"\n                [innerTableWidth]=\"'100%'\"\n                [captionPadding]=\"'0px'\"\n                [margin]=\"'1px'\"\n                [caption]=\"caption\"\n                [enabled]=\"enabled\"\n                [selected]=\"selected\"\n                (action)=\"action()\">\n    </sti-button>\n  "
        })
    ], DatePickerDayButtonComponent);
    return DatePickerDayButtonComponent;
}());

var DoubleDatePickerMenuComponent = /** @class */ (function () {
    function DoubleDatePickerMenuComponent(model, helper) {
        this.model = model;
        this.helper = helper;
    }
    DoubleDatePickerMenuComponent.prototype.ngOnInit = function () { };
    Object.defineProperty(DoubleDatePickerMenuComponent.prototype, "showTime", {
        get: function () {
            var _a, _b;
            return ((_b = (_a = this.menu) === null || _a === void 0 ? void 0 : _a.params) === null || _b === void 0 ? void 0 : _b.dateTimeType) !== 'Date';
        },
        enumerable: true,
        configurable: true
    });
    DoubleDatePickerMenuComponent.prototype.setTimeInterval = function (firstDate, secondDate) {
        firstDate.setHours(0);
        firstDate.setMinutes(0);
        firstDate.setSeconds(0);
        secondDate.setHours(23);
        secondDate.setMinutes(59);
        secondDate.setSeconds(59);
    };
    DoubleDatePickerMenuComponent.prototype.getFirstDayOfWeek = function () {
        var date = new Date();
        var timeString = date.toLocaleTimeString();
        return (timeString.toLowerCase().indexOf('am') >= 0 || timeString.toLowerCase().indexOf('pm') >= 0 ? 0 : 1);
    };
    DoubleDatePickerMenuComponent.prototype.getWeekInterval = function (now) {
        var startDay = this.getFirstDayOfWeek();
        var dayWeek = startDay === 0 ? now.getDay() : now.getDay() - 1;
        if (dayWeek < 0) {
            dayWeek = 6;
        }
        var values = [new Date(now.valueOf() - dayWeek * 86400000)];
        values.push(new Date(values[0].valueOf() + 6 * 86400000));
        this.setTimeInterval(values[0], values[1]);
        return values;
    };
    DoubleDatePickerMenuComponent.prototype.getValuesByDateRangeName = function (item) {
        var now = new Date();
        var values = [new Date(), new Date()];
        switch (item) {
            case 'CurrentMonth': {
                values[0].setDate(1);
                values[1].setDate(this.helper.getCountDaysOfMonth(now.getFullYear(), now.getMonth()));
                break;
            }
            case 'CurrentQuarter': {
                var firstMonth = parseInt((now.getMonth() / 3).toString(), 10) * 3;
                values[0] = new Date(now.getFullYear(), firstMonth, 1);
                values[1] = new Date(now.getFullYear(), firstMonth + 2, this.helper.getCountDaysOfMonth(now.getFullYear(), firstMonth + 2));
                break;
            }
            case 'CurrentWeek': {
                values = this.getWeekInterval(now);
                break;
            }
            case 'CurrentYear': {
                values[0] = new Date(now.getFullYear(), 0, 1);
                values[1] = new Date(now.getFullYear(), 11, 31);
                break;
            }
            case 'NextMonth': {
                var month = now.getMonth() + 1;
                var year = now.getFullYear();
                if (month > 11) {
                    month = 0;
                    year++;
                }
                values[0] = new Date(year, month, 1);
                values[1] = new Date(year, month, this.helper.getCountDaysOfMonth(year, month));
                break;
            }
            case 'NextQuarter': {
                var year = now.getFullYear();
                var firstMonth = parseInt((now.getMonth() / 3).toString(), 10) * 3 + 3;
                if (firstMonth > 11) {
                    firstMonth = 0;
                    year++;
                }
                values[0] = new Date(year, firstMonth, 1);
                values[1] = new Date(year, firstMonth + 2, this.helper.getCountDaysOfMonth(year, firstMonth + 2));
                break;
            }
            case 'NextWeek': {
                values = this.getWeekInterval(now);
                values[0] = new Date(values[0].valueOf() + 7 * 86400000);
                values[1] = new Date(values[1].valueOf() + 7 * 86400000);
                break;
            }
            case 'NextYear': {
                values[0] = new Date(now.getFullYear() + 1, 0, 1);
                values[1] = new Date(now.getFullYear() + 1, 11, 31);
                break;
            }
            case 'PreviousMonth': {
                var month = now.getMonth() - 1;
                var year = now.getFullYear();
                if (month < 0) {
                    month = 11;
                    year--;
                }
                values[0] = new Date(year, month, 1);
                values[1] = new Date(year, month, this.helper.getCountDaysOfMonth(year, month));
                break;
            }
            case 'PreviousQuarter': {
                var year = now.getFullYear();
                var firstMonth = parseInt((now.getMonth() / 3).toString(), 10) * 3 - 3;
                if (firstMonth < 0) {
                    firstMonth = 9;
                    year--;
                }
                values[0] = new Date(year, firstMonth, 1);
                values[1] = new Date(year, firstMonth + 2, this.helper.getCountDaysOfMonth(year, firstMonth + 2));
                break;
            }
            case 'PreviousWeek': {
                values = this.getWeekInterval(now);
                values[0] = new Date(values[0].valueOf() - 7 * 86400000);
                values[1] = new Date(values[1].valueOf() - 7 * 86400000);
                break;
            }
            case 'PreviousYear': {
                values[0] = new Date(now.getFullYear() - 1, 0, 1);
                values[1] = new Date(now.getFullYear() - 1, 11, 31);
                break;
            }
            case 'FirstQuarter': {
                values[0] = new Date(now.getFullYear(), 0, 1);
                values[1] = new Date(now.getFullYear(), 2, this.helper.getCountDaysOfMonth(now.getFullYear(), 2));
                break;
            }
            case 'SecondQuarter': {
                values[0] = new Date(now.getFullYear(), 3, 1);
                values[1] = new Date(now.getFullYear(), 5, this.helper.getCountDaysOfMonth(now.getFullYear(), 5));
                break;
            }
            case 'ThirdQuarter': {
                values[0] = new Date(now.getFullYear(), 6, 1);
                values[1] = new Date(now.getFullYear(), 8, this.helper.getCountDaysOfMonth(now.getFullYear(), 8));
                break;
            }
            case 'FourthQuarter': {
                values[0] = new Date(now.getFullYear(), 9, 1);
                values[1] = new Date(now.getFullYear(), 11, this.helper.getCountDaysOfMonth(now.getFullYear(), 11));
                break;
            }
            case 'MonthToDate': {
                values[0].setDate(1);
                break;
            }
            case 'QuarterToDate': {
                var firstMonth = parseInt((now.getMonth() / 3).toString(), 10) * 3;
                values[0].setDate(1);
                values[0].setMonth(firstMonth);
                break;
            }
            case 'WeekToDate': {
                var weekValues = this.getWeekInterval(now);
                values[0] = weekValues[0];
                break;
            }
            case 'YearToDate': {
                values[0].setDate(1);
                values[0].setMonth(0);
                break;
            }
            case 'Today': {
                break;
            }
            case 'Tomorrow': {
                values[0] = new Date(values[0].valueOf() + 86400000);
                values[1] = new Date(values[1].valueOf() + 86400000);
                break;
            }
            case 'Yesterday': {
                values[0] = new Date(values[0].valueOf() - 86400000);
                values[1] = new Date(values[1].valueOf() - 86400000);
                break;
            }
            case 'Last7Days': {
                if (this.model.options.appearance.datePickerIncludeCurrentDayForRanges) {
                    values[0] = new Date(values[0].valueOf() - 6 * 86400000);
                }
                else {
                    values[0] = new Date(values[0].valueOf() - 7 * 86400000);
                }
                break;
            }
            case 'Last14Days': {
                if (this.model.options.appearance.datePickerIncludeCurrentDayForRanges) {
                    values[0] = new Date(values[0].valueOf() - 13 * 86400000);
                }
                else {
                    values[0] = new Date(values[0].valueOf() - 14 * 86400000);
                }
                break;
            }
            case 'Last30Days': {
                if (this.model.options.appearance.datePickerIncludeCurrentDayForRanges) {
                    values[0] = new Date(values[0].valueOf() - 29 * 86400000);
                }
                else {
                    values[0] = new Date(values[0].valueOf() - 30 * 86400000);
                }
                break;
            }
        }
        this.setTimeInterval(values[0], values[1]);
        this.menu.params.key = this.helper.getDateTimeObject(values[0]);
        this.menu.params.keyTo = this.helper.getDateTimeObject(values[1]);
    };
    DoubleDatePickerMenuComponent.ctorParameters = function () { return [
        { type: ModelService },
        { type: HelperService }
    ]; };
    __decorate([
        Input()
    ], DoubleDatePickerMenuComponent.prototype, "menu", void 0);
    DoubleDatePickerMenuComponent = __decorate([
        Component({
            selector: 'sti-double-date-picker-menu',
            template: "\n      <table class=\"stiJsViewerClearAllStyles\" cellpadding=\"0\" cellspacing=\"0\" style=\"margin: 4px; border: 1px dotted rgb(198, 198, 198);\">\n          <tbody>\n            <tr class=\"stiJsViewerClearAllStyles\">\n              <td class=\"stiJsViewerClearAllStyles\" style=\"vertical-align: top;\">\n                  <div style=\"margin:4px\">\n                    <sti-date-picker-menu [menu]=\"menu\" [closeOnAction]=\"false\">\n                    </sti-date-picker-menu>\n                  </div>\n              </td>\n\n              <td class=\"stiJsViewerClearAllStyles\" style=\"border-left: 1px dotted rgb(198, 198, 198); vertical-align: top;\">\n                  <div style=\"margin:4px\">\n                    <sti-date-picker-menu [menu]=\"menu\" [keyTo]=\"true\" [closeOnAction]=\"false\">\n                    </sti-date-picker-menu>\n                  </div>\n              </td>\n\n              <td class=\"stiJsViewerClearAllStyles\" style=\"border-left: 1px dotted rgb(198, 198, 198); vertical-align: top;\">\n                <div style=\"width: 150px; overflow: auto; margin: 4px;\" [style.height.px]=\"showTime ? 250 : 220\">\n                    <ng-container *ngFor=\"let item of model.dateRanges\">\n                        <sti-button [caption]=\"model.loc(item)\" (action)=\"getValuesByDateRangeName(item)\">\n                        </sti-button>\n\n                        <div *ngIf=\"item=='Yesterday' || item=='PreviousWeek' || item=='PreviousMonth' || item=='PreviousQuarter' || item=='PreviousYear' || item=='FourthQuarter' || item=='Last30Days'\"\n                            class=\"stiJsViewerVerticalMenuSeparator\" style=\"margin:2px\"></div>\n                    </ng-container>\n                </div>\n              </td>\n            </tr>\n          </tbody>\n      </table>\n  "
        })
    ], DoubleDatePickerMenuComponent);
    return DoubleDatePickerMenuComponent;
}());

var BaseFormComponent = /** @class */ (function () {
    function BaseFormComponent(model, helper, formService) {
        this.model = model;
        this.helper = helper;
        this.formService = formService;
        this.changeVisibility = new EventEmitter();
        this.action = new EventEmitter();
        this.level = 1;
        this.showCancel = true;
        this.showButtons = true;
        this.showSeparator = true;
        this.display = 'none';
    }
    BaseFormComponent.prototype.ngOnInit = function () { };
    BaseFormComponent.prototype.startAnimation = function (event) {
        if (event.toState === 'visible') {
            this.display = '';
            if (this.defaultTop != null) {
                this.formService.centerForm(this, this.defaultTop);
            }
        }
    };
    BaseFormComponent.prototype.doneAnimation = function (event) {
        if (event.toState === 'hidden') {
            this.display = 'none';
        }
        this.changeVisibility.emit(event.toState);
    };
    BaseFormComponent.ctorParameters = function () { return [
        { type: ModelService },
        { type: HelperService },
        { type: FormService }
    ]; };
    __decorate([
        ViewChild('element')
    ], BaseFormComponent.prototype, "element", void 0);
    __decorate([
        Output()
    ], BaseFormComponent.prototype, "changeVisibility", void 0);
    __decorate([
        Output()
    ], BaseFormComponent.prototype, "action", void 0);
    __decorate([
        Input()
    ], BaseFormComponent.prototype, "level", void 0);
    __decorate([
        Input()
    ], BaseFormComponent.prototype, "caption", void 0);
    __decorate([
        Input()
    ], BaseFormComponent.prototype, "helpUrl", void 0);
    __decorate([
        Input()
    ], BaseFormComponent.prototype, "fontFamily", void 0);
    __decorate([
        Input()
    ], BaseFormComponent.prototype, "color", void 0);
    __decorate([
        Input()
    ], BaseFormComponent.prototype, "fontSize", void 0);
    __decorate([
        Input()
    ], BaseFormComponent.prototype, "containerPadding", void 0);
    __decorate([
        Input()
    ], BaseFormComponent.prototype, "name", void 0);
    __decorate([
        Input()
    ], BaseFormComponent.prototype, "defaultTop", void 0);
    __decorate([
        Input()
    ], BaseFormComponent.prototype, "showCancel", void 0);
    __decorate([
        Input()
    ], BaseFormComponent.prototype, "showButtons", void 0);
    __decorate([
        Input()
    ], BaseFormComponent.prototype, "showSeparator", void 0);
    BaseFormComponent = __decorate([
        Component({
            selector: 'sti-base-form',
            template: "\n    <div #element class=\"stiJsViewerForm\"\n      [style.zIndex]=\"level * 10 + 1\"\n      [@.disabled]=\"!model.options.toolbar.menuAnimation\"\n      [style.fontFamily]=\"fontFamily\"\n      [style.color]=\"color\"\n      [style.fontSize]=\"fontSize\"\n      [style.left.px]=\"formService.form?.left\"\n      [style.top.px]=\"formService.form?.top\"\n      [style.display]=\"display\"\n      [@showForm]=\"formService.form?.name == name ? 'visible' : 'hidden'\"\n      (@showForm.start)=\"startAnimation($event)\"\n      (@showForm.done)=\"doneAnimation($event)\">\n      <div class=\"stiJsViewerFormHeader\"\n        (mousedown)=\"formService.startMove(name, $event)\"\n        (touchstart)=\"formService.startMove(name, null, $event)\"\n        (touchmove)=\"formService.move($event)\"\n        (touchend)=\"formService.stopMove()\">\n        <table class=\"stiJsViewerClearAllStyles\" cellpadding=\"0\" cellspacing=\"0\" style=\"width: 100%;\">\n          <tbody>\n            <tr class=\"stiJsViewerClearAllStyles\">\n              <td class=\"stiJsViewerClearAllStyles\" style=\"text-align: left; padding: 5px 10px 8px 15px;\">\n                {{caption}}\n              </td>\n              <td *ngIf=\"helpUrl != null && model.options.appearance.showDialogsHelp\" class=\"stiJsViewerClearAllStyles\" style=\"width: 20px; text-align: right; padding: 2px 0px 1px 0px; vertical-align: top;\">\n                <sti-button [imageMargin]=\"'0 2px 0 2px'\" [display]=\"'inline-block'\" (action)=\"helper.showHelpWindow(helpUrl)\">\n                </sti-button>\n              </td>\n              <td class=\"stiJsViewerClearAllStyles\" style=\"vertical-align: top; width: 30px; text-align: right; padding: 2px 1px 1px;\">\n                <sti-button [imageMargin]=\"'0 2px 0 2px'\" [display]=\"'inline-block'\" [imageName]=\"'CloseForm.png'\" (action)=\"formService.closeForm(name)\">\n                </sti-button>\n              </td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n\n      <div class=\"stiJsViewerFormContainer\" [style.padding]=\"containerPadding\">\n        <ng-content>\n        </ng-content>\n      </div>\n\n      <div *ngIf=\"showSeparator\" class=\"stiJsViewerFormSeparator\"></div>\n\n      <div *ngIf=\"showButtons\" class=\"stiJsViewerFormButtonsPanel\">\n        <table class=\"stiJsViewerClearAllStyles\" cellpadding=\"0\" cellspacing=\"0\">\n          <tbody>\n            <tr class=\"stiJsViewerClearAllStyles\">\n              <td class=\"stiJsViewerClearAllStyles\" style=\"padding: 8px;\">\n                <sti-form-button [caption]=\"model.loc('ButtonOk')\" (action)=\"action.emit()\">\n                </sti-form-button>\n              </td>\n              <td *ngIf=\"showCancel\" class=\"stiJsViewerClearAllStyles\" style=\"padding: 8px 8px 8px 0px;\">\n                <sti-form-button [caption]=\"model.loc('ButtonCancel')\" (action)=\"formService.closeForm(name)\">\n                </sti-form-button>\n              </td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n\n    </div>\n  ",
            animations: [
                trigger('showForm', [
                    state('hidden', style({ opacity: '0' })),
                    state('visible', style({ opacity: '1' })),
                    transition('hidden => visible', [
                        animate('200ms ease-in-out')
                    ])
                ])
            ]
        })
    ], BaseFormComponent);
    return BaseFormComponent;
}());

var ExportFormComponent = /** @class */ (function () {
    function ExportFormComponent(model, exportService, helper, formService, menuService, collections, controller) {
        this.model = model;
        this.exportService = exportService;
        this.helper = helper;
        this.formService = formService;
        this.menuService = menuService;
        this.collections = collections;
        this.controller = controller;
        this.PROPERTY_ALIAS = {
            ImageFormatForHtml: 'ImageFormat',
            EncodingTextOrCsvFile: 'Encoding',
            ExportModeRtf: 'ExportMode',
            EncodingDifFile: 'Encoding',
            EncodingDbfFile: 'CodePage'
        };
        this.formVisible = false;
        this.disabledComponents = {};
    }
    ExportFormComponent.prototype.ngOnChanges = function (changes) {
        var _this = this;
        var _a, _b;
        if (this.baseForm && ((_b = (_a = this.formService) === null || _a === void 0 ? void 0 : _a.form) === null || _b === void 0 ? void 0 : _b.name) === this.baseForm.name) {
            setTimeout(function () { return _this.updateDisabledComponents(); });
        }
    };
    ExportFormComponent.prototype.ngOnInit = function () { };
    ExportFormComponent.prototype.action = function () {
        this.formService.closeForm(this.baseForm.name);
        if (this.model.options.exports.storeExportSettings) {
            this.helper.setCookie('StimulsoftWebViewerExportSettings' + this.exportService.getCommonExportFormat(), JSON.stringify(this.exportService.exportSettings));
        }
        this.exportService.postExport();
    };
    ExportFormComponent.prototype.updateDisabledComponents = function () {
        var _this = this;
        var _a;
        ['StandardPdfFonts', 'EmbeddedFonts', 'UseUnicode'].forEach(function (n) { return _this.disabledComponents[n] = (_this.exportService.exportSettings.PdfACompliance === true); });
        this.disabledComponents.ImageQuality = this.exportService.exportSettings.ImageCompressionMethod && this.exportService.exportSettings.ImageCompressionMethod !== 'Jpeg';
        this.disabledComponents.ExportObjectFormatting = this.exportService.exportSettings.DataExportMode === 'AllBands';
        this.disabledComponents.UseOnePageHeaderAndFooter = this.exportService.exportSettings.DataExportMode != 'AllBands';
        this.disabledComponents.EncodingDifFile = this.exportService.exportSettings.UseDefaultSystemEncoding;
        this.disabledComponents.TiffCompressionScheme = this.exportService.exportSettings.ImageType !== 'Tiff';
        this.disabledComponents.UseDigitalSignature = !this.exportService.exportSettings.UseDigitalSignature || !(((_a = this.model.pdfSecurityCertificates) === null || _a === void 0 ? void 0 : _a.length) > 0);
        this.disabledComponents.RemoveEmptySpaceAtBottom = this.exportService.exportSettings.UsePageHeadersAndFooters;
        if (this.exportService.exportSettings.ImageType != null) {
            var ifComponent = this.exportService.exportFormSettings.components.find(function (c) { return c.name === 'ImageFormat'; });
            if (ifComponent != null) {
                ifComponent.items = this.collections.getImageFormatItems(this.exportService.exportSettings.ImageType === 'Emf');
            }
        }
        this.disabledComponents.DitheringType = this.exportService.exportSettings.ImageFormat !== 'Monochrome';
        if (this.saveReportMdc) {
            this.saveReportMdc.click();
        }
        if (this.pagesRangeAll && !this.exportFormSettings.groups.pageRangeGroup.pageRangeAllIsDisabled) {
            this.pagesRangeAll.click();
        }
        if (this.pageRangeCurrentPage && this.exportFormSettings.groups.pageRangeGroup.pageRangeAllIsDisabled) {
            this.pageRangeCurrentPage.click();
        }
        if (this.exportService.exportSettings.CompressToArchive === true) {
            this.exportFormSettings.groups.pageRangeGroup.pageRangeAllIsDisabled = false;
        }
        if (this.exportService.exportSettings.CompressToArchive === false) {
            this.exportFormSettings.groups.pageRangeGroup.pageRangeAllIsDisabled = true;
        }
    };
    ExportFormComponent.prototype.componentAction = function (comp, value) {
        var property = this.PROPERTY_ALIAS[comp.name] || comp.name;
        switch (property) {
            case 'EmbeddedFonts':
            case 'UseUnicode':
                if (value) {
                    this.exportService.exportSettings.StandardPdfFonts = false;
                }
                break;
            case 'StandardPdfFonts':
                if (value) {
                    this.exportService.exportSettings.EmbeddedFonts = false;
                    this.exportService.exportSettings.UseUnicode = false;
                }
                break;
            case 'ImageType':
                this.exportService.export('Image' + value, true);
                break;
            case 'DataType':
            case 'HtmlType':
                this.exportService.export(value, true);
                break;
            case 'ExcelType':
                var exportFormat = value === 'ExcelBinary' ? 'Excel' : value;
                this.exportService.export(exportFormat, true);
                break;
            case 'UseDigitalSignature':
                if (!(value === true || value === false)) {
                    property = 'CertificateThumbprint';
                }
                if (value === true && this.collections.getPdfSecurityCertificatesItems().length == 0) {
                    value = false;
                    this.controller.showError('Warning', 'Certificate Not Found!');
                }
                break;
            case 'UsePageHeadersAndFooters':
                if (value === true) {
                    this.exportService.exportSettings.RemoveEmptySpaceAtBottom = true;
                }
                break;
        }
        this.exportService.exportSettings[property] = value;
        this.updateDisabledComponents();
    };
    ExportFormComponent.prototype.getValue = function (comp, component) {
        var property = this.PROPERTY_ALIAS[comp.name] || comp.name;
        switch (property) {
            case 'Zoom2':
                return this.exportService.exportSettings[property].toString();
            case 'UseDigitalSignature':
                if (component == 'dropDownList') {
                    return this.exportService.exportSettings['CertificateThumbprint'];
                }
            default:
                return this.exportService.exportSettings[property];
        }
    };
    ExportFormComponent.prototype.changeVisibility = function (state) {
        var _a, _b;
        this.formVisible = state === 'visible';
        if (state === 'hidden' && ((_b = (_a = this.exportFormSettings) === null || _a === void 0 ? void 0 : _a.groups) === null || _b === void 0 ? void 0 : _b.savingReportGroup)) {
            this.helper.setCookie('StimulsoftWebViewerExportSettingsOpeningGroups', JSON.stringify({
                SavingReportGroup: this.exportFormSettings.groups.savingReportGroup.opened,
                PageRangeGroup: this.exportFormSettings.groups.pageRangeGroup.opened,
                SettingsGroup: this.exportFormSettings.groups.settingsGroup.opened
            }));
        }
        if (state === 'visible') {
            this.updateDisabledComponents();
        }
    };
    ExportFormComponent.prototype.showMenu = function (comp, button) {
        var _this = this;
        var menuName = 'documentSecurityMenu';
        if (comp.name === 'DocumentSecurityButton') {
            this.menuService.addMenu({
                type: menuName, name: menuName, items: [], parent: button.button,
                itemStyleName: 'stiJsViewerMenuStandartItem', menuStyleName: 'stiJsViewerDropdownMenu'
            });
        }
        else {
            menuName = this.menuService.VERTICAL_MENU_NAME;
            this.menuService.addMenu({
                type: 'buttonMenu', name: menuName, items: this.collections.getPdfSecurityCertificatesItems(), parent: button.button,
                itemStyleName: 'stiJsViewerMenuStandartItem', menuStyleName: 'stiJsViewerDropdownMenu'
            });
        }
        setTimeout(function () {
            _this.menuService.showMenu(menuName);
        });
    };
    ExportFormComponent.prototype.getTextBoxType = function (name) {
        if (name === 'SaveReportPassword' || name === 'PasswordInputUser' || name === 'PasswordInputOwner') {
            return this.formVisible ? 'password' : '';
        }
        return null;
    };
    ExportFormComponent.ctorParameters = function () { return [
        { type: ModelService },
        { type: ExportService },
        { type: HelperService },
        { type: FormService },
        { type: MenuService },
        { type: CollectionsService },
        { type: ControllerService }
    ]; };
    __decorate([
        ViewChild('baseForm')
    ], ExportFormComponent.prototype, "baseForm", void 0);
    __decorate([
        ViewChild('saveReportMdc')
    ], ExportFormComponent.prototype, "saveReportMdc", void 0);
    __decorate([
        ViewChild('pagesRangeAll')
    ], ExportFormComponent.prototype, "pagesRangeAll", void 0);
    __decorate([
        ViewChild('pageRangeCurrentPage')
    ], ExportFormComponent.prototype, "pageRangeCurrentPage", void 0);
    __decorate([
        Input()
    ], ExportFormComponent.prototype, "exportFormSettings", void 0);
    ExportFormComponent = __decorate([
        Component({
            selector: 'sti-export-form',
            template: "\n    <sti-base-form #baseForm [fontFamily]=\"model.options.toolbar.fontFamily\"\n    [color]=\"model.options.toolbar.fontColor\"\n    [fontSize]=\"'12px'\"\n    [containerPadding]=\"'3px'\"\n    [name]=\"'exportForm'\"\n    [caption]=\"model.loc('ExportFormTitle')\"\n    [defaultTop]=\"150\"\n    (changeVisibility)=\"changeVisibility($event)\"\n    (action)=\"action()\">\n    <table class=\"stiJsViewerClearAllStyles\" cellpadding=\"0\" cellspacing=\"0\" style=\"width: 100%;\">\n      <tbody>\n          <tr *ngIf=\"exportFormSettings?.groups.savingReportGroup.visible\" class=\"stiJsViewerClearAllStyles\">\n            <td class=\"stiJsViewerClearAllStyles\" colspan=\"2\">\n              <sti-group-panel [caption]=\"model.loc('SavingReport')\"\n               [width]=\"390\"\n               [margin]=\"'4px'\"\n               [innerPadding]=\"'4px 0 4px 0'\"\n               [opened]=\"exportFormSettings.groups.savingReportGroup.opened\"\n               (action)=\"exportFormSettings.groups.savingReportGroup.opened=$event\">\n                <table class=\"stiJsViewerClearAllStyles\" cellpadding=\"0\" cellspacing=\"0\" style=\"width: 100%;\">\n                  <tbody>\n                    <tr class=\"stiJsViewerClearAllStyles\">\n                      <td class=\"stiJsViewerClearAllStyles\" colspan=\"2\">\n                        <sti-radio-button #saveReportMdc\n                           [name]=\"baseForm.name + 'SaveReportMdc'\"\n                           [groupName]=\"baseForm.name + 'SavingReportGroup'\"\n                           [caption]=\"model.loc('SaveReportMdc')\"\n                           [margin]=\"'6px 8px 3px 8px'\"\n                           [checked]=\"true\"\n                           (action)=\"exportService.exportSettings.Format = 'Mdc'\">\n                        </sti-radio-button>\n                      </td>\n                    </tr>\n                    <tr class=\"stiJsViewerClearAllStyles\">\n                      <td class=\"stiJsViewerClearAllStyles\" colspan=\"2\">\n                        <sti-radio-button\n                           [name]=\"baseForm.name + 'SaveReportMdz'\"\n                           [groupName]=\"baseForm.name + 'SavingReportGroup'\"\n                           [caption]=\"model.loc('SaveReportMdz')\"\n                           [margin]=\"'3px 8px 3px 8px'\"\n                           (action)=\"exportService.exportSettings.Format = 'Mdz'\">\n                        </sti-radio-button>\n                      </td>\n                    </tr>\n                    <tr class=\"stiJsViewerClearAllStyles\">\n                      <td class=\"stiJsViewerClearAllStyles\" colspan=\"2\">\n                        <sti-radio-button\n                           [name]=\"baseForm.name + 'SaveReportMdx'\"\n                           [groupName]=\"baseForm.name + 'SavingReportGroup'\"\n                           [caption]=\"model.loc('SaveReportMdx')\"\n                           [margin]=\"'3px 8px 0px 8px'\"\n                           (action)=\"exportService.exportSettings.Format = 'Mdx'\">\n                        </sti-radio-button>\n                      </td>\n                    </tr>\n                    <tr class=\"stiJsViewerClearAllStyles\">\n                      <td class=\"stiJsViewerClearAllStyles\" style=\"padding: 0px 8px; min-width: 150px;\" [attr.title]=\"model.loc('PasswordSaveReportTooltip')\">\n                      {{model.loc('PasswordSaveReport')}}\n                      </td>\n                      <td>\n                        <sti-text-box\n                           [width]=\"140\"\n                           [tooltip]=\"model.loc('PasswordSaveReportTooltip')\"\n                           [margin]=\"'4px 8px 0px 8px'\"\n                           [type]=\"getTextBoxType('SaveReportPassword')\"\n                           [enabled]=\"exportService.exportSettings.Format == 'Mdx'\"\n                           (onchange)=\"exportService.exportSettings.Password = $event.value\">\n                        </sti-text-box>\n                      </td>\n                    </tr>\n                  </tbody>\n                </table>\n              </sti-group-panel>\n            </td>\n          </tr>\n\n          <tr *ngIf=\"exportFormSettings?.groups.pageRangeGroup.visible\" class=\"stiJsViewerClearAllStyles\">\n            <td class=\"stiJsViewerClearAllStyles\" colspan=\"2\">\n              <sti-group-panel [caption]=\"model.loc('PagesRange')\"\n               [width]=\"390\"\n               [margin]=\"'4px'\"\n               [innerPadding]=\"'4px 0 4px 0'\"\n               [opened]=\"exportFormSettings.groups.pageRangeGroup.opened\"\n               (action)=\"exportFormSettings.groups.pageRangeGroup.opened=$event\">\n                <table class=\"stiJsViewerClearAllStyles\" cellpadding=\"0\" cellspacing=\"0\" style=\"width: 100%;\">\n                  <tbody>\n                    <tr class=\"stiJsViewerClearAllStyles\">\n                      <td class=\"stiJsViewerClearAllStyles\" colspan=\"2\">\n                        <sti-radio-button #pagesRangeAll\n                           [name]=\"baseForm.name + 'PagesRangeAll'\"\n                           [groupName]=\"baseForm.name + 'PageRangeGroup'\"\n                           [caption]=\"model.loc('PagesRangeAll')\"\n                           [tooltip]=\"model.loc('PagesRangeAllTooltip')\"\n                           [margin]=\"'6px 8px 6px 8px'\"\n                           [checked]=\"!exportFormSettings.groups.pageRangeGroup.pageRangeAllIsDisabled\"\n                           [enabled]=\"!exportFormSettings.groups.pageRangeGroup.pageRangeAllIsDisabled\"\n                           (action)=\"exportService.exportSettings.PageRange = 'All'\">\n                        </sti-radio-button>\n                      </td>\n                    </tr>\n                    <tr class=\"stiJsViewerClearAllStyles\">\n                      <td class=\"stiJsViewerClearAllStyles\" colspan=\"2\">\n                        <sti-radio-button #pageRangeCurrentPage\n                           [name]=\"baseForm.name + 'PageRangeCurrentPage'\"\n                           [groupName]=\"baseForm.name + 'PageRangeGroup'\"\n                           [caption]=\"model.loc('PagesRangeCurrentPage')\"\n                           [tooltip]=\"model.loc('PagesRangeCurrentPageTooltip')\"\n                           [margin]=\"'0px 8px 4px 8px'\"\n                           [checked]=\"exportFormSettings.groups.pageRangeGroup.pageRangeAllIsDisabled\"\n                           (action)=\"exportService.exportSettings.PageRange = (model.reportParams.pageNumber + 1).toString()\">\n                        </sti-radio-button>\n                      </td>\n                    </tr>\n                    <tr class=\"stiJsViewerClearAllStyles\">\n                      <td class=\"stiJsViewerClearAllStyles\" colspan=\"2\">\n                        <sti-radio-button\n                           [name]=\"baseForm.name + 'PageRangePages'\"\n                           [groupName]=\"baseForm.name + 'PageRangeGroup'\"\n                           [caption]=\"model.loc('PagesRangePages')\"\n                           [tooltip]=\"model.loc('PagesRangePagesTooltip')\"\n                           [margin]=\"'0px 8px 0px 8px'\"\n                           [paddingLeftLastCell]=\"'60px'\"\n                           (action)=\"exportService.exportSettings.PageRange = pagesRange.element.nativeElement.value\">\n                              <sti-text-box #pagesRange\n                                [width]=\"130\"\n                                [tooltip]=\"model.loc('PagesRangePagesTooltip')\"\n                                [margin]=\"'0px 0px 0px 30px'\"\n                                (onchange)=\"exportService.exportSettings.PageRange = $event.value\"\n                                (onblur)=\"exportService.exportSettings.PageRange = $event.value\">\n                              </sti-text-box>\n                        </sti-radio-button>\n                      </td>\n                    </tr>\n                  </tbody>\n                </table>\n              </sti-group-panel>\n            </td>\n          </tr>\n\n        <tr *ngIf=\"exportFormSettings?.groups.settingsGroup.visible\"class=\"stiJsViewerClearAllStyles\">\n            <td class=\"stiJsViewerClearAllStyles\" colspan=\"2\">\n              <sti-group-panel [caption]=\"model.loc('SettingsGroup')\"\n                [opened]=\"exportFormSettings.groups.settingsGroup.opened\"\n                [width]=\"390\"\n                [margin]=\"'4px'\"\n                [innerPadding]=\"'4px 0 4px 0'\"\n                (action)=\"exportFormSettings.groups.settingsGroup.opened=$event\">\n                <table class=\"stiJsViewerClearAllStyles\" cellpadding=\"0\" cellspacing=\"0\" style=\"width: 100%;\">\n                  <tbody>\n                    <tr *ngFor=\"let comp of exportFormSettings.components\">\n                      <td *ngIf=\"comp.label != null\" style=\"padding: 0px 8px; min-width: 150px;\" [attr.title]=\"comp.tooltip\">\n                        {{comp.label}}\n                      </td>\n\n                      <td *ngIf=\"comp.name == 'UseDigitalSignature'\">\n                        <sti-check-box\n                           [tooltip]=\"comp.tooltip\"\n                           [margin]=\"comp.margin\"\n                           [captionText]=\"comp.caption\"\n                           [isChecked]=\"getValue(comp)\"\n                           (action)=\"componentAction(comp, $event)\">\n                        </sti-check-box>\n                      </td>\n\n                      <td [attr.colSpan]=\"comp.label != null || comp.name == 'DocumentSecurityButton' || comp.name == 'UseDigitalSignature' ? 1 : 2\">\n                        <sti-drop-down-list-for-export-form *ngIf=\"comp.type == 'DropDownListForExportForm'\"\n                           [width]=\"comp.width\"\n                           [items]=\"comp.items\"\n                           [key]=\"getValue(comp, 'dropDownList')\"\n                           [margin]=\"comp.margin\"\n                           [verticalAlign]=\"comp.name == 'ImageQuality' || comp.name == 'ImageResolution' ? 'middle' : null\"\n                           [styleDisplay]=\"comp.name == 'ImageQuality' || comp.name == 'ImageResolution' ? 'inline-block' : null\"\n                           [enabled]=\"!disabledComponents[comp.name]\"\n                           (action)=\"componentAction(comp, $event.key)\">\n                        </sti-drop-down-list-for-export-form>\n\n                        <div *ngIf=\"comp.name == 'ImageQuality' || comp.name == 'ImageResolution'\"\n                           [style.display]=\"'inline-block'\">\n                          {{comp.name == 'ImageQuality' ? '%' : 'dpi'}}\n                        </div>\n\n                        <sti-text-box *ngIf=\"comp.type == 'TextBox'\"\n                           [width]=\"comp.width\"\n                           [tooltip]=\"comp.tooltip\"\n                           [margin]=\"comp.margin\"\n                           [type]=\"getTextBoxType(comp.name)\"\n                           [enabled]=\"!comp.disabled\"\n                           [value]=\"getValue(comp)\"\n                           [enabled]=\"!disabledComponents[comp.name]\"\n                           (onchange)=\"componentAction(comp, $event.value)\">\n                        </sti-text-box>\n\n                        <sti-check-box *ngIf=\"comp.type == 'CheckBox' || comp.type == 'DigitalSignature'\"\n                           [tooltip]=\"comp.tooltip\"\n                           [margin]=\"comp.margin\"\n                           [captionText]=\"comp.caption\"\n                           [isChecked]=\"getValue(comp)\"\n                           [isEnabled]=\"!disabledComponents[comp.name]\"\n                           (action)=\"componentAction(comp, $event)\">\n                        </sti-check-box>\n\n                      </td>\n\n                      <td *ngIf=\"comp.name == 'DocumentSecurityButton'\">\n                        <sti-button #button\n                           [width]=\"comp.width\"\n                           [arrow]=\"'Down'\"\n                           [minWidth]=\"'163px'\"\n                           [captionAlign]=\"'center'\"\n                           [display]=\"'inline-block'\"\n                           [styleName]=\"'stiJsViewerFormButton'\"\n                           [margin]=\"'2px 8px'\"\n                           [innerTableWidth]=\"'100%'\"\n                           [captionWidth]=\"'100%'\"\n                           [caption]=\"comp.name == 'DocumentSecurityButton' ? comp.caption : ''\"\n                           [enabled]=\"!disabledComponents[comp.name + 'Button']\"\n                           (action)=\"showMenu(comp, button)\">\n                        </sti-button>\n                      </td>\n                    </tr>\n                  </tbody>\n                </table>\n\n              </sti-group-panel>\n            </td>\n        </tr>\n\n        <tr *ngIf=\"model.options.exports.showOpenAfterExport && exportFormSettings?.openAfterExport && !exportService.sendMail\" class=\"stiJsViewerClearAllStyles\">\n            <td class=\"stiJsViewerClearAllStyles\" colspan=\"2\">\n                <sti-check-box [captionText]=\"model.loc('OpenAfterExport')\"\n                  [tooltip]=\"model.loc('OpenAfterExportTooltip')\"\n                  [margin]=\"'4px 8px 4px 8px'\"\n                  [isChecked]=\"exportService.exportSettings.OpenAfterExport\"\n                  (action)=\"exportService.exportSettings.OpenAfterExport = $event\">\n                </sti-check-box>\n            </td>\n        </tr>\n      </tbody>\n    </table>\n\n    </sti-base-form>\n  "
        })
    ], ExportFormComponent);
    return ExportFormComponent;
}());

var GroupPanelComponent = /** @class */ (function () {
    function GroupPanelComponent(model) {
        this.model = model;
        this.opened = false;
        this.action = new EventEmitter();
        this.display = 'none';
    }
    GroupPanelComponent.prototype.ngOnInit = function () { };
    GroupPanelComponent.prototype.startAnimation = function (event) {
        if (event.toState === 'opened') {
            this.display = '';
        }
    };
    GroupPanelComponent.prototype.doneAnimation = function (event) {
        if (event.toState === 'closed') {
            this.display = 'none';
        }
    };
    GroupPanelComponent.ctorParameters = function () { return [
        { type: ModelService }
    ]; };
    __decorate([
        Input()
    ], GroupPanelComponent.prototype, "width", void 0);
    __decorate([
        Input()
    ], GroupPanelComponent.prototype, "caption", void 0);
    __decorate([
        Input()
    ], GroupPanelComponent.prototype, "innerPadding", void 0);
    __decorate([
        Input()
    ], GroupPanelComponent.prototype, "opened", void 0);
    __decorate([
        Input()
    ], GroupPanelComponent.prototype, "margin", void 0);
    __decorate([
        Output()
    ], GroupPanelComponent.prototype, "action", void 0);
    GroupPanelComponent = __decorate([
        Component({
            selector: 'sti-group-panel',
            template: "\n  <div #groupPanel [style.fontFamily]=\"model.options.toolbar.fontFamily\"\n       [style.color]=\"model.options.toolbarFontColor\"\n       [style.minWidth.px]=\"width\"\n       [style.margin]=\"margin\"\n       style=\"overflow: hidden\">\n      <sti-form-button [caption]=\"caption\"\n          [imageName]=\"opened ? 'Arrows.BigArrowDown.png' : 'Arrows.BigArrowRight.png'\"\n          [imageCellWidth]=\"'1px'\"\n          [captionPadding]=\"'0 15px 0 5px'\"\n          [margin]=\"'0px'\"\n          [captionAlign]=\"'left'\"\n          (action)=\"opened = !opened; action.emit(opened)\">\n      </sti-form-button>\n\n      <div class=\"stiJsViewerGroupPanelContainer\"\n           [style.padding]=\"innerPadding\"\n           [style.display]=\"display\"\n           [@state]=\"opened ? 'opened' : 'closed'\"\n           (@state.start)=\"startAnimation($event)\"\n           (@state.done)=\"doneAnimation($event)\">\n          <ng-content>\n\n          </ng-content>\n      </div>\n\n\n  </div>\n  ",
            animations: [
                trigger('state', [
                    state('opened', style({ height: '*' })),
                    state('closed', style({ height: '0px' })),
                    transition('* => *', [
                        animate('150ms ease-in-out')
                    ])
                ])
            ]
        })
    ], GroupPanelComponent);
    return GroupPanelComponent;
}());

var RadioButtonComponent = /** @class */ (function () {
    function RadioButtonComponent(model, radioService) {
        this.model = model;
        this.radioService = radioService;
        this.action = new EventEmitter();
        this.enabled = true;
        this.checked = false;
        this.over = false;
    }
    RadioButtonComponent.prototype.ngAfterViewInit = function () {
        this.radioService.addButton(this);
    };
    RadioButtonComponent.prototype.ngOnDestroy = function () {
        this.radioService.removeButton(this);
    };
    RadioButtonComponent.prototype.ngOnInit = function () { };
    RadioButtonComponent.prototype.mouseover = function () {
        if (!this.enabled) {
            return;
        }
        this.over = true;
    };
    RadioButtonComponent.prototype.mouseout = function () {
        if (!this.enabled) {
            return;
        }
        this.over = false;
    };
    RadioButtonComponent.prototype.click = function () {
        if (this.enabled) {
            this.checked = true;
            this.radioService.check(this);
            this.action.emit(true);
        }
    };
    RadioButtonComponent.prototype.uncheck = function () {
        this.checked = false;
        this.action.emit(false);
    };
    Object.defineProperty(RadioButtonComponent.prototype, "outClass", {
        get: function () {
            return !this.enabled ? 'stiJsViewerRadioButtonOutCircleDisabled' : (this.over ? 'stiJsViewerRadioButtonOutCircleOver' : 'stiJsViewerRadioButtonOutCircle');
        },
        enumerable: true,
        configurable: true
    });
    RadioButtonComponent.ctorParameters = function () { return [
        { type: ModelService },
        { type: RadioButtonService }
    ]; };
    __decorate([
        Output()
    ], RadioButtonComponent.prototype, "action", void 0);
    __decorate([
        Input()
    ], RadioButtonComponent.prototype, "groupName", void 0);
    __decorate([
        Input()
    ], RadioButtonComponent.prototype, "name", void 0);
    __decorate([
        Input()
    ], RadioButtonComponent.prototype, "enabled", void 0);
    __decorate([
        Input()
    ], RadioButtonComponent.prototype, "checked", void 0);
    __decorate([
        Input()
    ], RadioButtonComponent.prototype, "tooltip", void 0);
    __decorate([
        Input()
    ], RadioButtonComponent.prototype, "caption", void 0);
    __decorate([
        Input()
    ], RadioButtonComponent.prototype, "margin", void 0);
    __decorate([
        Input()
    ], RadioButtonComponent.prototype, "paddingLeftLastCell", void 0);
    RadioButtonComponent = __decorate([
        Component({
            selector: 'sti-radio-button',
            template: "\n    <table [class]=\"enabled ? 'stiJsViewerRadioButton' : 'stiJsViewerRadioButtonDisabled'\" cellpadding=\"0\" cellspacing=\"0\"\n      [style.fontFamily]=\"model.options.toolbar.fontFamily\"\n      [style.margin]=\"margin\"\n      [attr.title]=\"tooltip\"\n      (mouseover)=\"mouseover()\" (mouseout)=\"mouseout()\" (click)=\"click()\">\n      <tbody>\n        <tr class=\"stiJsViewerClearAllStyles\">\n          <td class=\"stiJsViewerClearAllStyles\">\n            <div class=\"stiJsViewerRadioButtonOutCircle\" [class]=\"outClass\">\n              <div class=\"stiJsViewerRadioButtonInnerCircle\"\n                  [style.margin]=\"model.options.isTouchDevice ? '4px' : '3px'\"\n                  [style.width]=\"model.options.isTouchDevice ? '9px' : '7px'\"\n                  [style.height]=\"model.options.isTouchDevice ? '9px' : '7px'\"\n                  [style.visibility]=\"checked ? 'visible' : 'hidden'\"\n                  [style.opacity]=\"enabled ? 1 : 0.5\">\n              </div>\n            </div>\n          </td>\n          <td *ngIf=\"caption != null\" class=\"stiJsViewerClearAllStyles\" style=\"padding-left: 4px; white-space: nowrap;\">\n            {{caption}}\n          </td>\n          <td class=\"stiJsViewerClearAllStyles\" [style.paddingLeft]=\"paddingLeftLastCell\">\n            <ng-content></ng-content>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n  "
        })
    ], RadioButtonComponent);
    return RadioButtonComponent;
}());

var DropDownListForExportFormComponent = /** @class */ (function () {
    function DropDownListForExportFormComponent() {
        this.enabled = true;
        this.action = new EventEmitter();
    }
    DropDownListForExportFormComponent.prototype.ngOnInit = function () { };
    __decorate([
        Input()
    ], DropDownListForExportFormComponent.prototype, "items", void 0);
    __decorate([
        Input()
    ], DropDownListForExportFormComponent.prototype, "width", void 0);
    __decorate([
        Input()
    ], DropDownListForExportFormComponent.prototype, "key", void 0);
    __decorate([
        Input()
    ], DropDownListForExportFormComponent.prototype, "margin", void 0);
    __decorate([
        Input()
    ], DropDownListForExportFormComponent.prototype, "enabled", void 0);
    __decorate([
        Input()
    ], DropDownListForExportFormComponent.prototype, "styleDisplay", void 0);
    __decorate([
        Input()
    ], DropDownListForExportFormComponent.prototype, "verticalAlign", void 0);
    __decorate([
        Output()
    ], DropDownListForExportFormComponent.prototype, "action", void 0);
    DropDownListForExportFormComponent = __decorate([
        Component({
            selector: 'sti-drop-down-list-for-export-form',
            template: "\n    <sti-drop-down-list [items]=\"items\"\n      [width]=\"width\"\n      [readOnly]=\"true\"\n      [key]=\"key\"\n      [margin]=\"margin\"\n      [enabled]=\"enabled\"\n      [styleDisplay]=\"styleDisplay\"\n      [verticalAlign]=\"verticalAlign\"\n      (action)=\"key = $event.key; action.emit($event)\">\n    </sti-drop-down-list>\n  "
        })
    ], DropDownListForExportFormComponent);
    return DropDownListForExportFormComponent;
}());

var DocumentSecurityMenuComponent = /** @class */ (function () {
    function DocumentSecurityMenuComponent(model, formService, exportService, collections) {
        this.model = model;
        this.formService = formService;
        this.exportService = exportService;
        this.collections = collections;
    }
    DocumentSecurityMenuComponent.prototype.ngOnInit = function () { };
    DocumentSecurityMenuComponent.prototype.getTextBoxType = function () {
        var _a;
        return ((_a = this.formService.form) === null || _a === void 0 ? void 0 : _a.name) === 'exportForm' ? 'password' : '';
    };
    DocumentSecurityMenuComponent.prototype.updateUserAccessPrivileges = function () {
        var privileges = [];
        if (this.allowPrintDocument.isChecked) {
            privileges.push('PrintDocument');
        }
        if (this.allowModifyContents.isChecked) {
            privileges.push('ModifyContents');
        }
        if (this.allowCopyTextAndGraphics.isChecked) {
            privileges.push('CopyTextAndGraphics');
        }
        if (this.allowAddOrModifyTextAnnotations.isChecked) {
            privileges.push('AddOrModifyTextAnnotations');
        }
        this.exportService.exportSettings.UserAccessPrivileges = privileges.join(',');
    };
    DocumentSecurityMenuComponent.prototype.getUserAccessPrivileges = function (name) {
        var _a, _b, _c;
        return ((_a = this.exportService.exportSettings) === null || _a === void 0 ? void 0 : _a.UserAccessPrivileges) === 'All' || ((_c = (_b = this.exportService.exportSettings) === null || _b === void 0 ? void 0 : _b.UserAccessPrivileges) === null || _c === void 0 ? void 0 : _c.indexOf(name)) >= 0;
    };
    DocumentSecurityMenuComponent.ctorParameters = function () { return [
        { type: ModelService },
        { type: FormService },
        { type: ExportService },
        { type: CollectionsService }
    ]; };
    __decorate([
        ViewChild('AllowPrintDocument')
    ], DocumentSecurityMenuComponent.prototype, "allowPrintDocument", void 0);
    __decorate([
        ViewChild('AllowModifyContents')
    ], DocumentSecurityMenuComponent.prototype, "allowModifyContents", void 0);
    __decorate([
        ViewChild('AllowCopyTextAndGraphics')
    ], DocumentSecurityMenuComponent.prototype, "allowCopyTextAndGraphics", void 0);
    __decorate([
        ViewChild('AllowAddOrModifyTextAnnotations')
    ], DocumentSecurityMenuComponent.prototype, "allowAddOrModifyTextAnnotations", void 0);
    DocumentSecurityMenuComponent = __decorate([
        Component({
            selector: 'sti-document-security-menu',
            template: "\n    <table class=\"stiJsViewerClearAllStyles\" cellpadding=\"0\" cellspacing=\"0\" style=\"width: 100%;\">\n                  <tbody>\n                    <tr class=\"stiJsViewerClearAllStyles\">\n                      <td style=\"padding: 0px 8px; min-width: 150px;\" [attr.title]=\"model.loc('UserPasswordTooltip')\">\n                        {{model.loc('UserPassword')}}\n                      </td>\n                      <td class=\"stiJsViewerClearAllStyles\">\n                        <sti-text-box\n                           [width]=\"160\"\n                           [tooltip]=\"model.loc('UserPasswordTooltip')\"\n                           [margin]=\"'8px 8px 2px 8px'\"\n                           [type]=\"getTextBoxType()\"\n                           [value]=\"exportService.exportSettings?.PasswordInputUser\"\n                           (onchange)=\"exportService.exportSettings.PasswordInputUser =  $event.value\">\n                        </sti-text-box>\n                      </td>\n                    </tr>\n\n                    <tr class=\"stiJsViewerClearAllStyles\" [attr.title]=\"model.loc('OwnerPasswordTooltip')\">\n                      <td style=\"padding: 0px 8px; min-width: 150px;\">\n                        {{model.loc('OwnerPassword')}}\n                      </td>\n                      <td class=\"stiJsViewerClearAllStyles\">\n                        <sti-text-box\n                           [width]=\"160\"\n                           [tooltip]=\"model.loc('OwnerPasswordTooltip')\"\n                           [margin]=\"'2px 8px 2px 8px'\"\n                           [type]=\"getTextBoxType()\"\n                           [value]=\"exportService.exportSettings?.PasswordInputOwner\"\n                           (onchange)=\"exportService.exportSettings.PasswordInputOwner =  $event.value\">\n                        </sti-text-box>\n                      </td>\n                    </tr>\n\n                    <tr class=\"stiJsViewerClearAllStyles\">\n                      <td class=\"stiJsViewerClearAllStyles\" colspan=\"2\">\n                        <sti-check-box #AllowPrintDocument\n                           [captionText]=\"model.loc('AllowPrintDocument')\"\n                           [tooltip]=\"model.loc('AllowPrintDocumentTooltip')\"\n                           [margin]=\"'4px 8px 4px 8px'\"\n                           [isChecked]=\"getUserAccessPrivileges('PrintDocument')\"\n                           (action)=\"updateUserAccessPrivileges()\">\n                        </sti-check-box>\n                      </td>\n                    </tr>\n\n                    <tr class=\"stiJsViewerClearAllStyles\">\n                      <td class=\"stiJsViewerClearAllStyles\" colspan=\"2\">\n                        <sti-check-box #AllowModifyContents\n                           [captionText]=\"model.loc('AllowModifyContents')\"\n                           [tooltip]=\"model.loc('AllowModifyContentsTooltip')\"\n                           [margin]=\"'4px 8px 4px 8px'\"\n                           [isChecked]=\"getUserAccessPrivileges('ModifyContents')\"\n                           (action)=\"updateUserAccessPrivileges()\">\n                        </sti-check-box>\n                      </td>\n                    </tr>\n\n                    <tr class=\"stiJsViewerClearAllStyles\">\n                      <td class=\"stiJsViewerClearAllStyles\" colspan=\"2\">\n                        <sti-check-box #AllowCopyTextAndGraphics\n                           [captionText]=\"model.loc('AllowCopyTextAndGraphics')\"\n                           [tooltip]=\"model.loc('AllowCopyTextAndGraphicsTooltip')\"\n                           [margin]=\"'4px 8px 4px 8px'\"\n                           [isChecked]=\"getUserAccessPrivileges('CopyTextAndGraphics')\"\n                           (action)=\"updateUserAccessPrivileges()\">\n                        </sti-check-box>\n                      </td>\n                    </tr>\n\n                    <tr class=\"stiJsViewerClearAllStyles\">\n                      <td class=\"stiJsViewerClearAllStyles\" colspan=\"2\">\n                        <sti-check-box #AllowAddOrModifyTextAnnotations\n                           [captionText]=\"model.loc('AllowAddOrModifyTextAnnotations')\"\n                           [tooltip]=\"model.loc('AllowAddOrModifyTextAnnotationsTooltip')\"\n                           [margin]=\"'4px 8px 4px 8px'\"\n                           [isChecked]=\"getUserAccessPrivileges('AddOrModifyTextAnnotations')\"\n                           (action)=\"updateUserAccessPrivileges()\">\n                        </sti-check-box>\n                      </td>\n                    </tr>\n                    <tr class=\"stiJsViewerClearAllStyles\">\n                      <td class=\"stiJsViewerClearAllStyles\" style=\"padding: 0px 8px; min-width: 150px;\" [attr.title]=\"model.loc('EncryptionKeyLengthTooltip')\">\n                        {{model.loc('EncryptionKeyLength')}}\n                      </td>\n                      <td>\n                        <sti-drop-down-list-for-export-form\n                           [width]=\"160\"\n                           [items]=\"collections.getEncryptionKeyLengthItems()\"\n                           [key]=\"exportService.exportSettings?.KeyLength\"\n                           [margin]=\"'2px 8px 4px 8px'\"\n                           (action)=\"exportService.exportSettings.KeyLength = $event.key\">\n                        </sti-drop-down-list-for-export-form>\n                      </td>\n                    </tr>\n                  </tbody>\n                </table>\n"
        })
    ], DocumentSecurityMenuComponent);
    return DocumentSecurityMenuComponent;
}());

var DigitalSignatureMenuComponent = /** @class */ (function () {
    function DigitalSignatureMenuComponent(model, exportService) {
        this.model = model;
        this.exportService = exportService;
    }
    DigitalSignatureMenuComponent.prototype.ngOnInit = function () { };
    DigitalSignatureMenuComponent.ctorParameters = function () { return [
        { type: ModelService },
        { type: ExportService }
    ]; };
    DigitalSignatureMenuComponent = __decorate([
        Component({
            selector: 'sti-digital-signature-menu',
            template: "\n    <div *ngFor=\"let item of model.pdfSecurityCertificates\" class=\"stiJsViewerMenuStandartItem stiJsViewerMenuStandartItemSelected\" style=\"height: auto; line-height: 1.3;\">\n      <table class=\"stiJsViewerClearAllStyles\" cellpadding=\"0\" cellspacing=\"0\" style=\"height: 100%; width: 100%;\">\n        <tbody>\n          <tr class=\"stiJsViewerClearAllStyles\">\n            <td class=\"stiJsViewerClearAllStyles\" style=\"padding: 8px 20px 8px 8px; text-align: left; white-space: nowrap;\">\n            </td>\n          </tr>\n        </tbody>\n      </table>\n    </div>\n"
        })
    ], DigitalSignatureMenuComponent);
    return DigitalSignatureMenuComponent;
}());

var SendEmailFormComponent = /** @class */ (function () {
    function SendEmailFormComponent(model, mailService, exportService) {
        this.model = model;
        this.mailService = mailService;
        this.exportService = exportService;
    }
    SendEmailFormComponent.prototype.ngOnInit = function () { };
    SendEmailFormComponent.ctorParameters = function () { return [
        { type: ModelService },
        { type: MailService },
        { type: ExportService }
    ]; };
    SendEmailFormComponent = __decorate([
        Component({
            selector: 'sti-send-email-form',
            template: "\n    <sti-base-form #baseForm [fontFamily]=\"model.options.toolbar.fontFamily\"\n      [color]=\"model.options.toolbar.fontColor\"\n      [fontSize]=\"'12px'\"\n      [name]=\"'sendEmailForm'\"\n      [caption]=\"model.loc('EmailOptions')\"\n      [level]=\"1\"\n      [defaultTop]=\"150\"\n      (action)=\"this.mailService.sendMail()\">\n      <table class=\"stiJsViewerClearAllStyles\" cellpadding=\"0\" cellspacing=\"0\" style=\"width: 100%;\">\n        <tbody>\n            <tr class=\"stiJsViewerClearAllStyles\">\n              <td class=\"stiJsViewerCaptionControls\" [style.padding]=\"model.options.isMobileDevice ? '0 25px 0 4px' : ''\">\n                {{model.loc('Email')}}\n              </td>\n              <td *ngIf=\"!model.options.isMobileDevice\">\n                <sti-text-box [margin]=\"model.options.isMobileDevice ? '4px 4px 12px 4px' : '4px'\"\n                  [value]=\"exportService.exportSettings.Email\"\n                  [width]=\"model.options.isMobileDevice ? 200 : 280\"\n                  (onchange)=\"exportService.exportSettings.Email = $event.value\">\n                </sti-text-box>\n              </td>\n            </tr>\n            <tr class=\"stiJsViewerClearAllStyles\" *ngIf=\"model.options.isMobileDevice\">\n              <td class=\"stiJsViewerClearAllStyles\">\n                <sti-text-box [margin]=\"model.options.isMobileDevice ? '4px 4px 12px 4px' : '4px'\"\n                  [value]=\"exportService.exportSettings.Email\"\n                  [width]=\"model.options.isMobileDevice ? 200 : 280\"\n                  (onchange)=\"exportService.exportSettings.Email = $event.value\">\n                </sti-text-box>\n              </td>\n            </tr>\n\n            <tr class=\"stiJsViewerClearAllStyles\">\n              <td class=\"stiJsViewerCaptionControls\" [style.padding]=\"model.options.isMobileDevice ? '0 25px 0 4px' : ''\">\n                {{model.loc('Subject')}}\n              </td>\n              <td *ngIf=\"!model.options.isMobileDevice\">\n                <sti-text-box [margin]=\"model.options.isMobileDevice ? '4px 4px 12px 4px' : '4px'\"\n                  [value]=\"exportService.exportSettings.Subject\"\n                  [width]=\"model.options.isMobileDevice ? 200 : 280\"\n                  (onchange)=\"exportService.exportSettings.Subject = $event.value\">\n                </sti-text-box>\n              </td>\n            </tr>\n            <tr class=\"stiJsViewerClearAllStyles\" *ngIf=\"model.options.isMobileDevice\">\n              <td class=\"stiJsViewerClearAllStyles\">\n                <sti-text-box [margin]=\"model.options.isMobileDevice ? '4px 4px 12px 4px' : '4px'\"\n                  [value]=\"exportService.exportSettings.Subject\"\n                  [width]=\"model.options.isMobileDevice ? 200 : 280\"\n                  (onchange)=\"exportService.exportSettings.Subject = $event.value\">\n                </sti-text-box>\n              </td>\n            </tr>\n\n            <tr class=\"stiJsViewerClearAllStyles\">\n              <td class=\"stiJsViewerCaptionControls\" [style.padding]=\"model.options.isMobileDevice ? '0 25px 0 4px' : ''\">\n                {{model.loc('Message')}}\n              </td>\n              <td *ngIf=\"!model.options.isMobileDevice\">\n                <sti-text-area [margin]=\"model.options.isMobileDevice ? '4px 4px 12px 4px' : '4px'\"\n                  [value]=\"exportService.exportSettings.Message\"\n                  [height]=\"70\"\n                  [width]=\"model.options.isMobileDevice ? 200 : 280\"\n                  (onchange)=\"exportService.exportSettings.Message = $event.value\">\n                </sti-text-area>\n              </td>\n            </tr>\n            <tr class=\"stiJsViewerClearAllStyles\" *ngIf=\"model.options.isMobileDevice\">\n              <td class=\"stiJsViewerClearAllStyles\">\n                <sti-text-area [margin]=\"model.options.isMobileDevice ? '4px 4px 12px 4px' : '4px'\"\n                  [value]=\"exportService.exportSettings.Message\"\n                  [height]=\"70\"\n                  [width]=\"model.options.isMobileDevice ? 200 : 280\"\n                  (onchange)=\"exportService.exportSettings.Message = $event.value\">\n                </sti-text-area>\n              </td>\n            </tr>\n\n            <tr class=\"stiJsViewerClearAllStyles\">\n              <td class=\"stiJsViewerCaptionControls\" [style.padding]=\"model.options.isMobileDevice ? '0 25px 0 4px' : ''\">\n                {{model.loc('Attachment')}}\n              </td>\n              <td *ngIf=\"!model.options.isMobileDevice\">\n                <div style=\"margin: 4px\">\n                  {{exportService.exportSettings.Attachment}}\n                </div>\n              </td>\n            </tr>\n            <tr class=\"stiJsViewerClearAllStyles\" *ngIf=\"model.options.isMobileDevice\">\n              <td class=\"stiJsViewerClearAllStyles\">\n                <div style=\"margin: 4px\">\n                  {{exportService.exportSettings.Attachment}}\n                </div>\n              </td>\n            </tr>\n        </tbody>\n      </table>\n    </sti-base-form>\n  "
        })
    ], SendEmailFormComponent);
    return SendEmailFormComponent;
}());

var TextAreaComponent = /** @class */ (function () {
    function TextAreaComponent() {
        this.enabled = true;
        this.action = new EventEmitter();
        this.onchange = new EventEmitter();
        this.onblur = new EventEmitter();
        this.selected = false;
        this.focused = false;
        this.over = false;
        this._readOnly = false;
        this.styleName = 'stiJsViewerTextBox';
    }
    TextAreaComponent.prototype.ngOnInit = function () { };
    TextAreaComponent.prototype.keypress = function (event) {
        if (!this.enabled) {
            return false;
        }
        if (event.keyCode === 13) {
            this.action.emit(event.target);
        }
    };
    TextAreaComponent.prototype.onchanged = function (event) {
        this.onchange.emit(event.target);
    };
    Object.defineProperty(TextAreaComponent.prototype, "className", {
        get: function () {
            if (this._readOnly) {
                return this.styleName + ' ' + this.styleName + 'Default';
            }
            return this.styleName + ' ' + this.styleName + (this.selected ? 'Over' : (this.enabled ? (this.over ? 'Over' : 'Default') : 'Disabled'));
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextAreaComponent.prototype, "readOnly", {
        get: function () {
            return this._readOnly;
        },
        enumerable: true,
        configurable: true
    });
    __decorate([
        Input()
    ], TextAreaComponent.prototype, "width", void 0);
    __decorate([
        Input()
    ], TextAreaComponent.prototype, "height", void 0);
    __decorate([
        Input()
    ], TextAreaComponent.prototype, "enabled", void 0);
    __decorate([
        Input()
    ], TextAreaComponent.prototype, "value", void 0);
    __decorate([
        Input()
    ], TextAreaComponent.prototype, "padding", void 0);
    __decorate([
        Input()
    ], TextAreaComponent.prototype, "margin", void 0);
    __decorate([
        Output()
    ], TextAreaComponent.prototype, "action", void 0);
    __decorate([
        Output()
    ], TextAreaComponent.prototype, "onchange", void 0);
    __decorate([
        Output()
    ], TextAreaComponent.prototype, "onblur", void 0);
    TextAreaComponent = __decorate([
        Component({
            selector: 'sti-text-area',
            template: "\n    <textarea\n      [style.width.px]=\"width\"\n      [style.minWidth.px]=\"width\"\n      [style.height.px]=\"height\"\n      [style.minHeight.px]=\"height\"\n      [class]=\"className\"\n      [value]=\"value || ''\"\n      [style.margin]=\"margin\"\n      [style.cursor]=\"readOnly ? 'default' : ''\"\n      [style.padding]=\"padding\"\n      style=\"padding-top: 3px, font-family: Arial\"\n      (mouseover)=\"over=true\"\n      (mouseleave)=\"over=false\"\n      (focused)=\"focused=true; selected=true\"\n      (blur)=\"focused=false; selected=false; onblur.emit($event.target)\"\n      (keypress)=\"keypress($event)\"\n      (keyup)=\"onchanged($event)\">\n    </textarea>\n  "
        })
    ], TextAreaComponent);
    return TextAreaComponent;
}());

var DrillDownPanelComponent = /** @class */ (function () {
    function DrillDownPanelComponent(model, drillDownService, controller) {
        var _this = this;
        this.model = model;
        this.drillDownService = drillDownService;
        this.controller = controller;
        controller.getMessage().subscribe(function (message) {
            var _a;
            if (((_a = message) === null || _a === void 0 ? void 0 : _a.action) === 'DrillDown' && _this.element) {
                _this.element.nativeElement.scrollTop = 0;
            }
        });
    }
    DrillDownPanelComponent.prototype.ngOnInit = function () { };
    DrillDownPanelComponent.prototype.ngAfterViewInit = function () {
        this.model.controls.drillDownPanel.el = this.element;
    };
    DrillDownPanelComponent.prototype.action = function (button) {
        this.drillDownService.saveState();
        this.model.drillDownButtons.forEach(function (b) { return b.selected = false; });
        button.selected = true;
        this.model.setReportParams(button.reportParams);
        this.element.nativeElement.scrollTop = 0;
        this.controller.getPages();
    };
    DrillDownPanelComponent.prototype.close = function (button) {
        button.visible = false;
        if (button.selected) {
            this.action(this.model.drillDownButtons[0]);
        }
    };
    DrillDownPanelComponent.ctorParameters = function () { return [
        { type: ModelService },
        { type: DrillDownService },
        { type: ControllerService }
    ]; };
    __decorate([
        ViewChild('element')
    ], DrillDownPanelComponent.prototype, "element", void 0);
    DrillDownPanelComponent = __decorate([
        Component({
            selector: 'sti-drill-down-panel',
            template: "\n  <div #element [class]=\"'stiJsViewerToolBar' + (model.options.toolbar.displayMode == 'Separated' ? ' stiJsViewerToolBarSeparated' : '')\"\n    [style.display]=\"model.controls.drillDownPanel.visible ? '' : 'none'\">\n    <div [style.paddingTop]=\"model.options.toolbar.displayMode == 'Simple' ? '2px' : ''\">\n      <table class=\"stiJsViewerToolBarTable\" cellpadding=\"0\" cellspacing=\"0\" style=\"margin: 0px; box-sizing: border-box;\"\n        [style.border]=\"model.options.toolbar.displayMode == 'Separated' ? '0px' : ''\"\n        [style.color]=\"model.options.toolbar.fontColor\"\n        [style.fontFamily]=\"model.options.toolbar.fontFamily\">\n        <tbody>\n          <tr class=\"stiJsViewerClearAllStyles\">\n            <td class=\"stiJsViewerClearAllStyles\">\n              <table class=\"stiJsViewerClearAllStyles\" cellpadding=\"0\" cellspacing=\"0\">\n                <tbody>\n                  <tr class=\"stiJsViewerClearAllStyles\">\n                    <td *ngFor=\"let button of model.drillDownButtons; index as i\" class=\"stiJsViewerClearAllStyles\" style=\"padding: 0px; border: 0px; line-height: 0;\">\n                      <sti-button [display]=\"button.visible ? 'inline-block': 'none'\"\n                        [margin]=\"'2px 1px 2px 2px'\"\n                        [caption]=\"button.caption\"\n                        [height]=\"model.options.toolbar.displayMode == 'Separated' ? '28px' : null\"\n                        [display]=\"'inline-block'\"\n                        [selected]=\"button.selected\"\n                        [closeButton]=\"i > 0\"\n                        (action)=\"action(button)\"\n                        (closeButtonAction)=\"close(button)\">\n                      </sti-button>\n                    </td>\n                  </tr>\n                </tbody>\n              </table>\n            </td>\n          </tr>\n        </tbody>\n      </table>\n    </div>\n  </div>\n  "
        })
    ], DrillDownPanelComponent);
    return DrillDownPanelComponent;
}());

var OpenDialogComponent = /** @class */ (function () {
    function OpenDialogComponent(model, controller) {
        this.model = model;
        this.controller = controller;
    }
    OpenDialogComponent.prototype.ngOnChanges = function (changes) {
        var _this = this;
        if (this.fileMask != null && this.model.openDialogFileMask != null) {
            setTimeout(function () {
                _this.element.nativeElement.focus();
                _this.element.nativeElement.click();
            });
        }
    };
    OpenDialogComponent.prototype.ngOnInit = function () { };
    OpenDialogComponent.prototype.onchange = function (event) {
        var _this = this;
        var files = event.target.files;
        var fileName = files[0] ? files[0].name : 'Report';
        var filePath = event.target.value;
        var reader = new FileReader();
        reader.onload = function (e) {
            _this.controller.loadFile(fileName, e.target.result);
        };
        this.model.openDialogFileMask = null;
        reader.readAsDataURL(files[0]);
    };
    OpenDialogComponent.ctorParameters = function () { return [
        { type: ModelService },
        { type: ControllerService }
    ]; };
    __decorate([
        ViewChild('element')
    ], OpenDialogComponent.prototype, "element", void 0);
    __decorate([
        Input()
    ], OpenDialogComponent.prototype, "fileMask", void 0);
    OpenDialogComponent = __decorate([
        Component({
            selector: 'sti-open-dialog',
            template: "\n    <input #element *ngIf=\"model.openDialogFileMask != null\"  type=\"file\" name=\"files[]\" multiple=\"\" style=\"display: none;\"\n      [attr.accept]=\"model.openDialogFileMask\"\n      (change)=\"onchange($event)\">\n  "
        })
    ], OpenDialogComponent);
    return OpenDialogComponent;
}());

var PasswordFormComponent = /** @class */ (function () {
    function PasswordFormComponent(model, controller, formService) {
        this.model = model;
        this.controller = controller;
        this.formService = formService;
    }
    PasswordFormComponent.prototype.ngOnInit = function () { };
    PasswordFormComponent.prototype.changeVisibility = function (state) {
        if (state === 'visible') {
            this.password = '';
            this.textBox.element.nativeElement.focus();
        }
    };
    PasswordFormComponent.prototype.action = function () {
        var data = this.formService.form.formData;
        data.openingFilePassword = this.password;
        this.formService.closeForm('passwordForm');
        this.controller.postOpen(data);
    };
    PasswordFormComponent.ctorParameters = function () { return [
        { type: ModelService },
        { type: ControllerService },
        { type: FormService }
    ]; };
    __decorate([
        ViewChild('textBox')
    ], PasswordFormComponent.prototype, "textBox", void 0);
    PasswordFormComponent = __decorate([
        Component({
            selector: 'sti-password-form',
            template: "\n    <sti-base-form [fontFamily]=\"model.options.toolbar.fontFamily\"\n      [color]=\"model.options.toolbar.fontColor\"\n      [name]=\"'passwordForm'\"\n      [caption]=\"model.loc('PasswordSaveReport').replace(':', '')\"\n      [level]=\"2\"\n      [defaultTop]=\"150\"\n      (changeVisibility)=\"changeVisibility($event)\"\n      (action)=\"action()\">\n      <table class=\"stiJsViewerClearAllStyles\" cellpadding=\"0\" cellspacing=\"0\" style=\"margin: 5px;\">\n        <tbody>\n          <tr class=\"stiJsViewerClearAllStyles\">\n            <td class=\"stiJsViewerCaptionControls\">\n              {{model.loc('PasswordEnter')}}\n            </td>\n            <td class=\"stiJsViewerCaptionControls\">\n              <sti-text-box #textBox [type]=\"'password'\" [width]=\"200\" [focusOnCreate]=\"true\" [value]=\"password\" (onchange)=\"password = $event.value\">\n              </sti-text-box>\n            </td>\n          </tr>\n        </tbody>\n      </table>\n    </sti-base-form>\n  "
        })
    ], PasswordFormComponent);
    return PasswordFormComponent;
}());

var ErrorMessageFormComponent = /** @class */ (function () {
    function ErrorMessageFormComponent(model, formService) {
        this.model = model;
        this.formService = formService;
    }
    ErrorMessageFormComponent.prototype.ngOnInit = function () { };
    ErrorMessageFormComponent.prototype.getImage = function () {
        var _a;
        var messageType = (_a = this.model.errorMessage) === null || _a === void 0 ? void 0 : _a.type;
        if (messageType === 'Warning') {
            return this.model.img('MsgFormWarning.png');
        }
        else if (messageType === true || messageType === 'Info') {
            return this.model.img('MsgFormInfo.png');
        }
        else {
            return this.model.img('MsgFormError.png');
        }
    };
    ErrorMessageFormComponent.ctorParameters = function () { return [
        { type: ModelService },
        { type: FormService }
    ]; };
    ErrorMessageFormComponent = __decorate([
        Component({
            selector: 'sti-error-message-form',
            template: "\n    <sti-base-form [fontFamily]=\"model.options.toolbar.fontFamily\"\n      [color]=\"model.options.toolbar.fontColor\"\n      [name]=\"'errorMessageForm'\"\n      [caption]=\"model.loc(model.errorMessage?.type == 'Error' ? 'Error' : 'FormViewerTitle')\"\n      [level]=\"4\"\n      [defaultTop]=\"150\"\n      [showCancel]=\"false\"\n      (action)=\"formService.closeForm('errorMessageForm')\">\n      <table class=\"stiJsViewerClearAllStyles\" cellpadding=\"0\" cellspacing=\"0\">\n        <tbody>\n          <tr class=\"stiJsViewerClearAllStyles\">\n            <td class=\"stiJsViewerClearAllStyles\">\n              <img [attr.src]=\"getImage()\" style=\"padding: 15px; height: 32px; width: 32px;\">\n            </td>\n            <td class=\"stiJsViewerMessagesFormDescription\" style=\"max-width: 600px;\"\n              [style.color]=\"model.options.toolbar.fontColor\" [innerHTML]=\"model.errorMessage?.error\">\n            </td>\n          </tr>\n        </tbody>\n      </table>\n    </sti-base-form>\n  "
        })
    ], ErrorMessageFormComponent);
    return ErrorMessageFormComponent;
}());

var ResourcesPanelComponent = /** @class */ (function () {
    function ResourcesPanelComponent(model, controller, helper) {
        var _this = this;
        this.model = model;
        this.controller = controller;
        this.helper = helper;
        controller.getMessage().subscribe(function (message) {
            var _a;
            if (message.action === 'GetReport' || message.action === 'OpenReport') {
                _this.model.controls.resourcesPanel.visible = ((_a = _this.model.reportParams.resources) === null || _a === void 0 ? void 0 : _a.length) > 0;
            }
        });
    }
    ResourcesPanelComponent.prototype.ngOnInit = function () { };
    ResourcesPanelComponent.prototype.ngAfterViewInit = function () {
        this.model.controls.resourcesPanel.el = this.element;
    };
    ResourcesPanelComponent.prototype.action = function (resource) {
        var resTypesAllowedViewInBrowser = ['Image', 'Pdf', 'Txt'];
        var viewType = resTypesAllowedViewInBrowser.indexOf(resource.type) >= 0 ? 'View' : 'SaveFile';
        this.controller.postReportResource(resource.name, this.model.options.jsMode ? 'SaveFile' : viewType);
    };
    ResourcesPanelComponent.prototype.getResourceImage = function (resourceType) {
        if (this.model.img('BigResource' + resourceType + '.png') !== '') {
            return 'BigResource' + resourceType + '.png';
        }
        else {
            return 'BigResource.png';
        }
    };
    ResourcesPanelComponent.prototype.getMenuItems = function (resource) {
        var items = [];
        items.push({ name: 'Resource' + 'View', caption: this.model.loc('ButtonView'), value: resource });
        items.push({ name: 'Resource' + 'SaveFile', caption: this.model.loc('SaveFile'), value: resource });
        return items;
    };
    ResourcesPanelComponent.prototype.getActionName = function (resource) {
        if (!resource.id) {
            resource.id = Math.random().toString();
        }
        return 'resource' + resource.name + resource.id;
    };
    ResourcesPanelComponent.ctorParameters = function () { return [
        { type: ModelService },
        { type: ControllerService },
        { type: HelperService }
    ]; };
    __decorate([
        ViewChild('element')
    ], ResourcesPanelComponent.prototype, "element", void 0);
    ResourcesPanelComponent = __decorate([
        Component({
            selector: 'sti-resources-panel',
            template: "\n    <div #element style=\"z-index: 3\"\n      [style.display]=\"this.model.controls.resourcesPanel.visible ? '' : 'none'\"\n      [style.fontFamily]=\"model.options.toolbar.fontFamily\"\n      [style.fontColor]=\"model.options.toolbar.fontColor\"\n      [class]=\"'stiJsViewerToolBar' + (model.options.toolbar.displayMode == 'Separated' ? ' stiJsViewerToolBarSeparated' : '')\">\n      <div [style.paddingTop]=\"model.options.toolbar.displayMode == 'Simple' ? '2px' : ''\">\n        <div class=\"stiJsViewerToolBarTable\" style=\"box-sizing: border-box; display: table;\"\n          [style.border]=\"model.options.toolbar.displayMode == 'Separated' ? '0px' : ''\">\n          <table class=\"stiJsViewerClearAllStyles\" cellpadding=\"0\" cellspacing=\"0\">\n            <tbody>\n              <tr class=\"stiJsViewerClearAllStyles\">\n                <td *ngFor=\"let resource of model.reportParams.resources\" class=\"stiJsViewerClearAllStyles\">\n                  <sti-button [caption]=\"resource.name\"\n                    [caption2]=\"helper.getHumanFileSize(resource.size, 1)\"\n                    [imageName]=\"getResourceImage(resource.type)\"\n                    [styleName]=\"'stiJsViewerFormButton'\"\n                    [height]=\"'auto'\"\n                    [margin]=\"'3px 0 3px 3px'\"\n                    [innerTableWidth]=\"'100%'\"\n                    [minWidth]=\"'80px'\"\n                    [captionAlign]=\"'left'\"\n                    [captionPaddingLeft]=\"'3px'\"\n                    [captionMaxWidth]=\"'150px'\"\n                    [captionLineHeight]=\"'14px'\"\n                    [captionWhiteSpace]=\"'nowrap'\"\n                    [captionOverflow]=\"'hidden'\"\n                    [captionTextOverflow]=\"'ellipsis'\"\n                    [imageCellWidth]=\"'1px'\"\n                    [imageCellPadding]=\"'4px 8px 4px 4px'\"\n                    [menuItems]=\"getMenuItems(resource)\"\n                    [resourceButton]=\"true\"\n                    [imageSizesWidth]=\"32\"\n                    [imageSizesHeight]=\"32\"\n                    [actionName]=\"getActionName(resource)\"\n                    (action)=\"action(resource)\">\n                  </sti-button>\n                </td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n      </div>\n    </div>\n  "
        })
    ], ResourcesPanelComponent);
    return ResourcesPanelComponent;
}());

var ProgressComponent = /** @class */ (function () {
    function ProgressComponent(model) {
        this.model = model;
    }
    ProgressComponent.prototype.ngOnInit = function () { };
    ProgressComponent.ctorParameters = function () { return [
        { type: ModelService }
    ]; };
    ProgressComponent = __decorate([
        Component({
            selector: 'sti-progress',
            template: "\n    <div style=\"position: absolute; z-index: 1000; left: calc(50% - 35px);\"\n        [style.top]=\"model.options.appearance.fullScreenMode ? 'calc(50% - 100px)' : '250px'\"\n        [style.display]=\"model.showProgress ? '' : 'none'\">\n      <div class=\"js_viewer_loader\"></div>\n    </div>\n  "
        })
    ], ProgressComponent);
    return ProgressComponent;
}());

var NavigatePanelComponent = /** @class */ (function () {
    function NavigatePanelComponent(model, controller, helper, pageService) {
        this.model = model;
        this.controller = controller;
        this.helper = helper;
        this.pageService = pageService;
        this.comps = [];
    }
    NavigatePanelComponent.prototype.ngOnInit = function () {
        var _this = this;
        if (this.model.options.toolbar.displayMode === 'Separated') {
            this.initButtons();
        }
        this.controller.getMessage().subscribe(function (message) {
            if (message.action !== 'viewer_loaded') {
                _this.updateButtons();
            }
        });
        this.model.controls.navigatePanel.visible = this.model.options.toolbar.displayMode === 'Separated';
    };
    NavigatePanelComponent.prototype.ngAfterViewInit = function () {
        this.model.controls.navigatePanel.el = this.element;
    };
    NavigatePanelComponent.prototype.updateButtons = function () {
        var _this = this;
        this.comps.filter(function (i) { return i.action === 'ViewMode'; }).forEach(function (m) { return m.caption = _this.model.loc(_this.model.reportParams.viewMode); });
        this.comps.filter(function (i) { return i.action === 'Zoom'; }).forEach(function (m) {
            m.menuItems.forEach(function (n) { return n.selected = n.name === ('Zoom' + _this.model.reportParams.zoom); });
            m.caption = Math.round(_this.model.reportParams.zoom) + '%';
        });
        this.comps.filter(function (i) { return i.action === 'ShowFind'; }).forEach(function (m) {
            m.selected = _this.model.controls.findPanel.visible;
        });
    };
    NavigatePanelComponent.prototype.initButtons = function () {
        var comps = [];
        if (this.model.options.toolbar.showFirstPageButton) {
            comps.push({ type: 'button', action: 'FirstPage', img: 'PageFirst20.png', tooltip: true });
        }
        if (this.model.options.toolbar.showPreviousPageButton) {
            comps.push({ type: 'button', action: 'PrevPage', img: 'PagePrevious20.png', tooltip: true });
        }
        if (this.model.options.toolbar.showCurrentPageControl) {
            comps.push({ type: 'separator' });
            comps.push({ type: 'pageControl' });
            comps.push({ type: 'separator' });
        }
        if (this.model.options.toolbar.showNextPageButton) {
            comps.push({ type: 'button', action: 'NextPage', img: 'PageNext20.png', tooltip: true });
        }
        if (this.model.options.toolbar.showLastPageButton) {
            comps.push({ type: 'button', action: 'LastPage', img: 'PageLast20.png', tooltip: true });
        }
        comps.push({ type: 'space' });
        comps.push({ type: 'button', action: 'ZoomPageWidth', img: 'ZoomPageWidth20.png', tooltip: true });
        comps.push({ type: 'button', action: 'ZoomOnePage', img: 'ZoomOnePage20.png', tooltip: true });
        if (this.model.options.toolbar.showZoomButton) {
            comps.push({ type: 'separator' });
            comps.push({
                type: 'button', action: 'Zoom', caption: '100%', tooltip: true, arrow: 'Arrows.SmallArrowUpWhite.png',
                menuItems: this.helper.getZoomMenuItems()
            });
        }
        this.comps = comps;
    };
    NavigatePanelComponent.prototype.enabled = function (desc) {
        var disableNaviButtons = this.disableNaviButtons();
        switch (desc.action) {
            case 'FirstPage':
            case 'PrevPage':
                return this.model.reportParams.pageNumber > 0 && !disableNaviButtons;
            case 'NextPage':
            case 'LastPage':
                return this.model.reportParams.pageNumber < this.model.reportParams.pagesCount - 1 && !disableNaviButtons;
        }
        return true;
    };
    NavigatePanelComponent.prototype.selected = function (desc) {
        switch (desc.action) {
            case 'ZoomPageWidth':
                return Math.round(this.model.reportParams.zoom) === Math.round(this.pageService.getZoomByPageWidth());
            case 'ZoomOnePage':
                return Math.round(this.model.reportParams.zoom) === Math.round(this.pageService.getZoomByPageHeight());
        }
        return false;
    };
    NavigatePanelComponent.prototype.disableNaviButtons = function () {
        return this.model.reportParams.viewMode === 'MultiplePages' || this.model.reportParams.viewMode === 'WholeReport' ||
            (this.model.reportParams.viewMode === 'Continuous' && !this.model.options.appearance.scrollbarsMode && !this.model.options.appearance.fullScreenMode);
    };
    NavigatePanelComponent.ctorParameters = function () { return [
        { type: ModelService },
        { type: ControllerService },
        { type: HelperService },
        { type: PageService }
    ]; };
    __decorate([
        ViewChild('element')
    ], NavigatePanelComponent.prototype, "element", void 0);
    NavigatePanelComponent = __decorate([
        Component({
            selector: 'sti-navigate-panel',
            template: "\n  <div #element class=\"stiJsViewerNavigatePanel\" style=\"display: block;\"\n    [style.display]=\"!model.options.isMobileDevice ? (this.model.controls.navigatePanel.visible ? '' : 'none') : ''\"\n    [style.transition]=\"model.options.isMobileDevice ? 'margin 300ms ease, opacity 300ms ease' : null\"\n    [style.zIndex]=\"model.options.isMobileDevice ? (model.options.toolbar.autoHide ? 5 : 2) : null\"\n    [style.opacity]=\"model.options.isMobileDevice ? (model.controls.navigatePanel.visible ? (model.options.toolbar.autoHide ? 0.9 : 1) : 0) : 1\"\n    [style.marginBottom]=\"model.options.isMobileDevice && !model.controls.navigatePanel.visible ? '-0.55in' : 0\">\n    <table class=\"stiJsViewerClearAllStyles\" cellpadding=\"0\" cellspacing=\"0\">\n      <tbody>\n        <tr class=\"stiJsViewerClearAllStyles\">\n          <td *ngFor=\"let comp of comps\" class=\"stiJsViewerClearAllStyles\" [style.width]=\"comp.type == 'space' ? '100%' : null\">\n            <sti-button *ngIf=\"comp.type=='button'\"\n              [caption]=\"comp.caption\"\n              [imageName]=\"comp.img\"\n              [arrow]=\"comp.arrow\"\n              [menuItems]=\"comp.menuItems\"\n              [actionName]=\"comp.action\"\n              [tooltip]=\"comp.tooltip\"\n              [styleName]=\"'stiJsViewerNavigateButton'\"\n              [height]=\"model.options.isMobileDevice ? '0.5in' : '35px'\"\n              [width]=\"model.options.isMobileDevice ? '0.4in' : '35px'\"\n              [boxSizing]=\"'border-box'\"\n              [arrowMarginTop]=\"'1px'\"\n              [enabled]=\"enabled(comp)\"\n              [imageCellTextAlign]=\"'center'\"\n              [innerTableWidth]=\"'100%'\"\n              [navagationPanelTooltip]=\"true\"\n              [margin]=\"comp.action == 'FirstPage' ? '0 1px 0 3px' : (comp.action == 'Zoom' ? '0 3px 0 1px' : '0px 1px 0 1px')\"\n              [selected]=\"selected(comp)\"\n              (action)=\"controller.action({ name: comp.action })\">\n            </sti-button>\n\n            <div *ngIf=\"comp.type=='separator'\"\n              [style.height]=\"model.options.isMobileDevice ? '0.5in' : '35px'\"\n              [style.margin]=\"'0px 1px 0 1px'\"\n              class=\"stiJsViewerNavigatePanelSeparator\"></div>\n\n            <sti-page-control *ngIf=\"comp.type=='pageControl'\"\n              [enabled]=\"!(model.reportParams.pagesCount <= 1 || disableNaviButtons())\"\n              [count]=\"model.reportParams.pagesCount\"\n              [margin]=\"'0px 1px 0 1px'\"\n              [textBoxBorder]=\"'0px'\"></sti-page-control>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n    <div class=\"stiJsViewerNavigatePanelDisabledPanel\" [style.display]=\"this.model.controls.navigatePanel.enabled ? 'none' : 'block'\"></div>\n  </div>\n  "
        })
    ], NavigatePanelComponent);
    return NavigatePanelComponent;
}());

var AboutPanelComponent = /** @class */ (function () {
    function AboutPanelComponent(model, controller, helper, formService) {
        var _this = this;
        this.model = model;
        this.controller = controller;
        this.helper = helper;
        this.formService = formService;
        this.year = new Date().getFullYear();
        this.top = 0;
        this.left = 0;
        this.opacity = 0;
        controller.getActionMessage().subscribe(function (message) {
            if (message.action === 'About') {
                _this.formService.form = { name: 'about', left: 0, top: 0, isMooving: false, level: 2 };
                _this.opacity = 0;
                setTimeout(function () {
                    _this.top = _this.model.viewerSize.height / 2 - _this.element.nativeElement.offsetHeight / 2;
                    _this.left = _this.model.viewerSize.width / 2 - _this.element.nativeElement.offsetWidth / 2;
                    _this.opacity = 1;
                });
            }
        });
    }
    AboutPanelComponent.prototype.ngOnInit = function () { };
    AboutPanelComponent.prototype.close = function () {
        this.formService.closeForm('about');
    };
    AboutPanelComponent.prototype.click = function (event) {
        if (event) {
            event.stopPropagation();
            event.preventDefault();
        }
        this.helper.openNewWindow('https://www.stimulsoft.com');
    };
    AboutPanelComponent.prototype.isLicensed = function () {
        return !this.model.options.cloudMode && !this.model.options.serverMode && !this.model.options.standaloneJsMode &&
            !this.model.options.reportDesignerMode && !this.model.options.licenseIsValid;
    };
    Object.defineProperty(AboutPanelComponent.prototype, "userLabel", {
        get: function () {
            var userName = this.model.options.licenseUserName || '';
            if (this.isLicensed()) {
                if (userName) {
                    userName += ', ';
                }
                return userName + this.helper.getBackText(true) + ' Version';
            }
            else {
                return userName;
            }
        },
        enumerable: true,
        configurable: true
    });
    AboutPanelComponent.ctorParameters = function () { return [
        { type: ModelService },
        { type: ControllerService },
        { type: HelperService },
        { type: FormService }
    ]; };
    __decorate([
        ViewChild('element')
    ], AboutPanelComponent.prototype, "element", void 0);
    AboutPanelComponent = __decorate([
        Component({
            selector: 'sti-about-panel',
            template: "\n    <div #element class=\"stiJsViewerAboutPanel\" style=\"background-size: contain;\"\n      [style.display]=\"formService.form?.name == 'about' ? '' : 'none'\"\n      [style.left.px]=\"left\"\n      [style.top.px]=\"top\"\n      [style.opacity]=\"opacity\"\n      (click)=\"close()\" >\n      <div class=\"stiJsViewerAboutPanelHeader\">\n        Stimulsoft Reports\n      </div>\n      <img src=\"{{model.img('About.png')}}\" style=\"margin-top: 30px; height: 94px; width: 94px;\">\n      <div class=\"stiJsViewerAboutPanelCopyright\">\n        {{'Copyright 2003-' + year + ' Stimulsoft'}}\n      </div>\n      <div class=\"stiJsViewerAboutPanelVersion\">\n        {{model.options.productVersion?.trim()}}, {{model.options?.frameworkType}}, Angular\n      </div>\n      <div class=\"stiJsViewerAboutPanelVersion\">\n        All rights reserved\n      </div>\n      <div class=\"stiJsViewerAboutPanelVersion\" style=\"margin-top: 20px;font-weight: bold; \"\n        [style.color]=\"isLicensed() ? 'red' : '#444444'\"\n        [style.display]=\"isLicensed() || userLabel ? '' : 'none'\">\n        {{userLabel}}\n      </div>\n      <div class=\"stiJsViewerFormSeparator\" style=\"margin-top: 20px;\">\n      </div>\n      <div class=\"stiJsViewerAboutPanelStiLink\" (click)='click($event)'>\n        www.stimulsoft.com\n      </div>\n    </div>\n  "
        })
    ], AboutPanelComponent);
    return AboutPanelComponent;
}());

var ToolbarDopComponent = /** @class */ (function () {
    function ToolbarDopComponent(model, controller, toolbarService) {
        this.model = model;
        this.controller = controller;
        this.toolbarService = toolbarService;
        this.marginLeft = '1px';
        this.viewInit = false;
    }
    ToolbarDopComponent.prototype.ngAfterViewInit = function () {
        var _this = this;
        this.viewInit = true;
        setTimeout(function () {
            var _a, _b;
            var width = (_b = (_a = _this.mainTable) === null || _a === void 0 ? void 0 : _a.nativeElement) === null || _b === void 0 ? void 0 : _b.offsetWidth;
            _this.marginLeft = _this.viewInit && _this.model.options.toolbar.alignment === 'Center' && width ? "calc(50% - " + Math.trunc(width / 2) + "px)" : '1px';
        });
    };
    ToolbarDopComponent.prototype.ngOnInit = function () { };
    ToolbarDopComponent.ctorParameters = function () { return [
        { type: ModelService },
        { type: ControllerService },
        { type: ToolbarService }
    ]; };
    __decorate([
        ViewChild('mainTable')
    ], ToolbarDopComponent.prototype, "mainTable", void 0);
    __decorate([
        Input()
    ], ToolbarDopComponent.prototype, "comps", void 0);
    __decorate([
        Input()
    ], ToolbarDopComponent.prototype, "align", void 0);
    ToolbarDopComponent = __decorate([
        Component({
            selector: 'sti-toolbar-dop',
            template: "\n    <table #mainTable\n      class=\"stiJsViewerClearAllStyles\"\n      cellpadding=\"0\"\n      cellspacing=\"0\"\n      style=\"margin: 1px;\"\n      [attr.align]=\"align\"\n      [style.marginLeft]=\"marginLeft\">\n      <tbody>\n        <tr class=\"stiJsViewerClearAllStyles\">\n          <td *ngFor=\"let comp of comps\" class=\"stiJsViewerClearAllStyles\">\n            <sti-button *ngIf=\"comp.type=='button'\"\n              [caption]=\"model.options.toolbar.showButtonCaptions ? comp.caption : null\"\n              [imageName]=\"comp.img\"\n              [arrow]=\"!model.options.isMobileDevice ? comp.arrow : null\"\n              [menuItems]=\"comp.menuItems\"\n              [actionName]=\"comp.action\"\n              [tooltip]=\"comp.tooltip\"\n              [enabled]=\"toolbarService.enabled(comp)\"\n              [display]=\"toolbarService.display(comp)\"\n              [innerTableWidth]=\"toolbarService.getInnerTableWidth(comp)\"\n              [width]=\"toolbarService.getButonWidth(comp)\"\n              [height]=\"model.options.toolbar.displayMode == 'Separated' ? (model.options.isMobileDevice ? '0.5in' : '28px') : null\"\n              (action)=\"controller.action({ name: comp.action });\"\n              [selected]=\"toolbarService.selected(comp)\"></sti-button>\n            <sti-toolbar-separator *ngIf=\"comp.type=='separator'\"></sti-toolbar-separator>\n            <sti-page-control *ngIf=\"comp.type=='pageControl'\" [enabled]=\"!(model.reportParams.pagesCount <= 1 || toolbarService.disableNaviButtons())\" [count]=\"model.reportParams.pagesCount\" ></sti-page-control>\n        </td>\n      </tr>\n    </tbody>\n  </table>\n  "
        })
    ], ToolbarDopComponent);
    return ToolbarDopComponent;
}());

var CenterTextComponent = /** @class */ (function () {
    function CenterTextComponent(model, controller, helper) {
        var _this = this;
        this.model = model;
        this.controller = controller;
        this.helper = helper;
        this.text = '';
        this.opacity = 0;
        this.display = 'none';
        controller.getActionMessage().subscribe(function (message) {
            switch (message.action) {
                case 'centerText':
                    _this.show(message.data);
                    break;
                case 'hideCenterText':
                    _this.hide();
                    break;
            }
        });
    }
    CenterTextComponent.prototype.ngOnInit = function () { };
    CenterTextComponent.prototype.show = function (text) {
        var _this = this;
        this.display = '';
        this.opacity = 0;
        this.text = text;
        setTimeout(function () {
            _this.helper.setObjectToCenter(_this.element.nativeElement);
            _this.opacity = 1;
        });
        if (this.hideTimer) {
            clearTimeout(this.hideTimer);
        }
        this.hideTimer = setTimeout(function () {
            _this.hide();
        }, 2000);
    };
    CenterTextComponent.prototype.hide = function () {
        var _this = this;
        this.opacity = 0;
        if (this.hideTimer) {
            clearTimeout(this.hideTimer);
        }
        this.hideTimer = setTimeout(function () {
            _this.display = 'none';
        }, 300);
    };
    CenterTextComponent.ctorParameters = function () { return [
        { type: ModelService },
        { type: ControllerService },
        { type: HelperService }
    ]; };
    __decorate([
        ViewChild('element')
    ], CenterTextComponent.prototype, "element", void 0);
    CenterTextComponent = __decorate([
        Component({
            selector: 'sti-center-text',
            template: "\n    <div #element\n      style=\"position: absolute; z-index: 1000; transition-property: opacity; transition-duration: 300ms; text-shadow: rgb(0, 0, 0) -1px -1px 0px, rgb(0, 0, 0) 1px -1px 0px, rgb(0, 0, 0) -1px 1px 0px, rgb(0, 0, 0) 1px 1px 0px; font-size: 100px;\"\n      [style.fontFamily]=\"model.options.toolbar.fontFamily\"\n      [style.color]=\"model.options.toolbar.fontColor\"\n      [style.opacity]=\"opacity\"\n      [style.display]=\"display\">\n      <div>\n        {{text}}\n      </div>\n    </div>\n  "
        })
    ], CenterTextComponent);
    return CenterTextComponent;
}());

var NotificationFormComponent = /** @class */ (function () {
    function NotificationFormComponent(model, formService) {
        this.model = model;
        this.formService = formService;
    }
    NotificationFormComponent.prototype.ngOnInit = function () { };
    NotificationFormComponent.prototype.changeVisibility = function (state) {
        var _a;
        if (state === 'hidden' && ((_a = this.model.notificationFormOptions) === null || _a === void 0 ? void 0 : _a.cancelAction)) {
            this.model.notificationFormOptions.cancelAction();
        }
    };
    NotificationFormComponent.prototype.action = function () {
        var _a;
        ((_a = this.model.notificationFormOptions) === null || _a === void 0 ? void 0 : _a.action) ? this.model.notificationFormOptions.action() : this.formService.closeForm('notificationForm');
    };
    NotificationFormComponent.ctorParameters = function () { return [
        { type: ModelService },
        { type: FormService }
    ]; };
    NotificationFormComponent = __decorate([
        Component({
            selector: 'sti-notification-form',
            template: "\n  <sti-base-form [fontFamily]=\"model.options.toolbar.fontFamily\"\n      [color]=\"model.options.toolbar.fontColor\"\n      [name]=\"'notificationForm'\"\n      [defaultTop]=\"150\"\n      [caption]=\"model.loc('Viewer')\"\n      [level]=\"4\"\n      [showButtons]=\"false\"\n      [showSeparator]=\"false\"\n      (changeVisibility)=\"changeVisibility($event)\">\n      <table class=\"stiJsViewerClearAllStyles\" cellpadding=\"0\" cellspacing=\"0\">\n        <tbody>\n          <tr *ngIf=\"model.notificationFormOptions?.image\" class=\"stiJsViewerClearAllStyles\">\n            <td class=\"stiJsViewerClearAllStyles\" style=\"text-align: center;\">\n              <img src=\"{{model.img(model.notificationFormOptions?.image)}}\" style=\"margin-top: 20px; width: 112px; height: 112px;\">\n            </td>\n          </tr>\n          <tr *ngIf=\"model.notificationFormOptions?.message\" class=\"stiJsViewerClearAllStyles\">\n            <td class=\"stiJsViewerClearAllStyles\">\n              <div class=\"stiJsViewerNotificationFormMessage\">\n                {{model.notificationFormOptions?.message}}\n              </div>\n            </td>\n          </tr>\n          <tr *ngIf=\"model.notificationFormOptions?.description\" class=\"stiJsViewerClearAllStyles\">\n            <td class=\"stiJsViewerClearAllStyles\">\n              <div class=\"stiJsViewerNotificationFormDescription\">\n                {{model.notificationFormOptions?.description}}\n              </div>\n            </td>\n          </tr>\n          <tr class=\"stiJsViewerClearAllStyles\">\n            <td class=\"stiJsViewerClearAllStyles\" style=\"text-align: center;\">\n              <sti-button\n                [caption]=\"model.notificationFormOptions?.buttonCaption\"\n                [styleName]=\"'stiJsViewerLoginButton'\"\n                [innerTableWidth]=\"'100%'\"\n                [height]=\"'40px'\"\n                [minWidth]=\"'80px'\"\n                [captionAlign]=\"'center'\"\n                [cursor]=\"'pointer'\"\n                [display]=\"'inline-block'\"\n                [minWidth]=\"'200px'\"\n                [width]=\"'auto'\"\n                [margin]=\"'20px 30px 30px 30px'\"\n                [fontSize]=\"'14px'\"\n                (action)=\"action()\">\n              </sti-button>\n            </td>\n          </tr>\n        </tbody>\n      </table>\n    </sti-base-form>\n    "
        })
    ], NotificationFormComponent);
    return NotificationFormComponent;
}());

var DashboardsPanelComponent = /** @class */ (function () {
    function DashboardsPanelComponent(model, helper, dashboardService) {
        this.model = model;
        this.helper = helper;
        this.dashboardService = dashboardService;
        this.imagesPath = 'Dashboards.Actions.Light.';
    }
    DashboardsPanelComponent.prototype.ngOnInit = function () { };
    DashboardsPanelComponent.prototype.ngAfterViewInit = function () {
        this.model.controls.navigatePanel.el = this.element;
    };
    Object.defineProperty(DashboardsPanelComponent.prototype, "dbsMode", {
        get: function () {
            return this.dashboardsCount > 0 && this.reportsCount === 0;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DashboardsPanelComponent.prototype, "dashboardsCount", {
        get: function () {
            var _a, _b;
            var count = 0;
            if ((_b = (_a = this.model) === null || _a === void 0 ? void 0 : _a.reportParams) === null || _b === void 0 ? void 0 : _b.dashboards) {
                this.model.reportParams.dashboards.forEach(function (i) {
                    if (i['type'] === 'Dashboard') {
                        count++;
                    }
                });
            }
            return count;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DashboardsPanelComponent.prototype, "reportsCount", {
        get: function () {
            var _a, _b;
            if ((_b = (_a = this.model) === null || _a === void 0 ? void 0 : _a.reportParams) === null || _b === void 0 ? void 0 : _b.dashboards) {
                return this.model.reportParams.dashboards.length - this.dashboardsCount;
            }
            return 0;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DashboardsPanelComponent.prototype, "previewSettings", {
        get: function () {
            return this.model.reportParams.previewSettings || {};
        },
        enumerable: true,
        configurable: true
    });
    DashboardsPanelComponent.ctorParameters = function () { return [
        { type: ModelService },
        { type: HelperService },
        { type: DashboardService }
    ]; };
    __decorate([
        ViewChild('element')
    ], DashboardsPanelComponent.prototype, "element", void 0);
    DashboardsPanelComponent = __decorate([
        Component({
            selector: 'sti-dashboards-panel',
            template: "\n    <div #element\n      [class]=\"'stiJsViewerToolBar' + (model.options.toolbar.displayMode == 'Separated' ? ' stiJsViewerToolBarSeparated' : '')\"\n      [style.fontFamily]=\"model.options.toolbar.fontFamily\"\n      [style.fontColor]=\"helper.val(model.options.toolbar.fontColor)\"\n      [style.display]=\"model.controls.dashboardsPanel.visible ? '' : 'none'\"\n      [style.background]=\"dbsMode ? 'transparent' : ''\"\n      [style.borderColor]=\"dbsMode ? 'transparent' : ''\">\n      <div [style.paddingTop]=\"model.options.toolbar.displayMode == 'Simple' ? '2px' : ''\">\n        <table class=\"stiJsViewerToolBarTable\" cellpadding=\"0\" cellspacing=\"0\" style=\"margin: 0px; box-sizing: border-box;\"\n          [style.border]=\"model.options.toolbar.displayMode == 'Separated' ? '0px' : ''\"\n          [style.background]=\"dbsMode ? 'transparent' : ''\"\n          [style.borderColor]=\"dbsMode ? 'transparent' : ''\">\n          <tbody>\n            <tr class=\"stiJsViewerClearAllStyles\">\n              <td class=\"stiJsViewerClearAllStyles\" style=\"width: 100%;\">\n                <table class=\"stiJsViewerToolBarTable\" cellpadding=\"0\" cellspacing=\"0\"\n                  [style.align]=\"model.options.appearance.rightToLeft ? 'right' : (model.options.toolbar.alignment == 'default' ? 'left' : model.options.toolbar.alignment)\">\n                  <tbody>\n                      <tr>\n                         <td *ngFor=\"let info of model.reportParams.dashboards; let i=index\">\n                            <sti-dashboard-button\n                              [info]=\"info\"\n                              [dbsMode]=\"dbsMode\"\n                              [display]=\"dashboardsCount == 1 && reportsCount == 0 ? 'none': null\">\n                            </sti-dashboard-button>\n                        </td>\n                      </tr>\n                  </tbody>\n                </table>\n              </td>\n\n              <!-- actions table -->\n              <td class=\"stiJsViewerClearAllStyles\">\n                <table class=\"stiJsViewerToolBarTable\" cellpadding=\"0\" cellspacing=\"0\" style=\"margin-right:2px\">\n                  <tbody>\n                      <tr>\n                        <td *ngIf=\"model.options.toolbar.showRefreshButton && model.options.toolbar.visible\">\n                          <sti-button [imageName]=\"imagesPath + 'Refresh.png'\"\n                            [tooltip]=\"model.loc('Refresh')\"\n                            [helpLink]=\"helper.helpLinks['DashboardToolbar']\"\n                            [margin]=\"'2px 0 2px 2px'\"\n                            [actionName]=\"'Refresh'\"\n                            [height]=\"model.options.toolbar.displayMode == 'Separated' ? (dbsMode ? (model.options.isTouchDevice ? '28px' : '23px') : '28px') : null\"\n                            [width]=\"model.options.toolbar.displayMode == 'Separated' ? (dbsMode ? (model.options.isTouchDevice ? '28px' : '23px') : '28px') : null\"\n                            [innerTableWidth]=\"model.options.toolbar.displayMode == 'Separated' ? '100%': null\"\n                            [imageCellTextAlign]=\"model.options.toolbar.displayMode == 'Separated' ? 'center': null\"\n                            [display]=\"previewSettings.dashboardToolBar && previewSettings.dashboardRefreshButton ? '' : 'none'\">\n                          </sti-button>\n                        </td>\n\n                        <td *ngIf=\"model.options.toolbar.showParametersButton && model.options.toolbar.visible\">\n                          <sti-button [imageName]=\"imagesPath + 'Parameters.png'\"\n                            [tooltip]=\"model.loc('Parameters')\"\n                            [helpLink]=\"helper.helpLinks['DashboardToolbar']\"\n                            [margin]=\"'2px 0 2px 2px'\"\n                            [actionName]=\"'Parameters'\"\n                            [height]=\"model.options.toolbar.displayMode == 'Separated' ? (dbsMode ? (model.options.isTouchDevice ? '28px' : '23px') : '28px') : null\"\n                            [width]=\"model.options.toolbar.displayMode == 'Separated' ? (dbsMode ? (model.options.isTouchDevice ? '28px' : '23px') : '28px') : null\"\n                            [innerTableWidth]=\"model.options.toolbar.displayMode == 'Separated' ? '100%': null\"\n                            [imageCellTextAlign]=\"model.options.toolbar.displayMode == 'Separated' ? 'center': null\">\n                          </sti-button>\n                        </td>\n\n                        <td *ngIf=\"model.options.toolbar.showOpenButton && model.options.toolbar.visible\">\n                          <sti-button [imageName]=\"imagesPath + 'Open.png'\"\n                            [tooltip]=\"model.loc('Open')\"\n                            [helpLink]=\"helper.helpLinks['DashboardToolbar']\"\n                            [margin]=\"'2px 0 2px 2px'\"\n                            [actionName]=\"'OpenDashboard'\"\n                            [height]=\"model.options.toolbar.displayMode == 'Separated' ? (dbsMode ? (model.options.isTouchDevice ? '28px' : '23px') : '28px') : null\"\n                            [width]=\"model.options.toolbar.displayMode == 'Separated' ? (dbsMode ? (model.options.isTouchDevice ? '28px' : '23px') : '28px') : null\"\n                            [innerTableWidth]=\"model.options.toolbar.displayMode == 'Separated' ? '100%': null\"\n                            [imageCellTextAlign]=\"model.options.toolbar.displayMode == 'Separated' ? 'center': null\"\n                            [display]=\"previewSettings.dashboardToolBar && previewSettings.dashboardOpenButton ? '' : 'none'\">\n                          </sti-button>\n                        </td>\n\n                        <td *ngIf=\"model.options.toolbar.showDesignButton && model.options.toolbar.visible\">\n                          <sti-button [imageName]=\"imagesPath + 'Edit.png'\"\n                            [tooltip]=\"model.loc('Edit')\"\n                            [helpLink]=\"helper.helpLinks['DashboardToolbar']\"\n                            [margin]=\"'2px 0 2px 2px'\"\n                            [actionName]=\"'postDesign'\"\n                            [height]=\"model.options.toolbar.displayMode == 'Separated' ? (dbsMode ? (model.options.isTouchDevice ? '28px' : '23px') : '28px') : null\"\n                            [width]=\"model.options.toolbar.displayMode == 'Separated' ? (dbsMode ? (model.options.isTouchDevice ? '28px' : '23px') : '28px') : null\"\n                            [innerTableWidth]=\"model.options.toolbar.displayMode == 'Separated' ? '100%': null\"\n                            [imageCellTextAlign]=\"model.options.toolbar.displayMode == 'Separated' ? 'center': null\"\n                            [display]=\"previewSettings.dashboardToolBar && previewSettings.dashboardEditButton ? '' : 'none'\">\n                          </sti-button>\n                        </td>\n\n                        <td *ngIf=\"model.options.toolbar.showFullScreenButton && model.options.toolbar.visible\">\n                          <sti-button [imageName]=\"imagesPath + 'CloseFullScreen.png'\"\n                            [caption]=\"model.loc('Close')\"\n                            [tooltip]=\"model.loc('FullScreen')\"\n                            [helpLink]=\"helper.helpLinks['DashboardToolbar']\"\n                            [margin]=\"'2px 0 2px 2px'\"\n                            [actionName]=\"'postFullScreen'\"\n                            [height]=\"model.options.toolbar.displayMode == 'Separated' ? (dbsMode ? (model.options.isTouchDevice ? '28px' : '23px') : '28px') : null\"\n                            [innerTableWidth]=\"model.options.toolbar.displayMode == 'Separated' ? '100%': null\"\n                            [imageCellTextAlign]=\"model.options.toolbar.displayMode == 'Separated' ? 'center': null\"\n                            [display]=\"previewSettings.dashboardToolBar && previewSettings.dashboardFullScreenButton ? '' : 'none'\">\n                          </sti-button>\n                        </td>\n\n                        <td *ngIf=\"model.options.toolbar.showSaveButton && model.options.toolbar.visible\">\n                          <sti-button [imageName]=\"imagesPath + 'Menu.png'\"\n                            [tooltip]=\"model.loc('Save')\"\n                            [helpLink]=\"helper.helpLinks['DashboardToolbar']\"\n                            [margin]=\"'2px 0 2px 2px'\"\n                            [actionName]=\"'ExportDashboard'\"\n                            [height]=\"model.options.toolbar.displayMode == 'Separated' ? (dbsMode ? (model.options.isTouchDevice ? '28px' : '23px') : '28px') : null\"\n                            [width]=\"model.options.toolbar.displayMode == 'Separated' ? (dbsMode ? (model.options.isTouchDevice ? '28px' : '23px') : '28px') : null\"\n                            [innerTableWidth]=\"model.options.toolbar.displayMode == 'Separated' ? '100%': null\"\n                            [imageCellTextAlign]=\"model.options.toolbar.displayMode == 'Separated' ? 'center': null\"\n                            [display]=\"previewSettings.dashboardToolBar && previewSettings.dashboardMenuButton && ((previewSettings.dashboardShowReportSnapshots && !model.options.jsMode) || previewSettings.dashboardShowExports) ? '' :'none'\">\n                          </sti-button>\n                        </td>\n                      </tr>\n                  </tbody>\n                </table>\n              </td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n    </div>\n  "
        })
    ], DashboardsPanelComponent);
    return DashboardsPanelComponent;
}());

var DashboardButtonComponent = /** @class */ (function () {
    function DashboardButtonComponent(model) {
        this.model = model;
        this.showCloseButton = false;
    }
    DashboardButtonComponent.prototype.ngOnInit = function () { };
    DashboardButtonComponent.ctorParameters = function () { return [
        { type: ModelService }
    ]; };
    __decorate([
        Input()
    ], DashboardButtonComponent.prototype, "showCloseButton", void 0);
    __decorate([
        Input()
    ], DashboardButtonComponent.prototype, "info", void 0);
    __decorate([
        Input()
    ], DashboardButtonComponent.prototype, "dbsMode", void 0);
    __decorate([
        Input()
    ], DashboardButtonComponent.prototype, "display", void 0);
    DashboardButtonComponent = __decorate([
        Component({
            selector: 'sti-dashboard-button',
            template: "\n    <sti-button\n      [margin]=\"'2px 1px 2px 2px'\"\n      [display]=\"display\"\n      [borderColor]=\"!dbsMode ? 'transparent' : ''\"\n      [height]=\"model.options.toolbar.displayMode == 'Separated' ? (dbsMode ? (model.options.isTouchDevice ? '28px' : '23px') : '28px') : null\">\n    </sti-button>\n  "
        })
    ], DashboardButtonComponent);
    return DashboardButtonComponent;
}());

var StimulsoftViewerModule = /** @class */ (function () {
    function StimulsoftViewerModule() {
    }
    StimulsoftViewerModule = __decorate([
        NgModule({
            declarations: [StimulsoftViewerComponent, ToolbarComponent, ButtonComponent, PageComponent, ReportPanelComponent, ToolbarSeparatorComponent, PageControlComponent, TextBoxComponent,
                MenuComponent, MenuItemComponent, TooltipComponent, FindPanelComponent, TextBlockComponent, BookmarksPanelComponent, InteractionsPanelComponent, FormButtonComponent,
                ParameterComponent, ParameterTextBoxComponent, CheckboxComponent, ParameterCheckboxComponent, ParameterButtonComponent, ParameterMenuEditListComponent,
                ParameterMenuItemComponent, ParameterMenuSeparatorComponent, ParameterFindComponent, ParameterMenuNotEditListComponent, ParameterMenuForValueComponent,
                ParameterMenuForRangeComponent, DatePickerMenuComponent, DropDownListComponent, VerticalMenuComponent, VerticalMenuItemComponent, DatePickerDayButtonComponent,
                DoubleDatePickerMenuComponent, BaseFormComponent, ExportFormComponent, GroupPanelComponent, RadioButtonComponent, DropDownListForExportFormComponent,
                DocumentSecurityMenuComponent, DigitalSignatureMenuComponent, SendEmailFormComponent, TextAreaComponent, DrillDownPanelComponent, OpenDialogComponent,
                PasswordFormComponent, ErrorMessageFormComponent, ResourcesPanelComponent, ProgressComponent, NavigatePanelComponent, AboutPanelComponent, ToolbarDopComponent,
                CenterTextComponent, NotificationFormComponent, DashboardsPanelComponent, DashboardButtonComponent],
            imports: [
                CommonModule
            ],
            providers: [],
            exports: [StimulsoftViewerComponent]
        })
    ], StimulsoftViewerModule);
    return StimulsoftViewerModule;
}());

/*
 * Public API Surface of stimulsoft-viewer-angular
 */

/**
 * Generated bundle index. Do not edit.
 */

export { StimulsoftViewerComponent, StimulsoftViewerModule, ModelService as a, StiHttpClientService as b, ButtonComponent as ba, PageComponent as bb, ReportPanelComponent as bc, ToolbarSeparatorComponent as bd, PageControlComponent as be, TextBoxComponent as bf, MenuComponent as bg, MenuItemComponent as bh, TooltipComponent as bi, FindPanelComponent as bj, TextBlockComponent as bk, BookmarksPanelComponent as bl, InteractionsPanelComponent as bm, FormButtonComponent as bn, ParameterComponent as bo, ParameterTextBoxComponent as bp, CheckboxComponent as bq, ParameterCheckboxComponent as br, ParameterButtonComponent as bs, ParameterMenuEditListComponent as bt, ParameterMenuItemComponent as bu, ParameterMenuSeparatorComponent as bv, ParameterFindComponent as bw, ParameterMenuNotEditListComponent as bx, ParameterMenuForValueComponent as by, ParameterMenuForRangeComponent as bz, HelperService as c, DatePickerMenuComponent as ca, DropDownListComponent as cb, VerticalMenuComponent as cc, VerticalMenuItemComponent as cd, DatePickerDayButtonComponent as ce, DoubleDatePickerMenuComponent as cf, BaseFormComponent as cg, ExportFormComponent as ch, GroupPanelComponent as ci, RadioButtonComponent as cj, DropDownListForExportFormComponent as ck, DocumentSecurityMenuComponent as cl, DigitalSignatureMenuComponent as cm, SendEmailFormComponent as cn, TextAreaComponent as co, DrillDownPanelComponent as cp, OpenDialogComponent as cq, PasswordFormComponent as cr, ErrorMessageFormComponent as cs, ResourcesPanelComponent as ct, ProgressComponent as cu, NavigatePanelComponent as cv, AboutPanelComponent as cw, ToolbarDopComponent as cx, CenterTextComponent as cy, NotificationFormComponent as cz, AnimationService as d, DashboardsPanelComponent as da, DashboardButtonComponent as db, ControllerService as e, StylesService as f, PageService as g, FormService as h, MouseService as i, MenuService as j, FullScreenService as k, TooltipService as l, FindService as m, Md5Service as n, InteractionsService as o, DrillDownService as p, RadioButtonService as q, ExportService as r, CollectionsService as s, MailService as t, EditableFieldsService as u, PrintService as v, ToolbarService as w, ApiService as x, DashboardService as y, ToolbarComponent as z };
//# sourceMappingURL=stimulsoft-viewer-angular.js.map
