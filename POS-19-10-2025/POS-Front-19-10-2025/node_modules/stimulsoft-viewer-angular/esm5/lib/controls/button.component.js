import { __decorate } from "tslib";
import { Component, Input, ViewChild, Output, EventEmitter } from '@angular/core';
import { ControllerService } from '../services/controller.service';
import { ModelService } from '../services/model.service';
import { MenuService, Menu } from '../menu/menu.service';
import { TooltipService } from '../services/tooltip.service';
import { HelperService } from '../services/helper.service';
var ButtonComponent = /** @class */ (function () {
    function ButtonComponent(model, controller, menuService, tooltipService, helper) {
        this.model = model;
        this.controller = controller;
        this.menuService = menuService;
        this.tooltipService = tooltipService;
        this.helper = helper;
        this.margin = '1px';
        this.height = '23px';
        this.selected = false;
        this.imageCellTextAlign = 'center';
        this.imageSizesWidth = 16;
        this.imageSizesHeight = 16;
        this.closeButton = false;
        this.resourceButton = false;
        this.navagationPanelTooltip = false;
        this.helpLink = 'user-manual/index.html?viewer_reports.htm';
        this.action = new EventEmitter();
        this.closeButtonAction = new EventEmitter();
        this.over = false;
        this.showMenu = false;
        this.closeButtonPressed = false;
        this.resourceButtonPressed = false;
        this._enabled = true;
        this.canShowTooltip = true;
    }
    ButtonComponent.prototype.ngOnInit = function () {
        var _this = this;
        if (this.menuItems) {
            setTimeout(function () {
                _this.menuObj = { type: 'buttonMenu', name: _this.actionName, items: _this.menuItems, parent: !_this.resourceButton ? _this.button : _this.resButtonEl };
                _this.menuService.addMenu(_this.menuObj);
            }, 500);
        }
    };
    Object.defineProperty(ButtonComponent.prototype, "styleName", {
        get: function () {
            return this._styleName || 'stiJsViewerStandartSmallButton';
        },
        set: function (value) {
            this._styleName = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ButtonComponent.prototype, "enabled", {
        get: function () {
            return this._enabled;
        },
        set: function (value) {
            if (!value) {
                this.over = false;
            }
            this._enabled = value;
        },
        enumerable: true,
        configurable: true
    });
    ButtonComponent.prototype.mouseover = function () {
        var _this = this;
        if (!this.enabled) {
            return;
        }
        this.over = true;
        if (this.model.options.toolbar.showMenuMode === 'Hover' && ['Print', 'Save', 'SendEmail', 'Zoom', 'ViewMode'].some(function (a) { return a === _this.actionName; })) {
            this.tooltipService.hideImmediately();
            this.menuService.showMenu(this.actionName);
        }
        else if (this.tooltip && !this.menuService.menus.some(function (e) { return e.state === 'expanded'; }) && this.canShowTooltip) {
            var top_1 = !this.navagationPanelTooltip ? this.model.controls.toolbar.offsetHeight + this.model.controls.dashboardsPanel.offsetHeight :
                this.helper.findPosY(this.model.controls.navigatePanel.el.nativeElement, 'stiJsViewerMainPanel');
            var tooltip = this.tooltip === true ? (this.model.localization[this.actionName + 'ToolTip'] != null ? this.model.loc(this.actionName + 'ToolTip') : this.model.loc(this.actionName)) : this.tooltip;
            this.tooltipService.show(this.helper.findPosX(this.button.nativeElement, 'stiJsViewerMainPanel'), top_1, tooltip, !this.navagationPanelTooltip, this.helpLink);
        }
    };
    ButtonComponent.prototype.mouseout = function () {
        var _this = this;
        if (!this.enabled) {
            return;
        }
        this.over = false;
        this.tooltipService.hide();
        setTimeout(function () {
            _this.canShowTooltip = true;
        }, 1000);
    };
    ButtonComponent.prototype.click = function () {
        if (this.enabled && !this.closeButtonPressed) {
            this.tooltipService.hideImmediately();
            if (this.menuItems == null || (this.resourceButton && !this.resourceButtonPressed)) {
                this.action.emit();
            }
            else {
                this.menuService.showMenu(this.actionName);
            }
        }
        this.canShowTooltip = false;
        this.closeButtonPressed = false;
        this.resourceButtonPressed = false;
    };
    Object.defineProperty(ButtonComponent.prototype, "className", {
        get: function () {
            var _a;
            return this.styleName ? this.styleName + ' ' + (this.enabled ? (this.styleName + ((this.selected || ((_a = this.menuObj) === null || _a === void 0 ? void 0 : _a.state) === 'expanded') ? 'Selected' : (this.over ? 'Over' : 'Default'))) : this.styleName + 'Disabled') : '';
        },
        enumerable: true,
        configurable: true
    });
    ButtonComponent.ctorParameters = function () { return [
        { type: ModelService },
        { type: ControllerService },
        { type: MenuService },
        { type: TooltipService },
        { type: HelperService }
    ]; };
    __decorate([
        Input()
    ], ButtonComponent.prototype, "caption", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "caption2", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "captionAlign", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "captionPadding", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "captionPaddingLeft", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "captionWhiteSpace", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "captionOverflow", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "captionTextOverflow", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "captionWidth", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "captionMaxWidth", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "captionLineHeight", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "imageName", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "arrow", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "arrowMarginTop", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "margin", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "height", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "selected", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "minWidth", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "innerTableWidth", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "menuItems", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "actionName", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "tooltip", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "imageCellTextAlign", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "imageCellWidth", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "imageCellPadding", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "imageSizesWidth", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "imageSizesHeight", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "imageMargin", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "width", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "display", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "closeButton", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "resourceButton", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "styleColors", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "boxSizing", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "navagationPanelTooltip", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "cursor", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "fontSize", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "helpLink", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "borderColor", void 0);
    __decorate([
        Output()
    ], ButtonComponent.prototype, "action", void 0);
    __decorate([
        Output()
    ], ButtonComponent.prototype, "closeButtonAction", void 0);
    __decorate([
        ViewChild('button')
    ], ButtonComponent.prototype, "button", void 0);
    __decorate([
        ViewChild('resButtonEl')
    ], ButtonComponent.prototype, "resButtonEl", void 0);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "styleName", null);
    __decorate([
        Input()
    ], ButtonComponent.prototype, "enabled", null);
    ButtonComponent = __decorate([
        Component({
            selector: 'sti-button',
            template: "\n  <div #button\n    [style.fontFamily]=\"model.options.toolbar.fontFamily\"\n    [style.cursor]=\"cursor\"\n    [style.borderColor]=\"borderColor\"\n    [class]=\"className\"\n    [style]=\"{height: helper.val(height, '23px'), boxSizing: helper.val(boxSizing, 'content-box'), margin: helper.val(margin, '1px'), minWidth: minWidth, width: width, display: display }\"\n    [style.fontSize]=\"fontSize\"\n    (mouseover)=\"mouseover()\"\n    (mouseout)=\"mouseout()\"\n    (click)=\"click()\" >\n    <table class=\"stiJsViewerClearAllStyles\" cellpadding=\"0\" cellspacing=\"0\" style=\"height: 100%;width:100%\" [style.width]=\"innerTableWidth\">\n      <tbody>\n        <tr class=\"stiJsViewerClearAllStyles\">\n          <td *ngIf=\"imageName != null\" [style]=\"{lineHeight:'0', padding:helper.val(imageCellPadding, '0 3px'), textAlign: imageCellTextAlign, width: imageCellWidth}\" class=\"stiJsViewerClearAllStyles\">\n            <img src=\"{{model.img(imageName)}}\" [style.opacity]=\"enabled ? '1' : '0.5'\"\n                [style.width.px]=\"imageSizesWidth\"\n                [style.height.px]=\"imageSizesHeight\"\n                [style.margin]=\"imageMargin\">\n          </td>\n          <td *ngIf=\"caption != null\"\n             [style]=\"{whiteSpace:'nowrap', textAlign: captionAlign || 'left', padding:captionPadding || ((arrow ? '1px 0' : '1px 5px') + (imageName ? ' 0 0' : ' 0 5px')), width: captionWidth}\"\n             [style.maxWidth]=\"captionMaxWidth\"\n             [style.lineHeight]=\"captionLineHeight\"\n             [style.paddingLeft]=\"captionPaddingLeft\"\n             [style.whiteSpace]=\"captionWhiteSpace\"\n             [style.overflow]=\"captionOverflow\"\n             [style.textOverflow]=\"captionTextOverflow\"\n             class=\"stiJsViewerClearAllStyles\">\n            {{caption}}\n            <div *ngIf=\"caption2 != null\">\n            {{caption2}}\n            </div>\n          </td>\n          <td *ngIf=\"arrow\" class=\"stiJsViewerClearAllStyles\">\n            <img src=\"{{arrow == 'Up' || arrow == 'Down' ? model.img('Arrows.SmallArrow' + arrow + (arrow == 'Down' && styleColors && styleColors.isDarkStyle ? 'White.png' : '.png')) : model.img(arrow)}}\"\n            [style]=\"{lineHeight:'0', width:'8px', height:'8px', verticalAlign:'baseline', padding:caption ? '0 5px 0 5px' : '0 5px 0 2px', marginTop: arrowMarginTop}\"\n            [style.opacity]=\"enabled ? '1' : '0.5'\"/>\n          </td>\n\n          <td *ngIf=\"closeButton\" class=\"stiJsViewerClearAllStyles\">\n            <sti-button [imageName]=\"'CloseForm.png'\"\n              [imageMargin]=\"'1px 0 0 -1px'\"\n              [margin]=\"'0 2px 0 0'\"\n              [imageCellPadding]=\"'0'\"\n              [width]=\"model.options.isTouchDevice ? '22px' : '17px'\"\n              [height]=\"model.options.isTouchDevice ? '22px' : '17px'\"\n              (action)=\"closeButtonPressed = true; closeButtonAction.emit()\">\n            </sti-button>\n          </td>\n\n          <td #resButtonEl *ngIf=\"resourceButton\" style=\"width: 1px;\">\n            <sti-button [imageName]=\"'Arrows.SmallArrowDown.png'\"\n              [styleName]=\"'stiJsViewerResourceDropDownButton'\"\n              [innerTableWidth]=\"'100%'\"\n              [margin]=\"'0 7px 0 3px'\"\n              [imageCellTextAlign]=\"'center'\"\n              [imageSizesWidth]=\"8\"\n              [imageSizesHeight]=\"8\"\n              [height]=\"model.options.isTouchDevice ? '23px' : '17px'\"\n              [width]=\"model.options.isTouchDevice ? '23px' : '17px'\"\n              (action)=\"resourceButtonPressed = true;\">>\n            </sti-button>\n          </td>\n\n        </tr>\n      </tbody>\n    </table>\n  </div>\n  "
        })
    ], ButtonComponent);
    return ButtonComponent;
}());
export { ButtonComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYnV0dG9uLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL3N0aW11bHNvZnQtdmlld2VyLWFuZ3VsYXIvIiwic291cmNlcyI6WyJsaWIvY29udHJvbHMvYnV0dG9uLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBVSxLQUFLLEVBQUUsU0FBUyxFQUFjLE1BQU0sRUFBRSxZQUFZLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDdEcsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0sZ0NBQWdDLENBQUM7QUFDbkUsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLDJCQUEyQixDQUFDO0FBQ3pELE9BQU8sRUFBRSxXQUFXLEVBQUUsSUFBSSxFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFDekQsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLDZCQUE2QixDQUFDO0FBQzdELE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSw0QkFBNEIsQ0FBQztBQTRFM0Q7SUF3REUseUJBQW1CLEtBQW1CLEVBQVMsVUFBNkIsRUFBUyxXQUF3QixFQUFVLGNBQThCLEVBQzVJLE1BQXFCO1FBRFgsVUFBSyxHQUFMLEtBQUssQ0FBYztRQUFTLGVBQVUsR0FBVixVQUFVLENBQW1CO1FBQVMsZ0JBQVcsR0FBWCxXQUFXLENBQWE7UUFBVSxtQkFBYyxHQUFkLGNBQWMsQ0FBZ0I7UUFDNUksV0FBTSxHQUFOLE1BQU0sQ0FBZTtRQXpDckIsV0FBTSxHQUFHLEtBQUssQ0FBQztRQUNmLFdBQU0sR0FBRyxNQUFNLENBQUM7UUFDaEIsYUFBUSxHQUFHLEtBQUssQ0FBQztRQU1qQix1QkFBa0IsR0FBRyxRQUFRLENBQUM7UUFHOUIsb0JBQWUsR0FBRyxFQUFFLENBQUM7UUFDckIscUJBQWdCLEdBQUcsRUFBRSxDQUFDO1FBSXRCLGdCQUFXLEdBQUcsS0FBSyxDQUFDO1FBQ3BCLG1CQUFjLEdBQUcsS0FBSyxDQUFDO1FBR3ZCLDJCQUFzQixHQUFH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QjtRQUFSLEtBQUssRUFBRTt3REFBa0I7SUFDakI7UUFBUixLQUFLLEVBQUU7c0RBQW1CO0lBQ2xCO1FBQVIsS0FBSyxFQUFFO21FQUFnQztJQUMvQjtRQUFSLEtBQUssRUFBRTttREFBZ0I7SUFDZjtRQUFSLEtBQUssRUFBRTtxREFBa0I7SUFDakI7UUFBUixLQUFLLEVBQUU7cURBQXdEO0lBQ3ZEO1FBQVIsS0FBSyxFQUFFO3dEQUFhO0lBRVg7UUFBVCxNQUFNLEVBQUU7bURBQWdEO0lBQy9DO1FBQVQsTUFBTSxFQUFFOzhEQUEyRDtJQUMvQztRQUFwQixTQUFTLENBQUMsUUFBUSxDQUFDO21EQUFvQjtJQUNkO1FBQXpCLFNBQVMsQ0FBQyxhQUFhLENBQUM7d0RBQXlCO0lBdUJ6QztRQUFSLEtBQUssRUFBRTtvREFFUDtJQU1RO1FBQVIsS0FBSyxFQUFFO2tEQUVQO0lBOUVVLGVBQWU7UUF6RTNCLFNBQVMsQ0FBQztZQUNULFFBQVEsRUFBRSxZQUFZO1lBQ3RCLFFBQVEsRUFBRSwycEhBcUVUO1NBQ0YsQ0FBQztPQUNXLGVBQWUsQ0FxSTNCO0lBQUQsc0JBQUM7Q0FBQSxBQXJJRCxJQXFJQztTQXJJWSxlQUFlIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBPbkluaXQsIElucHV0LCBWaWV3Q2hpbGQsIEVsZW1lbnRSZWYsIE91dHB1dCwgRXZlbnRFbWl0dGVyIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IENvbnRyb2xsZXJTZXJ2aWNlIH0gZnJvbSAnLi4vc2VydmljZXMvY29udHJvbGxlci5zZXJ2aWNlJztcclxuaW1wb3J0IHsgTW9kZWxTZXJ2aWNlIH0gZnJvbSAnLi4vc2VydmljZXMvbW9kZWwuc2VydmljZSc7XHJcbmltcG9ydCB7IE1lbnVTZXJ2aWNlLCBNZW51IH0gZnJvbSAnLi4vbWVudS9tZW51LnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBUb29sdGlwU2VydmljZSB9IGZyb20gJy4uL3NlcnZpY2VzL3Rvb2x0aXAuc2VydmljZSc7XHJcbmltcG9ydCB7IEhlbHBlclNlcnZpY2UgfSBmcm9tICcuLi9zZXJ2aWNlcy9oZWxwZXIuc2VydmljZSc7XHJcbmltcG9ydCB7IE1lbnVJdGVtIH0gZnJvbSAnLi4vbWVudS9tZW5pLWl0ZW0uY29tcG9uZW50JztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gIHNlbGVjdG9yOiAnc3RpLWJ1dHRvbicsXHJcbiAgdGVtcGxhdGU6IGBcclxuICA8ZGl2ICNidXR0b25cclxuICAgIFtzdHlsZS5mb250RmFtaWx5XT1cIm1vZGVsLm9wdGlvbnMudG9vbGJhci5mb250RmFtaWx5XCJcclxuICAgIFtzdHlsZS5jdXJzb3JdPVwiY3Vyc29yXCJcclxuICAgIFtzdHlsZS5ib3JkZXJDb2xvcl09XCJib3JkZXJDb2xvclwiXHJcbiAgICBbY2xhc3NdPVwiY2xhc3NOYW1lXCJcclxuICAgIFtzdHlsZV09XCJ7aGVpZ2h0OiBoZWxwZXIudmFsKGhlaWdodCwgJzIzcHgnKSwgYm94U2l6aW5nOiBoZWxwZXIudmFsKGJveFNpemluZywgJ2NvbnRlbnQtYm94JyksIG1hcmdpbjogaGVscGVyLnZhbChtYXJnaW4sICcxcHgnKSwgbWluV2lkdGg6IG1pbldpZHRoLCB3aWR0aDogd2lkdGgsIGRpc3BsYXk6IGRpc3BsYXkgfVwiXHJcbiAgICBbc3R5bGUuZm9udFNpemVdPVwiZm9udFNpemVcIlxyXG4gICAgKG1vdXNlb3Zlcik9XCJtb3VzZW92ZXIoKVwiXHJcbiAgICAobW91c2VvdXQpPVwibW91c2VvdXQoKVwiXHJcbiAgICAoY2xpY2spPVwiY2xpY2soKVwiID5cclxuICAgIDx0YWJsZSBjbGFzcz1cInN0aUpzVmlld2VyQ2xlYXJBbGxTdHlsZXNcIiBjZWxscGFkZGluZz1cIjBcIiBjZWxsc3BhY2luZz1cIjBcIiBzdHlsZT1cImhlaWdodDogMTAwJTt3aWR0aDoxMDAlXCIgW3N0eWxlLndpZHRoXT1cImlubmVyVGFibGVXaWR0aFwiPlxyXG4gICAgICA8dGJvZHk+XHJcbiAgICAgICAgPHRyIGNsYXNzPVwic3RpSnNWaWV3ZXJDbGVhckFsbFN0eWxlc1wiPlxyXG4gICAgICAgICAgPHRkICpuZ0lmPVwiaW1hZ2VOYW1lICE9IG51bGxcIiBbc3R5bGVdPVwie2xpbmVIZWlnaHQ6JzAnLCBwYWRkaW5nOmhlbHBlci52YWwoaW1hZ2VDZWxsUGFkZGluZywgJzAgM3B4JyksIHRleHRBbGlnbjogaW1hZ2VDZWxsVGV4dEFsaWduLCB3aWR0aDogaW1hZ2VDZWxsV2lkdGh9XCIgY2xhc3M9XCJzdGlKc1ZpZXdlckNsZWFyQWxsU3R5bGVzXCI+XHJcbiAgICAgICAgICAgIDxpbWcgc3JjPVwie3ttb2RlbC5pbWcoaW1hZ2VOYW1lKX19XCIgW3N0eWxlLm9wYWNpdHldPVwiZW5hYmxlZCA/ICcxJyA6ICcwLjUnXCJcclxuICAgICAgICAgICAgICAgIFtzdHlsZS53aWR0aC5weF09XCJpbWFnZVNpemVzV2lkdGhcIlxyXG4gICAgICAgICAgICAgICAgW3N0eWxlLmhlaWdodC5weF09XCJpbWFnZVNpemVzSGVpZ2h0XCJcclxuICAgICAgICAgICAgICAgIFtzdHlsZS5tYXJnaW5dPVwiaW1hZ2VNYXJnaW5cIj5cclxuICAgICAgICAgIDwvdGQ+XHJcbiAgICAgICAgICA8dGQgKm5nSWY9XCJjYXB0aW9uICE9IG51bGxcIlxyXG4gICAgICAgICAgICAgW3N0eWxlXT1cInt3aGl0ZVNwYWNlOidub3dyYXAnLCB0ZXh0QWxpZ246IGNhcHRpb25BbGlnbiB8fCAnbGVmdCcsIHBhZGRpbmc6Y2FwdGlvblBhZGRpbmcgfHwgKChhcnJvdyA/ICcxcHggMCcgOiAnMXB4IDVweCcpICsgKGltYWdlTmFtZSA/ICcgMCAwJyA6ICcgMCA1cHgnKSksIHdpZHRoOiBjYXB0aW9uV2lkdGh9XCJcclxuICAgICAgICAgICAgIFtzdHlsZS5tYXhXaWR0aF09XCJjYXB0aW9uTWF4V2lkdGhcIlxyXG4gICAgICAgICAgICAgW3N0eWxlLmxpbmVIZWlnaHRdPVwiY2FwdGlvbkxpbmVIZWlnaHRcIlxyXG4gICAgICAgICAgICAgW3N0eWxlLnBhZGRpbmdMZWZ0XT1cImNhcHRpb25QYWRkaW5nTGVmdFwiXHJcbiAgICAgICAgICAgICBbc3R5bGUud2hpdGVTcGFjZV09XCJjYXB0aW9uV2hpdGVTcGFjZVwiXHJcbiAgICAgICAgICAgICBbc3R5bGUub3ZlcmZsb3ddPVwiY2FwdGlvbk92ZXJmbG93XCJcclxuICAgICAgICAgICAgIFtzdHlsZS50ZXh0T3ZlcmZsb3ddPVwiY2FwdGlvblRleHRPdmVyZmxvd1wiXHJcbiAgICAgICAgICAgICBjbGFzcz1cInN0aUpzVmlld2VyQ2xlYXJBbGxTdHlsZXNcIj5cclxuICAgICAgICAgICAge3tjYXB0aW9ufX1cclxuICAgICAgICAgICAgPGRpdiAqbmdJZj1cImNhcHRpb24yICE9IG51bGxcIj5cclxuICAgICAgICAgICAge3tjYXB0aW9uMn19XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgPC90ZD5cclxuICAgICAgICAgIDx0ZCAqbmdJZj1cImFycm93XCIgY2xhc3M9XCJzdGlKc1ZpZXdlckNsZWFyQWxsU3R5bGVzXCI+XHJcbiAgICAgICAgICAgIDxpbWcgc3JjPVwie3thcnJvdyA9PSAnVXAnIHx8IGFycm93ID09ICdEb3duJyA/IG1vZGVsLmltZygnQXJyb3dzLlNtYWxsQXJyb3cnICsgYXJyb3cgKyAoYXJyb3cgPT0gJ0Rvd24nICYmIHN0eWxlQ29sb3JzICYmIHN0eWxlQ29sb3JzLmlzRGFya1N0eWxlID8gJ1doaXRlLnBuZycgOiAnLnBuZycpKSA6IG1vZGVsLmltZyhhcnJvdyl9fVwiXHJcbiAgICAgICAgICAgIFtzdHlsZV09XCJ7bGluZUhlaWdodDonMCcsIHdpZHRoOic4cHgnLCBoZWlnaHQ6JzhweCcsIHZlcnRpY2FsQWxpZ246J2Jhc2VsaW5lJywgcGFkZGluZzpjYXB0aW9uID8gJzAgNXB4IDAgNXB4JyA6ICcwIDVweCAwIDJweCcsIG1hcmdpblRvcDogYXJyb3dNYXJnaW5Ub3B9XCJcclxuICAgICAgICAgICAgW3N0eWxlLm9wYWNpdHldPVwiZW5hYmxlZCA/ICcxJyA6ICcwLjUnXCIvPlxyXG4gICAgICAgICAgPC90ZD5cclxuXHJcbiAgICAgICAgICA8dGQgKm5nSWY9XCJjbG9zZUJ1dHRvblwiIGNsYXNzPVwic3RpSnNWaWV3ZXJDbGVhckFsbFN0eWxlc1wiPlxyXG4gICAgICAgICAgICA8c3RpLWJ1dHRvbiBbaW1hZ2VOYW1lXT1cIidDbG9zZUZvcm0ucG5nJ1wiXHJcbiAgICAgICAgICAgICAgW2ltYWdlTWFyZ2luXT1cIicxcHggMCAwIC0xcHgnXCJcclxuICAgICAgICAgICAgICBbbWFyZ2luXT1cIicwIDJweCAwIDAnXCJcclxuICAgICAgICAgICAgICBbaW1hZ2VDZWxsUGFkZGluZ109XCInMCdcIlxyXG4gICAgICAgICAgICAgIFt3aWR0aF09XCJtb2RlbC5vcHRpb25zLmlzVG91Y2hEZXZpY2UgPyAnMjJweCcgOiAnMTdweCdcIlxyXG4gICAgICAgICAgICAgIFtoZWlnaHRdPVwibW9kZWwub3B0aW9ucy5pc1RvdWNoRGV2aWNlID8gJzIycHgnIDogJzE3cHgnXCJcclxuICAgICAgICAgICAgICAoYWN0aW9uKT1cImNsb3NlQnV0dG9uUHJlc3NlZCA9IHRydWU7IGNsb3NlQnV0dG9uQWN0aW9uLmVtaXQoKVwiPlxyXG4gICAgICAgICAgICA8L3N0aS1idXR0b24+XHJcbiAgICAgICAgICA8L3RkPlxyXG5cclxuICAgICAgICAgIDx0ZCAjcmVzQnV0dG9uRWwgKm5nSWY9XCJyZXNvdXJjZUJ1dHRvblwiIHN0eWxlPVwid2lkdGg6IDFweDtcIj5cclxuICAgICAgICAgICAgPHN0aS1idXR0b24gW2ltYWdlTmFtZV09XCInQXJyb3dzLlNtYWxsQXJyb3dEb3duLnBuZydcIlxyXG4gICAgICAgICAgICAgIFtzdHlsZU5hbWVdPVwiJ3N0aUpzVmlld2VyUmVzb3VyY2VEcm9wRG93bkJ1dHRvbidcIlxyXG4gICAgICAgICAgICAgIFtpbm5lclRhYmxlV2lkdGhdPVwiJzEwMCUnXCJcclxuICAgICAgICAgICAgICBbbWFyZ2luXT1cIicwIDdweCAwIDNweCdcIlxyXG4gICAgICAgICAgICAgIFtpbWFnZUNlbGxUZXh0QWxpZ25dPVwiJ2NlbnRlcidcIlxyXG4gICAgICAgICAgICAgIFtpbWFnZVNpemVzV2lkdGhdPVwiOFwiXHJcbiAgICAgICAgICAgICAgW2ltYWdlU2l6ZXNIZWlnaHRdPVwiOFwiXHJcbiAgICAgICAgICAgICAgW2hlaWdodF09XCJtb2RlbC5vcHRpb25zLmlzVG91Y2hEZXZpY2UgPyAnMjNweCcgOiAnMTdweCdcIlxyXG4gICAgICAgICAgICAgIFt3aWR0aF09XCJtb2RlbC5vcHRpb25zLmlzVG91Y2hEZXZpY2UgPyAnMjNweCcgOiAnMTdweCdcIlxyXG4gICAgICAgICAgICAgIChhY3Rpb24pPVwicmVzb3VyY2VCdXR0b25QcmVzc2VkID0gdHJ1ZTtcIj4+XHJcbiAgICAgICAgICAgIDwvc3RpLWJ1dHRvbj5cclxuICAgICAgICAgIDwvdGQ+XHJcblxyXG4gICAgICAgIDwvdHI+XHJcbiAgICAgIDwvdGJvZHk+XHJcbiAgICA8L3RhYmxlPlxyXG4gIDwvZGl2PlxyXG4gIGBcclxufSlcclxuZXhwb3J0IGNsYXNzIEJ1dHRvbkNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XHJcblxyXG4gIEBJbnB1dCgpIGNhcHRpb246IHN0cmluZztcclxuICBASW5wdXQoKSBjYXB0aW9uMjogc3RyaW5nO1xyXG4gIEBJbnB1dCgpIGNhcHRpb25BbGlnbjogc3RyaW5nO1xyXG4gIEBJbnB1dCgpIGNhcHRpb25QYWRkaW5nOiBzdHJpbmc7XHJcbiAgQElucHV0KCkgY2FwdGlvblBhZGRpbmdMZWZ0OiBzdHJpbmc7XHJcbiAgQElucHV0KCkgY2FwdGlvbldoaXRlU3BhY2U6IHN0cmluZztcclxuICBASW5wdXQoKSBjYXB0aW9uT3ZlcmZsb3c6IHN0cmluZztcclxuICBASW5wdXQoKSBjYXB0aW9uVGV4dE92ZXJmbG93OiBzdHJpbmc7XHJcbiAgQElucHV0KCkgY2FwdGlvbldpZHRoOiBzdHJpbmc7XHJcbiAgQElucHV0KCkgY2FwdGlvbk1heFdpZHRoOiBzdHJpbmc7XHJcbiAgQElucHV0KCkgY2FwdGlvbkxpbmVIZWlnaHQ6IHN0cmluZztcclxuICBASW5wdXQoKSBpbWFnZU5hbWU6IHN0cmluZztcclxuICBASW5wdXQoKSBhcnJvdzogc3RyaW5nO1xyXG4gIEBJbnB1dCgpIGFycm93TWFyZ2luVG9wOiBzdHJpbmc7XHJcbiAgQElucHV0KCkgbWFyZ2luID0gJzFweCc7XHJcbiAgQElucHV0KCkgaGVpZ2h0ID0gJzIzcHgnO1xyXG4gIEBJbnB1dCgpIHNlbGVjdGVkID0gZmFsc2U7XHJcbiAgQElucHV0KCkgbWluV2lkdGg6IHN0cmluZztcclxuICBASW5wdXQoKSBpbm5lclRhYmxlV2lkdGg6IHN0cmluZztcclxuICBASW5wdXQoKSBtZW51SXRlbXM6IE1lbnVJdGVtW107XHJcbiAgQElucHV0KCkgYWN0aW9uTmFtZTogc3RyaW5nO1xyXG4gIEBJbnB1dCgpIHRvb2x0aXA6IGFueTtcclxuICBASW5wdXQoKSBpbWFnZUNlbGxUZXh0QWxpZ24gPSAnY2VudGVyJztcclxuICBASW5wdXQoKSBpbWFnZUNlbGxXaWR0aDogc3RyaW5nO1xyXG4gIEBJbnB1dCgpIGltYWdlQ2VsbFBhZGRpbmc6IHN0cmluZztcclxuICBASW5wdXQoKSBpbWFnZVNpemVzV2lkdGggPSAxNjtcclxuICBASW5wdXQoKSBpbWFnZVNpemVzSGVpZ2h0ID0gMTY7XHJcbiAgQElucHV0KCkgaW1hZ2VNYXJnaW46IHN0cmluZztcclxuICBASW5wdXQoKSB3aWR0aDogc3RyaW5nO1xyXG4gIEBJbnB1dCgpIGRpc3BsYXk6IHN0cmluZztcclxuICBASW5wdXQoKSBjbG9zZUJ1dHRvbiA9IGZhbHNlO1xyXG4gIEBJbnB1dCgpIHJlc291cmNlQnV0dG9uID0gZmFsc2U7XHJcbiAgQElucHV0KCkgc3R5bGVDb2xvcnM6IGFueTtcclxuICBASW5wdXQoKSBib3hTaXppbmc6IHN0cmluZztcclxuICBASW5wdXQoKSBuYXZhZ2F0aW9uUGFuZWxUb29sdGlwID0gZmFsc2U7XHJcbiAgQElucHV0KCkgY3Vyc29yOiBzdHJpbmc7XHJcbiAgQElucHV0KCkgZm9udFNpemU6IHN0cmluZztcclxuICBASW5wdXQoKSBoZWxwTGluayA9ICd1c2VyLW1hbnVhbC9pbmRleC5odG1sP3ZpZXdlcl9yZXBvcnRzLmh0bSc7XHJcbiAgQElucHV0KCkgYm9yZGVyQ29sb3I7XHJcblxyXG4gIEBPdXRwdXQoKSBhY3Rpb246IEV2ZW50RW1pdHRlcjxhbnk+ID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gIEBPdXRwdXQoKSBjbG9zZUJ1dHRvbkFjdGlvbjogRXZlbnRFbWl0dGVyPGFueT4gPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcbiAgQFZpZXdDaGlsZCgnYnV0dG9uJykgYnV0dG9uOiBFbGVtZW50UmVmO1xyXG4gIEBWaWV3Q2hpbGQoJ3Jlc0J1dHRvbkVsJykgcmVzQnV0dG9uRWw6IEVsZW1lbnRSZWY7XHJcblxyXG4gIG92ZXIgPSBmYWxzZTtcclxuICBzaG93TWVudSA9IGZhbHNlO1xyXG4gIGNsb3NlQnV0dG9uUHJlc3NlZCA9IGZhbHNlO1xyXG4gIHJlc291cmNlQnV0dG9uUHJlc3NlZCA9IGZhbHNlO1xyXG4gIHByaXZhdGUgX2VuYWJsZWQgPSB0cnVlO1xyXG4gIHByaXZhdGUgX3N0eWxlTmFtZTogc3RyaW5nO1xyXG4gIHByaXZhdGUgbWVudU9iajogTWVudTtcclxuICBwcml2YXRlIGNhblNob3dUb29sdGlwID0gdHJ1ZTtcclxuXHJcbiAgY29uc3RydWN0b3IocHVibGljIG1vZGVsOiBNb2RlbFNlcnZpY2UsIHB1YmxpYyBjb250cm9sbGVyOiBDb250cm9sbGVyU2VydmljZSwgcHVibGljIG1lbnVTZXJ2aWNlOiBNZW51U2VydmljZSwgcHJpdmF0ZSB0b29sdGlwU2VydmljZTogVG9vbHRpcFNlcnZpY2UsXHJcbiAgICBwdWJsaWMgaGVscGVyOiBIZWxwZXJTZXJ2aWNlKSB7IH1cclxuXHJcbiAgbmdPbkluaXQoKTogdm9pZCB7XHJcbiAgICBpZiAodGhpcy5tZW51SXRlbXMpIHtcclxuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5tZW51T2JqID0geyB0eXBlOiAnYnV0dG9uTWVudScsIG5hbWU6IHRoaXMuYWN0aW9uTmFtZSwgaXRlbXM6IHRoaXMubWVudUl0ZW1zLCBwYXJlbnQ6ICF0aGlzLnJlc291cmNlQnV0dG9uID8gdGhpcy5idXR0b24gOiB0aGlzLnJlc0J1dHRvbkVsIH07XHJcbiAgICAgICAgdGhpcy5tZW51U2VydmljZS5hZGRNZW51KHRoaXMubWVudU9iaik7XHJcbiAgICAgIH0sIDUwMCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBASW5wdXQoKSBnZXQgc3R5bGVOYW1lKCk6IHN0cmluZyB7XHJcbiAgICByZXR1cm4gdGhpcy5fc3R5bGVOYW1lIHx8ICdzdGlKc1ZpZXdlclN0YW5kYXJ0U21hbGxCdXR0b24nO1xyXG4gIH1cclxuXHJcbiAgc2V0IHN0eWxlTmFtZSh2YWx1ZTogc3RyaW5nKSB7XHJcbiAgICB0aGlzLl9zdHlsZU5hbWUgPSB2YWx1ZTtcclxuICB9XHJcblxyXG4gIEBJbnB1dCgpIGdldCBlbmFibGVkKCk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuIHRoaXMuX2VuYWJsZWQ7XHJcbiAgfVxyXG5cclxuICBzZXQgZW5hYmxlZCh2YWx1ZTogYm9vbGVhbikge1xyXG4gICAgaWYgKCF2YWx1ZSkge1xyXG4gICAgICB0aGlzLm92ZXIgPSBmYWxzZTtcclxuICAgIH1cclxuICAgIHRoaXMuX2VuYWJsZWQgPSB2YWx1ZTtcclxuICB9XHJcblxyXG4gIG1vdXNlb3ZlcigpIHtcclxuICAgIGlmICghdGhpcy5lbmFibGVkKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIHRoaXMub3ZlciA9IHRydWU7XHJcblxyXG4gICAgaWYgKHRoaXMubW9kZWwub3B0aW9ucy50b29sYmFyLnNob3dNZW51TW9kZSA9PT0gJ0hvdmVyJyAmJiBbJ1ByaW50JywgJ1NhdmUnLCAnU2VuZEVtYWlsJywgJ1pvb20nLCAnVmlld01vZGUnXS5zb21lKGEgPT4gYSA9PT0gdGhpcy5hY3Rpb25OYW1lKSkge1xyXG4gICAgICB0aGlzLnRvb2x0aXBTZXJ2aWNlLmhpZGVJbW1lZGlhdGVseSgpO1xyXG4gICAgICB0aGlzLm1lbnVTZXJ2aWNlLnNob3dNZW51KHRoaXMuYWN0aW9uTmFtZSk7XHJcbiAgICB9IGVsc2UgaWYgKHRoaXMudG9vbHRpcCAmJiAhdGhpcy5tZW51U2VydmljZS5tZW51cy5zb21lKGUgPT4gZS5zdGF0ZSA9PT0gJ2V4cGFuZGVkJykgJiYgdGhpcy5jYW5TaG93VG9vbHRpcCkge1xyXG4gICAgICBjb25zdCB0b3AgPSAhdGhpcy5uYXZhZ2F0aW9uUGFuZWxUb29sdGlwID8gdGhpcy5tb2RlbC5jb250cm9scy50b29sYmFyLm9mZnNldEhlaWdodCArIHRoaXMubW9kZWwuY29udHJvbHMuZGFzaGJvYXJkc1BhbmVsLm9mZnNldEhlaWdodCA6XHJcbiAgICAgICAgdGhpcy5oZWxwZXIuZmluZFBvc1kodGhpcy5tb2RlbC5jb250cm9scy5uYXZpZ2F0ZVBhbmVsLmVsLm5hdGl2ZUVsZW1lbnQsICdzdGlKc1ZpZXdlck1haW5QYW5lbCcpO1xyXG4gICAgICBjb25zdCB0b29sdGlwID0gdGhpcy50b29sdGlwID09PSB0cnVlID8gKHRoaXMubW9kZWwubG9jYWxpemF0aW9uW3RoaXMuYWN0aW9uTmFtZSArICdUb29sVGlwJ10gIT0gbnVsbCA/IHRoaXMubW9kZWwubG9jKHRoaXMuYWN0aW9uTmFtZSArICdUb29sVGlwJykgOiB0aGlzLm1vZGVsLmxvYyh0aGlzLmFjdGlvbk5hbWUpKSA6IHRoaXMudG9vbHRpcDtcclxuICAgICAgdGhpcy50b29sdGlwU2VydmljZS5zaG93KHRoaXMuaGVscGVyLmZpbmRQb3NYKHRoaXMuYnV0dG9uLm5hdGl2ZUVsZW1lbnQsICdzdGlKc1ZpZXdlck1haW5QYW5lbCcpLFxyXG4gICAgICAgIHRvcCwgdG9vbHRpcCwgIXRoaXMubmF2YWdhdGlvblBhbmVsVG9vbHRpcCwgdGhpcy5oZWxwTGluayk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBtb3VzZW91dCgpIHtcclxuICAgIGlmICghdGhpcy5lbmFibGVkKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIHRoaXMub3ZlciA9IGZhbHNlO1xyXG4gICAgdGhpcy50b29sdGlwU2VydmljZS5oaWRlKCk7XHJcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgdGhpcy5jYW5TaG93VG9vbHRpcCA9IHRydWU7XHJcbiAgICB9LCAxMDAwKTtcclxuICB9XHJcblxyXG4gIGNsaWNrKCkge1xyXG4gICAgaWYgKHRoaXMuZW5hYmxlZCAmJiAhdGhpcy5jbG9zZUJ1dHRvblByZXNzZWQpIHtcclxuICAgICAgdGhpcy50b29sdGlwU2VydmljZS5oaWRlSW1tZWRpYXRlbHkoKTtcclxuICAgICAgaWYgKHRoaXMubWVudUl0ZW1zID09IG51bGwgfHwgKHRoaXMucmVzb3VyY2VCdXR0b24gJiYgIXRoaXMucmVzb3VyY2VCdXR0b25QcmVzc2VkKSkge1xyXG4gICAgICAgIHRoaXMuYWN0aW9uLmVtaXQoKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0aGlzLm1lbnVTZXJ2aWNlLnNob3dNZW51KHRoaXMuYWN0aW9uTmFtZSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHRoaXMuY2FuU2hvd1Rvb2x0aXAgPSBmYWxzZTtcclxuICAgIHRoaXMuY2xvc2VCdXR0b25QcmVzc2VkID0gZmFsc2U7XHJcbiAgICB0aGlzLnJlc291cmNlQnV0dG9uUHJlc3NlZCA9IGZhbHNlO1xyXG4gIH1cclxuXHJcbiAgZ2V0IGNsYXNzTmFtZSgpOiBzdHJpbmcge1xyXG4gICAgcmV0dXJuIHRoaXMuc3R5bGVOYW1lID8gdGhpcy5zdHlsZU5hbWUgKyAnICcgKyAodGhpcy5lbmFibGVkID8gKHRoaXMuc3R5bGVOYW1lICsgKCh0aGlzLnNlbGVjdGVkIHx8IHRoaXMubWVudU9iaj8uc3RhdGUgPT09ICdleHBhbmRlZCcpID8gJ1NlbGVjdGVkJyA6ICh0aGlzLm92ZXIgPyAnT3ZlcicgOiAnRGVmYXVsdCcpKSkgOiB0aGlzLnN0eWxlTmFtZSArICdEaXNhYmxlZCcpIDogJyc7XHJcbiAgfVxyXG59XHJcbiJdfQ==