import { __decorate } from "tslib";
import { Component, Input, ViewChild } from '@angular/core';
import { HelperService } from '../../services/helper.service';
import { ModelService } from '../../services/model.service';
var ParameterTextBoxComponent = /** @class */ (function () {
    function ParameterTextBoxComponent(helper, model) {
        this.helper = helper;
        this.model = model;
        this.focusOnCreate = false;
        this.isMenu = false;
        this.value = '';
        this.secondTextBox = false;
    }
    ParameterTextBoxComponent.prototype.ngOnInit = function () { };
    ParameterTextBoxComponent.prototype.onchange = function (target) {
        if (this.element.oldValue === target.value) {
            return;
        }
        var value = this.getValue(target);
        if (this.isMenu) {
            if (!this.secondTextBox) {
                this.item.key = value;
            }
            else {
                this.item.keyTo = value;
            }
        }
        else {
            if (!this.secondTextBox) {
                if (this.variable.basicType === 'Range' || this.variable.type === 'DateTime') {
                    this.variable.key = value;
                }
                else {
                    this.variable.value = value;
                }
            }
            else {
                this.variable.keyTo = value;
            }
        }
    };
    ParameterTextBoxComponent.prototype.getValue = function (target) {
        if (this.variable.type === 'DateTime') {
            if (this.element.oldValue === target.value) {
                return;
            }
            try {
                var timeString = new Date().toLocaleTimeString();
                var isAmericanFormat = timeString.toLowerCase().indexOf('am') >= 0 || timeString.toLowerCase().indexOf('pm') >= 0;
                var formatDate = isAmericanFormat ? 'MM/dd/yyyy' : 'dd.MM.yyyy';
                var format = formatDate + (isAmericanFormat ? ' h:mm:ss tt' : ' hh:mm:ss');
                if (this.variable.dateTimeType === 'Date') {
                    format = formatDate;
                }
                if (this.variable.dateTimeType === 'Time') {
                    format = 'hh:mm:ss';
                }
                var date = this.helper.getDateTimeFromString(target.value, this.model.options.appearance.parametersPanelDateFormat || format);
                return this.helper.getDateTimeObject(date);
            }
            catch (e) {
                alert(e);
            }
        }
        else {
            return target.value;
        }
    };
    Object.defineProperty(ParameterTextBoxComponent.prototype, "width", {
        get: function () {
            var width = 210;
            if (this.variable.basicType === 'Range') {
                width = 140;
                if (this.variable.type === 'Guid' || this.variable.type === 'String') {
                    width = 190;
                }
                if (this.variable.type === 'DateTime') {
                    width = 235;
                }
                if (this.variable.type === 'Char') {
                    width = 60;
                }
            }
            else {
                if (this.variable.type === 'Guid') {
                    width = 265;
                }
                else {
                    width = 210;
                }
            }
            return width;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ParameterTextBoxComponent.prototype, "color", {
        get: function () {
            return !this.variable.isNull
                ? (this.model.options.toolbar.fontColor && this.model.options.toolbar.fontColor !== 'Empty' ? this.model.options.toolbar.fontColor : '#444444')
                : this.variable.type === 'DateTime' ? 'transparent' : '#c6c6c6';
        },
        enumerable: true,
        configurable: true
    });
    ParameterTextBoxComponent.ctorParameters = function () { return [
        { type: HelperService },
        { type: ModelService }
    ]; };
    __decorate([
        ViewChild('element')
    ], ParameterTextBoxComponent.prototype, "element", void 0);
    __decorate([
        Input()
    ], ParameterTextBoxComponent.prototype, "item", void 0);
    __decorate([
        Input()
    ], ParameterTextBoxComponent.prototype, "variable", void 0);
    __decorate([
        Input()
    ], ParameterTextBoxComponent.prototype, "readOnly", void 0);
    __decorate([
        Input()
    ], ParameterTextBoxComponent.prototype, "focusOnCreate", void 0);
    __decorate([
        Input()
    ], ParameterTextBoxComponent.prototype, "isMenu", void 0);
    __decorate([
        Input()
    ], ParameterTextBoxComponent.prototype, "value", void 0);
    __decorate([
        Input()
    ], ParameterTextBoxComponent.prototype, "secondTextBox", void 0);
    ParameterTextBoxComponent = __decorate([
        Component({
            selector: 'sti-parameter-text-box',
            template: "\n    <sti-text-box #element\n      [maxLength]=\"variable.type === 'Char' ? 1 : ''\"\n      [value]=\"isMenu ? helper.getStringKey(item.key, variable): value\"\n      [width]=\"width\"\n      [readOnly]=\"readOnly\"\n      [focusOnCreate]=\"focusOnCreate\"\n      [enabled]=\"!variable?.isNull\"\n      [color]=\"color\"\n      (onchange)=\"onchange($event)\">\n    </sti-text-box>\n  "
        })
    ], ParameterTextBoxComponent);
    return ParameterTextBoxComponent;
}());
export { ParameterTextBoxComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGFyYW1ldGVyLXRleHQtYm94LmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL3N0aW11bHNvZnQtdmlld2VyLWFuZ3VsYXIvIiwic291cmNlcyI6WyJsaWIvY29udHJvbHMvcGFyYW1ldGVycy9wYXJhbWV0ZXItdGV4dC1ib3guY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFVLEtBQUssRUFBRSxTQUFTLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFHcEUsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLCtCQUErQixDQUFDO0FBQzlELE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSw4QkFBOEIsQ0FBQztBQWtCNUQ7SUFZRSxtQ0FBbUIsTUFBcUIsRUFBUyxLQUFtQjtRQUFqRCxXQUFNLEdBQU4sTUFBTSxDQUFlO1FBQVMsVUFBSyxHQUFMLEtBQUssQ0FBYztRQUwzRCxrQkFBYSxHQUFHLEtBQUssQ0FBQztRQUN0QixXQUFNLEdBQUcsS0FBSyxDQUFDO1FBQ2YsVUFBSyxHQUFHLEVBQUUsQ0FBQztRQUNYLGtCQUFhLEdBQUcsS0FBSyxDQUFDO0lBRXlDLENBQUM7SUFFekUsNENBQVEsR0FBUixjQUFhLENBQUM7SUFFZCw0Q0FBUSxHQUFSLFVBQVMsTUFBVztRQUNsQixJQUFJLElBQUksQ0FBQyxPQUFPLENBQUMsUUFBUSxLQUFLLE1BQU0sQ0FBQyxLQUFLLEVBQUU7WUFDMUMsT0FBTztTQUNSO1FBQ0QsSUFBTSxLQUFLLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUNwQyxJQUFJLElBQUksQ0FBQyxNQUFNLEVBQUU7WUFDZixJQUFJLENBQUMsSUFBSSxDQUFDLGFBQWEsRUFBRTtnQkFDdkIsSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLEdBQUcsS0FBSyxDQUFDO2FBQ3ZCO2lCQUFNO2dCQUNMLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxHQUFHLEtBQUssQ0FBQzth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ckM7SUFBRCxnQ0FBQztDQUFBLEFBOUZELElBOEZDO1NBOUZZLHlCQUF5QiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgT25Jbml0LCBJbnB1dCwgVmlld0NoaWxkIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IFZhcmlhYmxlIH0gZnJvbSAnLi4vLi4vc2VydmljZXMvb2JqZWN0cyc7XHJcbmltcG9ydCB7IFRleHRCb3hDb21wb25lbnQgfSBmcm9tICcuLi90ZXh0LWJveC5jb21wb25ldCc7XHJcbmltcG9ydCB7IEhlbHBlclNlcnZpY2UgfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9oZWxwZXIuc2VydmljZSc7XHJcbmltcG9ydCB7IE1vZGVsU2VydmljZSB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL21vZGVsLnNlcnZpY2UnO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6ICdzdGktcGFyYW1ldGVyLXRleHQtYm94JyxcclxuICB0ZW1wbGF0ZTogYFxyXG4gICAgPHN0aS10ZXh0LWJveCAjZWxlbWVudFxyXG4gICAgICBbbWF4TGVuZ3RoXT1cInZhcmlhYmxlLnR5cGUgPT09ICdDaGFyJyA/IDEgOiAnJ1wiXHJcbiAgICAgIFt2YWx1ZV09XCJpc01lbnUgPyBoZWxwZXIuZ2V0U3RyaW5nS2V5KGl0ZW0ua2V5LCB2YXJpYWJsZSk6IHZhbHVlXCJcclxuICAgICAgW3dpZHRoXT1cIndpZHRoXCJcclxuICAgICAgW3JlYWRPbmx5XT1cInJlYWRPbmx5XCJcclxuICAgICAgW2ZvY3VzT25DcmVhdGVdPVwiZm9jdXNPbkNyZWF0ZVwiXHJcbiAgICAgIFtlbmFibGVkXT1cIiF2YXJpYWJsZT8uaXNOdWxsXCJcclxuICAgICAgW2NvbG9yXT1cImNvbG9yXCJcclxuICAgICAgKG9uY2hhbmdlKT1cIm9uY2hhbmdlKCRldmVudClcIj5cclxuICAgIDwvc3RpLXRleHQtYm94PlxyXG4gIGBcclxufSlcclxuXHJcbmV4cG9ydCBjbGFzcyBQYXJhbWV0ZXJUZXh0Qm94Q29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcclxuXHJcbiAgQFZpZXdDaGlsZCgnZWxlbWVudCcpIGVsZW1lbnQ6IFRleHRCb3hDb21wb25lbnQ7XHJcblxyXG4gIEBJbnB1dCgpIGl0ZW06IFZhcmlhYmxlO1xyXG4gIEBJbnB1dCgpIHZhcmlhYmxlOiBWYXJpYWJsZTtcclxuICBASW5wdXQoKSByZWFkT25seTogYm9vbGVhbjtcclxuICBASW5wdXQoKSBmb2N1c09uQ3JlYXRlID0gZmFsc2U7XHJcbiAgQElucHV0KCkgaXNNZW51ID0gZmFsc2U7XHJcbiAgQElucHV0KCkgdmFsdWUgPSAnJztcclxuICBASW5wdXQoKSBzZWNvbmRUZXh0Qm94ID0gZmFsc2U7XHJcblxyXG4gIGNvbnN0cnVjdG9yKHB1YmxpYyBoZWxwZXI6IEhlbHBlclNlcnZpY2UsIHB1YmxpYyBtb2RlbDogTW9kZWxTZXJ2aWNlKSB7IH1cclxuXHJcbiAgbmdPbkluaXQoKSB7IH1cclxuXHJcbiAgb25jaGFuZ2UodGFyZ2V0OiBhbnkpIHtcclxuICAgIGlmICh0aGlzLmVsZW1lbnQub2xkVmFsdWUgPT09IHRhcmdldC52YWx1ZSkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBjb25zdCB2YWx1ZSA9IHRoaXMuZ2V0VmFsdWUodGFyZ2V0KTtcclxuICAgIGlmICh0aGlzLmlzTWVudSkge1xyXG4gICAgICBpZiAoIXRoaXMuc2Vjb25kVGV4dEJveCkge1xyXG4gICAgICAgIHRoaXMuaXRlbS5rZXkgPSB2YWx1ZTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0aGlzLml0ZW0ua2V5VG8gPSB2YWx1ZTtcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgaWYgKCF0aGlzLnNlY29uZFRleHRCb3gpIHtcclxuICAgICAgICBpZiAodGhpcy52YXJpYWJsZS5iYXNpY1R5cGUgPT09ICdSYW5nZScgfHwgdGhpcy52YXJpYWJsZS50eXBlID09PSAnRGF0ZVRpbWUnKSB7XHJcbiAgICAgICAgICB0aGlzLnZhcmlhYmxlLmtleSA9IHZhbHVlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICB0aGlzLnZhcmlhYmxlLnZhbHVlID0gdmFsdWU7XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRoaXMudmFyaWFibGUua2V5VG8gPSB2YWx1ZTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZ2V0VmFsdWUodGFyZ2V0OiBhbnkpOiBhbnkge1xyXG4gICAgaWYgKHRoaXMudmFyaWFibGUudHlwZSA9PT0gJ0RhdGVUaW1lJykge1xyXG4gICAgICBpZiAodGhpcy5lbGVtZW50Lm9sZFZhbHVlID09PSB0YXJnZXQudmFsdWUpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgdHJ5IHtcclxuICAgICAgICBjb25zdCB0aW1lU3RyaW5nID0gbmV3IERhdGUoKS50b0xvY2FsZVRpbWVTdHJpbmcoKTtcclxuICAgICAgICBjb25zdCBpc0FtZXJpY2FuRm9ybWF0ID0gdGltZVN0cmluZy50b0xvd2VyQ2FzZSgpLmluZGV4T2YoJ2FtJykgPj0gMCB8fCB0aW1lU3RyaW5nLnRvTG93ZXJDYXNlKCkuaW5kZXhPZigncG0nKSA+PSAwO1xyXG4gICAgICAgIGNvbnN0IGZvcm1hdERhdGUgPSBpc0FtZXJpY2FuRm9ybWF0ID8gJ01NL2RkL3l5eXknIDogJ2RkLk1NLnl5eXknO1xyXG4gICAgICAgIGxldCBmb3JtYXQgPSBmb3JtYXREYXRlICsgKGlzQW1lcmljYW5Gb3JtYXQgPyAnIGg6bW06c3MgdHQnIDogJyBoaDptbTpzcycpO1xyXG4gICAgICAgIGlmICh0aGlzLnZhcmlhYmxlLmRhdGVUaW1lVHlwZSA9PT0gJ0RhdGUnKSB7XHJcbiAgICAgICAgICBmb3JtYXQgPSBmb3JtYXREYXRlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy52YXJpYWJsZS5kYXRlVGltZVR5cGUgPT09ICdUaW1lJykge1xyXG4gICAgICAgICAgZm9ybWF0ID0gJ2hoOm1tOnNzJztcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgZGF0ZSA9IHRoaXMuaGVscGVyLmdldERhdGVUaW1lRnJvbVN0cmluZyh0YXJnZXQudmFsdWUsIHRoaXMubW9kZWwub3B0aW9ucy5hcHBlYXJhbmNlLnBhcmFtZXRlcnNQYW5lbERhdGVGb3JtYXQgfHwgZm9ybWF0KTtcclxuICAgICAgICByZXR1cm4gdGhpcy5oZWxwZXIuZ2V0RGF0ZVRpbWVPYmplY3QoZGF0ZSk7XHJcbiAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICBhbGVydChlKTtcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmV0dXJuIHRhcmdldC52YWx1ZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGdldCB3aWR0aCgpOiBudW1iZXIge1xyXG4gICAgbGV0IHdpZHRoID0gMjEwO1xyXG4gICAgaWYgKHRoaXMudmFyaWFibGUuYmFzaWNUeXBlID09PSAnUmFuZ2UnKSB7XHJcbiAgICAgIHdpZHRoID0gMTQwO1xyXG4gICAgICBpZiAodGhpcy52YXJpYWJsZS50eXBlID09PSAnR3VpZCcgfHwgdGhpcy52YXJpYWJsZS50eXBlID09PSAnU3RyaW5nJykge1xyXG4gICAgICAgIHdpZHRoID0gMTkwO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICh0aGlzLnZhcmlhYmxlLnR5cGUgPT09ICdEYXRlVGltZScpIHtcclxuICAgICAgICB3aWR0aCA9IDIzNTtcclxuICAgICAgfVxyXG4gICAgICBpZiAodGhpcy52YXJpYWJsZS50eXBlID09PSAnQ2hhcicpIHtcclxuICAgICAgICB3aWR0aCA9IDYwO1xyXG4gICAgICB9XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBpZiAodGhpcy52YXJpYWJsZS50eXBlID09PSAnR3VpZCcpIHtcclxuICAgICAgICB3aWR0aCA9IDI2NTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB3aWR0aCA9IDIxMDtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHdpZHRoO1xyXG4gIH1cclxuXHJcbiAgZ2V0IGNvbG9yKCk6IHN0cmluZyB7XHJcbiAgICByZXR1cm4gIXRoaXMudmFyaWFibGUuaXNOdWxsXHJcbiAgICAgID8gKHRoaXMubW9kZWwub3B0aW9ucy50b29sYmFyLmZvbnRDb2xvciAmJiB0aGlzLm1vZGVsLm9wdGlvbnMudG9vbGJhci5mb250Q29sb3IgIT09ICdFbXB0eScgPyB0aGlzLm1vZGVsLm9wdGlvbnMudG9vbGJhci5mb250Q29sb3IgOiAnIzQ0NDQ0NCcpXHJcbiAgICAgIDogdGhpcy52YXJpYWJsZS50eXBlID09PSAnRGF0ZVRpbWUnID8gJ3RyYW5zcGFyZW50JyA6ICcjYzZjNmM2JztcclxuICB9XHJcbn1cclxuIl19