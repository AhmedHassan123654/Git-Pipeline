import { __decorate } from "tslib";
import { Component, Input, ViewChild } from '@angular/core';
import { ModelService } from '../../services/model.service';
import { HelperService } from '../../services/helper.service';
import { MenuService } from '../../menu/menu.service';
var ParameterComponent = /** @class */ (function () {
    function ParameterComponent(model, helper, menuService) {
        this.model = model;
        this.helper = helper;
        this.menuService = menuService;
    }
    ParameterComponent.prototype.ngOnInit = function () { };
    Object.defineProperty(ParameterComponent.prototype, "params", {
        get: function () {
            return this._params;
        },
        set: function (params) {
            this._params = params;
            if (params.basicType === 'Range') {
                if (params.type === 'DateTime' && params.keyTo && params.keyTo.isNull) {
                    params.keyTo = this.helper.getDateTimeObject(new Date());
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ParameterComponent.prototype, "showParameterInTwoRows", {
        get: function () {
            return this.params.basicType === 'Range' && this.model.options.appearance.parametersPanelPosition === 'Left';
        },
        enumerable: true,
        configurable: true
    });
    ParameterComponent.prototype.getReadOnlyCheckbox = function () {
        return this.params.basicType === 'List' || !this.params.allowUserValues;
    };
    ParameterComponent.prototype.getFirstTextBoxValue = function () {
        var _this = this;
        var value = '';
        if (this.params.basicType === 'Value' || this.params.basicType === 'NullableValue') {
            if (this.params.type === 'DateTime' && this.params.value === null) {
                this.params.value = new Date();
                this.params.key = this.helper.getDateTimeObject(this.params.value);
            }
            value = (this.params.type === 'DateTime') ? this.helper.getStringKey(this.params.key, this.params) : this.params.value;
        }
        // Range
        if (this.params.basicType === 'Range') {
            if (this.params.type === 'DateTime' && this.params.key && this.params.key.isNull) {
                this.params.key = this.helper.getDateTimeObject(new Date());
            }
            value = this.helper.getStringKey(this.params.key, this.params);
        }
        // List
        if (this.params.basicType === 'List' && this.params.items) {
            this.params.items.forEach(function (item) {
                if (item.isChecked) {
                    if (value !== '') {
                        value += (_this.model.options.listSeparator ? _this.model.options.listSeparator + " " : "; ");
                    }
                    if (_this.params.allowUserValues) {
                        value += _this.helper.getStringKey(item.key, _this.params);
                    }
                    else {
                        value += item.value !== '' ? item.value : _this.helper.getStringKey(item.key, _this.params);
                    }
                }
            });
        }
        return value != null ? value.toString() : value;
    };
    ParameterComponent.prototype.nullableAction = function (checked) {
        this.params.isNull = !this.params.isNull;
    };
    ParameterComponent.prototype.firstGuidAction = function () {
        if (this.params.basicType === 'Range') {
            this.params.key = this.helper.newGuid();
        }
        else {
            this.params.value = this.helper.newGuid();
        }
    };
    ParameterComponent.prototype.doubleDateTimeAction = function (event) {
        var _this = this;
        this.menuService.addMenu({
            type: 'doubleDatePickerMenu', name: 'doubleDatePickerMenu', items: [], parent: this.rangeFrom,
            params: this.params
        });
        setTimeout(function () {
            _this.menuService.showMenu('doubleDatePickerMenu');
        });
    };
    ParameterComponent.prototype.firstDateTimeAction = function (event) {
        var _this = this;
        this.menuService.addMenu({
            type: 'datePickerMenu', name: 'datePickerMenu', items: [], parent: this.firstDateTimeButton,
            params: this.params
        });
        setTimeout(function () {
            _this.menuService.showMenu('datePickerMenu');
        });
    };
    ParameterComponent.prototype.dropDownButtonAction = function (event) {
        var _this = this;
        var menuType = 'parameterMenuForValue';
        switch (this.params.basicType) {
            case 'Range':
                menuType = 'parameterMenuForRange';
                break;
            case 'List':
                menuType = this.params.allowUserValues ? 'parameterMenuForEditList' : 'parameterMenuForNotEditList';
                break;
        }
        if (this.params.items) {
            this.params.items.forEach(function (i) { return i.visible = true; });
        }
        this.menuService.addMenu({
            type: menuType, name: 'parameterMenu', items: [], parent: this.element,
            params: this.params
        });
        setTimeout(function () {
            _this.menuService.showMenu('parameterMenu');
        });
    };
    ParameterComponent.ctorParameters = function () { return [
        { type: ModelService },
        { type: HelperService },
        { type: MenuService }
    ]; };
    __decorate([
        ViewChild('element')
    ], ParameterComponent.prototype, "element", void 0);
    __decorate([
        ViewChild('firstDateTimeButton')
    ], ParameterComponent.prototype, "firstDateTimeButton", void 0);
    __decorate([
        ViewChild('doubleDateTimeButton')
    ], ParameterComponent.prototype, "doubleDateTimeButton", void 0);
    __decorate([
        ViewChild('rangeFrom')
    ], ParameterComponent.prototype, "rangeFrom", void 0);
    __decorate([
        Input()
    ], ParameterComponent.prototype, "params", null);
    ParameterComponent = __decorate([
        Component({
            selector: 'sti-parameter',
            template: "\n    <table #element class=\"stiJsViewerClearAllStyles\" cellpadding=\"0\" cellspacing=\"0\" #rangeFrom>\n       <tbody>\n          <tr class=\"stiJsViewerClearAllStyles\" >\n            <td *ngIf=\"params.type == 'Bool' && (params.basicType == 'Value' || params.basicType == 'NullableValue')\"\n                style=\"padding: 0px 2px;\" [style.height.px]=\"model.options.parameterRowHeight\">\n                <sti-parameter-checkbox [params]=\"params\" [isEnabled]=\"params.allowUserValues && !params.isNull\" (action)=\"params.value = $event\">\n                </sti-parameter-checkbox>\n            </td>\n\n            <td *ngIf=\"params.basicType == 'Range' && model.options.appearance.parametersPanelPosition === 'Top'\"  style=\"padding: 0px 2px;\" [style.height.px]=\"model.options.parameterRowHeight\">\n                {{model.loc('RangeFrom')}}\n            </td>\n\n            <td *ngIf=\"params.type != 'Bool' || params.basicType == 'List'\"\n                style=\"padding: 0px 2px;\" [style.height.px]=\"model.options.parameterRowHeight\">\n                <sti-parameter-text-box [variable]=\"params\"\n                    [readOnly]=\"getReadOnlyCheckbox()\"\n                    [value]=\"getFirstTextBoxValue()\">\n                </sti-parameter-text-box>\n            </td>\n\n            <td *ngIf=\"params.type == 'DateTime' && params.allowUserValues && params.basicType != 'List' && params.basicType != 'Range'\"\n                style=\"padding: 0px 2px;\" [style.height.px]=\"model.options.parameterRowHeight\" #firstDateTimeButton>\n                <sti-parameter-button [buttonType]=\"'DateTimeButton'\" [params]=\"params\"  (action)=\"firstDateTimeAction($event)\">\n                </sti-parameter-button>\n            </td>\n\n            <td *ngIf=\"params.type == 'Guid' && params.allowUserValues && params.basicType != 'List'\"\n                style=\"padding: 0px 2px;\" [style.height.px]=\"model.options.parameterRowHeight\">\n                <sti-parameter-button  [buttonType]=\"'GuidButton'\" [params]=\"params\" (action)=\"firstGuidAction()\">\n                </sti-parameter-button>\n            </td>\n\n            <td *ngIf=\"!showParameterInTwoRows && params.basicType == 'Range' && model.options.appearance.parametersPanelPosition === 'Top'\" style=\"padding: 0px 2px;\" [style.height.px]=\"model.options.parameterRowHeight\">\n              {{model.loc('RangeTo')}}\n            </td>\n\n            <!-- second -->\n            <td *ngIf=\"!showParameterInTwoRows && params.basicType == 'Range'\" style=\"padding: 0px 2px;\" [style.height.px]=\"model.options.parameterRowHeight\">\n              <sti-parameter-text-box [variable]=\"params\"\n                    [readOnly]=\"!params.allowUserValues\"\n                    [value]=\"helper.getStringKey(params.keyTo, params)\"\n                    [secondTextBox]=\"true\">\n              </sti-parameter-text-box>\n            </td>\n\n            <td *ngIf=\"!showParameterInTwoRows && params.basicType == 'Range' && params.type == 'DateTime' && params.allowUserValues\" #doubleDateTimeButton\n              style=\"padding: 0px 2px;\" [style.height.px]=\"model.options.parameterRowHeight\">\n              <sti-parameter-button  [buttonType]=\"'DateTimeButton'\" [params]=\"params\" (action)=\"doubleDateTimeAction($event)\">\n              </sti-parameter-button>\n            </td>\n\n            <td *ngIf=\"!showParameterInTwoRows && params.basicType == 'Range' && params.type == 'Guid' && params.allowUserValues\"\n              style=\"padding: 0px 2px;\" [style.height.px]=\"model.options.parameterRowHeight\">\n              <sti-parameter-button  [buttonType]=\"'GuidButton'\" [params]=\"params\" (action)=\"params.keyTo=helper.newGuid()\">\n              </sti-parameter-button>\n            </td>\n\n            <td *ngIf=\"!showParameterInTwoRows && params.items != null || (params.basicType == 'List' && params.allowUserValues)\"\n                style=\"padding: 0px 2px;\" [style.height.px]=\"model.options.parameterRowHeight\">\n              <sti-parameter-button [buttonType]=\"'DropDownButton'\" [params]=\"params\" (action)=\"dropDownButtonAction($event)\">\n              </sti-parameter-button>\n            </td>\n\n            <td *ngIf=\"!showParameterInTwoRows && params.basicType == 'NullableValue' && params.allowUserValues\"\n                style=\"padding: 0px 2px;\" [style.height.px]=\"model.options.parameterRowHeight\">\n                <sti-parameter-checkbox [params]=\"params\" [isEnabled]=\"params.allowUserValues\" (action)=\"nullableAction($event)\" [nullable]=\"true\" >\n                </sti-parameter-checkbox>\n            </td>\n\n            <td *ngIf=\"!showParameterInTwoRows && params.basicType == 'NullableValue' && params.allowUserValues\"\n                style=\"padding: 0px\" [style.height.px]=\"model.options.parameterRowHeight\">\n                {{model.loc('Null')}}\n            </td>\n          </tr>\n\n          <!-- NEW LINE -->\n          <tr *ngIf=\"showParameterInTwoRows\">\n            <td *ngIf=\"params.basicType == 'Range' && model.options.appearance.parametersPanelPosition === 'Top'\" style=\"padding: 0px 2px;\" [style.height.px]=\"model.options.parameterRowHeight\">\n              {{model.loc('RangeTo')}}\n            </td>\n\n            <!-- second -->\n            <td *ngIf=\"params.basicType == 'Range'\" style=\"padding: 0px 2px;\" [style.height.px]=\"model.options.parameterRowHeight\">\n              <sti-parameter-text-box [variable]=\"params\"\n                    [readOnly]=\"!params.allowUserValues\"\n                    [value]=\"helper.getStringKey(params.keyTo, params)\"\n                    [secondTextBox]=\"true\">\n              </sti-parameter-text-box>\n            </td>\n\n            <td *ngIf=\"params.basicType == 'Range' && params.type == 'DateTime' && params.allowUserValues\" #doubleDateTimeButton\n              style=\"padding: 0px 2px;\" [style.height.px]=\"model.options.parameterRowHeight\">\n              <sti-parameter-button  [buttonType]=\"'DateTimeButton'\" [params]=\"params\" (action)=\"doubleDateTimeAction($event)\">\n              </sti-parameter-button>\n            </td>\n\n            <td *ngIf=\"params.basicType == 'Range' && params.type == 'Guid' && params.allowUserValues\"\n              style=\"padding: 0px 2px;\" [style.height.px]=\"model.options.parameterRowHeight\">\n              <sti-parameter-button  [buttonType]=\"'GuidButton'\" [params]=\"params\" (action)=\"params.keyTo=helper.newGuid()\">\n              </sti-parameter-button>\n            </td>\n\n            <td *ngIf=\"params.items != null || (params.basicType == 'List' && params.allowUserValues)\"\n                style=\"padding: 0px 2px;\" [style.height.px]=\"model.options.parameterRowHeight\">\n              <sti-parameter-button [buttonType]=\"'DropDownButton'\" [params]=\"params\" (action)=\"dropDownButtonAction($event)\">\n              </sti-parameter-button>\n            </td>\n\n            <td *ngIf=\"params.basicType == 'NullableValue' && params.allowUserValues\"\n                style=\"padding: 0px 2px;\" [style.height.px]=\"model.options.parameterRowHeight\">\n                <sti-parameter-checkbox [params]=\"params\" [isEnabled]=\"params.allowUserValues\" (action)=\"nullableAction($event)\" [nullable]=\"true\" >\n                </sti-parameter-checkbox>\n            </td>\n\n            <td *ngIf=\"params.basicType == 'NullableValue' && params.allowUserValues\"\n                style=\"padding: 0px\" [style.height.px]=\"model.options.parameterRowHeight\">\n                {{model.loc('Null')}}\n            </td>\n\n          </tr>\n       </tbody>\n    </table>\n  "
        })
    ], ParameterComponent);
    return ParameterComponent;
}());
export { ParameterComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGFyYW1ldGVyLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL3N0aW11bHNvZnQtdmlld2VyLWFuZ3VsYXIvIiwic291cmNlcyI6WyJsaWIvY29udHJvbHMvcGFyYW1ldGVycy9wYXJhbWV0ZXIuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFVLEtBQUssRUFBYyxTQUFTLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDaEYsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLDhCQUE4QixDQUFDO0FBRTVELE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSwrQkFBK0IsQ0FBQztBQUM5RCxPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0seUJBQXlCLENBQUM7QUFtSXREO0lBU0UsNEJBQW1CLEtBQW1CLEVBQVMsTUFBcUIsRUFBUyxXQUF3QjtRQUFsRixVQUFLLEdBQUwsS0FBSyxDQUFjO1FBQVMsV0FBTSxHQUFOLE1BQU0sQ0FBZTtRQUFTLGdCQUFXLEdBQVgsV0FBVyxDQUFhO0lBQUksQ0FBQztJQUUxRyxxQ0FBUSxHQUFSLGNBQWEsQ0FBQztJQUVMLHNCQUFJLHNDQUFNO2FBQVY7WUFDUCxPQUFPLElBQUksQ0FBQyxPQUFPLENBQUM7UUFDdEIsQ0FBQzthQUVELFVBQVcsTUFBZ0I7WUFDekIsSUFBSSxDQUFDLE9BQU8sR0FBRyxNQUFNLENBQUM7WUFFdEIsSUFBSSxNQUFNLENBQUMsU0FBUyxLQUFLLE9BQU8sRUFBRTtnQkFDaEMsSUFBSSxNQUFNLENBQUMsSUFBSSxLQUFLLFVBQVUsSUFBSSxNQUFNLENBQUMsS0FBSyxJQUFJLE1BQU0sQ0FBQyxLQUFLLENBQUMsTUFBTSxFQUFFO29CQUNyRSxNQUFNLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUMsSUFBSSxJQUFJLEVBQUUsQ0FBQyxDQUFDO2lCQUMxRDthQUNGO1FBQ0gsQ0FBQzs7O09BVkE7SUFZRCxzQkFBSSxz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QUFFLElBQUksQ0FBQyxPQUFPO1lBQ3RFLE1BQU0sRUFBRSxJQUFJLENBQUMsTUFBTTtTQUNwQixDQUFDLENBQUM7UUFFSCxVQUFVLENBQUM7WUFDVCxLQUFJLENBQUMsV0FBVyxDQUFDLFFBQVEsQ0FBQyxlQUFlLENBQUMsQ0FBQztRQUM3QyxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUM7O2dCQTFIeUIsWUFBWTtnQkFBaUIsYUFBYTtnQkFBc0IsV0FBVzs7SUFQL0U7UUFBckIsU0FBUyxDQUFDLFNBQVMsQ0FBQzt1REFBcUI7SUFDUjtRQUFqQyxTQUFTLENBQUMscUJBQXFCLENBQUM7bUVBQWlDO0lBQy9CO1FBQWxDLFNBQVMsQ0FBQyxzQkFBc0IsQ0FBQztvRUFBa0M7SUFDNUM7UUFBdkIsU0FBUyxDQUFDLFdBQVcsQ0FBQzt5REFBdUI7SUFRckM7UUFBUixLQUFLLEVBQUU7b0RBRVA7SUFmVSxrQkFBa0I7UUFqSTlCLFNBQVMsQ0FBQztZQUNULFFBQVEsRUFBRSxlQUFlO1lBQ3pCLFFBQVEsRUFBRSwyaVBBNEhUO1NBQ0YsQ0FBQztPQUVXLGtCQUFrQixDQW9JOUI7SUFBRCx5QkFBQztDQUFBLEFBcElELElBb0lDO1NBcElZLGtCQUFrQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgT25Jbml0LCBJbnB1dCwgRWxlbWVudFJlZiwgVmlld0NoaWxkIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IE1vZGVsU2VydmljZSB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL21vZGVsLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBWYXJpYWJsZSB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL29iamVjdHMnO1xyXG5pbXBvcnQgeyBIZWxwZXJTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vc2VydmljZXMvaGVscGVyLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBNZW51U2VydmljZSB9IGZyb20gJy4uLy4uL21lbnUvbWVudS5zZXJ2aWNlJztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gIHNlbGVjdG9yOiAnc3RpLXBhcmFtZXRlcicsXHJcbiAgdGVtcGxhdGU6IGBcclxuICAgIDx0YWJsZSAjZWxlbWVudCBjbGFzcz1cInN0aUpzVmlld2VyQ2xlYXJBbGxTdHlsZXNcIiBjZWxscGFkZGluZz1cIjBcIiBjZWxsc3BhY2luZz1cIjBcIiAjcmFuZ2VGcm9tPlxyXG4gICAgICAgPHRib2R5PlxyXG4gICAgICAgICAgPHRyIGNsYXNzPVwic3RpSnNWaWV3ZXJDbGVhckFsbFN0eWxlc1wiID5cclxuICAgICAgICAgICAgPHRkICpuZ0lmPVwicGFyYW1zLnR5cGUgPT0gJ0Jvb2wnICYmIChwYXJhbXMuYmFzaWNUeXBlID09ICdWYWx1ZScgfHwgcGFyYW1zLmJhc2ljVHlwZSA9PSAnTnVsbGFibGVWYWx1ZScpXCJcclxuICAgICAgICAgICAgICAgIHN0eWxlPVwicGFkZGluZzogMHB4IDJweDtcIiBbc3R5bGUuaGVpZ2h0LnB4XT1cIm1vZGVsLm9wdGlvbnMucGFyYW1ldGVyUm93SGVpZ2h0XCI+XHJcbiAgICAgICAgICAgICAgICA8c3RpLXBhcmFtZXRlci1jaGVja2JveCBbcGFyYW1zXT1cInBhcmFtc1wiIFtpc0VuYWJsZWRdPVwicGFyYW1zLmFsbG93VXNlclZhbHVlcyAmJiAhcGFyYW1zLmlzTnVsbFwiIChhY3Rpb24pPVwicGFyYW1zLnZhbHVlID0gJGV2ZW50XCI+XHJcbiAgICAgICAgICAgICAgICA8L3N0aS1wYXJhbWV0ZXItY2hlY2tib3g+XHJcbiAgICAgICAgICAgIDwvdGQ+XHJcblxyXG4gICAgICAgICAgICA8dGQgKm5nSWY9XCJwYXJhbXMuYmFzaWNUeXBlID09ICdSYW5nZScgJiYgbW9kZWwub3B0aW9ucy5hcHBlYXJhbmNlLnBhcmFtZXRlcnNQYW5lbFBvc2l0aW9uID09PSAnVG9wJ1wiICBzdHlsZT1cInBhZGRpbmc6IDBweCAycHg7XCIgW3N0eWxlLmhlaWdodC5weF09XCJtb2RlbC5vcHRpb25zLnBhcmFtZXRlclJvd0hlaWdodFwiPlxyXG4gICAgICAgICAgICAgICAge3ttb2RlbC5sb2MoJ1JhbmdlRnJvbScpfX1cclxuICAgICAgICAgICAgPC90ZD5cclxuXHJcbiAgICAgICAgICAgIDx0ZCAqbmdJZj1cInBhcmFtcy50eXBlICE9ICdCb29sJyB8fCBwYXJhbXMuYmFzaWNUeXBlID09ICdMaXN0J1wiXHJcbiAgICAgICAgICAgICAgICBzdHlsZT1cInBhZGRpbmc6IDBweCAycHg7XCIgW3N0eWxlLmhlaWdodC5weF09XCJtb2RlbC5vcHRpb25zLnBhcmFtZXRlclJvd0hlaWdodFwiPlxyXG4gICAgICAgICAgICAgICAgPHN0aS1wYXJhbWV0ZXItdGV4dC1ib3ggW3ZhcmlhYmxlXT1cInBhcmFtc1wiXHJcbiAgICAgICAgICAgICAgICAgICAgW3JlYWRPbmx5XT1cImdldFJlYWRPbmx5Q2hlY2tib3goKVwiXHJcbiAgICAgICAgICAgICAgICAgICAgW3ZhbHVlXT1cImdldEZpcnN0VGV4dEJveFZhbHVlKClcIj5cclxuICAgICAgICAgICAgICAgIDwvc3RpLXBhcmFtZXRlci10ZXh0LWJveD5cclxuICAgICAgICAgICAgPC90ZD5cclxuXHJcbiAgICAgICAgICAgIDx0ZCAqbmdJZj1cInBhcmFtcy50eXBlID09ICdEYXRlVGltZScgJiYgcGFyYW1zLmFsbG93VXNlclZhbHVlcyAmJiBwYXJhbXMuYmFzaWNUeXBlICE9ICdMaXN0JyAmJiBwYXJhbXMuYmFzaWNUeXBlICE9ICdSYW5nZSdcIlxyXG4gICAgICAgICAgICAgICAgc3R5bGU9XCJwYWRkaW5nOiAwcHggMnB4O1wiIFtzdHlsZS5oZWlnaHQucHhdPVwibW9kZWwub3B0aW9ucy5wYXJhbWV0ZXJSb3dIZWlnaHRcIiAjZmlyc3REYXRlVGltZUJ1dHRvbj5cclxuICAgICAgICAgICAgICAgIDxzdGktcGFyYW1ldGVyLWJ1dHRvbiBbYnV0dG9uVHlwZV09XCInRGF0ZVRpbWVCdXR0b24nXCIgW3BhcmFtc109XCJwYXJhbXNcIiAgKGFjdGlvbik9XCJmaXJzdERhdGVUaW1lQWN0aW9uKCRldmVudClcIj5cclxuICAgICAgICAgICAgICAgIDwvc3RpLXBhcmFtZXRlci1idXR0b24+XHJcbiAgICAgICAgICAgIDwvdGQ+XHJcblxyXG4gICAgICAgICAgICA8dGQgKm5nSWY9XCJwYXJhbXMudHlwZSA9PSAnR3VpZCcgJiYgcGFyYW1zLmFsbG93VXNlclZhbHVlcyAmJiBwYXJhbXMuYmFzaWNUeXBlICE9ICdMaXN0J1wiXHJcbiAgICAgICAgICAgICAgICBzdHlsZT1cInBhZGRpbmc6IDBweCAycHg7XCIgW3N0eWxlLmhlaWdodC5weF09XCJtb2RlbC5vcHRpb25zLnBhcmFtZXRlclJvd0hlaWdodFwiPlxyXG4gICAgICAgICAgICAgICAgPHN0aS1wYXJhbWV0ZXItYnV0dG9uICBbYnV0dG9uVHlwZV09XCInR3VpZEJ1dHRvbidcIiBbcGFyYW1zXT1cInBhcmFtc1wiIChhY3Rpb24pPVwiZmlyc3RHdWlkQWN0aW9uKClcIj5cclxuICAgICAgICAgICAgICAgIDwvc3RpLXBhcmFtZXRlci1idXR0b24+XHJcbiAgICAgICAgICAgIDwvdGQ+XHJcblxyXG4gICAgICAgICAgICA8dGQgKm5nSWY9XCIhc2hvd1BhcmFtZXRlckluVHdvUm93cyAmJiBwYXJhbXMuYmFzaWNUeXBlID09ICdSYW5nZScgJiYgbW9kZWwub3B0aW9ucy5hcHBlYXJhbmNlLnBhcmFtZXRlcnNQYW5lbFBvc2l0aW9uID09PSAnVG9wJ1wiIHN0eWxlPVwicGFkZGluZzogMHB4IDJweDtcIiBbc3R5bGUuaGVpZ2h0LnB4XT1cIm1vZGVsLm9wdGlvbnMucGFyYW1ldGVyUm93SGVpZ2h0XCI+XHJcbiAgICAgICAgICAgICAge3ttb2RlbC5sb2MoJ1JhbmdlVG8nKX19XHJcbiAgICAgICAgICAgIDwvdGQ+XHJcblxyXG4gICAgICAgICAgICA8IS0tIHNlY29uZCAtLT5cclxuICAgICAgICAgICAgPHRkICpuZ0lmPVwiIXNob3dQYXJhbWV0ZXJJblR3b1Jvd3MgJiYgcGFyYW1zLmJhc2ljVHlwZSA9PSAnUmFuZ2UnXCIgc3R5bGU9XCJwYWRkaW5nOiAwcHggMnB4O1wiIFtzdHlsZS5oZWlnaHQucHhdPVwibW9kZWwub3B0aW9ucy5wYXJhbWV0ZXJSb3dIZWlnaHRcIj5cclxuICAgICAgICAgICAgICA8c3RpLXBhcmFtZXRlci10ZXh0LWJveCBbdmFyaWFibGVdPVwicGFyYW1zXCJcclxuICAgICAgICAgICAgICAgICAgICBbcmVhZE9ubHldPVwiIXBhcmFtcy5hbGxvd1VzZXJWYWx1ZXNcIlxyXG4gICAgICAgICAgICAgICAgICAgIFt2YWx1ZV09XCJoZWxwZXIuZ2V0U3RyaW5nS2V5KHBhcmFtcy5rZXlUbywgcGFyYW1zKVwiXHJcbiAgICAgICAgICAgICAgICAgICAgW3NlY29uZFRleHRCb3hdPVwidHJ1ZVwiPlxyXG4gICAgICAgICAgICAgIDwvc3RpLXBhcmFtZXRlci10ZXh0LWJveD5cclxuICAgICAgICAgICAgPC90ZD5cclxuXHJcbiAgICAgICAgICAgIDx0ZCAqbmdJZj1cIiFzaG93UGFyYW1ldGVySW5Ud29Sb3dzICYmIHBhcmFtcy5iYXNpY1R5cGUgPT0gJ1JhbmdlJyAmJiBwYXJhbXMudHlwZSA9PSAnRGF0ZVRpbWUnICYmIHBhcmFtcy5hbGxvd1VzZXJWYWx1ZXNcIiAjZG91YmxlRGF0ZVRpbWVCdXR0b25cclxuICAgICAgICAgICAgICBzdHlsZT1cInBhZGRpbmc6IDBweCAycHg7XCIgW3N0eWxlLmhlaWdodC5weF09XCJtb2RlbC5vcHRpb25zLnBhcmFtZXRlclJvd0hlaWdodFwiPlxyXG4gICAgICAgICAgICAgIDxzdGktcGFyYW1ldGVyLWJ1dHRvbiAgW2J1dHRvblR5cGVdPVwiJ0RhdGVUaW1lQnV0dG9uJ1wiIFtwYXJhbXNdPVwicGFyYW1zXCIgKGFjdGlvbik9XCJkb3VibGVEYXRlVGltZUFjdGlvbigkZXZlbnQpXCI+XHJcbiAgICAgICAgICAgICAgPC9zdGktcGFyYW1ldGVyLWJ1dHRvbj5cclxuICAgICAgICAgICAgPC90ZD5cclxuXHJcbiAgICAgICAgICAgIDx0ZCAqbmdJZj1cIiFzaG93UGFyYW1ldGVySW5Ud29Sb3dzICYmIHBhcmFtcy5iYXNpY1R5cGUgPT0gJ1JhbmdlJyAmJiBwYXJhbXMudHlwZSA9PSAnR3VpZCcgJiYgcGFyYW1zLmFsbG93VXNlclZhbHVlc1wiXHJcbiAgICAgICAgICAgICAgc3R5bGU9XCJwYWRkaW5nOiAwcHggMnB4O1wiIFtzdHlsZS5oZWlnaHQucHhdPVwibW9kZWwub3B0aW9ucy5wYXJhbWV0ZXJSb3dIZWlnaHRcIj5cclxuICAgICAgICAgICAgICA8c3RpLXBhcmFtZXRlci1idXR0b24gIFtidXR0b25UeXBlXT1cIidHdWlkQnV0dG9uJ1wiIFtwYXJhbXNdPVwicGFyYW1zXCIgKGFjdGlvbik9XCJwYXJhbXMua2V5VG89aGVscGVyLm5ld0d1aWQoKVwiPlxyXG4gICAgICAgICAgICAgIDwvc3RpLXBhcmFtZXRlci1idXR0b24+XHJcbiAgICAgICAgICAgIDwvdGQ+XHJcblxyXG4gICAgICAgICAgICA8dGQgKm5nSWY9XCIhc2hvd1BhcmFtZXRlckluVHdvUm93cyAmJiBwYXJhbXMuaXRlbXMgIT0gbnVsbCB8fCAocGFyYW1zLmJhc2ljVHlwZSA9PSAnTGlzdCcgJiYgcGFyYW1zLmFsbG93VXNlclZhbHVlcylcIlxyXG4gICAgICAgICAgICAgICAgc3R5bGU9XCJwYWRkaW5nOiAwcHggMnB4O1wiIFtzdHlsZS5oZWlnaHQucHhdPVwibW9kZWwub3B0aW9ucy5wYXJhbWV0ZXJSb3dIZWlnaHRcIj5cclxuICAgICAgICAgICAgICA8c3RpLXBhcmFtZXRlci1idXR0b24gW2J1dHRvblR5cGVdPVwiJ0Ryb3BEb3duQnV0dG9uJ1wiIFtwYXJhbXNdPVwicGFyYW1zXCIgKGFjdGlvbik9XCJkcm9wRG93bkJ1dHRvbkFjdGlvbigkZXZlbnQpXCI+XHJcbiAgICAgICAgICAgICAgPC9zdGktcGFyYW1ldGVyLWJ1dHRvbj5cclxuICAgICAgICAgICAgPC90ZD5cclxuXHJcbiAgICAgICAgICAgIDx0ZCAqbmdJZj1cIiFzaG93UGFyYW1ldGVySW5Ud29Sb3dzICYmIHBhcmFtcy5iYXNpY1R5cGUgPT0gJ051bGxhYmxlVmFsdWUnICYmIHBhcmFtcy5hbGxvd1VzZXJWYWx1ZXNcIlxyXG4gICAgICAgICAgICAgICAgc3R5bGU9XCJwYWRkaW5nOiAwcHggMnB4O1wiIFtzdHlsZS5oZWlnaHQucHhdPVwibW9kZWwub3B0aW9ucy5wYXJhbWV0ZXJSb3dIZWlnaHRcIj5cclxuICAgICAgICAgICAgICAgIDxzdGktcGFyYW1ldGVyLWNoZWNrYm94IFtwYXJhbXNdPVwicGFyYW1zXCIgW2lzRW5hYmxlZF09XCJwYXJhbXMuYWxsb3dVc2VyVmFsdWVzXCIgKGFjdGlvbik9XCJudWxsYWJsZUFjdGlvbigkZXZlbnQpXCIgW251bGxhYmxlXT1cInRydWVcIiA+XHJcbiAgICAgICAgICAgICAgICA8L3N0aS1wYXJhbWV0ZXItY2hlY2tib3g+XHJcbiAgICAgICAgICAgIDwvdGQ+XHJcblxyXG4gICAgICAgICAgICA8dGQgKm5nSWY9XCIhc2hvd1BhcmFtZXRlckluVHdvUm93cyAmJiBwYXJhbXMuYmFzaWNUeXBlID09ICdOdWxsYWJsZVZhbHVlJyAmJiBwYXJhbXMuYWxsb3dVc2VyVmFsdWVzXCJcclxuICAgICAgICAgICAgICAgIHN0eWxlPVwicGFkZGluZzogMHB4XCIgW3N0eWxlLmhlaWdodC5weF09XCJtb2RlbC5vcHRpb25zLnBhcmFtZXRlclJvd0hlaWdodFwiPlxyXG4gICAgICAgICAgICAgICAge3ttb2RlbC5sb2MoJ051bGwnKX19XHJcbiAgICAgICAgICAgIDwvdGQ+XHJcbiAgICAgICAgICA8L3RyPlxyXG5cclxuICAgICAgICAgIDwhLS0gTkVXIExJTkUgLS0+XHJcbiAgICAgICAgICA8dHIgKm5nSWY9XCJzaG93UGFyYW1ldGVySW5Ud29Sb3dzXCI+XHJcbiAgICAgICAgICAgIDx0ZCAqbmdJZj1cInBhcmFtcy5iYXNpY1R5cGUgPT0gJ1JhbmdlJyAmJiBtb2RlbC5vcHRpb25zLmFwcGVhcmFuY2UucGFyYW1ldGVyc1BhbmVsUG9zaXRpb24gPT09ICdUb3AnXCIgc3R5bGU9XCJwYWRkaW5nOiAwcHggMnB4O1wiIFtzdHlsZS5oZWlnaHQucHhdPVwibW9kZWwub3B0aW9ucy5wYXJhbWV0ZXJSb3dIZWlnaHRcIj5cclxuICAgICAgICAgICAgICB7e21vZGVsLmxvYygnUmFuZ2VUbycpfX1cclxuICAgICAgICAgICAgPC90ZD5cclxuXHJcbiAgICAgICAgICAgIDwhLS0gc2Vjb25kIC0tPlxyXG4gICAgICAgICAgICA8dGQgKm5nSWY9XCJwYXJhbXMuYmFzaWNUeXBlID09ICdSYW5nZSdcIiBzdHlsZT1cInBhZGRpbmc6IDBweCAycHg7XCIgW3N0eWxlLmhlaWdodC5weF09XCJtb2RlbC5vcHRpb25zLnBhcmFtZXRlclJvd0hlaWdodFwiPlxyXG4gICAgICAgICAgICAgIDxzdGktcGFyYW1ldGVyLXRleHQtYm94IFt2YXJpYWJsZV09XCJwYXJhbXNcIlxyXG4gICAgICAgICAgICAgICAgICAgIFtyZWFkT25seV09XCIhcGFyYW1zLmFsbG93VXNlclZhbHVlc1wiXHJcbiAgICAgICAgICAgICAgICAgICAgW3ZhbHVlXT1cImhlbHBlci5nZXRTdHJpbmdLZXkocGFyYW1zLmtleVRvLCBwYXJhbXMpXCJcclxuICAgICAgICAgICAgICAgICAgICBbc2Vjb25kVGV4dEJveF09XCJ0cnVlXCI+XHJcbiAgICAgICAgICAgICAgPC9zdGktcGFyYW1ldGVyLXRleHQtYm94PlxyXG4gICAgICAgICAgICA8L3RkPlxyXG5cclxuICAgICAgICAgICAgPHRkICpuZ0lmPVwicGFyYW1zLmJhc2ljVHlwZSA9PSAnUmFuZ2UnICYmIHBhcmFtcy50eXBlID09ICdEYXRlVGltZScgJiYgcGFyYW1zLmFsbG93VXNlclZhbHVlc1wiICNkb3VibGVEYXRlVGltZUJ1dHRvblxyXG4gICAgICAgICAgICAgIHN0eWxlPVwicGFkZGluZzogMHB4IDJweDtcIiBbc3R5bGUuaGVpZ2h0LnB4XT1cIm1vZGVsLm9wdGlvbnMucGFyYW1ldGVyUm93SGVpZ2h0XCI+XHJcbiAgICAgICAgICAgICAgPHN0aS1wYXJhbWV0ZXItYnV0dG9uICBbYnV0dG9uVHlwZV09XCInRGF0ZVRpbWVCdXR0b24nXCIgW3BhcmFtc109XCJwYXJhbXNcIiAoYWN0aW9uKT1cImRvdWJsZURhdGVUaW1lQWN0aW9uKCRldmVudClcIj5cclxuICAgICAgICAgICAgICA8L3N0aS1wYXJhbWV0ZXItYnV0dG9uPlxyXG4gICAgICAgICAgICA8L3RkPlxyXG5cclxuICAgICAgICAgICAgPHRkICpuZ0lmPVwicGFyYW1zLmJhc2ljVHlwZSA9PSAnUmFuZ2UnICYmIHBhcmFtcy50eXBlID09ICdHdWlkJyAmJiBwYXJhbXMuYWxsb3dVc2VyVmFsdWVzXCJcclxuICAgICAgICAgICAgICBzdHlsZT1cInBhZGRpbmc6IDBweCAycHg7XCIgW3N0eWxlLmhlaWdodC5weF09XCJtb2RlbC5vcHRpb25zLnBhcmFtZXRlclJvd0hlaWdodFwiPlxyXG4gICAgICAgICAgICAgIDxzdGktcGFyYW1ldGVyLWJ1dHRvbiAgW2J1dHRvblR5cGVdPVwiJ0d1aWRCdXR0b24nXCIgW3BhcmFtc109XCJwYXJhbXNcIiAoYWN0aW9uKT1cInBhcmFtcy5rZXlUbz1oZWxwZXIubmV3R3VpZCgpXCI+XHJcbiAgICAgICAgICAgICAgPC9zdGktcGFyYW1ldGVyLWJ1dHRvbj5cclxuICAgICAgICAgICAgPC90ZD5cclxuXHJcbiAgICAgICAgICAgIDx0ZCAqbmdJZj1cInBhcmFtcy5pdGVtcyAhPSBudWxsIHx8IChwYXJhbXMuYmFzaWNUeXBlID09ICdMaXN0JyAmJiBwYXJhbXMuYWxsb3dVc2VyVmFsdWVzKVwiXHJcbiAgICAgICAgICAgICAgICBzdHlsZT1cInBhZGRpbmc6IDBweCAycHg7XCIgW3N0eWxlLmhlaWdodC5weF09XCJtb2RlbC5vcHRpb25zLnBhcmFtZXRlclJvd0hlaWdodFwiPlxyXG4gICAgICAgICAgICAgIDxzdGktcGFyYW1ldGVyLWJ1dHRvbiBbYnV0dG9uVHlwZV09XCInRHJvcERvd25CdXR0b24nXCIgW3BhcmFtc109XCJwYXJhbXNcIiAoYWN0aW9uKT1cImRyb3BEb3duQnV0dG9uQWN0aW9uKCRldmVudClcIj5cclxuICAgICAgICAgICAgICA8L3N0aS1wYXJhbWV0ZXItYnV0dG9uPlxyXG4gICAgICAgICAgICA8L3RkPlxyXG5cclxuICAgICAgICAgICAgPHRkICpuZ0lmPVwicGFyYW1zLmJhc2ljVHlwZSA9PSAnTnVsbGFibGVWYWx1ZScgJiYgcGFyYW1zLmFsbG93VXNlclZhbHVlc1wiXHJcbiAgICAgICAgICAgICAgICBzdHlsZT1cInBhZGRpbmc6IDBweCAycHg7XCIgW3N0eWxlLmhlaWdodC5weF09XCJtb2RlbC5vcHRpb25zLnBhcmFtZXRlclJvd0hlaWdodFwiPlxyXG4gICAgICAgICAgICAgICAgPHN0aS1wYXJhbWV0ZXItY2hlY2tib3ggW3BhcmFtc109XCJwYXJhbXNcIiBbaXNFbmFibGVkXT1cInBhcmFtcy5hbGxvd1VzZXJWYWx1ZXNcIiAoYWN0aW9uKT1cIm51bGxhYmxlQWN0aW9uKCRldmVudClcIiBbbnVsbGFibGVdPVwidHJ1ZVwiID5cclxuICAgICAgICAgICAgICAgIDwvc3RpLXBhcmFtZXRlci1jaGVja2JveD5cclxuICAgICAgICAgICAgPC90ZD5cclxuXHJcbiAgICAgICAgICAgIDx0ZCAqbmdJZj1cInBhcmFtcy5iYXNpY1R5cGUgPT0gJ051bGxhYmxlVmFsdWUnICYmIHBhcmFtcy5hbGxvd1VzZXJWYWx1ZXNcIlxyXG4gICAgICAgICAgICAgICAgc3R5bGU9XCJwYWRkaW5nOiAwcHhcIiBbc3R5bGUuaGVpZ2h0LnB4XT1cIm1vZGVsLm9wdGlvbnMucGFyYW1ldGVyUm93SGVpZ2h0XCI+XHJcbiAgICAgICAgICAgICAgICB7e21vZGVsLmxvYygnTnVsbCcpfX1cclxuICAgICAgICAgICAgPC90ZD5cclxuXHJcbiAgICAgICAgICA8L3RyPlxyXG4gICAgICAgPC90Ym9keT5cclxuICAgIDwvdGFibGU+XHJcbiAgYFxyXG59KVxyXG5cclxuZXhwb3J0IGNsYXNzIFBhcmFtZXRlckNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XHJcblxyXG4gIEBWaWV3Q2hpbGQoJ2VsZW1lbnQnKSBlbGVtZW50OiBFbGVtZW50UmVmO1xyXG4gIEBWaWV3Q2hpbGQoJ2ZpcnN0RGF0ZVRpbWVCdXR0b24nKSBmaXJzdERhdGVUaW1lQnV0dG9uOiBFbGVtZW50UmVmO1xyXG4gIEBWaWV3Q2hpbGQoJ2RvdWJsZURhdGVUaW1lQnV0dG9uJykgZG91YmxlRGF0ZVRpbWVCdXR0b246IEVsZW1lbnRSZWY7XHJcbiAgQFZpZXdDaGlsZCgncmFuZ2VGcm9tJykgcmFuZ2VGcm9tOiBFbGVtZW50UmVmO1xyXG5cclxuICBwcml2YXRlIF9wYXJhbXM6IFZhcmlhYmxlO1xyXG5cclxuICBjb25zdHJ1Y3RvcihwdWJsaWMgbW9kZWw6IE1vZGVsU2VydmljZSwgcHVibGljIGhlbHBlcjogSGVscGVyU2VydmljZSwgcHVibGljIG1lbnVTZXJ2aWNlOiBNZW51U2VydmljZSkgeyB9XHJcblxyXG4gIG5nT25Jbml0KCkgeyB9XHJcblxyXG4gIEBJbnB1dCgpIGdldCBwYXJhbXMoKTogVmFyaWFibGUge1xyXG4gICAgcmV0dXJuIHRoaXMuX3BhcmFtcztcclxuICB9XHJcblxyXG4gIHNldCBwYXJhbXMocGFyYW1zOiBWYXJpYWJsZSkge1xyXG4gICAgdGhpcy5fcGFyYW1zID0gcGFyYW1zO1xyXG5cclxuICAgIGlmIChwYXJhbXMuYmFzaWNUeXBlID09PSAnUmFuZ2UnKSB7XHJcbiAgICAgIGlmIChwYXJhbXMudHlwZSA9PT0gJ0RhdGVUaW1lJyAmJiBwYXJhbXMua2V5VG8gJiYgcGFyYW1zLmtleVRvLmlzTnVsbCkge1xyXG4gICAgICAgIHBhcmFtcy5rZXlUbyA9IHRoaXMuaGVscGVyLmdldERhdGVUaW1lT2JqZWN0KG5ldyBEYXRlKCkpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBnZXQgc2hvd1BhcmFtZXRlckluVHdvUm93cygpOiBib29sZWFuIHtcclxuICAgIHJldHVybiB0aGlzLnBhcmFtcy5iYXNpY1R5cGUgPT09ICdSYW5nZScgJiYgdGhpcy5tb2RlbC5vcHRpb25zLmFwcGVhcmFuY2UucGFyYW1ldGVyc1BhbmVsUG9zaXRpb24gPT09ICdMZWZ0JztcclxuICB9XHJcblxyXG4gIGdldFJlYWRPbmx5Q2hlY2tib3goKTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gdGhpcy5wYXJhbXMuYmFzaWNUeXBlID09PSAnTGlzdCcgfHwgIXRoaXMucGFyYW1zLmFsbG93VXNlclZhbHVlcztcclxuICB9XHJcblxyXG4gIGdldEZpcnN0VGV4dEJveFZhbHVlKCk6IHN0cmluZyB7XHJcbiAgICBsZXQgdmFsdWUgPSAnJztcclxuICAgIGlmICh0aGlzLnBhcmFtcy5iYXNpY1R5cGUgPT09ICdWYWx1ZScgfHwgdGhpcy5wYXJhbXMuYmFzaWNUeXBlID09PSAnTnVsbGFibGVWYWx1ZScpIHtcclxuICAgICAgaWYgKHRoaXMucGFyYW1zLnR5cGUgPT09ICdEYXRlVGltZScgJiYgdGhpcy5wYXJhbXMudmFsdWUgPT09IG51bGwpIHtcclxuICAgICAgICB0aGlzLnBhcmFtcy52YWx1ZSA9IG5ldyBEYXRlKCk7XHJcbiAgICAgICAgdGhpcy5wYXJhbXMua2V5ID0gdGhpcy5oZWxwZXIuZ2V0RGF0ZVRpbWVPYmplY3QodGhpcy5wYXJhbXMudmFsdWUpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICB2YWx1ZSA9ICh0aGlzLnBhcmFtcy50eXBlID09PSAnRGF0ZVRpbWUnKSA/IHRoaXMuaGVscGVyLmdldFN0cmluZ0tleSh0aGlzLnBhcmFtcy5rZXksIHRoaXMucGFyYW1zKSA6IHRoaXMucGFyYW1zLnZhbHVlO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFJhbmdlXHJcbiAgICBpZiAodGhpcy5wYXJhbXMuYmFzaWNUeXBlID09PSAnUmFuZ2UnKSB7XHJcbiAgICAgIGlmICh0aGlzLnBhcmFtcy50eXBlID09PSAnRGF0ZVRpbWUnICYmIHRoaXMucGFyYW1zLmtleSAmJiB0aGlzLnBhcmFtcy5rZXkuaXNOdWxsKSB7XHJcbiAgICAgICAgdGhpcy5wYXJhbXMua2V5ID0gdGhpcy5oZWxwZXIuZ2V0RGF0ZVRpbWVPYmplY3QobmV3IERhdGUoKSk7XHJcbiAgICAgIH1cclxuICAgICAgdmFsdWUgPSB0aGlzLmhlbHBlci5nZXRTdHJpbmdLZXkodGhpcy5wYXJhbXMua2V5LCB0aGlzLnBhcmFtcyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gTGlzdFxyXG4gICAgaWYgKHRoaXMucGFyYW1zLmJhc2ljVHlwZSA9PT0gJ0xpc3QnICYmIHRoaXMucGFyYW1zLml0ZW1zKSB7XHJcbiAgICAgIHRoaXMucGFyYW1zLml0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcclxuICAgICAgICBpZiAoaXRlbS5pc0NoZWNrZWQpIHtcclxuICAgICAgICAgIGlmICh2YWx1ZSAhPT0gJycpIHtcclxuICAgICAgICAgICAgdmFsdWUgKz0gKHRoaXMubW9kZWwub3B0aW9ucy5saXN0U2VwYXJhdG9yID8gdGhpcy5tb2RlbC5vcHRpb25zLmxpc3RTZXBhcmF0b3IgKyBcIiBcIiA6IFwiOyBcIik7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgaWYgKHRoaXMucGFyYW1zLmFsbG93VXNlclZhbHVlcykge1xyXG4gICAgICAgICAgICB2YWx1ZSArPSB0aGlzLmhlbHBlci5nZXRTdHJpbmdLZXkoaXRlbS5rZXksIHRoaXMucGFyYW1zKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHZhbHVlICs9IGl0ZW0udmFsdWUgIT09ICcnID8gaXRlbS52YWx1ZSA6IHRoaXMuaGVscGVyLmdldFN0cmluZ0tleShpdGVtLmtleSwgdGhpcy5wYXJhbXMpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHZhbHVlICE9IG51bGwgPyB2YWx1ZS50b1N0cmluZygpIDogdmFsdWU7XHJcbiAgfVxyXG5cclxuICBudWxsYWJsZUFjdGlvbihjaGVja2VkOiBib29sZWFuKSB7XHJcbiAgICB0aGlzLnBhcmFtcy5pc051bGwgPSAhdGhpcy5wYXJhbXMuaXNOdWxsO1xyXG4gIH1cclxuXHJcbiAgZmlyc3RHdWlkQWN0aW9uKCkge1xyXG4gICAgaWYgKHRoaXMucGFyYW1zLmJhc2ljVHlwZSA9PT0gJ1JhbmdlJykge1xyXG4gICAgICB0aGlzLnBhcmFtcy5rZXkgPSB0aGlzLmhlbHBlci5uZXdHdWlkKCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLnBhcmFtcy52YWx1ZSA9IHRoaXMuaGVscGVyLm5ld0d1aWQoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGRvdWJsZURhdGVUaW1lQWN0aW9uKGV2ZW50OiBhbnkpIHtcclxuICAgIHRoaXMubWVudVNlcnZpY2UuYWRkTWVudSh7XHJcbiAgICAgIHR5cGU6ICdkb3VibGVEYXRlUGlja2VyTWVudScsIG5hbWU6ICdkb3VibGVEYXRlUGlja2VyTWVudScsIGl0ZW1zOiBbXSwgcGFyZW50OiB0aGlzLnJhbmdlRnJvbSxcclxuICAgICAgcGFyYW1zOiB0aGlzLnBhcmFtc1xyXG4gICAgfSk7XHJcblxyXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgIHRoaXMubWVudVNlcnZpY2Uuc2hvd01lbnUoJ2RvdWJsZURhdGVQaWNrZXJNZW51Jyk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGZpcnN0RGF0ZVRpbWVBY3Rpb24oZXZlbnQ6IGFueSkge1xyXG4gICAgdGhpcy5tZW51U2VydmljZS5hZGRNZW51KHtcclxuICAgICAgdHlwZTogJ2RhdGVQaWNrZXJNZW51JywgbmFtZTogJ2RhdGVQaWNrZXJNZW51JywgaXRlbXM6IFtdLCBwYXJlbnQ6IHRoaXMuZmlyc3REYXRlVGltZUJ1dHRvbixcclxuICAgICAgcGFyYW1zOiB0aGlzLnBhcmFtc1xyXG4gICAgfSk7XHJcblxyXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgIHRoaXMubWVudVNlcnZpY2Uuc2hvd01lbnUoJ2RhdGVQaWNrZXJNZW51Jyk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGRyb3BEb3duQnV0dG9uQWN0aW9uKGV2ZW50OiBhbnkpIHtcclxuICAgIGxldCBtZW51VHlwZSA9ICdwYXJhbWV0ZXJNZW51Rm9yVmFsdWUnO1xyXG4gICAgc3dpdGNoICh0aGlzLnBhcmFtcy5iYXNpY1R5cGUpIHtcclxuICAgICAgY2FzZSAnUmFuZ2UnOlxyXG4gICAgICAgIG1lbnVUeXBlID0gJ3BhcmFtZXRlck1lbnVGb3JSYW5nZSc7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgJ0xpc3QnOlxyXG4gICAgICAgIG1lbnVUeXBlID0gdGhpcy5wYXJhbXMuYWxsb3dVc2VyVmFsdWVzID8gJ3BhcmFtZXRlck1lbnVGb3JFZGl0TGlzdCcgOiAncGFyYW1ldGVyTWVudUZvck5vdEVkaXRMaXN0JztcclxuICAgICAgICBicmVhaztcclxuICAgIH1cclxuXHJcbiAgICBpZiAodGhpcy5wYXJhbXMuaXRlbXMpIHtcclxuICAgICAgdGhpcy5wYXJhbXMuaXRlbXMuZm9yRWFjaChpID0+IGkudmlzaWJsZSA9IHRydWUpO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMubWVudVNlcnZpY2UuYWRkTWVudSh7XHJcbiAgICAgIHR5cGU6IG1lbnVUeXBlLCBuYW1lOiAncGFyYW1ldGVyTWVudScsIGl0ZW1zOiBbXSwgcGFyZW50OiB0aGlzLmVsZW1lbnQsXHJcbiAgICAgIHBhcmFtczogdGhpcy5wYXJhbXNcclxuICAgIH0pO1xyXG5cclxuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICB0aGlzLm1lbnVTZXJ2aWNlLnNob3dNZW51KCdwYXJhbWV0ZXJNZW51Jyk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIl19