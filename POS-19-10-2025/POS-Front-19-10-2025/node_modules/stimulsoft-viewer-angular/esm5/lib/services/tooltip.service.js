import { __decorate } from "tslib";
import { Injectable } from '@angular/core';
import { ModelService } from './model.service';
import { MenuService } from '../menu/menu.service';
var TooltipService = /** @class */ (function () {
    function TooltipService(model, menuService) {
        this.model = model;
        this.menuService = menuService;
        this.state = 'initial';
        this.caption = '';
        this.helpLink = '';
        this.top = 0;
        this.left = 0;
        this.innerState = 'initial';
    }
    TooltipService.prototype.show = function (left, top, caption, below, helpLink) {
        var _this = this;
        if (below === void 0) { below = true; }
        if (this.menuService.isMenuVisible() || !this.model.options.appearance.showTooltips) {
            this.hideImmediately();
            return;
        }
        if (this.caption === caption && this.helpLink === helpLink && this.state !== 'initial') {
            this.showInternal();
            return;
        }
        this.caption = caption;
        this.helpLink = helpLink;
        this.state = this.innerState = this.state !== 'expanded' ? 'preInitial' : 'preInitial2';
        setTimeout(function () {
            var tooltip = _this.model.controls.tooltip.el.nativeElement;
            var browserWidth = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;
            if (!below) {
                top -= tooltip.offsetHeight;
            }
            if (left + tooltip.offsetWidth > browserWidth) {
                left = browserWidth - tooltip.offsetWidth;
            }
            _this.left = left;
            _this.top = top;
            if (_this.innerState !== 'initial') {
                _this.showInternal();
            }
        });
    };
    TooltipService.prototype.showInternal = function () {
        this.state = 'expanded';
        this.innerState = 'expanded';
    };
    TooltipService.prototype.showFromTooltip = function () {
        if (this.state !== 'preInitial') {
            this.state = 'expanded';
            this.innerState = 'expanded';
        }
    };
    TooltipService.prototype.hideImmediately = function () {
        this.innerState = 'initial';
        this.state = 'initial';
    };
    TooltipService.prototype.hide = function () {
        var _this = this;
        this.innerState = 'initial';
        if (this.timeout) {
            clearTimeout(this.timeout);
        }
        this.timeout = setTimeout(function () {
            if (_this.innerState === 'initial') {
                _this.state = 'initial';
            }
            _this.timeout = null;
        }, 1000);
    };
    TooltipService.ctorParameters = function () { return [
        { type: ModelService },
        { type: MenuService }
    ]; };
    TooltipService = __decorate([
        Injectable()
    ], TooltipService);
    return TooltipService;
}());
export { TooltipService };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidG9vbHRpcC5zZXJ2aWNlLmpzIiwic291cmNlUm9vdCI6Im5nOi8vc3RpbXVsc29mdC12aWV3ZXItYW5ndWxhci8iLCJzb3VyY2VzIjpbImxpYi9zZXJ2aWNlcy90b29sdGlwLnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDM0MsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBQy9DLE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQUduRDtJQVdFLHdCQUFtQixLQUFtQixFQUFTLFdBQXdCO1FBQXBELFVBQUssR0FBTCxLQUFLLENBQWM7UUFBUyxnQkFBVyxHQUFYLFdBQVcsQ0FBYTtRQVRoRSxVQUFLLEdBQUcsU0FBUyxDQUFDO1FBQ2xCLFlBQU8sR0FBRyxFQUFFLENBQUM7UUFDYixhQUFRLEdBQUcsRUFBRSxDQUFDO1FBQ2QsUUFBRyxHQUFHLENBQUMsQ0FBQztRQUNSLFNBQUksR0FBRyxDQUFDLENBQUM7UUFFUixlQUFVLEdBQUcsU0FBUyxDQUFDO0lBRzRDLENBQUM7SUFFckUsNkJBQUksR0FBWCxVQUFZLElBQVksRUFBRSxHQUFXLEVBQUUsT0FBZSxFQUFFLEtBQXFCLEVBQUUsUUFBaUI7UUFBaEcsaUJBK0JDO1FBL0J1RCxzQkFBQSxFQUFBLFlBQXFCO1FBQzNFLElBQUksSUFBSSxDQUFDLFdBQVcsQ0FBQyxhQUFhLEVBQUUsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQyxZQUFZLEVBQUU7WUFDbkYsSUFBSSxDQUFDLGVBQWUsRUFBRSxDQUFDO1lBQ3ZCLE9BQU87U0FDUjtRQUVELElBQUksSUFBSSxDQUFDLE9BQU8sS0FBSyxPQUFPLElBQUksSUFBSSxDQUFDLFFBQVEsS0FBSyxRQUFRLElBQUksSUFBSSxDQUFDLEtBQUssS0FBSyxTQUFTLEVBQUU7WUFDdEYsSUFBSSxDQUFDLFlBQVksRUFBRSxDQUFDO1lBQ3BCLE9BQU87U0FDUjtRQUVELElBQUksQ0FBQyxPQUFPLEdBQUcsT0FBTyxDQUFDO1FBQ3ZCLElBQUksQ0FBQyxRQUFRLEdBQUcsUUFBUSxDQUFDO1FBQ3pCLElBQUksQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDLFVBQVUsR0FBRyxJQUFJLENBQUMsS0FBSyxLQUFLLFVBQVUsQ0FBQyxDQUFDLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxhQUFhLENBQUM7UUFFeEYsVUFBVSxDQUFDO1lBQ1QsSUFBTSxPQUFPLEdBQUcsS0FBSSxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQyxhQUFhLENBQUM7WUFDN0QsSUFBTSxZQUFZLEdBQUcsTUFBTSxDQUFDLFVBQVUsSUFBSSxRQUFRLENBQUMsZUFBZSxDQUFDLFdBQVcsSUFBSSxRQUFRLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQztZQUM1RyxJQUFJLENBQUMsS0FBSyxFQUFFO2dCQUNWLEdBQUcsSUFBSSxPQUFPLENBQUMsWUFBWSxDQUFDO2FBQzdCO1lBQ0QsSUFBSSxJQUFJLEdBQUcsT0FBTyxDQUFDLFdBQVcsR0FBRyxZQUFZLEVBQUU7Z0JBQzdDLElBQUksR0FBRyxZQUFZLEdBQUcsT0FBTyxDQUFDLFdBQVcsQ0FBQzthQUMzQztZQUVELEtBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDO1lBQ2pCLEtBQUksQ0FBQyxHQUFHLEdBQUcsR0FBRyxDQUFDO1lBQ2YsSUFBSSxLQUFJLENBQUMsVUFBVSxLQUFLLFNBQVMsRUFBRTtnQkFDakMsS0FBSSxDQUFDLFlBQVksRUFBRSxDQUFDO2FBQ3JCO1FBQ0gsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDO0lBRU8scUNBQVksR0FBcEI7UUFDRSxJQUFJLENBQUMsS0FBSyxHQUFHLFVBQVUsQ0FBQztRQUN4QixJQUFJLENBQUMsVUFBVSxHQUFHLFVBQVUsQ0FBQztJQUMvQixDQUFDO0lBRU0sd0NBQWUsR0FBdEI7UUFDRSxJQUFJLElBQUksQ0FBQyxLQUFLLEtBQUssWUFBWSxFQUFFO1lBQy9CLElBQUksQ0FBQyxLQUFLLEdBQUcsVUFBVSxDQUFDO1lBQ3hCLElBQUksQ0FBQyxVQUFVLEdBQUcsVUFBVSxDQUFDO1NBQzlCO0lBQ0gsQ0FBQztJQUVNLHdDQUFlLEdBQXRCO1FBQ0UsSUFBSSxDQUFDLFVBQVUsR0FBRyxTQUFTLENBQUM7UUFDNUIsSUFBSSxDQUFDLEtBQUssR0FBRyxTQUFTLENBQUM7SUFDekIsQ0FBQztJQUVNLDZCQUFJLEdBQVg7UUFBQSxpQkFXQztRQVZDLElBQUksQ0FBQyxVQUFVLEdBQUcsU0FBUyxDQUFDO1FBQzVCLElBQUksSUFBSSxDQUFDLE9BQU8sRUFBRTtZQUNoQixZQUFZLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1NBQzVCO1FBQ0QsSUFBSSxDQUFDLE9BQU8sR0FBRyxVQUFVLENBQUM7WUFDeEIsSUFBSSxLQUFJLENBQUMsVUFBVSxLQUFLLFNBQVMsRUFBRTtnQkFDakMsS0FBSSxDQUFDLEtBQUssR0FBRyxTQUFTLENBQUM7YUFDeEI7WUFDRCxLQUFJLENBQUMsT0FBTyxHQUFHLElBQUksQ0FBQztRQUN0QixDQUFDLEVBQUUsSUFBSSxDQUFDLENBQUM7SUFDWCxDQUFDOztnQkEvRHlCLFlBQVk7Z0JBQXNCLFdBQVc7O0lBWDVELGNBQWM7UUFEMUIsVUFBVSxFQUFFO09BQ0EsY0FBYyxDQTRFMUI7SUFBRCxxQkFBQztDQUFBLEFBNUVELElBNEVDO1NBNUVZLGNBQWMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IE1vZGVsU2VydmljZSB9IGZyb20gJy4vbW9kZWwuc2VydmljZSc7XHJcbmltcG9ydCB7IE1lbnVTZXJ2aWNlIH0gZnJvbSAnLi4vbWVudS9tZW51LnNlcnZpY2UnO1xyXG5cclxuQEluamVjdGFibGUoKVxyXG5leHBvcnQgY2xhc3MgVG9vbHRpcFNlcnZpY2Uge1xyXG5cclxuICBwdWJsaWMgc3RhdGUgPSAnaW5pdGlhbCc7XHJcbiAgcHVibGljIGNhcHRpb24gPSAnJztcclxuICBwdWJsaWMgaGVscExpbmsgPSAnJztcclxuICBwdWJsaWMgdG9wID0gMDtcclxuICBwdWJsaWMgbGVmdCA9IDA7XHJcblxyXG4gIHByaXZhdGUgaW5uZXJTdGF0ZSA9ICdpbml0aWFsJztcclxuICBwcml2YXRlIHRpbWVvdXQ6IGFueTtcclxuXHJcbiAgY29uc3RydWN0b3IocHVibGljIG1vZGVsOiBNb2RlbFNlcnZpY2UsIHB1YmxpYyBtZW51U2VydmljZTogTWVudVNlcnZpY2UpIHsgfVxyXG5cclxuICBwdWJsaWMgc2hvdyhsZWZ0OiBudW1iZXIsIHRvcDogbnVtYmVyLCBjYXB0aW9uOiBzdHJpbmcsIGJlbG93OiBib29sZWFuID0gdHJ1ZSwgaGVscExpbms/OiBzdHJpbmcpIHtcclxuICAgIGlmICh0aGlzLm1lbnVTZXJ2aWNlLmlzTWVudVZpc2libGUoKSB8fCAhdGhpcy5tb2RlbC5vcHRpb25zLmFwcGVhcmFuY2Uuc2hvd1Rvb2x0aXBzKSB7XHJcbiAgICAgIHRoaXMuaGlkZUltbWVkaWF0ZWx5KCk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICBpZiAodGhpcy5jYXB0aW9uID09PSBjYXB0aW9uICYmIHRoaXMuaGVscExpbmsgPT09IGhlbHBMaW5rICYmIHRoaXMuc3RhdGUgIT09ICdpbml0aWFsJykge1xyXG4gICAgICB0aGlzLnNob3dJbnRlcm5hbCgpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5jYXB0aW9uID0gY2FwdGlvbjtcclxuICAgIHRoaXMuaGVscExpbmsgPSBoZWxwTGluaztcclxuICAgIHRoaXMuc3RhdGUgPSB0aGlzLmlubmVyU3RhdGUgPSB0aGlzLnN0YXRlICE9PSAnZXhwYW5kZWQnID8gJ3ByZUluaXRpYWwnIDogJ3ByZUluaXRpYWwyJztcclxuXHJcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgY29uc3QgdG9vbHRpcCA9IHRoaXMubW9kZWwuY29udHJvbHMudG9vbHRpcC5lbC5uYXRpdmVFbGVtZW50O1xyXG4gICAgICBjb25zdCBicm93c2VyV2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aCB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGggfHwgZG9jdW1lbnQuYm9keS5jbGllbnRXaWR0aDtcclxuICAgICAgaWYgKCFiZWxvdykge1xyXG4gICAgICAgIHRvcCAtPSB0b29sdGlwLm9mZnNldEhlaWdodDtcclxuICAgICAgfVxyXG4gICAgICBpZiAobGVmdCArIHRvb2x0aXAub2Zmc2V0V2lkdGggPiBicm93c2VyV2lkdGgpIHtcclxuICAgICAgICBsZWZ0ID0gYnJvd3NlcldpZHRoIC0gdG9vbHRpcC5vZmZzZXRXaWR0aDtcclxuICAgICAgfVxyXG5cclxuICAgICAgdGhpcy5sZWZ0ID0gbGVmdDtcclxuICAgICAgdGhpcy50b3AgPSB0b3A7XHJcbiAgICAgIGlmICh0aGlzLmlubmVyU3RhdGUgIT09ICdpbml0aWFsJykge1xyXG4gICAgICAgIHRoaXMuc2hvd0ludGVybmFsKCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBzaG93SW50ZXJuYWwoKSB7XHJcbiAgICB0aGlzLnN0YXRlID0gJ2V4cGFuZGVkJztcclxuICAgIHRoaXMuaW5uZXJTdGF0ZSA9ICdleHBhbmRlZCc7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgc2hvd0Zyb21Ub29sdGlwKCkge1xyXG4gICAgaWYgKHRoaXMuc3RhdGUgIT09ICdwcmVJbml0aWFsJykge1xyXG4gICAgICB0aGlzLnN0YXRlID0gJ2V4cGFuZGVkJztcclxuICAgICAgdGhpcy5pbm5lclN0YXRlID0gJ2V4cGFuZGVkJztcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHB1YmxpYyBoaWRlSW1tZWRpYXRlbHkoKSB7XHJcbiAgICB0aGlzLmlubmVyU3RhdGUgPSAnaW5pdGlhbCc7XHJcbiAgICB0aGlzLnN0YXRlID0gJ2luaXRpYWwnO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGhpZGUoKSB7XHJcbiAgICB0aGlzLmlubmVyU3RhdGUgPSAnaW5pdGlhbCc7XHJcbiAgICBpZiAodGhpcy50aW1lb3V0KSB7XHJcbiAgICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVvdXQpO1xyXG4gICAgfVxyXG4gICAgdGhpcy50aW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgIGlmICh0aGlzLmlubmVyU3RhdGUgPT09ICdpbml0aWFsJykge1xyXG4gICAgICAgIHRoaXMuc3RhdGUgPSAnaW5pdGlhbCc7XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy50aW1lb3V0ID0gbnVsbDtcclxuICAgIH0sIDEwMDApO1xyXG4gIH1cclxuXHJcbn1cclxuIl19