import { __decorate } from "tslib";
import { Injectable } from '@angular/core';
import { ModelService } from './model.service';
var AnimationService = /** @class */ (function () {
    function AnimationService(model) {
        this.model = model;
    }
    AnimationService.prototype.showAnimationForScroll = function (reportPanel, finishScrollTop, endTime, completeFunction) {
        var _this = this;
        if (!reportPanel) {
            return;
        }
        var currentScrollTop = 0;
        if (this.model.options.appearance.scrollbarsMode) {
            currentScrollTop = reportPanel.scrollTop;
        }
        else {
            currentScrollTop = document.documentElement.scrollTop;
            if (currentScrollTop === 0) {
                currentScrollTop = document.getElementsByTagName('BODY')[0].scrollTop;
            }
        }
        clearTimeout(reportPanel.animationTimer);
        var d = new Date();
        var t = d.getTime();
        var step = Math.round((finishScrollTop - currentScrollTop) / ((Math.abs(endTime - t) + 1) / 30));
        // Last step
        if (Math.abs(step) > Math.abs(finishScrollTop - currentScrollTop)) {
            step = finishScrollTop - currentScrollTop;
        }
        currentScrollTop += step;
        var resultScrollTop;
        if (t < endTime) {
            resultScrollTop = currentScrollTop;
            reportPanel.animationTimer = setTimeout(function () {
                _this.showAnimationForScroll(reportPanel, finishScrollTop, endTime, completeFunction);
            }, 30);
        }
        else {
            resultScrollTop = finishScrollTop;
            if (completeFunction) {
                completeFunction();
            }
        }
        if (this.model.options.appearance.scrollbarsMode) {
            reportPanel.scrollTop = resultScrollTop;
        }
        else {
            window.scrollTo(0, resultScrollTop);
        }
    };
    AnimationService.ctorParameters = function () { return [
        { type: ModelService }
    ]; };
    AnimationService = __decorate([
        Injectable()
    ], AnimationService);
    return AnimationService;
}());
export { AnimationService };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYW5pbWF0aW9uLnNlcnZpY2UuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9zdGltdWxzb2Z0LXZpZXdlci1hbmd1bGFyLyIsInNvdXJjZXMiOlsibGliL3NlcnZpY2VzL2FuaW1hdGlvbi5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQzNDLE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUcvQztJQUNFLDBCQUFvQixLQUFtQjtRQUFuQixVQUFLLEdBQUwsS0FBSyxDQUFjO0lBQUksQ0FBQztJQUVyQyxpREFBc0IsR0FBN0IsVUFBOEIsV0FBVyxFQUFFLGVBQWUsRUFBRSxPQUFPLEVBQUUsZ0JBQWdCO1FBQXJGLGlCQTRDQztRQTNDQyxJQUFJLENBQUMsV0FBVyxFQUFFO1lBQ2hCLE9BQU87U0FDUjtRQUNELElBQUksZ0JBQWdCLEdBQUcsQ0FBQyxDQUFDO1FBQ3pCLElBQUksSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFDLGNBQWMsRUFBRTtZQUNoRCxnQkFBZ0IsR0FBRyxXQUFXLENBQUMsU0FBUyxDQUFDO1NBQzFDO2FBQU07WUFDTCxnQkFBZ0IsR0FBRyxRQUFRLENBQUMsZUFBZSxDQUFDLFNBQVMsQ0FBQztZQUN0RCxJQUFJLGdCQUFnQixLQUFLLENBQUMsRUFBRTtnQkFDMUIsZ0JBQWdCLEdBQUcsUUFBUSxDQUFDLG9CQUFvQixDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQzthQUN2RTtTQUNGO1FBRUQsWUFBWSxDQUFDLFdBQVcsQ0FBQyxjQUFjLENBQUMsQ0FBQztRQUN6QyxJQUFNLENBQUMsR0FBRyxJQUFJLElBQUksRUFBRSxDQUFDO1FBQ3JCLElBQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxPQUFPLEVBQUUsQ0FBQztRQUN0QixJQUFJLElBQUksR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsZUFBZSxHQUFHLGdCQUFnQixDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsT0FBTyxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDLENBQUM7UUFFakcsWUFBWTtRQUNaLElBQUksSUFBSSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLGVBQWUsR0FBRyxnQkFBZ0IsQ0FBQyxFQUFFO1lBQ2pFLElBQUksR0FBRyxlQUFlLEdBQUcsZ0JBQWdCLENBQUM7U0FDM0M7UUFFRCxnQkFBZ0IsSUFBSSxJQUFJLENBQUM7UUFDekIsSUFBSSxlQUF1QixDQUFDO1FBRTVCLElBQUksQ0FBQyxHQUFHLE9BQU8sRUFBRTtZQUNmLGVBQWUsR0FBRyxnQkFBZ0IsQ0FBQztZQUNuQyxXQUFXLENBQUMsY0FBYyxHQUFHLFVBQVUsQ0FBQztnQkFDdEMsS0FBSSxDQUFDLHNCQUFzQixDQUFDLFdBQVcsRUFBRSxlQUFlLEVBQUUsT0FBTyxFQUFFLGdCQUFnQixDQUFDLENBQUM7WUFDdkYsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDO1NBQ1I7YUFBTTtZQUNMLGVBQWUsR0FBRyxlQUFlLENBQUM7WUFDbEMsSUFBSSxnQkFBZ0IsRUFBRTtnQkFDcEIsZ0JBQWdCLEVBQUUsQ0FBQzthQUNwQjtTQUNGO1FBRUQsSUFBSSxJQUFJLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxVQUFVLENBQUMsY0FBYyxFQUFFO1lBQ2hELFdBQVcsQ0FBQyxTQUFTLEdBQUcsZUFBZSxDQUFDO1NBQ3pDO2FBQU07WUFDTCxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsRUFBRSxlQUFlLENBQUMsQ0FBQztTQUNyQztJQUNILENBQUM7O2dCQTlDMEIsWUFBWTs7SUFENUIsZ0JBQWdCO1FBRDVCLFVBQVUsRUFBRTtPQUNBLGdCQUFnQixDQWlENUI7SUFBRCx1QkFBQztDQUFBLEFBakRELElBaURDO1NBakRZLGdCQUFnQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgTW9kZWxTZXJ2aWNlIH0gZnJvbSAnLi9tb2RlbC5zZXJ2aWNlJztcclxuXHJcbkBJbmplY3RhYmxlKClcclxuZXhwb3J0IGNsYXNzIEFuaW1hdGlvblNlcnZpY2Uge1xyXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgbW9kZWw6IE1vZGVsU2VydmljZSkgeyB9XHJcblxyXG4gIHB1YmxpYyBzaG93QW5pbWF0aW9uRm9yU2Nyb2xsKHJlcG9ydFBhbmVsLCBmaW5pc2hTY3JvbGxUb3AsIGVuZFRpbWUsIGNvbXBsZXRlRnVuY3Rpb24pIHtcclxuICAgIGlmICghcmVwb3J0UGFuZWwpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgbGV0IGN1cnJlbnRTY3JvbGxUb3AgPSAwO1xyXG4gICAgaWYgKHRoaXMubW9kZWwub3B0aW9ucy5hcHBlYXJhbmNlLnNjcm9sbGJhcnNNb2RlKSB7XHJcbiAgICAgIGN1cnJlbnRTY3JvbGxUb3AgPSByZXBvcnRQYW5lbC5zY3JvbGxUb3A7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBjdXJyZW50U2Nyb2xsVG9wID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcDtcclxuICAgICAgaWYgKGN1cnJlbnRTY3JvbGxUb3AgPT09IDApIHtcclxuICAgICAgICBjdXJyZW50U2Nyb2xsVG9wID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ0JPRFknKVswXS5zY3JvbGxUb3A7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBjbGVhclRpbWVvdXQocmVwb3J0UGFuZWwuYW5pbWF0aW9uVGltZXIpO1xyXG4gICAgY29uc3QgZCA9IG5ldyBEYXRlKCk7XHJcbiAgICBjb25zdCB0ID0gZC5nZXRUaW1lKCk7XHJcbiAgICBsZXQgc3RlcCA9IE1hdGgucm91bmQoKGZpbmlzaFNjcm9sbFRvcCAtIGN1cnJlbnRTY3JvbGxUb3ApIC8gKChNYXRoLmFicyhlbmRUaW1lIC0gdCkgKyAxKSAvIDMwKSk7XHJcblxyXG4gICAgLy8gTGFzdCBzdGVwXHJcbiAgICBpZiAoTWF0aC5hYnMoc3RlcCkgPiBNYXRoLmFicyhmaW5pc2hTY3JvbGxUb3AgLSBjdXJyZW50U2Nyb2xsVG9wKSkge1xyXG4gICAgICBzdGVwID0gZmluaXNoU2Nyb2xsVG9wIC0gY3VycmVudFNjcm9sbFRvcDtcclxuICAgIH1cclxuXHJcbiAgICBjdXJyZW50U2Nyb2xsVG9wICs9IHN0ZXA7XHJcbiAgICBsZXQgcmVzdWx0U2Nyb2xsVG9wOiBudW1iZXI7XHJcblxyXG4gICAgaWYgKHQgPCBlbmRUaW1lKSB7XHJcbiAgICAgIHJlc3VsdFNjcm9sbFRvcCA9IGN1cnJlbnRTY3JvbGxUb3A7XHJcbiAgICAgIHJlcG9ydFBhbmVsLmFuaW1hdGlvblRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5zaG93QW5pbWF0aW9uRm9yU2Nyb2xsKHJlcG9ydFBhbmVsLCBmaW5pc2hTY3JvbGxUb3AsIGVuZFRpbWUsIGNvbXBsZXRlRnVuY3Rpb24pO1xyXG4gICAgICB9LCAzMCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXN1bHRTY3JvbGxUb3AgPSBmaW5pc2hTY3JvbGxUb3A7XHJcbiAgICAgIGlmIChjb21wbGV0ZUZ1bmN0aW9uKSB7XHJcbiAgICAgICAgY29tcGxldGVGdW5jdGlvbigpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHRoaXMubW9kZWwub3B0aW9ucy5hcHBlYXJhbmNlLnNjcm9sbGJhcnNNb2RlKSB7XHJcbiAgICAgIHJlcG9ydFBhbmVsLnNjcm9sbFRvcCA9IHJlc3VsdFNjcm9sbFRvcDtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHdpbmRvdy5zY3JvbGxUbygwLCByZXN1bHRTY3JvbGxUb3ApO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbn1cclxuIl19