import { __decorate } from "tslib";
import { Component, Input, ViewChild } from '@angular/core';
import { ModelService } from '../services/model.service';
import { Menu, MenuService } from './menu.service';
import { HelperService } from '../services/helper.service';
import { Variable } from '../services/objects';
var ParameterMenuEditListComponent = /** @class */ (function () {
    function ParameterMenuEditListComponent(model, helper, menuService) {
        this.model = model;
        this.helper = helper;
        this.menuService = menuService;
    }
    ParameterMenuEditListComponent.prototype.ngOnInit = function () { };
    ParameterMenuEditListComponent.prototype.newItem = function (event) {
        var item = new Variable();
        if (this.menu.params.type === 'DateTime') {
            item.key = this.helper.getDateTimeObject();
            item.value = this.helper.dateTimeObjectToString(item.key);
        }
        else if (this.menu.params.type === 'TimeSpan') {
            item.key = '00:00:00';
            item.value = '00:00:00';
        }
        else if (this.menu.params.type === 'Bool') {
            item.key = 'False';
            item.value = 'False';
        }
        else {
            item.key = '';
            item.value = '';
        }
        item.focusOnCreate = true;
        if (!this.menu.params.items) {
            this.menu.params.items = [];
        }
        this.menu.params.items.push(item);
        setTimeout(function () {
            item.focusOnCreate = false;
        });
    };
    ParameterMenuEditListComponent.prototype.dateTimeButtonAction = function (item) {
        var _this = this;
        this.menuService.addMenu({
            type: 'datePickerMenu', name: 'datePickerMenu', items: [], parent: this.dateTimeButton,
            params: item
        });
        setTimeout(function () {
            _this.menuService.showMenu('datePickerMenu');
        });
    };
    ParameterMenuEditListComponent.prototype.guidButtonAction = function (item) {
        item.key = this.helper.newGuid();
    };
    ParameterMenuEditListComponent.prototype.removeButtonAction = function (item) {
        this.menu.params.items.splice(this.menu.params.items.indexOf(item), 1);
    };
    ParameterMenuEditListComponent.prototype.removeAllAction = function () {
        this.menu.params.items.splice(0, this.menu.params.items.length);
    };
    ParameterMenuEditListComponent.prototype.closeAction = function () {
        this.menu.state = 'initialDown';
    };
    ParameterMenuEditListComponent.ctorParameters = function () { return [
        { type: ModelService },
        { type: HelperService },
        { type: MenuService }
    ]; };
    __decorate([
        ViewChild('dateTimeButton')
    ], ParameterMenuEditListComponent.prototype, "dateTimeButton", void 0);
    __decorate([
        Input()
    ], ParameterMenuEditListComponent.prototype, "menu", void 0);
    ParameterMenuEditListComponent = __decorate([
        Component({
            selector: 'sti-parameter-menu-edit-list',
            template: "\n        <table class=\"stiJsViewerClearAllStyles stiJsViewerParametersMenuInnerTable\" cellpadding=\"0\" cellspacing=\"0\"\n        [style.fontFamily]=\"model.options.toolbar.fontFamily\"\n        [style.color]=\"model.options.toolbar.fontColor\"\n        [style.fontSize]=\"'12px'\"\n        [style.width]=\"(menu.parent.nativeElement.offsetWidth - 5) + 'px'\">\n          <tbody>\n            <tr class=\"stiJsViewerClearAllStyles\">\n              <td class=\"stiJsViewerClearAllStyles\">\n                <!--New Item Button -->\n                <sti-parameter-menu-item (action)=\"newItem($event)\">\n                  {{model.loc('NewItem')}}\n                </sti-parameter-menu-item>\n              </td>\n            </tr>\n            <tr class=\"stiJsViewerClearAllStyles\">\n              <td class=\"stiJsViewerClearAllStyles\">\n                <sti-parameter-menu-item *ngFor=\"let item of menu.params.items\" [active]=\"false\">\n                  <table class=\"stiJsViewerClearAllStyles\" cellpadding=\"0\" cellspacing=\"0\">\n                    <tbody>\n                      <tr class=\"stiJsViewerClearAllStyles\">\n                         <td class=\"stiJsViewerClearAllStyles\" style=\"padding: 0px 1px 0px 0px;\">\n                            <sti-parameter-text-box [item]=\"item\" [isMenu]=\"true\"\n                              [variable]=\"menu.params\" [focusOnCreate]=\"item.focusOnCreate\">\n                            </sti-parameter-text-box>\n                         </td>\n\n                         <td *ngIf=\"menu.params.type == 'DateTime'\" class=\"stiJsViewerClearAllStyles\" style=\"padding: 0 1px 0 1px;\" #dateTimeButton>\n                           <sti-parameter-button [buttonType]=\"'DateTimeButton'\" (action)=\"dateTimeButtonAction(item)\">\n                           </sti-parameter-button>\n                         </td>\n\n                         <td *ngIf=\"menu.params.type == 'Guid'\" class=\"stiJsViewerClearAllStyles\" style=\"padding: 0 1px 0 1px;\">\n                           <sti-parameter-button [buttonType]=\"'GuidButton'\" (action)=\"guidButtonAction(item)\">\n                           </sti-parameter-button>\n                         </td>\n\n                         <td class=\"stiJsViewerClearAllStyles\" style=\"padding: 0 1px 0 1px;\">\n                           <sti-parameter-button [buttonType]=\"'RemoveItemButton'\" (action)=\"removeButtonAction(item)\" [params]=\"item\">\n                           </sti-parameter-button>\n                         </td>\n                       </tr>\n                     </tbody>\n                  </table>\n                </sti-parameter-menu-item>\n              </td>\n            </tr>\n\n            <tr class=\"stiJsViewerClearAllStyles\">\n              <td class=\"stiJsViewerClearAllStyles\">\n                  <sti-parameter-menu-item (action)=\"removeAllAction()\">\n                      {{model.loc('RemoveAll')}}\n                  </sti-parameter-menu-item>\n\n                  <sti-parameter-menu-separator></sti-parameter-menu-separator>\n\n                  <sti-parameter-menu-item (action)=\"closeAction()\">\n                      {{model.loc('Close')}}\n                  </sti-parameter-menu-item>\n              </td>\n            </tr>\n          </tbody>\n        </table>\n  "
        })
    ], ParameterMenuEditListComponent);
    return ParameterMenuEditListComponent;
}());
export { ParameterMenuEditListComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGFyYW1ldGVyLW1lbnUtZWRpdC1saXN0LmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL3N0aW11bHNvZnQtdmlld2VyLWFuZ3VsYXIvIiwic291cmNlcyI6WyJsaWIvbWVudS9wYXJhbWV0ZXItbWVudS1lZGl0LWxpc3QuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFVLEtBQUssRUFBRSxTQUFTLEVBQWMsTUFBTSxlQUFlLENBQUM7QUFDaEYsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLDJCQUEyQixDQUFDO0FBRXpELE9BQU8sRUFBRSxJQUFJLEVBQUUsV0FBVyxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFDbkQsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLDRCQUE0QixDQUFDO0FBQzNELE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQXNFL0M7SUFNRSx3Q0FBbUIsS0FBbUIsRUFBUyxNQUFxQixFQUFTLFdBQXdCO1FBQWxGLFVBQUssR0FBTCxLQUFLLENBQWM7UUFBUyxXQUFNLEdBQU4sTUFBTSxDQUFlO1FBQVMsZ0JBQVcsR0FBWCxXQUFXLENBQWE7SUFBSSxDQUFDO0lBRTFHLGlEQUFRLEdBQVIsY0FBYSxDQUFDO0lBRWQsZ0RBQU8sR0FBUCxVQUFRLEtBQVU7UUFDaEIsSUFBTSxJQUFJLEdBQVEsSUFBSSxRQUFRLEVBQUUsQ0FBQztRQUNqQyxJQUFJLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksS0FBSyxVQUFVLEVBQUU7WUFDeEMsSUFBSSxDQUFDLEdBQUcsR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLGlCQUFpQixFQUFFLENBQUM7WUFDM0MsSUFBSSxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLHNCQUFzQixDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztTQUMzRDthQUFNLElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxLQUFLLFVBQVUsRUFBRTtZQUMvQyxJQUFJLENBQUMsR0FBRyxHQUFHLFVBQVUsQ0FBQztZQUN0QixJQUFJLENBQUMsS0FBSyxHQUFHLFVBQVUsQ0FBQztTQUN6QjthQUFNLElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxLQUFLLE1BQU0sRUFBRTtZQUMzQyxJQUFJLENBQUMsR0FBRyxHQUFHLE9BQU8sQ0FBQztZQUNuQixJQUFJLENBQUMsS0FBSyxHQUFHLE9BQU8sQ0FBQztTQUN0QjthQUFNO1lBQ0wsSUFBSSxDQUFDLEdBQUcsR0FBRyxFQUFFLENBQUM7WUFDZCxJQUFJLENBQUMsS0FBSyxHQUFHLEVBQUUsQ0FBQztTQUNqQjtRQUNELElBQUksQ0FBQyxhQUFhLEdBQUcsSUFBSSxDQUFDO1FBQzFCLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxLQUFLLEVBQUU7WUFDM0IsSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsS0FBSyxHQUFHLEVBQUUsQ0FBQztTQUM3QjtRQUNELElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDbEMsVUFBVSxDQUFDO1lBQ1QsSUFBSSxDQUFDLGFBQWEsR0FBRyxLQUFLLENBQUM7UUFDN0IsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDO0lBRUQsNkRBQW9CLEdBQXBCLFVBQXFCLElBQWM7UUFBbkMsaUJBU0M7UUFSQyxJQUFJLENBQUMsV0FBVyxDQUFDLE9BQU8sQ0FBQztZQUN2QixJQUFJLEVBQUUsZ0JBQWdCLEVBQUUsSUFBSSxFQUFFLGdCQUFnQixFQUFFLEtBQUssRUFBRSxFQUFFLEVBQUUsTUFBTSxFQUFFLElBQUksQ0FBQyxjQUFjO1lBQ3RGLE1BQU0sRUFBRSxJQUFJO1NBQ2IsQ0FBQyxDQUFDO1FBRUgsVUFBVSxDQUFDO1lBQ1QsS0FBSSxDQUFDLFdBQVcsQ0FBQyxRQUFRLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztRQUM5QyxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUM7SUFFRCx5REFBZ0IsR0FBaEIsVUFBaUIsSUFBYztRQUM3QixJQUFJLENBQUMsR0FBRyxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUMsT0FBTyxFQUFFLENBQUM7SUFDbkMsQ0FBQztJQUVELDJEQUFrQixHQUFsQixVQUFtQixJQUFjO1FBQy9CLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztJQUN6RSxDQUFDO0lBRUQsd0RBQWUsR0FBZjtRQUNFLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsQ0FBQyxFQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUNsRSxDQUFDO0lBRUQsb0RBQVcsR0FBWDtRQUNFLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxHQUFHLGFBQWEsQ0FBQztJQUNsQyxDQUFDOztnQkF0RHlCLFlBQVk7Z0JBQWlCLGFBQWE7Z0JBQXNCLFdBQVc7O0lBSnhFO1FBQTVCLFNBQVMsQ0FBQyxnQkFBZ0IsQ0FBQzswRUFBNEI7SUFFL0M7UUFBUixLQUFLLEVBQUU7Z0VBQVk7SUFKVCw4QkFBOEI7UUFwRTFDLFNBQVMsQ0FBQztZQUNULFFBQVEsRUFBRSw4QkFBOEI7WUFDeEMsUUFBUSxFQUFFLDB3R0ErRFQ7U0FDRixDQUFDO09BRVcsOEJBQThCLENBNkQxQztJQUFELHFDQUFDO0NBQUEsQUE3REQsSUE2REM7U0E3RFksOEJBQThCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBPbkluaXQsIElucHV0LCBWaWV3Q2hpbGQsIEVsZW1lbnRSZWYgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgTW9kZWxTZXJ2aWNlIH0gZnJvbSAnLi4vc2VydmljZXMvbW9kZWwuc2VydmljZSc7XHJcbmltcG9ydCB7IE1lbnVJdGVtIH0gZnJvbSAnLi9tZW5pLWl0ZW0uY29tcG9uZW50JztcclxuaW1wb3J0IHsgTWVudSwgTWVudVNlcnZpY2UgfSBmcm9tICcuL21lbnUuc2VydmljZSc7XHJcbmltcG9ydCB7IEhlbHBlclNlcnZpY2UgfSBmcm9tICcuLi9zZXJ2aWNlcy9oZWxwZXIuc2VydmljZSc7XHJcbmltcG9ydCB7IFZhcmlhYmxlIH0gZnJvbSAnLi4vc2VydmljZXMvb2JqZWN0cyc7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogJ3N0aS1wYXJhbWV0ZXItbWVudS1lZGl0LWxpc3QnLFxyXG4gIHRlbXBsYXRlOiBgXHJcbiAgICAgICAgPHRhYmxlIGNsYXNzPVwic3RpSnNWaWV3ZXJDbGVhckFsbFN0eWxlcyBzdGlKc1ZpZXdlclBhcmFtZXRlcnNNZW51SW5uZXJUYWJsZVwiIGNlbGxwYWRkaW5nPVwiMFwiIGNlbGxzcGFjaW5nPVwiMFwiXHJcbiAgICAgICAgW3N0eWxlLmZvbnRGYW1pbHldPVwibW9kZWwub3B0aW9ucy50b29sYmFyLmZvbnRGYW1pbHlcIlxyXG4gICAgICAgIFtzdHlsZS5jb2xvcl09XCJtb2RlbC5vcHRpb25zLnRvb2xiYXIuZm9udENvbG9yXCJcclxuICAgICAgICBbc3R5bGUuZm9udFNpemVdPVwiJzEycHgnXCJcclxuICAgICAgICBbc3R5bGUud2lkdGhdPVwiKG1lbnUucGFyZW50Lm5hdGl2ZUVsZW1lbnQub2Zmc2V0V2lkdGggLSA1KSArICdweCdcIj5cclxuICAgICAgICAgIDx0Ym9keT5cclxuICAgICAgICAgICAgPHRyIGNsYXNzPVwic3RpSnNWaWV3ZXJDbGVhckFsbFN0eWxlc1wiPlxyXG4gICAgICAgICAgICAgIDx0ZCBjbGFzcz1cInN0aUpzVmlld2VyQ2xlYXJBbGxTdHlsZXNcIj5cclxuICAgICAgICAgICAgICAgIDwhLS1OZXcgSXRlbSBCdXR0b24gLS0+XHJcbiAgICAgICAgICAgICAgICA8c3RpLXBhcmFtZXRlci1tZW51LWl0ZW0gKGFjdGlvbik9XCJuZXdJdGVtKCRldmVudClcIj5cclxuICAgICAgICAgICAgICAgICAge3ttb2RlbC5sb2MoJ05ld0l0ZW0nKX19XHJcbiAgICAgICAgICAgICAgICA8L3N0aS1wYXJhbWV0ZXItbWVudS1pdGVtPlxyXG4gICAgICAgICAgICAgIDwvdGQ+XHJcbiAgICAgICAgICAgIDwvdHI+XHJcbiAgICAgICAgICAgIDx0ciBjbGFzcz1cInN0aUpzVmlld2VyQ2xlYXJBbGxTdHlsZXNcIj5cclxuICAgICAgICAgICAgICA8dGQgY2xhc3M9XCJzdGlKc1ZpZXdlckNsZWFyQWxsU3R5bGVzXCI+XHJcbiAgICAgICAgICAgICAgICA8c3RpLXBhcmFtZXRlci1tZW51LWl0ZW0gKm5nRm9yPVwibGV0IGl0ZW0gb2YgbWVudS5wYXJhbXMuaXRlbXNcIiBbYWN0aXZlXT1cImZhbHNlXCI+XHJcbiAgICAgICAgICAgICAgICAgIDx0YWJsZSBjbGFzcz1cInN0aUpzVmlld2VyQ2xlYXJBbGxTdHlsZXNcIiBjZWxscGFkZGluZz1cIjBcIiBjZWxsc3BhY2luZz1cIjBcIj5cclxuICAgICAgICAgICAgICAgICAgICA8dGJvZHk+XHJcbiAgICAgICAgICAgICAgICAgICAgICA8dHIgY2xhc3M9XCJzdGlKc1ZpZXdlckNsZWFyQWxsU3R5bGVzXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICA8dGQgY2xhc3M9XCJzdGlKc1ZpZXdlckNsZWFyQWxsU3R5bGVzXCIgc3R5bGU9XCJwYWRkaW5nOiAwcHggMXB4IDBweCAwcHg7XCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3RpLXBhcmFtZXRlci10ZXh0LWJveCBbaXRlbV09XCJpdGVtXCIgW2lzTWVudV09XCJ0cnVlXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW3ZhcmlhYmxlXT1cIm1lbnUucGFyYW1zXCIgW2ZvY3VzT25DcmVhdGVdPVwiaXRlbS5mb2N1c09uQ3JlYXRlXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3N0aS1wYXJhbWV0ZXItdGV4dC1ib3g+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICA8L3RkPlxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZCAqbmdJZj1cIm1lbnUucGFyYW1zLnR5cGUgPT0gJ0RhdGVUaW1lJ1wiIGNsYXNzPVwic3RpSnNWaWV3ZXJDbGVhckFsbFN0eWxlc1wiIHN0eWxlPVwicGFkZGluZzogMCAxcHggMCAxcHg7XCIgI2RhdGVUaW1lQnV0dG9uPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICA8c3RpLXBhcmFtZXRlci1idXR0b24gW2J1dHRvblR5cGVdPVwiJ0RhdGVUaW1lQnV0dG9uJ1wiIChhY3Rpb24pPVwiZGF0ZVRpbWVCdXR0b25BY3Rpb24oaXRlbSlcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zdGktcGFyYW1ldGVyLWJ1dHRvbj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGQ+XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgPHRkICpuZ0lmPVwibWVudS5wYXJhbXMudHlwZSA9PSAnR3VpZCdcIiBjbGFzcz1cInN0aUpzVmlld2VyQ2xlYXJBbGxTdHlsZXNcIiBzdHlsZT1cInBhZGRpbmc6IDAgMXB4IDAgMXB4O1wiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICA8c3RpLXBhcmFtZXRlci1idXR0b24gW2J1dHRvblR5cGVdPVwiJ0d1aWRCdXR0b24nXCIgKGFjdGlvbik9XCJndWlkQnV0dG9uQWN0aW9uKGl0ZW0pXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3RpLXBhcmFtZXRlci1idXR0b24+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICA8L3RkPlxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz1cInN0aUpzVmlld2VyQ2xlYXJBbGxTdHlsZXNcIiBzdHlsZT1cInBhZGRpbmc6IDAgMXB4IDAgMXB4O1wiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICA8c3RpLXBhcmFtZXRlci1idXR0b24gW2J1dHRvblR5cGVdPVwiJ1JlbW92ZUl0ZW1CdXR0b24nXCIgKGFjdGlvbik9XCJyZW1vdmVCdXR0b25BY3Rpb24oaXRlbSlcIiBbcGFyYW1zXT1cIml0ZW1cIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zdGktcGFyYW1ldGVyLWJ1dHRvbj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGQ+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgPC90cj5cclxuICAgICAgICAgICAgICAgICAgICAgPC90Ym9keT5cclxuICAgICAgICAgICAgICAgICAgPC90YWJsZT5cclxuICAgICAgICAgICAgICAgIDwvc3RpLXBhcmFtZXRlci1tZW51LWl0ZW0+XHJcbiAgICAgICAgICAgICAgPC90ZD5cclxuICAgICAgICAgICAgPC90cj5cclxuXHJcbiAgICAgICAgICAgIDx0ciBjbGFzcz1cInN0aUpzVmlld2VyQ2xlYXJBbGxTdHlsZXNcIj5cclxuICAgICAgICAgICAgICA8dGQgY2xhc3M9XCJzdGlKc1ZpZXdlckNsZWFyQWxsU3R5bGVzXCI+XHJcbiAgICAgICAgICAgICAgICAgIDxzdGktcGFyYW1ldGVyLW1lbnUtaXRlbSAoYWN0aW9uKT1cInJlbW92ZUFsbEFjdGlvbigpXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICB7e21vZGVsLmxvYygnUmVtb3ZlQWxsJyl9fVxyXG4gICAgICAgICAgICAgICAgICA8L3N0aS1wYXJhbWV0ZXItbWVudS1pdGVtPlxyXG5cclxuICAgICAgICAgICAgICAgICAgPHN0aS1wYXJhbWV0ZXItbWVudS1zZXBhcmF0b3I+PC9zdGktcGFyYW1ldGVyLW1lbnUtc2VwYXJhdG9yPlxyXG5cclxuICAgICAgICAgICAgICAgICAgPHN0aS1wYXJhbWV0ZXItbWVudS1pdGVtIChhY3Rpb24pPVwiY2xvc2VBY3Rpb24oKVwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAge3ttb2RlbC5sb2MoJ0Nsb3NlJyl9fVxyXG4gICAgICAgICAgICAgICAgICA8L3N0aS1wYXJhbWV0ZXItbWVudS1pdGVtPlxyXG4gICAgICAgICAgICAgIDwvdGQ+XHJcbiAgICAgICAgICAgIDwvdHI+XHJcbiAgICAgICAgICA8L3Rib2R5PlxyXG4gICAgICAgIDwvdGFibGU+XHJcbiAgYFxyXG59KVxyXG5cclxuZXhwb3J0IGNsYXNzIFBhcmFtZXRlck1lbnVFZGl0TGlzdENvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XHJcblxyXG4gIEBWaWV3Q2hpbGQoJ2RhdGVUaW1lQnV0dG9uJykgZGF0ZVRpbWVCdXR0b246IEVsZW1lbnRSZWY7XHJcblxyXG4gIEBJbnB1dCgpIG1lbnU6IE1lbnU7XHJcblxyXG4gIGNvbnN0cnVjdG9yKHB1YmxpYyBtb2RlbDogTW9kZWxTZXJ2aWNlLCBwdWJsaWMgaGVscGVyOiBIZWxwZXJTZXJ2aWNlLCBwdWJsaWMgbWVudVNlcnZpY2U6IE1lbnVTZXJ2aWNlKSB7IH1cclxuXHJcbiAgbmdPbkluaXQoKSB7IH1cclxuXHJcbiAgbmV3SXRlbShldmVudDogYW55KSB7XHJcbiAgICBjb25zdCBpdGVtOiBhbnkgPSBuZXcgVmFyaWFibGUoKTtcclxuICAgIGlmICh0aGlzLm1lbnUucGFyYW1zLnR5cGUgPT09ICdEYXRlVGltZScpIHtcclxuICAgICAgaXRlbS5rZXkgPSB0aGlzLmhlbHBlci5nZXREYXRlVGltZU9iamVjdCgpO1xyXG4gICAgICBpdGVtLnZhbHVlID0gdGhpcy5oZWxwZXIuZGF0ZVRpbWVPYmplY3RUb1N0cmluZyhpdGVtLmtleSk7XHJcbiAgICB9IGVsc2UgaWYgKHRoaXMubWVudS5wYXJhbXMudHlwZSA9PT0gJ1RpbWVTcGFuJykge1xyXG4gICAgICBpdGVtLmtleSA9ICcwMDowMDowMCc7XHJcbiAgICAgIGl0ZW0udmFsdWUgPSAnMDA6MDA6MDAnO1xyXG4gICAgfSBlbHNlIGlmICh0aGlzLm1lbnUucGFyYW1zLnR5cGUgPT09ICdCb29sJykge1xyXG4gICAgICBpdGVtLmtleSA9ICdGYWxzZSc7XHJcbiAgICAgIGl0ZW0udmFsdWUgPSAnRmFsc2UnO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgaXRlbS5rZXkgPSAnJztcclxuICAgICAgaXRlbS52YWx1ZSA9ICcnO1xyXG4gICAgfVxyXG4gICAgaXRlbS5mb2N1c09uQ3JlYXRlID0gdHJ1ZTtcclxuICAgIGlmICghdGhpcy5tZW51LnBhcmFtcy5pdGVtcykge1xyXG4gICAgICB0aGlzLm1lbnUucGFyYW1zLml0ZW1zID0gW107XHJcbiAgICB9XHJcbiAgICB0aGlzLm1lbnUucGFyYW1zLml0ZW1zLnB1c2goaXRlbSk7XHJcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgaXRlbS5mb2N1c09uQ3JlYXRlID0gZmFsc2U7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGRhdGVUaW1lQnV0dG9uQWN0aW9uKGl0ZW06IFZhcmlhYmxlKSB7XHJcbiAgICB0aGlzLm1lbnVTZXJ2aWNlLmFkZE1lbnUoe1xyXG4gICAgICB0eXBlOiAnZGF0ZVBpY2tlck1lbnUnLCBuYW1lOiAnZGF0ZVBpY2tlck1lbnUnLCBpdGVtczogW10sIHBhcmVudDogdGhpcy5kYXRlVGltZUJ1dHRvbixcclxuICAgICAgcGFyYW1zOiBpdGVtXHJcbiAgICB9KTtcclxuXHJcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgdGhpcy5tZW51U2VydmljZS5zaG93TWVudSgnZGF0ZVBpY2tlck1lbnUnKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZ3VpZEJ1dHRvbkFjdGlvbihpdGVtOiBWYXJpYWJsZSkge1xyXG4gICAgaXRlbS5rZXkgPSB0aGlzLmhlbHBlci5uZXdHdWlkKCk7XHJcbiAgfVxyXG5cclxuICByZW1vdmVCdXR0b25BY3Rpb24oaXRlbTogVmFyaWFibGUpIHtcclxuICAgIHRoaXMubWVudS5wYXJhbXMuaXRlbXMuc3BsaWNlKHRoaXMubWVudS5wYXJhbXMuaXRlbXMuaW5kZXhPZihpdGVtKSwgMSk7XHJcbiAgfVxyXG5cclxuICByZW1vdmVBbGxBY3Rpb24oKSB7XHJcbiAgICB0aGlzLm1lbnUucGFyYW1zLml0ZW1zLnNwbGljZSgwLCB0aGlzLm1lbnUucGFyYW1zLml0ZW1zLmxlbmd0aCk7XHJcbiAgfVxyXG5cclxuICBjbG9zZUFjdGlvbigpIHtcclxuICAgIHRoaXMubWVudS5zdGF0ZSA9ICdpbml0aWFsRG93bic7XHJcbiAgfVxyXG59XHJcbiJdfQ==