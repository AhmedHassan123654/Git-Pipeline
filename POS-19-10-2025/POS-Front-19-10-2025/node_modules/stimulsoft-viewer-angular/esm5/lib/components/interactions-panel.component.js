import { __decorate } from "tslib";
import { Component, ViewChild } from '@angular/core';
import { ModelService } from '../services/model.service';
import { HelperService } from '../services/helper.service';
import { InteractionsService } from '../services/interactions.service';
import { MenuService } from '../menu/menu.service';
import { ControllerService } from '../services/controller.service';
import { trigger, state, transition, style, keyframes, animate } from '@angular/animations';
var InteractionsPanelComponent = /** @class */ (function () {
    function InteractionsPanelComponent(model, helper, interactionService, menuService, controller) {
        this.model = model;
        this.helper = helper;
        this.interactionService = interactionService;
        this.menuService = menuService;
        this.controller = controller;
        this.currentOpeningParameter = null;
        this.dropDownButtonWasClicked = false;
        this.dateTimeButtonWasClicked = false;
    }
    InteractionsPanelComponent.prototype.ngAfterViewInit = function () {
        this.model.controls.parametersPanel.el = this.element;
    };
    InteractionsPanelComponent.prototype.ngOnInit = function () { };
    InteractionsPanelComponent.prototype.getNameAlign = function (indexRow, indexColumn) {
        var index = this.index(indexRow, indexColumn);
        if (index < this.length() &&
            this.model.interactions.paramsVariables[index].basicType === 'Range' &&
            this.model.options.appearance.parametersPanelPosition === 'Left') {
            return 'top';
        }
        return '';
    };
    InteractionsPanelComponent.prototype.getNamePadding = function (indexRow, indexColumn) {
        var index = this.index(indexRow, indexColumn);
        if (index < this.length() &&
            this.model.interactions.paramsVariables[index].basicType === 'Range' &&
            this.model.options.appearance.parametersPanelPosition === 'Left') {
            return this.model.options.isTouchDevice ? '11px' : '9px';
        }
        return '';
    };
    InteractionsPanelComponent.prototype.getCaption = function (indexRow, indexColumn, checkLeft) {
        if (checkLeft === void 0) { checkLeft = true; }
        var index = this.index(indexRow, indexColumn);
        if (checkLeft && this.ifLeftRange(indexRow, indexColumn)) {
            return '';
        }
        return index < this.length() ? this.model.interactions.paramsVariables[index].alias : '';
    };
    InteractionsPanelComponent.prototype.ifLeftRange = function (indexRow, indexColumn) {
        var index = this.index(indexRow, indexColumn);
        return this.model.interactions.paramsVariables[index].basicType === 'Range' && this.model.options.appearance.parametersPanelPosition === 'Left';
    };
    InteractionsPanelComponent.prototype.getTitle = function (indexRow, indexColumn) {
        var index = this.index(indexRow, indexColumn);
        return index < this.length() ? this.model.interactions.paramsVariables[index].description : '';
    };
    InteractionsPanelComponent.prototype.index = function (indexRow, indexColumn) {
        return indexColumn * this.model.interactions.countInColumn.length + indexRow;
    };
    InteractionsPanelComponent.prototype.length = function () {
        var _a, _b;
        return ((_a = this.model.interactions) === null || _a === void 0 ? void 0 : _a.paramsVariables) != null ? Object.keys((_b = this.model.interactions) === null || _b === void 0 ? void 0 : _b.paramsVariables).length : 0;
    };
    Object.defineProperty(InteractionsPanelComponent.prototype, "className", {
        get: function () {
            var className = 'stiJsViewerParametersPanel';
            if (this.model.options.appearance.parametersPanelPosition === 'Top') {
                className += ' stiJsViewerParametersPanelTop';
                if (this.model.options.toolbar.displayMode === 'Separated') {
                    className += ' stiJsViewerParametersPanelSeparatedTop';
                }
            }
            return className;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(InteractionsPanelComponent.prototype, "top", {
        get: function () {
            var styleTop = this.model.options.toolbar.visible ? this.model.controls.toolbar.offsetHeight : 0;
            if (this.model.options.isMobileDevice && this.model.options.toolbar.autoHide) {
                styleTop = 0;
            }
            styleTop += this.model.controls.drillDownPanel.exists ? this.model.controls.drillDownPanel.offsetHeight : 0;
            styleTop += this.model.controls.findPanel.exists ? this.model.controls.findPanel.offsetHeight : 0;
            styleTop += this.model.controls.resourcesPanel.exists ? this.model.controls.resourcesPanel.offsetHeight : 0;
            return styleTop;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(InteractionsPanelComponent.prototype, "bottom", {
        get: function () {
            if (this.model.options.appearance.parametersPanelPosition === 'Left') {
                if (this.model.options.isMobileDevice) {
                    return this.model.options.toolbar.autoHide ? '0' : '0.5in';
                }
                else {
                    return this.model.options.toolbar.displayMode === 'Separated' && this.model.options.toolbar.visible ? '35px' : '0';
                }
            }
            return '';
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(InteractionsPanelComponent.prototype, "innerClassName", {
        get: function () {
            var className = this.model.options.toolbar.displayMode === 'Simple' ? 'stiJsViewerInnerParametersPanelSimple' : '';
            if (this.model.options.appearance.parametersPanelPosition === 'Left') {
                className += ' stiJsViewerInnerParametersPanelLeft';
                if (this.model.options.toolbar.displayMode === 'Separated') {
                    className += ' stiJsViewerInnerParametersPanelSeparatedLeft';
                }
            }
            return className;
        },
        enumerable: true,
        configurable: true
    });
    InteractionsPanelComponent.ctorParameters = function () { return [
        { type: ModelService },
        { type: HelperService },
        { type: InteractionsService },
        { type: MenuService },
        { type: ControllerService }
    ]; };
    __decorate([
        ViewChild('element')
    ], InteractionsPanelComponent.prototype, "element", void 0);
    InteractionsPanelComponent = __decorate([
        Component({
            selector: 'sti-interactions-panel',
            template: "\n    <div #element [class]=\"className\"\n       [style.display]=\"!this.model.options.isMobileDevice ? (model.controls.parametersPanel.visible ? '' : 'none') : null\"\n       [style.fontFamily]=\"model.options.toolbar.fontFamily\"\n       [style.color]=\"model.options.toolbar.fontColor\"\n       [style.top.px]=\"top\"\n       [style.left.px]=\"model.controls.parametersPanel.layout.left\"\n       [style.bottom]=\"bottom\"\n       [style.transition]=\"model.options.isMobileDevice ? 'opacity 300ms ease' : null\"\n       [@visibility]=\"!this.model.options.isMobileDevice ? null : (model.controls.parametersPanel.visible ? 'visible' : 'hidden')\">\n       <div [class]=\"innerClassName\" [style.marginTop]=\"model.options.toolbar.displayMode == 'Simple' ? '2px' : ''\" (scroll)=\"menuService.closeAllMenus()\">\n         <div class=\"stiJsViewerInnerContainerParametersPanel\"\n              [style.background]=\"helper.val(model.options.toolbar.backgroundColor, '')\"\n              [style.border]=\"helper.val(model.options.toolbar.backgroundColor, '') != '' ? '1px solid ' + helper.val(model.options.toolbar.backgroundColor, '') : ''\"\n              [style.maxHeight]=\"model.options.appearance.parametersPanelPosition == 'Top' ? model.options.appearance.parametersPanelMaxHeight + 'px' : ''\"\n              (scroll)=\"menuService.closeAllMenus()\">\n            <table *ngIf=\"model.interactions\" class=\"stiJsViewerClearAllStyles\" cellpadding=\"0\" cellspacing=\"0\" style=\"border: 0px;\">\n              <tbody>\n                <tr *ngFor=\"let item of model.interactions.countInColumn; let indexRow=index\" >\n                  <ng-container *ngFor=\"let item2 of model.interactions.countColumns; let indexColumn=index\">\n                    <ng-container *ngIf=\"index(indexRow, indexColumn) <= length()\">\n                        <td [style.padding]=\"'0 10px 0 ' + (indexColumn > 0 ? '30px' : '0')\"\n                            [style.whiteSpace]=\"'nowrap'\"\n                            [style.verticalAlign]='getNameAlign(indexRow, indexColumn)'\n                            [style.paddingTop]='getNamePadding(indexRow, indexColumn)'\n                            [attr.title]='getTitle(indexRow, indexColumn)'>\n                            {{getCaption(indexRow, indexColumn)}}\n                              <table *ngIf=\"ifLeftRange(indexRow, indexColumn)\" class=\"stiJsViewerClearAllStyles\" cellpadding=\"0\" cellspacing=\"0\" style=\"height: 60px;\">\n                                <tbody>\n                                  <tr class=\"stiJsViewerClearAllStyles\">\n                                    <td class=\"stiJsViewerClearAllStyles\" rowspan=\"2\" style=\"vertical-align: top; padding-top: 9px;\">\n                                      {{getCaption(indexRow, indexColumn, false)}}\n                                    </td>\n                                    <td class=\"stiJsViewerClearAllStyles\" style=\"padding-left: 12px;\">\n                                      {{model.loc('RangeFrom')}}\n                                    </td>\n                                  </tr>\n                                  <tr class=\"stiJsViewerClearAllStyles\">\n                                    <td class=\"stiJsViewerClearAllStyles\" style=\"padding-left: 12px;\">\n                                      {{model.loc('RangeTo')}}\n                                    </td>\n                                  </tr>\n                                </tbody>\n                              </table>\n                            </td>\n                        <td [style.padding]=\"'0px'\">\n                          <sti-parameter *ngIf=\"index(indexRow, indexColumn) != length()\"  [params]=\"model.interactions.paramsVariables[index(indexRow, indexColumn)]\"></sti-parameter>\n\n                          <table *ngIf=\"index(indexRow, indexColumn) == length()\" class=\"stiJsViewerClearAllStyles\" cellpadding=\"0\" cellspacing=\"0\"\n                            align=\"right\" style=\"margin: 5px 2px 10px 0px;\">\n                            <tr class=\"stiJsViewerClearAllStyles\">\n                              <td class=\"stiJsViewerClearAllStyles\">\n                                <sti-form-button [caption]=\"model.loc('Reset')\" (action)=\"controller.action({name: 'Reset'})\"></sti-form-button>\n                              </td>\n                              <td class=\"stiJsViewerClearAllStyles\" style=\"padding-left: 10px;\">\n                                <sti-form-button [caption]=\"model.loc('Submit')\" (action)=\"controller.action({name: 'Submit'})\"></sti-form-button>\n                              </td>\n                            </tr>\n                          </table>\n                        </td>\n                    </ng-container>\n                  </ng-container>\n                </tr>\n                <tr *ngIf=\"length() == model.interactions.countInColumn.length * model.interactions.countColumns.length\">\n                  <td></td>\n                  <td *ngIf=\"model.interactions.countColumns.length > 1\"></td>\n                  <td *ngIf=\"model.interactions.countColumns.length > 1\"></td>\n                  <td [style.padding]=\"'0px'\">\n                      <table class=\"stiJsViewerClearAllStyles\" cellpadding=\"0\" cellspacing=\"0\"\n                         align=\"right\" style=\"margin: 5px 2px 10px 0px;\">\n                         <tr class=\"stiJsViewerClearAllStyles\">\n                           <td class=\"stiJsViewerClearAllStyles\">\n                             <sti-form-button [caption]=\"model.loc('Reset')\" (action)=\"controller.action({name: 'Reset'})\"></sti-form-button>\n                           </td>\n                           <td class=\"stiJsViewerClearAllStyles\" style=\"padding-left: 10px;\">\n                              <sti-form-button [caption]=\"model.loc('Submit')\" (action)=\"controller.action({name: 'Submit'})\"></sti-form-button>\n                           </td>\n                         </tr>\n                       </table>\n                  </td>\n                </tr>\n              </tbody>\n            </table>\n          </div>\n      </div>\n    </div>\n  ",
            animations: [
                trigger('visibility', [
                    state('visible', style({ opacity: 1, display: 'block' })),
                    state('hidden', style({ opacity: 0, display: 'none' })),
                    transition('hidden => visible', [
                        animate('300ms ease-in-out', keyframes([
                            style({ display: 'block', opacity: 0, offset: 0 }),
                            style({ display: 'block', opacity: 1, offset: 1 }),
                        ]))
                    ]),
                    transition('visible => hidden', [
                        animate('300ms ease-in-out', keyframes([
                            style({ display: 'block', opacity: 1, offset: 0 }),
                            style({ display: 'none', opacity: 0, offset: 1 }),
                        ]))
                    ])
                ])
            ]
        })
    ], InteractionsPanelComponent);
    return InteractionsPanelComponent;
}());
export { InteractionsPanelComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW50ZXJhY3Rpb25zLXBhbmVsLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL3N0aW11bHNvZnQtdmlld2VyLWFuZ3VsYXIvIiwic291cmNlcyI6WyJsaWIvY29tcG9uZW50cy9pbnRlcmFjdGlvbnMtcGFuZWwuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUF5QixTQUFTLEVBQWMsTUFBTSxlQUFlLENBQUM7QUFDeEYsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLDJCQUEyQixDQUFDO0FBQ3pELE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSw0QkFBNEIsQ0FBQztBQUMzRCxPQUFPLEVBQUUsbUJBQW1CLEVBQUUsTUFBTSxrQ0FBa0MsQ0FBQztBQUN2RSxPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFDbkQsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0sZ0NBQWdDLENBQUM7QUFDbkUsT0FBTyxFQUFFLE9BQU8sRUFBRSxLQUFLLEVBQUUsVUFBVSxFQUFFLEtBQUssRUFBRSxTQUFTLEVBQUUsT0FBTyxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUErRzVGO0lBUUUsb0NBQW1CLEtBQW1CLEVBQVMsTUFBcUIsRUFBUyxrQkFBdUMsRUFBUyxXQUF3QixFQUM1SSxVQUE2QjtRQURuQixVQUFLLEdBQUwsS0FBSyxDQUFjO1FBQVMsV0FBTSxHQUFOLE1BQU0sQ0FBZTtRQUFTLHVCQUFrQixHQUFsQixrQkFBa0IsQ0FBcUI7UUFBUyxnQkFBVyxHQUFYLFdBQVcsQ0FBYTtRQUM1SSxlQUFVLEdBQVYsVUFBVSxDQUFtQjtRQVB0Qyw0QkFBdUIsR0FBRyxJQUFJLENBQUM7UUFDL0IsNkJBQXdCLEdBQUcsS0FBSyxDQUFDO1FBQ2pDLDZCQUF3QixHQUFHLEtBQUssQ0FBQztJQUtTLENBQUM7SUFFM0Msb0RBQWUsR0FBZjtRQUNFLElBQUksQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFD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Qzs0QkFDckMsS0FBSyxDQUFDLEVBQUUsT0FBTyxFQUFFLE9BQU8sRUFBRSxPQUFPLEVBQUUsQ0FBQyxFQUFFLE1BQU0sRUFBRSxDQUFDLEVBQUUsQ0FBQzs0QkFDbEQsS0FBSyxDQUFDLEVBQUUsT0FBTyxFQUFFLE9BQU8sRUFBRSxPQUFPLEVBQUUsQ0FBQyxFQUFFLE1BQU0sRUFBRSxDQUFDLEVBQUUsQ0FBQzt5QkFDbkQsQ0FBQyxDQUFDO3FCQUNKLENBQUM7b0JBQ0YsVUFBVSxDQUFDLG1CQUFtQixFQUFFO3dCQUM5QixPQUFPLENBQUMsbUJBQW1CLEVBQUUsU0FBUyxDQUFDOzRCQUNyQyxLQUFLLENBQUMsRUFBRSxPQUFPLEVBQUUsT0FBTyxFQUFFLE9BQU8sRUFBRSxDQUFDLEVBQUUsTUFBTSxFQUFFLENBQUMsRUFBRSxDQUFDOzRCQUNsRCxLQUFLLENBQUMsRUFBRSxPQUFPLEVBQUUsTUFBTSxFQUFFLE9BQU8sRUFBRSxDQUFDLEVBQUUsTUFBTSxFQUFFLENBQUMsRUFBRSxDQUFDO3lCQUNsRCxDQUFDLENBQUM7cUJBQ0osQ0FBQztpQkFDSCxDQUFDO2FBQ0g7U0FDRixDQUFDO09BRVcsMEJBQTBCLENBK0d0QztJQUFELGlDQUFDO0NBQUEsQUEvR0QsSUErR0M7U0EvR1ksMEJBQTBCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBPbkluaXQsIEFmdGVyVmlld0luaXQsIFZpZXdDaGlsZCwgRWxlbWVudFJlZiB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBNb2RlbFNlcnZpY2UgfSBmcm9tICcuLi9zZXJ2aWNlcy9tb2RlbC5zZXJ2aWNlJztcclxuaW1wb3J0IHsgSGVscGVyU2VydmljZSB9IGZyb20gJy4uL3NlcnZpY2VzL2hlbHBlci5zZXJ2aWNlJztcclxuaW1wb3J0IHsgSW50ZXJhY3Rpb25zU2VydmljZSB9IGZyb20gJy4uL3NlcnZpY2VzL2ludGVyYWN0aW9ucy5zZXJ2aWNlJztcclxuaW1wb3J0IHsgTWVudVNlcnZpY2UgfSBmcm9tICcuLi9tZW51L21lbnUuc2VydmljZSc7XHJcbmltcG9ydCB7IENvbnRyb2xsZXJTZXJ2aWNlIH0gZnJvbSAnLi4vc2VydmljZXMvY29udHJvbGxlci5zZXJ2aWNlJztcclxuaW1wb3J0IHsgdHJpZ2dlciwgc3RhdGUsIHRyYW5zaXRpb24sIHN0eWxlLCBrZXlmcmFtZXMsIGFuaW1hdGUgfSBmcm9tICdAYW5ndWxhci9hbmltYXRpb25zJztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gIHNlbGVjdG9yOiAnc3RpLWludGVyYWN0aW9ucy1wYW5lbCcsXHJcbiAgdGVtcGxhdGU6IGBcclxuICAgIDxkaXYgI2VsZW1lbnQgW2NsYXNzXT1cImNsYXNzTmFtZVwiXHJcbiAgICAgICBbc3R5bGUuZGlzcGxheV09XCIhdGhpcy5tb2RlbC5vcHRpb25zLmlzTW9iaWxlRGV2aWNlID8gKG1vZGVsLmNvbnRyb2xzLnBhcmFtZXRlcnNQYW5lbC52aXNpYmxlID8gJycgOiAnbm9uZScpIDogbnVsbFwiXHJcbiAgICAgICBbc3R5bGUuZm9udEZhbWlseV09XCJtb2RlbC5vcHRpb25zLnRvb2xiYXIuZm9udEZhbWlseVwiXHJcbiAgICAgICBbc3R5bGUuY29sb3JdPVwibW9kZWwub3B0aW9ucy50b29sYmFyLmZvbnRDb2xvclwiXHJcbiAgICAgICBbc3R5bGUudG9wLnB4XT1cInRvcFwiXHJcbiAgICAgICBbc3R5bGUubGVmdC5weF09XCJtb2RlbC5jb250cm9scy5wYXJhbWV0ZXJzUGFuZWwubGF5b3V0LmxlZnRcIlxyXG4gICAgICAgW3N0eWxlLmJvdHRvbV09XCJib3R0b21cIlxyXG4gICAgICAgW3N0eWxlLnRyYW5zaXRpb25dPVwibW9kZWwub3B0aW9ucy5pc01vYmlsZURldmljZSA/ICdvcGFjaXR5IDMwMG1zIGVhc2UnIDogbnVsbFwiXHJcbiAgICAgICBbQHZpc2liaWxpdHldPVwiIXRoaXMubW9kZWwub3B0aW9ucy5pc01vYmlsZURldmljZSA/IG51bGwgOiAobW9kZWwuY29udHJvbHMucGFyYW1ldGVyc1BhbmVsLnZpc2libGUgPyAndmlzaWJsZScgOiAnaGlkZGVuJylcIj5cclxuICAgICAgIDxkaXYgW2NsYXNzXT1cImlubmVyQ2xhc3NOYW1lXCIgW3N0eWxlLm1hcmdpblRvcF09XCJtb2RlbC5vcHRpb25zLnRvb2xiYXIuZGlzcGxheU1vZGUgPT0gJ1NpbXBsZScgPyAnMnB4JyA6ICcnXCIgKHNjcm9sbCk9XCJtZW51U2VydmljZS5jbG9zZUFsbE1lbnVzKClcIj5cclxuICAgICAgICAgPGRpdiBjbGFzcz1cInN0aUpzVmlld2VySW5uZXJDb250YWluZXJQYXJhbWV0ZXJzUGFuZWxcIlxyXG4gICAgICAgICAgICAgIFtzdHlsZS5iYWNrZ3JvdW5kXT1cImhlbHBlci52YWwobW9kZWwub3B0aW9ucy50b29sYmFyLmJhY2tncm91bmRDb2xvciwgJycpXCJcclxuICAgICAgICAgICAgICBbc3R5bGUuYm9yZGVyXT1cImhlbHBlci52YWwobW9kZWwub3B0aW9ucy50b29sYmFyLmJhY2tncm91bmRDb2xvciwgJycpICE9ICcnID8gJzFweCBzb2xpZCAnICsgaGVscGVyLnZhbChtb2RlbC5vcHRpb25zLnRvb2xiYXIuYmFja2dyb3VuZENvbG9yLCAnJykgOiAnJ1wiXHJcbiAgICAgICAgICAgICAgW3N0eWxlLm1heEhlaWdodF09XCJtb2RlbC5vcHRpb25zLmFwcGVhcmFuY2UucGFyYW1ldGVyc1BhbmVsUG9zaXRpb24gPT0gJ1RvcCcgPyBtb2RlbC5vcHRpb25zLmFwcGVhcmFuY2UucGFyYW1ldGVyc1BhbmVsTWF4SGVpZ2h0ICsgJ3B4JyA6ICcnXCJcclxuICAgICAgICAgICAgICAoc2Nyb2xsKT1cIm1lbnVTZXJ2aWNlLmNsb3NlQWxsTWVudXMoKVwiPlxyXG4gICAgICAgICAgICA8dGFibGUgKm5nSWY9XCJtb2RlbC5pbnRlcmFjdGlvbnNcIiBjbGFzcz1cInN0aUpzVmlld2VyQ2xlYXJBbGxTdHlsZXNcIiBjZWxscGFkZGluZz1cIjBcIiBjZWxsc3BhY2luZz1cIjBcIiBzdHlsZT1cImJvcmRlcjogMHB4O1wiPlxyXG4gICAgICAgICAgICAgIDx0Ym9keT5cclxuICAgICAgICAgICAgICAgIDx0ciAqbmdGb3I9XCJsZXQgaXRlbSBvZiBtb2RlbC5pbnRlcmFjdGlvbnMuY291bnRJbkNvbHVtbjsgbGV0IGluZGV4Um93PWluZGV4XCIgPlxyXG4gICAgICAgICAgICAgICAgICA8bmctY29udGFpbmVyICpuZ0Zvcj1cImxldCBpdGVtMiBvZiBtb2RlbC5pbnRlcmFjdGlvbnMuY291bnRDb2x1bW5zOyBsZXQgaW5kZXhDb2x1bW49aW5kZXhcIj5cclxuICAgICAgICAgICAgICAgICAgICA8bmctY29udGFpbmVyICpuZ0lmPVwiaW5kZXgoaW5kZXhSb3csIGluZGV4Q29sdW1uKSA8PSBsZW5ndGgoKVwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8dGQgW3N0eWxlLnBhZGRpbmddPVwiJzAgMTBweCAwICcgKyAoaW5kZXhDb2x1bW4gPiAwID8gJzMwcHgnIDogJzAnKVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbc3R5bGUud2hpdGVTcGFjZV09XCInbm93cmFwJ1wiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbc3R5bGUudmVydGljYWxBbGlnbl09J2dldE5hbWVBbGlnbihpbmRleFJvdywgaW5kZXhDb2x1bW4pJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgW3N0eWxlLnBhZGRpbmdUb3BdPSdnZXROYW1lUGFkZGluZyhpbmRleFJvdywgaW5kZXhDb2x1bW4pJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgW2F0dHIudGl0bGVdPSdnZXRUaXRsZShpbmRleFJvdywgaW5kZXhDb2x1bW4pJz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt7Z2V0Q2FwdGlvbihpbmRleFJvdywgaW5kZXhDb2x1bW4pfX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRhYmxlICpuZ0lmPVwiaWZMZWZ0UmFuZ2UoaW5kZXhSb3csIGluZGV4Q29sdW1uKVwiIGNsYXNzPVwic3RpSnNWaWV3ZXJDbGVhckFsbFN0eWxlc1wiIGNlbGxwYWRkaW5nPVwiMFwiIGNlbGxzcGFjaW5nPVwiMFwiIHN0eWxlPVwiaGVpZ2h0OiA2MHB4O1wiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0Ym9keT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ciBjbGFzcz1cInN0aUpzVmlld2VyQ2xlYXJBbGxTdHlsZXNcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkIGNsYXNzPVwic3RpSnNWaWV3ZXJDbGVhckFsbFN0eWxlc1wiIHJvd3NwYW49XCIyXCIgc3R5bGU9XCJ2ZXJ0aWNhbC1hbGlnbjogdG9wOyBwYWRkaW5nLXRvcDogOXB4O1wiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt7Z2V0Q2FwdGlvbihpbmRleFJvdywgaW5kZXhDb2x1bW4sIGZhbHNlKX19XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGQ+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz1cInN0aUpzVmlld2VyQ2xlYXJBbGxTdHlsZXNcIiBzdHlsZT1cInBhZGRpbmctbGVmdDogMTJweDtcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7e21vZGVsLmxvYygnUmFuZ2VGcm9tJyl9fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RkPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90cj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ciBjbGFzcz1cInN0aUpzVmlld2VyQ2xlYXJBbGxTdHlsZXNcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkIGNsYXNzPVwic3RpSnNWaWV3ZXJDbGVhckFsbFN0eWxlc1wiIHN0eWxlPVwicGFkZGluZy1sZWZ0OiAxMnB4O1wiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt7bW9kZWwubG9jKCdSYW5nZVRvJyl9fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RkPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90cj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3Rib2R5PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RhYmxlPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90ZD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPHRkIFtzdHlsZS5wYWRkaW5nXT1cIicwcHgnXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPHN0aS1wYXJhbWV0ZXIgKm5nSWY9XCJpbmRleChpbmRleFJvdywgaW5kZXhDb2x1bW4pICE9IGxlbmd0aCgpXCIgIFtwYXJhbXNdPVwibW9kZWwuaW50ZXJhY3Rpb25zLnBhcmFtc1ZhcmlhYmxlc1tpbmRleChpbmRleFJvdywgaW5kZXhDb2x1bW4pXVwiPjwvc3RpLXBhcmFtZXRlcj5cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPHRhYmxlICpuZ0lmPVwiaW5kZXgoaW5kZXhSb3csIGluZGV4Q29sdW1uKSA9PSBsZW5ndGgoKVwiIGNsYXNzPVwic3RpSnNWaWV3ZXJDbGVhckFsbFN0eWxlc1wiIGNlbGxwYWRkaW5nPVwiMFwiIGNlbGxzcGFjaW5nPVwiMFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGlnbj1cInJpZ2h0XCIgc3R5bGU9XCJtYXJnaW46IDVweCAycHggMTBweCAwcHg7XCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dHIgY2xhc3M9XCJzdGlKc1ZpZXdlckNsZWFyQWxsU3R5bGVzXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz1cInN0aUpzVmlld2VyQ2xlYXJBbGxTdHlsZXNcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3RpLWZvcm0tYnV0dG9uIFtjYXB0aW9uXT1cIm1vZGVsLmxvYygnUmVzZXQnKVwiIChhY3Rpb24pPVwiY29udHJvbGxlci5hY3Rpb24oe25hbWU6ICdSZXNldCd9KVwiPjwvc3RpLWZvcm0tYnV0dG9uPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RkPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQgY2xhc3M9XCJzdGlKc1ZpZXdlckNsZWFyQWxsU3R5bGVzXCIgc3R5bGU9XCJwYWRkaW5nLWxlZnQ6IDEwcHg7XCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHN0aS1mb3JtLWJ1dHRvbiBbY2FwdGlvbl09XCJtb2RlbC5sb2MoJ1N1Ym1pdCcpXCIgKGFjdGlvbik9XCJjb250cm9sbGVyLmFjdGlvbih7bmFtZTogJ1N1Ym1pdCd9KVwiPjwvc3RpLWZvcm0tYnV0dG9uPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RkPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90cj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RhYmxlPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L3RkPlxyXG4gICAgICAgICAgICAgICAgICAgIDwvbmctY29udGFpbmVyPlxyXG4gICAgICAgICAgICAgICAgICA8L25nLWNvbnRhaW5lcj5cclxuICAgICAgICAgICAgICAgIDwvdHI+XHJcbiAgICAgICAgICAgICAgICA8dHIgKm5nSWY9XCJsZW5ndGgoKSA9PSBtb2RlbC5pbnRlcmFjdGlvbnMuY291bnRJbkNvbHVtbi5sZW5ndGggKiBtb2RlbC5pbnRlcmFjdGlvbnMuY291bnRDb2x1bW5zLmxlbmd0aFwiPlxyXG4gICAgICAgICAgICAgICAgICA8dGQ+PC90ZD5cclxuICAgICAgICAgICAgICAgICAgPHRkICpuZ0lmPVwibW9kZWwuaW50ZXJhY3Rpb25zLmNvdW50Q29sdW1ucy5sZW5ndGggPiAxXCI+PC90ZD5cclxuICAgICAgICAgICAgICAgICAgPHRkICpuZ0lmPVwibW9kZWwuaW50ZXJhY3Rpb25zLmNvdW50Q29sdW1ucy5sZW5ndGggPiAxXCI+PC90ZD5cclxuICAgICAgICAgICAgICAgICAgPHRkIFtzdHlsZS5wYWRkaW5nXT1cIicwcHgnXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICA8dGFibGUgY2xhc3M9XCJzdGlKc1ZpZXdlckNsZWFyQWxsU3R5bGVzXCIgY2VsbHBhZGRpbmc9XCIwXCIgY2VsbHNwYWNpbmc9XCIwXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgIGFsaWduPVwicmlnaHRcIiBzdHlsZT1cIm1hcmdpbjogNXB4IDJweCAxMHB4IDBweDtcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgIDx0ciBjbGFzcz1cInN0aUpzVmlld2VyQ2xlYXJBbGxTdHlsZXNcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkIGNsYXNzPVwic3RpSnNWaWV3ZXJDbGVhckFsbFN0eWxlc1wiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzdGktZm9ybS1idXR0b24gW2NhcHRpb25dPVwibW9kZWwubG9jKCdSZXNldCcpXCIgKGFjdGlvbik9XCJjb250cm9sbGVyLmFjdGlvbih7bmFtZTogJ1Jlc2V0J30pXCI+PC9zdGktZm9ybS1idXR0b24+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGQ+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz1cInN0aUpzVmlld2VyQ2xlYXJBbGxTdHlsZXNcIiBzdHlsZT1cInBhZGRpbmctbGVmdDogMTBweDtcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHN0aS1mb3JtLWJ1dHRvbiBbY2FwdGlvbl09XCJtb2RlbC5sb2MoJ1N1Ym1pdCcpXCIgKGFjdGlvbik9XCJjb250cm9sbGVyLmFjdGlvbih7bmFtZTogJ1N1Ym1pdCd9KVwiPjwvc3RpLWZvcm0tYnV0dG9uPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RkPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgPC90cj5cclxuICAgICAgICAgICAgICAgICAgICAgICA8L3RhYmxlPlxyXG4gICAgICAgICAgICAgICAgICA8L3RkPlxyXG4gICAgICAgICAgICAgICAgPC90cj5cclxuICAgICAgICAgICAgICA8L3Rib2R5PlxyXG4gICAgICAgICAgICA8L3RhYmxlPlxyXG4gICAgICAgICAgPC9kaXY+XHJcbiAgICAgIDwvZGl2PlxyXG4gICAgPC9kaXY+XHJcbiAgYCxcclxuICBhbmltYXRpb25zOiBbXHJcbiAgICB0cmlnZ2VyKCd2aXNpYmlsaXR5JywgW1xyXG4gICAgICBzdGF0ZSgndmlzaWJsZScsIHN0eWxlKHsgb3BhY2l0eTogMSwgZGlzcGxheTogJ2Jsb2NrJyB9KSksXHJcbiAgICAgIHN0YXRlKCdoaWRkZW4nLCBzdHlsZSh7IG9wYWNpdHk6IDAsIGRpc3BsYXk6ICdub25lJyB9KSksXHJcbiAgICAgIHRyYW5zaXRpb24oJ2hpZGRlbiA9PiB2aXNpYmxlJywgW1xyXG4gICAgICAgIGFuaW1hdGUoJzMwMG1zIGVhc2UtaW4tb3V0Jywga2V5ZnJhbWVzKFtcclxuICAgICAgICAgIHN0eWxlKHsgZGlzcGxheTogJ2Jsb2NrJywgb3BhY2l0eTogMCwgb2Zmc2V0OiAwIH0pLFxyXG4gICAgICAgICAgc3R5bGUoeyBkaXNwbGF5OiAnYmxvY2snLCBvcGFjaXR5OiAxLCBvZmZzZXQ6IDEgfSksXHJcbiAgICAgICAgXSkpXHJcbiAgICAgIF0pLFxyXG4gICAgICB0cmFuc2l0aW9uKCd2aXNpYmxlID0+IGhpZGRlbicsIFtcclxuICAgICAgICBhbmltYXRlKCczMDBtcyBlYXNlLWluLW91dCcsIGtleWZyYW1lcyhbXHJcbiAgICAgICAgICBzdHlsZSh7IGRpc3BsYXk6ICdibG9jaycsIG9wYWNpdHk6IDEsIG9mZnNldDogMCB9KSxcclxuICAgICAgICAgIHN0eWxlKHsgZGlzcGxheTogJ25vbmUnLCBvcGFjaXR5OiAwLCBvZmZzZXQ6IDEgfSksXHJcbiAgICAgICAgXSkpXHJcbiAgICAgIF0pXHJcbiAgICBdKVxyXG4gIF1cclxufSlcclxuXHJcbmV4cG9ydCBjbGFzcyBJbnRlcmFjdGlvbnNQYW5lbENvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgQWZ0ZXJWaWV3SW5pdCB7XHJcblxyXG4gIGN1cnJlbnRPcGVuaW5nUGFyYW1ldGVyID0gbnVsbDtcclxuICBkcm9wRG93bkJ1dHRvbldhc0NsaWNrZWQgPSBmYWxzZTtcclxuICBkYXRlVGltZUJ1dHRvbldhc0NsaWNrZWQgPSBmYWxzZTtcclxuXHJcbiAgQFZpZXdDaGlsZCgnZWxlbWVudCcpIGVsZW1lbnQ6IEVsZW1lbnRSZWY7XHJcblxyXG4gIGNvbnN0cnVjdG9yKHB1YmxpYyBtb2RlbDogTW9kZWxTZXJ2aWNlLCBwdWJsaWMgaGVscGVyOiBIZWxwZXJTZXJ2aWNlLCBwdWJsaWMgaW50ZXJhY3Rpb25TZXJ2aWNlOiBJbnRlcmFjdGlvbnNTZXJ2aWNlLCBwdWJsaWMgbWVudVNlcnZpY2U6IE1lbnVTZXJ2aWNlLFxyXG4gICAgcHVibGljIGNvbnRyb2xsZXI6IENvbnRyb2xsZXJTZXJ2aWNlKSB7IH1cclxuXHJcbiAgbmdBZnRlclZpZXdJbml0KCk6IHZvaWQge1xyXG4gICAgdGhpcy5tb2RlbC5jb250cm9scy5wYXJhbWV0ZXJzUGFuZWwuZWwgPSB0aGlzLmVsZW1lbnQ7XHJcbiAgfVxyXG5cclxuICBuZ09uSW5pdCgpIHsgfVxyXG5cclxuICBnZXROYW1lQWxpZ24oaW5kZXhSb3c6IG51bWJlciwgaW5kZXhDb2x1bW46IG51bWJlcik6IHN0cmluZyB7XHJcbiAgICBjb25zdCBpbmRleCA9IHRoaXMuaW5kZXgoaW5kZXhSb3csIGluZGV4Q29sdW1uKTtcclxuICAgIGlmIChpbmRleCA8IHRoaXMubGVuZ3RoKCkgJiZcclxuICAgICAgdGhpcy5tb2RlbC5pbnRlcmFjdGlvbnMucGFyYW1zVmFyaWFibGVzW2luZGV4XS5iYXNpY1R5cGUgPT09ICdSYW5nZScgJiZcclxuICAgICAgdGhpcy5tb2RlbC5vcHRpb25zLmFwcGVhcmFuY2UucGFyYW1ldGVyc1BhbmVsUG9zaXRpb24gPT09ICdMZWZ0Jykge1xyXG4gICAgICByZXR1cm4gJ3RvcCc7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gJyc7XHJcbiAgfVxyXG5cclxuICBnZXROYW1lUGFkZGluZyhpbmRleFJvdzogbnVtYmVyLCBpbmRleENvbHVtbjogbnVtYmVyKTogc3RyaW5nIHtcclxuICAgIGNvbnN0IGluZGV4ID0gdGhpcy5pbmRleChpbmRleFJvdywgaW5kZXhDb2x1bW4pO1xyXG4gICAgaWYgKGluZGV4IDwgdGhpcy5sZW5ndGgoKSAmJlxyXG4gICAgICB0aGlzLm1vZGVsLmludGVyYWN0aW9ucy5wYXJhbXNWYXJpYWJsZXNbaW5kZXhdLmJhc2ljVHlwZSA9PT0gJ1JhbmdlJyAmJlxyXG4gICAgICB0aGlzLm1vZGVsLm9wdGlvbnMuYXBwZWFyYW5jZS5wYXJhbWV0ZXJzUGFuZWxQb3NpdGlvbiA9PT0gJ0xlZnQnKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1vZGVsLm9wdGlvbnMuaXNUb3VjaERldmljZSA/ICcxMXB4JyA6ICc5cHgnO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuICcnO1xyXG4gIH1cclxuXHJcbiAgZ2V0Q2FwdGlvbihpbmRleFJvdzogbnVtYmVyLCBpbmRleENvbHVtbjogbnVtYmVyLCBjaGVja0xlZnQgPSB0cnVlKTogc3RyaW5nIHtcclxuICAgIGNvbnN0IGluZGV4ID0gdGhpcy5pbmRleChpbmRleFJvdywgaW5kZXhDb2x1bW4pO1xyXG4gICAgaWYgKGNoZWNrTGVmdCAmJiB0aGlzLmlmTGVmdFJhbmdlKGluZGV4Um93LCBpbmRleENvbHVtbikpIHtcclxuICAgICAgcmV0dXJuICcnO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGluZGV4IDwgdGhpcy5sZW5ndGgoKSA/IHRoaXMubW9kZWwuaW50ZXJhY3Rpb25zLnBhcmFtc1ZhcmlhYmxlc1tpbmRleF0uYWxpYXMgOiAnJztcclxuICB9XHJcblxyXG4gIGlmTGVmdFJhbmdlKGluZGV4Um93OiBudW1iZXIsIGluZGV4Q29sdW1uOiBudW1iZXIpOiBib29sZWFuIHtcclxuICAgIGNvbnN0IGluZGV4ID0gdGhpcy5pbmRleChpbmRleFJvdywgaW5kZXhDb2x1bW4pO1xyXG4gICAgcmV0dXJuIHRoaXMubW9kZWwuaW50ZXJhY3Rpb25zLnBhcmFtc1ZhcmlhYmxlc1tpbmRleF0uYmFzaWNUeXBlID09PSAnUmFuZ2UnICYmIHRoaXMubW9kZWwub3B0aW9ucy5hcHBlYXJhbmNlLnBhcmFtZXRlcnNQYW5lbFBvc2l0aW9uID09PSAnTGVmdCc7XHJcbiAgfVxyXG5cclxuICBnZXRUaXRsZShpbmRleFJvdzogbnVtYmVyLCBpbmRleENvbHVtbjogbnVtYmVyKTogc3RyaW5nIHtcclxuICAgIGNvbnN0IGluZGV4ID0gdGhpcy5pbmRleChpbmRleFJvdywgaW5kZXhDb2x1bW4pO1xyXG4gICAgcmV0dXJuIGluZGV4IDwgdGhpcy5sZW5ndGgoKSA/IHRoaXMubW9kZWwuaW50ZXJhY3Rpb25zLnBhcmFtc1ZhcmlhYmxlc1tpbmRleF0uZGVzY3JpcHRpb24gOiAnJztcclxuICB9XHJcblxyXG4gIGluZGV4KGluZGV4Um93OiBudW1iZXIsIGluZGV4Q29sdW1uOiBudW1iZXIpOiBudW1iZXIge1xyXG4gICAgcmV0dXJuIGluZGV4Q29sdW1uICogdGhpcy5tb2RlbC5pbnRlcmFjdGlvbnMuY291bnRJbkNvbHVtbi5sZW5ndGggKyBpbmRleFJvdztcclxuICB9XHJcblxyXG4gIGxlbmd0aCgpOiBudW1iZXIge1xyXG4gICAgcmV0dXJuIHRoaXMubW9kZWwuaW50ZXJhY3Rpb25zPy5wYXJhbXNWYXJpYWJsZXMgIT0gbnVsbCA/IE9iamVjdC5rZXlzKHRoaXMubW9kZWwuaW50ZXJhY3Rpb25zPy5wYXJhbXNWYXJpYWJsZXMpLmxlbmd0aCA6IDA7XHJcbiAgfVxyXG5cclxuICBnZXQgY2xhc3NOYW1lKCk6IHN0cmluZyB7XHJcbiAgICBsZXQgY2xhc3NOYW1lID0gJ3N0aUpzVmlld2VyUGFyYW1ldGVyc1BhbmVsJztcclxuXHJcbiAgICBpZiAodGhpcy5tb2RlbC5vcHRpb25zLmFwcGVhcmFuY2UucGFyYW1ldGVyc1BhbmVsUG9zaXRpb24gPT09ICdUb3AnKSB7XHJcbiAgICAgIGNsYXNzTmFtZSArPSAnIHN0aUpzVmlld2VyUGFyYW1ldGVyc1BhbmVsVG9wJztcclxuXHJcbiAgICAgIGlmICh0aGlzLm1vZGVsLm9wdGlvbnMudG9vbGJhci5kaXNwbGF5TW9kZSA9PT0gJ1NlcGFyYXRlZCcpIHtcclxuICAgICAgICBjbGFzc05hbWUgKz0gJyBzdGlKc1ZpZXdlclBhcmFtZXRlcnNQYW5lbFNlcGFyYXRlZFRvcCc7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gY2xhc3NOYW1lO1xyXG4gIH1cclxuXHJcbiAgZ2V0IHRvcCgpOiBudW1iZXIge1xyXG4gICAgbGV0IHN0eWxlVG9wID0gdGhpcy5tb2RlbC5vcHRpb25zLnRvb2xiYXIudmlzaWJsZSA/IHRoaXMubW9kZWwuY29udHJvbHMudG9vbGJhci5vZmZzZXRIZWlnaHQgOiAwO1xyXG4gICAgaWYgKHRoaXMubW9kZWwub3B0aW9ucy5pc01vYmlsZURldmljZSAmJiB0aGlzLm1vZGVsLm9wdGlvbnMudG9vbGJhci5hdXRvSGlkZSkge1xyXG4gICAgICBzdHlsZVRvcCA9IDA7XHJcbiAgICB9XHJcbiAgICBzdHlsZVRvcCArPSB0aGlzLm1vZGVsLmNvbnRyb2xzLmRyaWxsRG93blBhbmVsLmV4aXN0cyA/IHRoaXMubW9kZWwuY29udHJvbHMuZHJpbGxEb3duUGFuZWwub2Zmc2V0SGVpZ2h0IDogMDtcclxuICAgIHN0eWxlVG9wICs9IHRoaXMubW9kZWwuY29udHJvbHMuZmluZFBhbmVsLmV4aXN0cyA/IHRoaXMubW9kZWwuY29udHJvbHMuZmluZFBhbmVsLm9mZnNldEhlaWdodCA6IDA7XHJcbiAgICBzdHlsZVRvcCArPSB0aGlzLm1vZGVsLmNvbnRyb2xzLnJlc291cmNlc1BhbmVsLmV4aXN0cyA/IHRoaXMubW9kZWwuY29udHJvbHMucmVzb3VyY2VzUGFuZWwub2Zmc2V0SGVpZ2h0IDogMDtcclxuICAgIHJldHVybiBzdHlsZVRvcDtcclxuICB9XHJcblxyXG4gIGdldCBib3R0b20oKTogc3RyaW5nIHtcclxuICAgIGlmICh0aGlzLm1vZGVsLm9wdGlvbnMuYXBwZWFyYW5jZS5wYXJhbWV0ZXJzUGFuZWxQb3NpdGlvbiA9PT0gJ0xlZnQnKSB7XHJcbiAgICAgIGlmICh0aGlzLm1vZGVsLm9wdGlvbnMuaXNNb2JpbGVEZXZpY2UpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5tb2RlbC5vcHRpb25zLnRvb2xiYXIuYXV0b0hpZGUgPyAnMCcgOiAnMC41aW4nO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJldHVybiB0aGlzLm1vZGVsLm9wdGlvbnMudG9vbGJhci5kaXNwbGF5TW9kZSA9PT0gJ1NlcGFyYXRlZCcgJiYgdGhpcy5tb2RlbC5vcHRpb25zLnRvb2xiYXIudmlzaWJsZSA/ICczNXB4JyA6ICcwJztcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuICcnO1xyXG4gIH1cclxuXHJcbiAgZ2V0IGlubmVyQ2xhc3NOYW1lKCk6IHN0cmluZyB7XHJcbiAgICBsZXQgY2xhc3NOYW1lID0gdGhpcy5tb2RlbC5vcHRpb25zLnRvb2xiYXIuZGlzcGxheU1vZGUgPT09ICdTaW1wbGUnID8gJ3N0aUpzVmlld2VySW5uZXJQYXJhbWV0ZXJzUGFuZWxTaW1wbGUnIDogJyc7XHJcblxyXG4gICAgaWYgKHRoaXMubW9kZWwub3B0aW9ucy5hcHBlYXJhbmNlLnBhcmFtZXRlcnNQYW5lbFBvc2l0aW9uID09PSAnTGVmdCcpIHtcclxuICAgICAgY2xhc3NOYW1lICs9ICcgc3RpSnNWaWV3ZXJJbm5lclBhcmFtZXRlcnNQYW5lbExlZnQnO1xyXG4gICAgICBpZiAodGhpcy5tb2RlbC5vcHRpb25zLnRvb2xiYXIuZGlzcGxheU1vZGUgPT09ICdTZXBhcmF0ZWQnKSB7XHJcbiAgICAgICAgY2xhc3NOYW1lICs9ICcgc3RpSnNWaWV3ZXJJbm5lclBhcmFtZXRlcnNQYW5lbFNlcGFyYXRlZExlZnQnO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gY2xhc3NOYW1lO1xyXG4gIH1cclxuXHJcbn1cclxuIl19