import { __decorate } from "tslib";
import { Component, Input, ViewChild } from '@angular/core';
import { ModelService } from '../services/model.service';
import { ControllerService } from '../services/controller.service';
var OpenDialogComponent = /** @class */ (function () {
    function OpenDialogComponent(model, controller) {
        this.model = model;
        this.controller = controller;
    }
    OpenDialogComponent.prototype.ngOnChanges = function (changes) {
        var _this = this;
        if (this.fileMask != null && this.model.openDialogFileMask != null) {
            setTimeout(function () {
                _this.element.nativeElement.focus();
                _this.element.nativeElement.click();
            });
        }
    };
    OpenDialogComponent.prototype.ngOnInit = function () { };
    OpenDialogComponent.prototype.onchange = function (event) {
        var _this = this;
        var files = event.target.files;
        var fileName = files[0] ? files[0].name : 'Report';
        var filePath = event.target.value;
        var reader = new FileReader();
        reader.onload = function (e) {
            _this.controller.loadFile(fileName, e.target.result);
        };
        this.model.openDialogFileMask = null;
        reader.readAsDataURL(files[0]);
    };
    OpenDialogComponent.ctorParameters = function () { return [
        { type: ModelService },
        { type: ControllerService }
    ]; };
    __decorate([
        ViewChild('element')
    ], OpenDialogComponent.prototype, "element", void 0);
    __decorate([
        Input()
    ], OpenDialogComponent.prototype, "fileMask", void 0);
    OpenDialogComponent = __decorate([
        Component({
            selector: 'sti-open-dialog',
            template: "\n    <input #element *ngIf=\"model.openDialogFileMask != null\"  type=\"file\" name=\"files[]\" multiple=\"\" style=\"display: none;\"\n      [attr.accept]=\"model.openDialogFileMask\"\n      (change)=\"onchange($event)\">\n  "
        })
    ], OpenDialogComponent);
    return OpenDialogComponent;
}());
export { OpenDialogComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib3Blbi1kaWFsb2cuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vc3RpbXVsc29mdC12aWV3ZXItYW5ndWxhci8iLCJzb3VyY2VzIjpbImxpYi9jb21wb25lbnRzL29wZW4tZGlhbG9nLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBVSxLQUFLLEVBQWEsU0FBUyxFQUFjLE1BQU0sZUFBZSxDQUFDO0FBQzNGLE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSwyQkFBMkIsQ0FBQztBQUN6RCxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxnQ0FBZ0MsQ0FBQztBQVduRTtJQU1FLDZCQUFtQixLQUFtQixFQUFTLFVBQTZCO1FBQXpELFVBQUssR0FBTCxLQUFLLENBQWM7UUFBUyxlQUFVLEdBQVYsVUFBVSxDQUFtQjtJQUFJLENBQUM7SUFFakYseUNBQVcsR0FBWCxVQUFZLE9BQThDO1FBQTFELGlCQU9DO1FBTkMsSUFBSSxJQUFJLENBQUMsUUFBUSxJQUFJLElBQUksSUFBSSxJQUFJLENBQUMsS0FBSyxDQUFDLGtCQUFrQixJQUFJLElBQUksRUFBRTtZQUNsRSxVQUFVLENBQUM7Z0JBQ1QsS0FBSSxDQUFDLE9BQU8sQ0FBQyxhQUFhLENBQUMsS0FBSyxFQUFFLENBQUM7Z0JBQ25DLEtBQUksQ0FBQyxPQUFPLENBQUMsYUFBYSxDQUFDLEtBQUssRUFBRSxDQUFDO1lBQ3JDLENBQUMsQ0FBQyxDQUFDO1NBQ0o7SUFDSCxDQUFDO0lBRUQsc0NBQVEsR0FBUixjQUFhLENBQUM7SUFFZCxzQ0FBUSxHQUFSLFVBQVMsS0FBVTtRQUFuQixpQkFZQztRQVhDLElBQU0sS0FBSyxHQUFVLEtBQUssQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDO1FBQ3hDLElBQU0sUUFBUSxHQUFHLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDO1FBQ3JELElBQU0sUUFBUSxHQUFHLEtBQUssQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDO1FBQ3BDLElBQU0sTUFBTSxHQUFHLElBQUksVUFBVSxFQUFFLENBQUM7UUFFaEMsTUFBTSxDQUFDLE1BQU0sR0FBRyxVQUFDLENBQU07WUFDckIsS0FBSSxDQUFDLFVBQVUsQ0FBQyxRQUFRLENBQUMsUUFBUSxFQUFFLENBQUMsQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDdEQsQ0FBQyxDQUFDO1FBRUYsSUFBSSxDQUFDLEtBQUssQ0FBQyxrQkFBa0IsR0FBRyxJQUFJLENBQUM7UUFDckMsTUFBTSxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUNqQyxDQUFDOztnQkF6QnlCLFlBQVk7Z0JBQXFCLGlCQUFpQjs7SUFKdEQ7UUFBckIsU0FBUyxDQUFDLFNBQVMsQ0FBQzt3REFBcUI7SUFFakM7UUFBUixLQUFLLEVBQUU7eURBQWtCO0lBSmYsbUJBQW1CO1FBVC9CLFNBQVMsQ0FBQztZQUNULFFBQVEsRUFBRSxpQkFBaUI7WUFDM0IsUUFBUSxFQUFFLHFPQUlUO1NBQ0YsQ0FBQztPQUVXLG1CQUFtQixDQWlDL0I7SUFBRCwwQkFBQztDQUFBLEFBakNELElBaUNDO1NBakNZLG1CQUFtQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgT25Jbml0LCBJbnB1dCwgT25DaGFuZ2VzLCBWaWV3Q2hpbGQsIEVsZW1lbnRSZWYgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgTW9kZWxTZXJ2aWNlIH0gZnJvbSAnLi4vc2VydmljZXMvbW9kZWwuc2VydmljZSc7XHJcbmltcG9ydCB7IENvbnRyb2xsZXJTZXJ2aWNlIH0gZnJvbSAnLi4vc2VydmljZXMvY29udHJvbGxlci5zZXJ2aWNlJztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gIHNlbGVjdG9yOiAnc3RpLW9wZW4tZGlhbG9nJyxcclxuICB0ZW1wbGF0ZTogYFxyXG4gICAgPGlucHV0ICNlbGVtZW50ICpuZ0lmPVwibW9kZWwub3BlbkRpYWxvZ0ZpbGVNYXNrICE9IG51bGxcIiAgdHlwZT1cImZpbGVcIiBuYW1lPVwiZmlsZXNbXVwiIG11bHRpcGxlPVwiXCIgc3R5bGU9XCJkaXNwbGF5OiBub25lO1wiXHJcbiAgICAgIFthdHRyLmFjY2VwdF09XCJtb2RlbC5vcGVuRGlhbG9nRmlsZU1hc2tcIlxyXG4gICAgICAoY2hhbmdlKT1cIm9uY2hhbmdlKCRldmVudClcIj5cclxuICBgXHJcbn0pXHJcblxyXG5leHBvcnQgY2xhc3MgT3BlbkRpYWxvZ0NvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgT25DaGFuZ2VzIHtcclxuXHJcbiAgQFZpZXdDaGlsZCgnZWxlbWVudCcpIGVsZW1lbnQ6IEVsZW1lbnRSZWY7XHJcblxyXG4gIEBJbnB1dCgpIGZpbGVNYXNrOiBzdHJpbmc7XHJcblxyXG4gIGNvbnN0cnVjdG9yKHB1YmxpYyBtb2RlbDogTW9kZWxTZXJ2aWNlLCBwdWJsaWMgY29udHJvbGxlcjogQ29udHJvbGxlclNlcnZpY2UpIHsgfVxyXG5cclxuICBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBpbXBvcnQoJ0Bhbmd1bGFyL2NvcmUnKS5TaW1wbGVDaGFuZ2VzKTogdm9pZCB7XHJcbiAgICBpZiAodGhpcy5maWxlTWFzayAhPSBudWxsICYmIHRoaXMubW9kZWwub3BlbkRpYWxvZ0ZpbGVNYXNrICE9IG51bGwpIHtcclxuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50Lm5hdGl2ZUVsZW1lbnQuZm9jdXMoKTtcclxuICAgICAgICB0aGlzLmVsZW1lbnQubmF0aXZlRWxlbWVudC5jbGljaygpO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIG5nT25Jbml0KCkgeyB9XHJcblxyXG4gIG9uY2hhbmdlKGV2ZW50OiBhbnkpIHtcclxuICAgIGNvbnN0IGZpbGVzOiBhbnlbXSA9IGV2ZW50LnRhcmdldC5maWxlcztcclxuICAgIGNvbnN0IGZpbGVOYW1lID0gZmlsZXNbMF0gPyBmaWxlc1swXS5uYW1lIDogJ1JlcG9ydCc7XHJcbiAgICBjb25zdCBmaWxlUGF0aCA9IGV2ZW50LnRhcmdldC52YWx1ZTtcclxuICAgIGNvbnN0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XHJcblxyXG4gICAgcmVhZGVyLm9ubG9hZCA9IChlOiBhbnkpID0+IHtcclxuICAgICAgdGhpcy5jb250cm9sbGVyLmxvYWRGaWxlKGZpbGVOYW1lLCBlLnRhcmdldC5yZXN1bHQpO1xyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLm1vZGVsLm9wZW5EaWFsb2dGaWxlTWFzayA9IG51bGw7XHJcbiAgICByZWFkZXIucmVhZEFzRGF0YVVSTChmaWxlc1swXSk7XHJcbiAgfVxyXG5cclxufVxyXG4iXX0=