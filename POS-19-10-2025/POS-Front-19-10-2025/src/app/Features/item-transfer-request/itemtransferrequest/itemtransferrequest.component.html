<app-breadcrumbs></app-breadcrumbs>
<form name="itemtransferrequestform" class="" #frmRef="ngForm" (ngSubmit)="(frmRef.form.valid)" novalidate>
  <app-pagetransactions
    (quickEvents)="quickEvents($event)"
    (returnobjEvent)="returnobjEvent($event)"
    (afterPag)="afterPag($event)"
    (clearobjEvent)="clearobject()"
    [form]="frmRef"
    [service]="service"
    [formobj]="responseobj"
    [pagename]="pagename"
    [pageNumber]="pageNumber"
    [request]="request">
  </app-pagetransactions>

  <div class="container-fluid mt-3">
    <div class="row">
      <div class="col-lg-5 col-md-5 col-sm-12">
        <!-- groups -->
        <div class="group-section ms-panel-order">
          <div class="tab-pane active show fade in" id="tab4" role="tabpanel">
            <div class="row">
              <div class="col-md-12">
                <div class="row">
                  <!-- <div class="col-md-12 col-xs-12">
                    <app-search-component
                      [FilterOne]="itemsGroups"
                      (returnedList)="updateFilterTwo($event)"
                      class="mt-3 mb-3"
                    ></app-search-component>
                  </div> -->
                  <div class="col-lg-12 col-md-12 col-12">
                    <perfect-scrollbar [config]="true" id="itemScorll">
                      <div class="container-fluid">
                        <div class="row">
                          <ul
                            class="nav nav-tabs d-flex has-gap nav-justified nav-tabs-editM groupsUl align-items-center group-section-item">
                            <li class="col-lg-2" *ngFor="let itemgroup of filterdItemlistTwo; let i = index">
                              <a
                                class="rounded"
                                [class.active]="i == 0"
                                aria-controls="tab4"
                                role="tab"
                                data-toggle="tab"
                                (click)="loadItems(itemgroup)">
                                {{ itemgroup.Name }}
                              </a>
                            </li>
                          </ul>
                        </div>
                      </div>
                    </perfect-scrollbar>
                  </div>
                  <!-- <div class="col-md-12">
                    <perfect-scrollbar
                      [config]="true"
                      class="col-sm-12 col-xs-12"
                      id="itemScorll"
                    >
                      <ul
                        id="GroupNav"
                        class="nav EditBox  nav-tabs-editM"
                        role="tablist"
                      >
                        <li
                          class="p-0 m-0"
                          role="presentation"
                          *ngFor="
                            let itemgroup of filterdItemlistTwo;
                            let i = index
                          "
                        >
                          <a
                            class="btn m-0 p-0"
                            [class.active]="i == 0"
                            [class.disabled]="disableControlEdit"
                            aria-controls="tab4"
                            role="tab"
                            (click)="loadItems(itemgroup)"
                            data-toggle="tab"
                          >
                            <p class="narrow breakAll m-0 p-0">
                              {{ itemgroup.Name }}
                            </p>
                          </a>
                        </li>
                      </ul>
                    </perfect-scrollbar>
                  </div> -->
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Menu -->
        <div class="presentaion-section ms-panel-order">
          <!--  Right details -->
          <!-- search feild -->
          <div class="col-lg-12 col-md-12 col-xs-12">
            <app-search-component
              [FilterOne]="itemlist"
              (returnedList)="updateFilterOne($event)"
              class="mt-3 mb-3"></app-search-component>
          </div>
          <!--search Start-->
          <!--end search -->
          <!-- show details -->
          <div class="col-lg-12">
            <perfect-scrollbar [config]="true">
              <div class="container-fluid">
                <ul
                  class="row nav nav-tabs d-flex has-gap nav-justified nav-tabs-editM groupsUl align-items-center group-section-item"
                  role="tablist">
                  <li role="presentation" *ngFor="let item of filterdItemlist; let i = index" class="col-lg-2">
                    <a
                      [class.active]="i == 0"
                      [class.disabled]="disableControlEdit == 1"
                      aria-controls="tab4"
                      role="tab"
                      data-toggle="tab"
                      class="rounded"
                      (click)="showUnits(item)">
                      {{ item.Name }}
                    </a>
                  </li>
                </ul>
              </div>
            </perfect-scrollbar>
          </div>
        </div>
      </div>

      <!--End Right details -->
      <!-- Start left Details -->

      <div class="col-lg-7 col-md-7 col-sm-12">
        <!-- master -->
        <div class="masterStyle">
          <div class="row mb-1">
            <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4 col-4 mb-3">
              <label class="lable"> {{ "stock.TransferStock" | translate }}</label>
              <ejs-combobox
                name="StockDocumentId"
                #StockDocumentId="ngModel"
                [(ngModel)]="responseobj.StockDocumentId"
                [allowFiltering]="true"
                [autofill]="true"
                [dataSource]="StockList"
                placeholder="{{ 'stock.Select TransferStock' | translate }}"
                [fields]="StockFlds"
                class="form-control borderRadius"
                id="stock_id"
                [enabled]="false"
                [required]="isRequired"></ejs-combobox>
              <div
                *ngIf="
                  (frmRef.submitted && StockDocumentId.invalid) || (StockDocumentId.invalid && StockDocumentId.touched)
                "
                class="mt-2">
                <div class="alert alert-danger stockValidationError">
                  {{ "Shared.required" | translate }}
                </div>
              </div>

              <!-- popover stores -->
              <popover-content
                #storesPopover
                title="{{ 'stock.TransferStock' | translate }}"
                placement="bottom"
                [animation]="true"
                [closeOnClickOutside]="true">
                <ul
                  class="row nav nav-tabs d-flex tab-pills has-gap nav-justified nav-tabs-editM align-items-center"
                  role="tablist"></ul>
              </popover-content>

              <!-- end popover stores -->
            </div>
            <div class="col-lg-4 col-md-4 col-sm-6 col-xs-12 col-12 mb-3">
              <label class="lable"> {{ "stock.DocumentDate" | translate }}</label>
              <ejs-datepicker
                class="pAsolute absolutePosition"
                format="MM/dd/yyyy"
                name="date"
                #date="ngModel"
                [(ngModel)]="responseobj.DocumentDate"
                [disabled]="true"
                [ngClass]="{ 'alert-danger': frmRef.submitted && date.invalid }"
                class="form-control borderRadius Prelative"
                id="date"
                placeholder="mm/dd/yyyy"
                required></ejs-datepicker>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-6 col-xs-12 col-12 mb-3">
              <label class="lable"> {{ "stock.CostCenter" | translate }}</label>
              <ejs-combobox
                name="CostCenterDocumentId"
                #CostCenterDocumentId="ngModel"
                [(ngModel)]="responseobj.CostCenterDocumentId"
                [allowFiltering]="true"
                [autofill]="true"
                [dataSource]="CostCentersList"
                placeholder="{{ 'Shared.Select' | translate }}"
                [fields]="CostCentersFlds"
                class="form-control borderRadius"
                id="costCenter_id"
                [enabled]="false"></ejs-combobox>
              <div
                *ngIf="
                  (frmRef.submitted && CostCenterDocumentId.invalid) ||
                  (CostCenterDocumentId.invalid && CostCenterDocumentId.touched)
                "
                class="mt-1 mb-1">
                <div class="alert alert-danger stockValidationError">
                  {{ "Shared.required" | translate }}
                </div>
              </div>
              <popover-content
                #storesPopover
                title="{{ 'stock.CostCenter' | translate }}"
                placement="bottom"
                [animation]="true"
                [closeOnClickOutside]="true">
                <ul
                  class="row nav nav-tabs d-flex tab-pills has-gap nav-justified nav-tabs-editM align-items-center"
                  role="tablist"></ul>
              </popover-content>
            </div>
          </div>
          <!-- </form> -->
          <div class="row mb-2">
            <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4 col-4">
              <div class="form-group m-0 form-input">
                <label class="lable m-0"> {{ "stock.DocumentNumber" | translate }}</label>
                <input
                  type="text"
                  [(ngModel)]="responseobj.DocumentNumber"
                  class="form-control"
                  name="docno"
                  readonly />
                <div class="invalid-feedback"></div>
              </div>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4 col-4">
              <div class="form-group m-0 form-input">
                <label class="lable m-0">{{ "stock.Reference" | translate }}</label>
                <input
                  name="reference"
                  class="form-control"
                  placeholder="{{ 'stock.Reference' | translate }}"
                  [(ngModel)]="responseobj.Reference" />
                <div class="invalid-feedback"></div>
              </div>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4 col-4">
              <div class="form-group m-0">
                <label class="lable m-0">{{ "stock.Description" | translate }}</label>
                <input
                  name="description"
                  class="form-control"
                  placeholder="{{ 'stock.Description' | translate }}"
                  [(ngModel)]="responseobj.Description" />

                <div class="invalid-feedback"></div>
              </div>
            </div>
          </div>
        </div>
        <div class="ms-panel ms-panel-order Prelative panelDetails">
          <div class="">
            <perfect-scrollbar [config]="true" class="table-responsive mt-3">
              <!-- <table class="table table-bordered text-dark table-striped mb-2">
                <thead>
                  <tr>
                    <th colspan="3">
                      {{ 'stock.Item' | translate }}
                    </th>
                    <th scope="col" colspan="3">{{ 'stock.Unit' | translate }}</th>
                    <th scope="col" colspan="1">{{ 'stock.Quantity' | translate }}</th>
                    <th scope="col">{{ 'stock.Description' | translate }}</th>
                    <th scope="col" *ngIf="!responseobj.Sent">
                      {{ 'stock.Actions' | translate }}
                    </th>
                  </tr>
                </thead>
                <tbody>
                  <tr
                    *ngFor="
                      let detail of responseobj.ItemTransferRequestDetails;
                      let i = index
                    "
                  >
                    <td colspan="3">
                      <div class="input-group editInputGroup">
                        <select
                          name="itemselect{{ i }}"
                          id="{{ i }}"
                          class="form-control qty"
                          required
                          disabled
                          [(ngModel)]="detail.ItemId"
                          (click)="checkDuplication(detail)"
                        >
                          <option
                            *ngFor="let item of items"
                            [value]="item.Id"
                            class="form-control qty"
                          >
                            {{ item.Name }}
                          </option>
                        </select>
                      </div>
                    </td>
                    <td colspan="3">
                      <div>
                        <div class="input-group editInputGroup">
                          <div class="input-group">
                            <select
                              name="unitselect{{ i }}"
                              id="{{ i }}"
                              class="form-control"
                              required
                              [disabled]="responseobj.Sent"
                              [(ngModel)]="detail.UnitId"
                              (click)="checkDuplication(detail)"
                            >
                              <option
                                *ngFor="let unit of gtSelectedUnits(detail)"
                                [value]="unit.Id"
                              >
                                {{ unit.Name }}
                              </option>
                            </select>
                          </div>
                        </div>
                      </div>
                    </td>
                    <td class="desc" colspan="1">
                      <div class="desc">
                        <input
                          name="qty{{ i }}"
                          type="number"
                          class="form-control borderRadius qty"
                          required
                          [(ngModel)]="detail.Quantity"
                          [disabled]="responseobj.Sent"
                        />
                      </div>
                    </td>
                    <td class="desc" colspan="1"> 
                      <div class="desc">
                        <input
                          name="des{{ i }}"
                          class="form-control borderRadius qty"
                          [(ngModel)]="detail.Description"
                          [disabled]="responseobj.Sent"
                        />
                      </div>
                    </td>
                    <td *ngIf="!responseobj.Sent">
                      <div class="d-flex">
                        <i
                          class="far fa-edit"
                          data-placement="bottom"
                          data-toggle="tooltip"
                          role="presentation"
                          title="{{ 'pagetransactions.Edit' | translate }}"
                        ></i>
                        <i
                          class="far fa-trash-alt"
                          role="presentation"
                          (click)="deleteRow(i)"
                        ></i>
                      </div>
                    </td>
                  </tr>
                </tbody>
              </table> -->
              <div class="container-fluid mt-2">
                <div class="row">
                  <div class="col-lg-12">
                    <table class="table table-bordered">
                      <thead>
                        <tr>
                          <th scope="col">{{ "stock.Item" | translate }}</th>
                          <th scope="col">{{ "stock.Unit" | translate }}</th>
                          <th scope="col" colspan="1">
                            {{ "stock.Quantity" | translate }}
                          </th>
                          <th scope="col">
                            {{ "stock.Description" | translate }}
                          </th>
                          <th scope="col" *ngIf="!responseobj.Sent">
                            {{ "stock.Actions" | translate }}
                          </th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr *ngFor="let detail of responseobj.ItemTransferRequestDetails; let i = index">
                          <td>
                            <select
                              name="itemselect{{ i }}"
                              id="{{ i }}"
                              class="form-control qty p-0"
                              required
                              disabled
                              [(ngModel)]="detail.ItemId"
                              (click)="checkDuplication(detail)">
                              <option *ngFor="let item of items" [value]="item.Id" class="form-control qty">
                                {{ item.Name }}
                              </option>
                            </select>
                          </td>
                          <td>
                            <select
                              name="unitselect{{ i }}"
                              id="{{ i }}"
                              class="form-control p-0"
                              required
                              [disabled]="responseobj.Sent"
                              [(ngModel)]="detail.UnitId"
                              (click)="checkDuplication(detail)">
                              <option *ngFor="let unit of gtSelectedUnits(detail)" [value]="unit.Id">
                                {{ unit.Name }}
                              </option>
                            </select>
                          </td>
                          <td class="quantiy">
                            <input
                              name="qty{{ i }}"
                              type="number"
                              class="form-control p-0"
                              required
                              [(ngModel)]="detail.Quantity"
                              [disabled]="responseobj.Sent" />
                          </td>
                          <td class="desc">
                            <input
                              name="des{{ i }}"
                              class="form-control borderRadius qty p-0"
                              [(ngModel)]="detail.Description"
                              [disabled]="responseobj.Sent" />
                          </td>
                          <td *ngIf="!responseobj.Sent">
                            <div class="d-flex">
                              <i
                                class="far fa-edit"
                                data-placement="bottom"
                                data-toggle="tooltip"
                                role="presentation"
                                title="{{ 'pagetransactions.Edit' | translate }}"></i>
                              <i class="far fa-trash-alt" role="presentation" (click)="deleteRow(i)"></i>
                            </div>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </perfect-scrollbar>
          </div>
          <!-- <ejs-grid #grid id='Grid' [dataSource]='responseobj.ItemTransferRequestDetails' [allowPaging]='true'
            [pageSettings]='pageSettings' rowHeight='38' [allowSorting]='true' [allowFiltering]='true'
            [filterSettings]='filterOptions' [toolbar]='toolbarOptions' [allowGrouping]='true' [allowPdfExport]='true'
            [allowExcelExport]='true' [editSettings]='editOptions' height='299.2px'>
            <e-columns>
             
              <e-column field='ItemId' headerText='الصنف' textAlign='Right' width=120></e-column>
              <e-column field='UnitId' headerText='وحدة الصنف' editType='dropdownedit' [edit]='ddParams'
                textAlign='Right' width=110 format='C2'></e-column>
              <e-column field='Quantity' headerText='الكمية' editType='numericedit' [edit]='numericParams'
                textAlign='Right' width=120></e-column>
              <e-column input type="text" formControlName="itemDescription" class="form-control" headerText='وصف الصنف'
                field='Description' textAlign='Right' width=100></e-column>
              <e-column headerText='الوحدات' field='UnitId2' textAlign='Right' width=100 editType='dropdownedit'
                [edit]='unitParams'>

              </e-column>
              <e-column field='Actions' headerText='العمليات' [commands]='commands' textAlign='center' width=100>
              </e-column>
            </e-columns>
          </ejs-grid> -->
        </div>
        <!-- End List Details -->
        <!--forms-->
        <form>
          <script>
            // Hide Placeholder On Form Focus

            $("[placeholder]")
              .focus(function () {
                $(this).attr("data-text", $(this).attr("placeholder"));

                $(this).attr("placeholder", "");
              })
              .blur(function () {
                $(this).attr("placeholder", $(this).attr("data-text"));
              });
          </script>
          <!-- <button  [popoverOnHover]="true"  [popover]="myPopover" class="btn btn-primary"   >إلغاء</button> -->
        </form>
        <!-- End forms-->
      </div>

      <!-- end left Details   -->
    </div>
  </div>
</form>
