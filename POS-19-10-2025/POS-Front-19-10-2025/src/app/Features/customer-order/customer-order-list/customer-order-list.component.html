<app-breadcrumbs *ngIf="!dialogData?.isPopUp"></app-breadcrumbs>
<div class="row d-flex ">
  <div class="col-md-4 pr-5">
    <div class="input-group editInputGroup">
      <div class="input-group-addon">
        <i class="fas fa-user" aria-hidden="true"></i>
      </div>
      <div class="input-group">
        <input
          #searchKeyList
          name="searchKeyList"
          class="form-control"
          type="text"
          [(ngModel)]="searchKey"
          (keyup)="filterList($event)"
          [placeholder]="'Shared.searchByPhoneorNumberorCustomerOrder' | translate"
          />
      </div>
    </div>
  </div>
  <div class="col-md-4 p-0">
    <div class="input-group editInputGroup">
      <div class="input-group-addon">
        <i class="fas fa-user" aria-hidden="true"></i>
      </div>
      <div class="input-group">
        <input
        name="searchBySerial"
        class="form-control"
        type="number"
        [(ngModel)]="searchBySerial"
        (keyup)="fileterBySerial($event)"
        [placeholder]="'Shared.searchBySerialNum' | translate"
        />
      </div>
    </div>
  </div>
  <div class="col-md-4 p-0">
    <div class="input-group editInputGroup">
      <div class="input-group-addon">
        <i class="fas fa-user" aria-hidden="true"></i>
      </div>
      <div class="input-group">
        <input
        name="searchByReceiver"
        class="form-control"
        type="text"
        [(ngModel)]="searchByReceiver"
        (keyup)="fileterByReceiver($event)"
        [placeholder]="'Shared.searchByReceiver' | translate"
        />
      </div>
    </div>
  </div>
</div>
<h1 mat-dialog-title *ngIf="dialogData?.isPopUp">{{dialogData?.title | translate }}</h1>
<div class="col-lg-12">
  <div class="ms-card">
    <div class="ms-card-body" *ngIf="responseobj?.List">
      <ejs-grid
        #grid
        id="Grid"
        height="400"
        [dataSource]="responseobj.List"
        (rowDataBound)="onRowDataBound($event)"
        [allowPaging]="true"
        [pageSettings]="pageSettings"
        [allowSorting]="true"
        [allowFiltering]="true"
        [filterSettings]="filterOptions"
        [toolbar]="toolbarOptions"
        (rowSelected)="onRowSelected($event)"
        [allowGrouping]="true"
        [allowPdfExport]="true"
        [allowExcelExport]="true"
        (toolbarClick)="toolbarClick($event)"
        [editSettings]="editOptions">
        <e-columns>
          <e-column
            field="CreationTime"
            width="120"
            headerText="{{ 'Shared.Creationdate' | translate }}"
            type="date"
            [format]="onlyDateFormat"
            textAlign="center"></e-column>
          <e-column
            field="ReceivedDate"
            width="120"
            headerText="{{ 'CustomerOrder.ReceivedDate' | translate }}"
            type="date"
            [format]="onlyDateFormat"
            textAlign="center"></e-column>
          <e-column
            field="CustomerName"
            width="120"
            headerText="{{ 'returninsurance.CustomerName' | translate }}"
            textAlign="center"></e-column>
          <e-column
            field="CustomerPhone"
            width="120"
            headerText="{{ 'Shared.customerPhone' | translate }}"
            textAlign="center"></e-column>
          <e-column
            field="ReceiverName"
            width="120"
            headerText="{{ 'CustomerOrder.ReceiverName' | translate }}"
            textAlign="center"></e-column>
          <e-column
            field="SubTotal"
            width="110"
            headerText="{{ 'ReturnOrder.SubTotal' | translate }}"
            textAlign="center"></e-column>
          <e-column
            field="PayedAmount"
            width="110"
            headerText="{{ 'manageorder.Pay Amount' | translate }}"
            textAlign="center"></e-column>
          <e-column
            field="RemainingAmount"
            width="110"
            headerText="{{ 'Shared.RemainingPrice' | translate }}"
            textAlign="center"></e-column>
          <e-column headerText="{{ 'delivery.Actions' | translate }}" textAlign="center">
            <ng-template #template let-data>
              <div class="justify-content-center d-flex align-items-center">
                <button *ngIf="data.SubTotal"
                  style="min-width: fit-content !important"
                  (click)="openCashReceiptPopUp(data)"
                  type="button"
                  class="btn btn-success p-1 has-icon m-0">
                  {{ "CustomerOrder.cashreceipt" | translate }}
                </button>
                &nbsp;
                <button style="min-width: fit-content !important"
                  (click)="openOrderInsuranceComponent(data)" type="button"
                  class="btn btn-success p-1 has-icon m-0">
                  {{ "Reports.Insurance" | translate }}
                </button>
                &nbsp;

                <button *ngIf="data.PayedAmount"
                  style="min-width: fit-content !important"
                  (click)="openCashReceiptListPopUp(data)"
                  type="button"
                  class="btn btn-success p-1 has-icon m-0">
                  {{ "manageorder.PaymentDetails" | translate }}
                </button>
                &nbsp;

                <button *ngIf="this.dialogData?.isPopUp"
                  style="min-width: 40px !important"
                  type="button"
                  (click)="PrintReceipt(data)"
                  class="btn btn-info btnEdit m-0">
                  {{ "Shared.Show" | translate }}
                </button>
                &nbsp;
                <!-- <button style="min-width: 40px !important"
                  type="button"
                  (click)="PrintBundeldReceipt(data)"
                  class="btn btn-info btnEdit m-0">
                  {{ "Shared.ShowKot" | translate }}
                </button>
                &nbsp; -->
              </div>
            </ng-template>
          </e-column>
        </e-columns>
      </ejs-grid>
    </div>
  </div>
</div>

<!--CashReceipt-->

<div
  *ngIf="cashReceipt"
  class="modal fade modalPinCode"
  id="CashReceipt"
  tabindex="-1"
  role="dialog"
  aria-labelledby="CashReceipt"
  aria-hidden="true">
  <div class="modal-dialog" role="document" style="transform: translate(0, 50%)">
    <form (ngSubmit)="submitCashReceipt(frmCashReceipt)" #frmCashReceipt="ngForm" class="row">
      <div class="modal-content modal-content DetailsCustomer">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">
            {{ "Screens.CashReceipt" | translate }}
          </h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <div class="row d-flex justify-content-center align-items-center">
            <!-- CustomerName -->
            <div class="col-md-6 mb-3">
              <div class="row">
                <div class="col-md-4 d-flex justify-content-start align-items-center label1">
                  <label for="validationCustom19">
                    {{ "returninsurance.CustomerName" | translate }}
                  </label>
                </div>
                <div class="col-md-8 paddingLeftz">
                  <div class="input-group editInputGroup">
                    <div class="input-group-addon">
                      <i class="material-icons fs-16">input</i>
                    </div>
                    <div class="input-group">
                      <input
                        id="CustomerName"
                        type="text"
                        class="form-control"
                        name="CustomerName"
                        [(ngModel)]="cashReceipt.CustomerName"
                        #CustomerName="ngModel"
                        readonly />
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!--Date-->
            <div class="col-md-6 mb-3">
              <div class="row justify-content-start align-items-center">
                <div class="col-md-4">
                  <label for="validationCustom19"> {{ "CashReceipt.Date" | translate }} : </label>
                </div>
                <div class="col-md-8">
                  <div class="input-group editInputGroup">
                    <div class="input-group-addon">
                      <i class="fa fa-calendar" aria-hidden="true"></i>
                    </div>
                    <div class="input-group">
                      <ejs-datepicker
                        readonly
                        class="pAsolute absolutePosition form-control borderRadius"
                        format="dd/MM/yyyy"
                        name="Date"
                        #Date="ngModel"
                        [(ngModel)]="cashReceipt.Date"
                        class="form-control borderRadius Prelative"
                        id="Date"
                        placeholder="mm/dd/yyyy"></ejs-datepicker>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- Amount -->
            <div class="col-md-6 mb-3">
              <div class="row">
                <div class="col-md-4 d-flex justify-content-start align-items-center label1">
                  <label for="validationCustom19">
                    {{ "CashReceipt.lblamount" | translate }}
                  </label>
                </div>
                <div class="col-md-8 paddingLeftz">
                  <div class="input-group editInputGroup">
                    <div class="input-group-addon">
                      <i class="material-icons fs-16">input</i>
                    </div>
                    <div class="input-group">
                      <input
                        id="Amount"
                        type="text"
                        class="form-control"
                        name="Amount"
                        [(ngModel)]="cashReceipt.Amount"
                        #Amount="ngModel"
                        required />
                      <div
                        class="alert alert-danger editAlertCash"
                        *ngIf="(frmCashReceipt.submitted && Amount.invalid) || (Amount.invalid && Amount.touched)">
                        <div *ngIf="Amount.errors.required">{{ "Shared.required" | translate }}</div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

           <!--Select Pay Type-->
            <div class="col-md-6 mb-3">
              <div class="row pr-xs-0">
                <div class="col-md-4 d-flex justify-content-start align-items-center label1">
                  <label for="validationCustom19"> {{ "permission.PayTypes" | translate }} : </label>
                </div>
                <div class="col-md-8 paddingLeftz">
                  <div class="input-group editInputGroup">
                    <div class="input-group-addon">
                      <i class="fas fa-user" aria-hidden="true"></i>
                    </div>
                    <div class="input-group">
                      <ejs-combobox
                        name="PayTypeDocumentId"
                        #PayTypeDocumentId="ngModel"
                        [(ngModel)]="cashReceipt.PayTypeDocumentId"
                        [allowFiltering]="true"
                        [autofill]="true"
                        [dataSource]="orderPayTypes"
                        placeholder="{{ 'Dashboard.SelectPayType' | translate }}"
                        [fields]="payFlds"
                        class="form-control borderRadius"
                        [required]="true"></ejs-combobox>
                    </div>

                    <div class="alert alert-danger editAlertCash"
                          *ngIf="(frmCashReceipt.submitted && PayTypeDocumentId.invalid) || (PayTypeDocumentId.invalid && PayTypeDocumentId.touched)">
                          <div *ngIf="PayTypeDocumentId.errors.required">{{ "Shared.required" | translate }}</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
              <!-- Description -->
            <div class="col-md-6 mb-3">
              <div class="row">
                <div class="col-md-4 d-flex justify-content-start align-items-center label1">
                  <label for="validationCustom19">
                    {{ "CashReceipt.lbldescription" | translate }}
                  </label>
                </div>
                <div class="col-md-8 paddingLeftz">
                  <div class="input-group editInputGroup">
                    <div class="input-group-addon">
                      <i class="material-icons fs-16">input</i>
                    </div>
                    <div class="input-group">
                      <input
                        id="Description"
                        type="text"
                        class="form-control"
                        name="Description"
                        [(ngModel)]="cashReceipt.Description"
                        #Description="ngModel" />
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="col-md-6 mb-3"></div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">
            {{ "Shared.Close" | translate }}
          </button>
          <button type="submit" class="btn btn-primary">
            {{ "Shared.Save" | translate }}
          </button>
        </div>
      </div>
    </form>
  </div>
</div>
<!-- end CashReceipt-->

<!-- Report modal -->
<div class="modal fade" id="modal-5" tabindex="-1" role="dialog" aria-labelledby="modal-1">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header borderb">
        <h5 class="modal-title has-icon ms-icon-round orangeColor restaurantName4">
          <svg
            width="28px"
            height="27px"
            version="1.1"
            id="Layer_1"
            x="0px"
            y="0px"
            viewBox="0 0 512 512"
            style="enable-background: new 0 0 512 512"
            xml:space="preserve">
            <g>
              <g>
                <path
                  d="M324.267,366.933H187.733c-5.12,0-8.533,3.413-8.533,8.533s3.413,8.533,8.533,8.533h136.533
            c5.12,0,8.533-3.413,8.533-8.533S329.387,366.933,324.267,366.933z" />
              </g>
            </g>
            <g>
              <g>
                <path
                  d="M349.867,409.6H162.133c-5.12,0-8.533,3.413-8.533,8.533s3.413,8.533,8.533,8.533h187.733c5.12,0,8.533-3.413,8.533-8.533
            S354.987,409.6,349.867,409.6z" />
              </g>
            </g>
            <g>
              <g>
                <path
                  d="M375.467,452.267H136.533c-5.12,0-8.533,3.413-8.533,8.533c0,5.12,3.413,8.533,8.533,8.533h238.933
            c5.12,0,8.533-3.413,8.533-8.533C384,455.68,380.587,452.267,375.467,452.267z" />
              </g>
            </g>
            <g>
              <g>
                <path
                  d="M0,307.2v93.867c0,14.507,11.093,25.6,25.6,25.6h58.027l-12.8,64.853c-0.853,5.12,0,10.24,3.413,14.507
            S81.92,512,87.04,512h337.92c5.12,0,10.24-2.56,12.8-5.973c3.413-4.267,4.267-9.387,3.413-14.507l-12.8-64.853H486.4
            c14.507,0,25.6-11.093,25.6-25.6V307.2H0z M87.04,494.933l15.36-75.093l15.36-78.507h276.48l15.36,78.507l15.36,75.093H87.04z" />
              </g>
            </g>
            <g>
              <g>
                <path
                  d="M486.4,85.333h-59.733v102.4c0,23.893-18.773,42.667-42.667,42.667H128c-23.893,0-42.667-18.773-42.667-42.667v-102.4
            H25.6c-14.507,0-25.6,11.093-25.6,25.6v179.2h512v-179.2C512,96.427,500.907,85.333,486.4,85.333z" />
              </g>
            </g>
            <g>
              <g>
                <rect x="290.133px" y="145.067px" width="85.333px" height="34.133px" />
              </g>
            </g>
            <g>
              <g>
                <path
                  d="M401.067,85.333V17.067C401.067,7.68,393.387,0,384,0H128c-9.387,0-17.067,7.68-17.067,17.067v68.267H102.4v102.4
            c0,14.507,11.093,25.6,25.6,25.6h256c14.507,0,25.6-11.093,25.6-25.6v-102.4H401.067z M128,17.067h256v68.267H128V17.067z
            M392.533,187.733c0,5.12-3.413,8.533-8.533,8.533H281.6c-5.12,0-8.533-3.413-8.533-8.533v-51.2c0-5.12,3.413-8.533,8.533-8.533
            H384c5.12,0,8.533,3.413,8.533,8.533V187.733z" />
              </g>
            </g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
          </svg>
          <span class="px-2"> Printer Setting</span>
        </h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>

      <div class="modal-body">
        <form>
          <div class="row d-flex justify-content-center align-items-center">
            <div class="col-md-10 py-2">
              <div class="row justify-content-center align-items-center">
                <div class="col-md-3 d-flex justify-content-start align-items-center label1"></div>
              </div>
            </div>
          </div>
        </form>
        <div id="myviewer"></div>

        <div></div>
      </div>
    </div>
  </div>
</div>


<!-- Report modal -->
<div *ngIf="!cashReceiptOpen" class="modal fade" id="modal-2" tabindex="-1" role="dialog" aria-labelledby="modal-2">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header borderb">
        <h5 class="modal-title has-icon ms-icon-round orangeColor restaurantName4">
          <svg
            width="28px"
            height="27px"
            version="1.1"
            id="Layer_1"
            x="0px"
            y="0px"
            viewBox="0 0 512 512"
            style="enable-background: new 0 0 512 512"
            xml:space="preserve">
            <g>
              <g>
                <path
                  d="M324.267,366.933H187.733c-5.12,0-8.533,3.413-8.533,8.533s3.413,8.533,8.533,8.533h136.533
      c5.12,0,8.533-3.413,8.533-8.533S329.387,366.933,324.267,366.933z" />
              </g>
            </g>
            <g>
              <g>
                <path
                  d="M349.867,409.6H162.133c-5.12,0-8.533,3.413-8.533,8.533s3.413,8.533,8.533,8.533h187.733c5.12,0,8.533-3.413,8.533-8.533
      S354.987,409.6,349.867,409.6z" />
              </g>
            </g>
            <g>
              <g>
                <path
                  d="M375.467,452.267H136.533c-5.12,0-8.533,3.413-8.533,8.533c0,5.12,3.413,8.533,8.533,8.533h238.933
      c5.12,0,8.533-3.413,8.533-8.533C384,455.68,380.587,452.267,375.467,452.267z" />
              </g>
            </g>
            <g>
              <g>
                <path
                  d="M0,307.2v93.867c0,14.507,11.093,25.6,25.6,25.6h58.027l-12.8,64.853c-0.853,5.12,0,10.24,3.413,14.507
      S81.92,512,87.04,512h337.92c5.12,0,10.24-2.56,12.8-5.973c3.413-4.267,4.267-9.387,3.413-14.507l-12.8-64.853H486.4
      c14.507,0,25.6-11.093,25.6-25.6V307.2H0z M87.04,494.933l15.36-75.093l15.36-78.507h276.48l15.36,78.507l15.36,75.093H87.04z" />
              </g>
            </g>
            <g>
              <g>
                <path
                  d="M486.4,85.333h-59.733v102.4c0,23.893-18.773,42.667-42.667,42.667H128c-23.893,0-42.667-18.773-42.667-42.667v-102.4
      H25.6c-14.507,0-25.6,11.093-25.6,25.6v179.2h512v-179.2C512,96.427,500.907,85.333,486.4,85.333z" />
              </g>
            </g>
            <g>
              <g>
                <rect x="290.133px" y="145.067px" width="85.333px" height="34.133px" />
              </g>
            </g>
            <g>
              <g>
                <path
                  d="M401.067,85.333V17.067C401.067,7.68,393.387,0,384,0H128c-9.387,0-17.067,7.68-17.067,17.067v68.267H102.4v102.4
      c0,14.507,11.093,25.6,25.6,25.6h256c14.507,0,25.6-11.093,25.6-25.6v-102.4H401.067z M128,17.067h256v68.267H128V17.067z
        M392.533,187.733c0,5.12-3.413,8.533-8.533,8.533H281.6c-5.12,0-8.533-3.413-8.533-8.533v-51.2c0-5.12,3.413-8.533,8.533-8.533
      H384c5.12,0,8.533,3.413,8.533,8.533V187.733z" />
              </g>
            </g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
            <g></g>
          </svg>
          <span class="px-2"> {{ "setting.PrinterSettings" | translate }}</span>
        </h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>

      <div class="modal-body" >
        <form #frmPrint="ngForm" (ngSubmit)="submitData(frmPrint)">
          <div class="row d-flex justify-content-center align-items-center">
            <div class="col-md-10 py-2">
              <div class="row justify-content-center align-items-center">
                <div class="col-md-3 d-flex justify-content-start align-items-center label1">
                  <span class="required-asterisk" style="font-size: 22px; font-weight: bold"> * </span>
                  <label for="language" style="margin-left: 6px">
                    <h6 class="m-0">{{ "Layout.Laguage" | translate }}</h6>
                  </label>
                </div>
                <div class="col-md-8 paddingLeftz">
                  <ejs-combobox
                    name="LanguageId"
                    #LanguageId="ngModel"
                    [(ngModel)]="printDetailobj.LanguageId"
                    id="language_id"
                    [dataSource]="languages"
                    [autofill]="true"
                    [allowFiltering]="true"
                    required
                    (change)="setReport($event)"
                    placeholder="Select Language"
                    [fields]="fields"
                    [(value)]="combovalLanguage">
                  </ejs-combobox>
                </div>
                <div
                  class="alert text-danger"
                  *ngIf="(!LanguageId.valid && LanguageId.touched) || (frmPrint.submitted && LanguageId.invalid)">
                  <div class="alert-danger" *ngIf="LanguageId.errors.required">
                    {{ "Shared.LanguageisRequired" | translate }}
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="modal-footer p-1">
            <button type="button" class="btn btn-light mt-0 btnEdit" data-dismiss="modal">
              {{ "Shared.Close" | translate }}
            </button>
          </div>
        </form>
        <div id="viewer"></div>

        <div></div>
      </div>
    </div>
  </div>
</div>
<!--end Report Modal-->
