<app-breadcrumbs></app-breadcrumbs>
<form name="Promoform" class="" #frmRef="ngForm" (ngSubmit)="(frmRef.form.valid)" novalidate>
  <app-pagetransactions (afterPag)="afterPag($event)" (quickEvents)="quickEvents($event)" [request]="request"
    [form]="frmRef" [service]="service" [formobj]="responseobj" [pagename]="pagename"
    [pageNumber]="pageNumber"></app-pagetransactions>

  <div class="col-md-12">
    <div class="ms-panel-fh">
      <div class="cont">
        <div class="ms-panel-body-1 clearfix">
          <div style="background: #fff" class="tab-content ms-panel">
            <div role="tabpanel" class="tab-pane active show fade in" id="tab133">
              <div class="col-xl-12 col-md-12 col-xs-12">
                <div class="p-2 row">
                  <div class="col-md-12">
                    <div class="row align-items-center">
                      <!--name-->
                      <div class="col-md-6 mb-3">
                        <div class="row">
                          <div class="col-md-3 d-flex justify-content-start align-items-center label1">
                            <label for="validationCustom19"> {{ "Shared.Description" | translate }} : </label>
                          </div>
                          <div class="col-md-8 paddingLeftz">
                            <div class="input-group editInputGroup">
                              <div class="input-group-addon">
                                <i class="fas fa-user fs-16"></i>
                              </div>
                              <div class="input-group">
                                <input type="text" placeholder="" name="Name" #Name="ngModel"
                                  [(ngModel)]="responseobj.Name" id="name_id" class="form-control borderRadius" disabled
                                  required />
                                <div *ngIf="(frmRef.submitted && Name.invalid) || (Name.invalid && Name.touched)">
                                  <div class="alert alert-danger editAlertCash" *ngIf="Name.errors.required">
                                    {{ "pointofsale.DiscriptionsIsRequired" | translate }}
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <!--ForeignName-->
                      <div class="col-md-6 mb-3">
                        <div class="row">
                          <div class="col-md-3 d-flex justify-content-start align-items-center label1">
                            <label for="validationCustom19"> {{ "Shared.ForeignDescription" | translate }} : </label>
                          </div>
                          <div class="col-md-8 paddingLeftz">
                            <div class="input-group editInputGroup">
                              <div class="input-group-addon">
                                <i class="fas fa-user fs-16"></i>
                              </div>
                              <div class="input-group">
                                <input type="text" placeholder="Foreign Name" placeholder=" " name="ForeignName"
                                  #ForeignName="ngModel" [(ngModel)]="responseobj.ForeignName" id="ForeignName_id"
                                  disabled class="form-control borderRadius" />
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <!--PromoValueType-->
                      <div class="col-md-6 mb-3">
                        <div class="row">
                          <div class="col-md-3 d-flex justify-content-start align-items-center label1">
                            <label for="validationCustom19"> {{ "Shared.PromoType" | translate }} : </label>
                          </div>
                          <div class="col-md-8 paddingLeftz">
                            <div class="input-group editInputGroup">
                              <div class="input-group-addon">
                                <i class="fas fa-user fs-16"></i>
                              </div>
                              <!-- [enabled]="false" -->
                              <div class="input-group">
                                <ejs-combobox name="ValueType" #ValueType="ngModel" [(ngModel)]="responseobj.ValueType"
                                  [allowFiltering]="true" [autofill]="true" [allowCustom]="false"
                                  [dataSource]="responseobj.PromoValueList" placeholder="" [fields]="Flds"
                                  class="form-control borderRadius" id="ValueType_id" (change)="setPromoType($event)"
                                  [enabled]="false" required></ejs-combobox>
                              </div>
                              <div class="" *ngIf="
                                  (frmRef.submitted && ValueType.invalid) || (ValueType.invalid && ValueType.touched)
                                ">
                                <div class="alert alert-danger editAlertCash" *ngIf="ValueType.errors.required">
                                  {{ "Shared.Promotypeisrequired" | translate }}
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <!--Value-->
                      <div class="col-md-6 mb-3" *ngIf="responseobj.ValueType != 5">
                        <div class="row">
                          <div class="col-md-3 d-flex justify-content-start align-items-center label1">
                            <label for="validationCustom19"> {{ "Shared.PercentageValue" | translate }} : </label>
                          </div>
                          <div class="col-md-8 paddingLeftz">
                            <div class="input-group editInputGroup">
                              <div class="input-group-addon">
                                <i class="fas fa-user fs-16"></i>
                              </div>
                              <div class="input-group">
                                <input [numbersOnly]="responseobj.Value" [allowDecimals]="false" name="Value"
                                  #Value="ngModel" [(ngModel)]="responseobj.Value" id="value_id"
                                  [disabled]="responseobj.ValueType == 3" class="form-control borderRadius" required />

                                <div *ngIf="(frmRef.submitted && Value.invalid) || (Value.invalid && Value.touched)">
                                  <div class="alert alert-danger editAlertCash" *ngIf="Value.errors.required">
                                    {{ "Shared.Percentagerequired" | translate }}
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <!--Fromdate-->
                      <div class="col-md-6 mb-3">
                        <div class="row">
                          <div class="col-md-3 d-flex justify-content-start align-items-center label1">
                            <label for="validationCustom19"> {{ "Reports.Fromdate" | translate }} : </label>
                          </div>
                          <div class="col-md-8 paddingLeftz">
                            <div class="input-group editInputGroup">
                              <div class="input-group-addon">
                                <i class="bi bi-calendar-check"></i>
                              </div>
                              <div class="input-group">
                                <ejs-datepicker class="pAsolute absolutePosition" format="dd/MM/yyyy" name="FromDate"
                                  #FromDate="ngModel" [(ngModel)]="responseobj.FromDate" [ngClass]="{
                                    'is-invalid': frmRef.submitted && FromDate.invalid
                                  }" class="form-control borderRadius Prelative" id="FromDate" placeholder="mm/dd/yyyy"
                                  [enabled]="false"></ejs-datepicker>
                              </div>
                              <div class="" *ngIf="
                                  (frmRef.submitted && FromDate.invalid) || (FromDate.invalid && FromDate.touched)
                                ">
                                <div class="alert alert-danger editAlertCash" *ngIf="FromDate.errors.required">
                                  {{ "ExtraExpenses.DateIsRequired" | translate }}
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <!-- ToDate -->
                      <div class="col-md-6 mb-3">
                        <div class="row">
                          <div class="col-md-3 d-flex justify-content-start align-items-center label1">
                            <label for="validationCustom19"> {{ "Reports.Todate" | translate }} : </label>
                          </div>
                          <div class="col-md-8 paddingLeftz">
                            <div class="input-group editInputGroup">
                              <div class="input-group-addon">
                                <i class="bi bi-calendar-check"></i>
                              </div>
                              <div class="input-group">
                                <ejs-datepicker class="pAsolute absolutePosition" format="dd/MM/yyyy" name="ToDate"
                                  #ToDate="ngModel" [(ngModel)]="responseobj.ToDate" [ngClass]="{
                                    'is-invalid': frmRef.submitted && ToDate.invalid
                                  }" class="form-control borderRadius Prelative" id="ToDate" placeholder="mm/dd/yyyy"
                                  [enabled]="false" [required]="isRequired"></ejs-datepicker>
                              </div>
                              <div class=""
                                *ngIf="(frmRef.submitted && ToDate.invalid) || (ToDate.invalid && ToDate.touched)">
                                <div class="alert alert-danger editAlertCash" *ngIf="ToDate.errors.required">
                                  {{ "ExtraExpenses.DateIsRequired" | translate }}
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <!--FromTime-->
                      <div class="col-md-6 mb-3">
                        <div class="row">
                          <div class="col-md-3 d-flex justify-content-start align-items-center label1">
                            <label for="validationCustom19"> {{ "Reports.FromTime" | translate }} : </label>
                          </div>
                          <div class="col-md-8 paddingLeftz">
                            <div class="input-group editInputGroup">
                              <div class="input-group-addon">
                                <i class="bi bi-clock"></i>
                              </div>
                              <div class="input-group">
                                <input type="time" class="form-control borderRadius" disabled required name="FromTime"
                                  #FromTime="ngModel" placeholder="FromTime" [(ngModel)]="responseobj.FromTime" />
                                <div *ngIf="
                                    (frmRef.submitted && FromTime.invalid) || (FromTime.invalid && FromTime.touched)
                                  ">
                                  <div class="alert alert-danger editAlertCash" *ngIf="FromTime.errors.required">
                                    {{ "setting.TimeISRequired" | translate }}
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <!-- ToTime -->
                      <div class="col-md-6 mb-3">
                        <div class="row">
                          <div class="col-md-3 d-flex justify-content-start align-items-center label1">
                            <label for="validationCustom19"> {{ "Reports.ToTime" | translate }} : </label>
                          </div>
                          <div class="col-md-8 paddingLeftz">
                            <div class="input-group editInputGroup">
                              <div class="input-group-addon">
                                <i class="bi bi-clock"></i>
                              </div>
                              <div class="input-group">
                                <input type="time" class="form-control borderRadius" disabled required name="ToTime"
                                  #ToTime="ngModel" placeholder="ToTime" [(ngModel)]="responseobj.ToTime" />
                                <div *ngIf="(frmRef.submitted && ToTime.invalid) || (ToTime.invalid && ToTime.touched)">
                                  <div class="alert alert-danger editAlertCash" *ngIf="ToTime.errors.required">
                                    {{ "setting.TimeISRequired" | translate }}
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <!--PaymentTypes-->
                      <!-- <div class="col-md-6 mb-3">
                        <div class="row">
                          <div class="col-md-3 d-flex justify-content-start align-items-center label1">
                            <label for="validationCustom19">
                              {{ "Shared.effectedForPaymentTypes" | translate }}
                              :
                            </label>
                          </div>
                          <div class="col-md-8 paddingLeftz">
                            <div class="input-group editInputGroup">
                              <div class="input-group-addon">
                                <i class="bi bi-credit-card-2-back-fill"></i>
                              </div>
                              <div class="input-group">
                                <ejs-multiselect
                                  name="PayTypesList"
                                  #PayTypesList="ngModel"
                                  [(ngModel)]="responseobj.PayTypesList"
                                  [dataSource]="responseobj.PaymentTypes"
                                  [fields]="PaymentTypeFld"
                                  class="form-control"
                                  placeholder=""
                                  [enabled]="false"></ejs-multiselect>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div> -->
                      <!--OrderTypes'-->
                      <div class="col-md-6 mb-3" *ngIf="OrderTypeList">
                        <div class="row">
                          <div class="col-md-3 d-flex justify-content-start align-items-center label1">
                            <label for="validationCustom19"> {{ "Shared.effectedForOrderTypes" | translate }} : </label>
                          </div>
                          <div class="col-md-8 paddingLeftz">
                            <div class="input-group editInputGroup">
                              <div class="input-group-addon">
                                <i class="bi bi-credit-card-2-back-fill"></i>
                              </div>
                              <div class="input-group">
                                <ejs-multiselect name="OrderTypesList" #OrderTypesList="ngModel"
                                  [(ngModel)]="responseobj.OrderTypesList" [dataSource]="OrderTypeList"
                                  [fields]="PaymentTypeFld" class="form-control" placeholder="" 
                                  [enabled]="false" required></ejs-multiselect>
                                  <div
                                  *ngIf="
                                    (frmRef.submitted && OrderTypesList.invalid) ||
                                    (OrderTypesList.invalid && OrderTypesList.touched)
                                  ">
                                  <div class="alert alert-danger editAlertCash" *ngIf="OrderTypesList.errors.required">
                                    {{ "setting.OrderTypeIsRequired" | translate }}
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <!--OrderPayTypes'-->
                      <div class="col-md-6 mb-3" *ngIf="OrderPayTypeList && responseobj.ValueType !=3 && responseobj.ValueType !=5">
                        <div class="row">
                          <div class="col-md-3 d-flex justify-content-start align-items-center label1">
                            <label for="validationCustom19"> {{ "Shared.effectedForPaymentTypes" | translate }} : </label>
                          </div>
                          <div class="col-md-8 paddingLeftz">
                            <div class="input-group editInputGroup">
                              <div class="input-group-addon">
                                <i class="bi bi-credit-card-2-back-fill"></i>
                              </div>
                              <div class="input-group">
                                <ejs-multiselect name="OrderPayTypesList" #OrderPayTypesList="ngModel"
                                  [(ngModel)]="responseobj.OrderPayTypesList" [dataSource]="OrderPayTypeList"
                                  [fields]="PaymentTypeFld" class="form-control" placeholder="" 
                                  [enabled]="false"></ejs-multiselect>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>

                      <!--Branches'-->
                      <div class="col-md-6 mb-3" *ngIf="BranchList">
                        <div class="row">
                          <div class="col-md-3 d-flex justify-content-start align-items-center label1">
                            <label for="validationCustom19"> {{ "Shared.effectedForBranches" | translate }} : </label>
                          </div>
                          <div class="col-md-8 paddingLeftz">
                            <div class="input-group editInputGroup">
                              <div class="input-group-addon">
                                <i class="bi bi-credit-card-2-back-fill"></i>
                              </div>
                              <div class="input-group">
                                <ejs-multiselect name="BranchesList" #BranchesList="ngModel"
                                  [(ngModel)]="responseobj.BranchesList" [dataSource]="BranchList"
                                  [fields]="PaymentTypeFld" class="form-control" placeholder="" 
                                  [enabled]="false" required></ejs-multiselect>
                                  <div
                                  *ngIf="(frmRef.submitted && BranchesList.invalid) || (BranchesList.invalid && BranchesList.touched)">
                                  <div class="alert alert-danger editAlertCash" *ngIf="BranchesList.errors.required">
                                    {{ "setting.BranchIsRequired" | translate }}
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>

                      <!--PromoDays'-->
                      <div class="col-md-6 mb-3">
                        <div class="row">
                          <div class="col-md-8 paddingLeftz">
                            <div class="input-group editInputGroup">
                              <div class="input-group">
                                <button class="btn btn-primary" (click)="CheckPromoDays()" [disabled]="!disabledflag">
                                  {{ "Shared.CheckPromoDays" | translate }}
                                </button>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <!--CustomPromoFiltter' -->
                      <div class="col-md-6 mb-3" *ngIf="showCustomProduct">
                        <div class="row">
                          <div class="col-md-8 paddingLeftz">
                            <div class="input-group editInputGroup">
                              <div class="input-group">
                                <button class="btn btn-primary" (click)="FiltterPromoProducts()" [disabled]="!disabledflag">
                                  {{ "Shared.Filtter" | translate }}
                                </button>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col row d-flex pr-xs-0" *ngIf="showCustomProduct">
                        <div class="col-md-4 d-flex justify-content-start align-items-center label1">
                          <label for="UseNewPriceAndPercentage">{{ "Shared.UseNewPriceAndPercentage" | translate }}:</label>
                        </div>
                        <div class="col-md-8 paddingLeftz">
                          <div class="input-group">
                            <input
                              type="checkbox" id="UseNewPriceAndPercentage"
                              #UseNewPriceAndPercentage="ngModel" name="UseNewPriceAndPercentage" [(ngModel)]="responseobj.UseNewPriceAndPercentage"
                              class="form-control borderRadius"
                              [disabled]="!disabledflag" />
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-12" *ngIf="responseobj.ValueType == 3">
                    <div class="value-type-three-list">
                      <div class="value-type-three-list__header">
                        <div>
                          <h5 class="value-type-three-list__title">{{ "Shared.promolist" | translate }}</h5>
                        </div>
                        <button class="btn btn-outline-primary" type="button" (click)="addValueTypeThreeRow()" [disabled]="!disabledflag">
                          <i class="fas fa-plus mr-1"></i>{{ "Shared.AddDetail" | translate }}
                        </button>
                      </div>
                      <div class="value-type-three-list__items" *ngIf="newProductList?.length; else emptyValueTypeThree">
                        <div class="offer-card" *ngFor="let detail of paginatedData; index as i">
                          <div class="offer-card__header">
                            <div class="offer-card__title">
                              <label class="ms-checkbox-wrap ms-todo-complete offer-card__checkbox">
                                <input type="checkbox" name="ValueTypeThreeIsChecked{{i}}" [disabled]="!disabledflag"
                                  [(ngModel)]="detail.IsChecked" class="form-control borderRadius" />
                              </label>
                              <input type="text" class="form-control borderRadius offer-card__description"
                                name="ValueTypeThreePromoDiscritpion{{i}}"
                                [(ngModel)]="detail.PromoDiscritpion"
                                [placeholder]="('Shared.Description' | translate)" [disabled]="!disabledflag" />
                            </div>
                            <div class="offer-card__actions">
                              <button class="btn btn-warning btnNav offer-card__action" type="button"
                                (click)="openValueTypeThreeModal(detail)" [disabled]="!disabledflag">
                                <i class="fa bi bi-pencil-fill"></i>
                              </button>
                              <button class="btn btn-outline-danger btnNav offer-card__action" type="button"
                                (click)="removeValueTypeThreeRow(detail)" [disabled]="!disabledflag">
                                <i class="fa bi bi-trash-fill"></i>
                              </button>
                            </div>
                          </div>
                          <div class="offer-card__body">
                            <div class="offer-card__column">
                              <div class="offer-card__label">{{ 'Shared.Take' | translate }}</div>
                              <div class="offer-card__value">{{ detail.takeProductsPreview || ('Shared.Select' | translate) }}</div>
                            </div>
                            <div class="offer-card__column">
                              <div class="offer-card__label">{{ 'Shared.Get' | translate }}</div>
                              <div class="offer-card__value">{{ detail.freeProductsPreview || ('Shared.Select' | translate) }}</div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <ng-template #emptyValueTypeThree>
                        <div class="value-type-three-list__empty text-center text-muted py-4">
                          <!-- {{ "Shared.NoData" | translate }} -->
                        </div>
                      </ng-template>
                    </div>
                  </div>
                  <div class="col-md-12"
                    *ngIf="responseobj.ValueType && responseobj.ValueType != 1 && responseobj.ValueType != 3 && responseobj.ValueType != 5">
                    <div class="paddingLeftz">
                      <div class="input-group editInputGroup">
                        <table class="table returnOrderTable table-bordered m-0 meals-table table-section">
                          <thead>
                            <tr>
                              <th scope="col" class="th-1">
                                {{ "Shared.SelectAll" | translate }}
                              </th>
                              <th scope="col">
                                {{ "Reports.ProductGroups" | translate }}
                              </th>
                              <th scope="col">
                                {{ "products.Product" | translate }}
                              </th>
                              <th scope="col" *ngIf="responseobj.ValueType ==5">
                                {{ "Shared.CustomPrice" | translate }}
                              </th>
                              <th scope="col" *ngIf="showCustomProduct == true">
                                {{ "stock.Quantity" | translate }}
                              </th>
                              <th scope="col" *ngIf="showCustomProduct == true  && !responseobj.UseNewPriceAndPercentage">
                                {{ "stock.OfferProduct" | translate }}
                              </th>
                              <th scope="col" *ngIf="showCustomProduct == true ">
                                {{ "stock.OfferQuntity" | translate }}
                              </th>
                              <th scope="col" *ngIf="responseobj.UseNewPriceAndPercentage">
                              </th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr>
                              <td>
                                <input type="checkbox" [disabled]="!disabledflag" name="SelectAll" #SelectAll="ngModel"
                                  id="SelectAll" [(ngModel)]="responseobj.SelectAll" (change)="SelectAllEvent($event)"
                                  class="form-control borderRadius" />
                              </td>
                              <td>
                                <input type="text" [disabled]="!disabledflag" name="SelectProductGroups"
                                  #SelectProductGroups="ngModel" id="SelectProductGroups"
                                  (keyup)="searchProducts(SelectProductGroups.value, SelectProducts.value)"
                                  [(ngModel)]="responseobj.SelectProductGroups" class="form-control borderRadius" />
                              </td>
                              <td>
                                <input type="text" [disabled]="!disabledflag" name="SelectProducts"
                                  #SelectProducts="ngModel" id="SelectProducts"
                                  (keyup)="searchProducts(SelectProductGroups.value, SelectProducts.value)"
                                  [(ngModel)]="responseobj.SelectProducts" class="form-control borderRadius" />
                              </td>
                            </tr>
                            <tr *ngFor="let detail of paginatedData; index as i">
                              <td>
                                <label class="ms-checkbox-wrap ms-todo-complete">
                                  <input type="checkbox" [disabled]="!disabledflag" name="IsChecked{{ i }}"
                                    #IsChecked="ngModel" id="IsChecked" [(ngModel)]="detail.IsChecked"
                                    class="form-control borderRadius" />
                                </label>
                              </td>
                              <td>
                                <input type="text" class="form-control borderRadius" name="TakeProductGroupName{{ i }}"
                                  [value]="detail.TakeProductGroupName" readonly />
                              </td>
                              <td>
                                <input type="text" class="form-control borderRadius" name="TakeProductName{{ i }}"
                                  [value]="detail.TakeProductName" readonly />
                              </td>
                              <td *ngIf="responseobj.ValueType ==5">
                                <input type="number" class="form-control borderRadius" name="CustomPrice{{ i }}"
                                [(ngModel)]="detail.CustomPrice" [disabled]="!disabledflag" />
                              </td>
                              <td *ngIf="showCustomProduct == true">
                                <input type="number" name="TakeProductQuantity{{ i }}" #TakeProductQuantity="ngModel"
                                  id="TakeProductQuantity" [(ngModel)]="detail.TakeProductQuantity"
                                  class="form-control borderRadius" [disabled]="!disabledflag" />
                              </td>
                              <td *ngIf="showCustomProduct == true  && !responseobj.UseNewPriceAndPercentage">
                                <ejs-multiselect 
                                  name="selectedTakeProductsDocumentId{{ i }}" #selectedTakeProductsDocumentId="ngModel"
                                  [(ngModel)]="detail.selectedTakeProductsDocumentId"
                                  [dataSource]="productsLockUp"
                                  (ngModelChange)="GetProductDocumentIdChange(detail)"
                                  [fields]="ProductFId" class="form-control" placeholder=""
                                  [enabled]="disabledflag"></ejs-multiselect>
                              </td>
                              <td *ngIf="showCustomProduct == true ">
                                <input type="number" name="GetProductQuantity{{ i }}" #GetProductQuantity="ngModel"
                                  id="GetProductQuantity" [(ngModel)]="detail.GetProductQuantity"
                                  class="form-control borderRadius" [disabled]="!disabledflag" />
                              </td>
                              <td  *ngIf="showCustomProduct == true && responseobj.UseNewPriceAndPercentage">
                                <button class="btn btn-primary" (click)="showAddPromoCustomProductDetails(detail)" [disabled]="!detail?.IsChecked || !disabledflag">
                                  {{ "Shared.Filtter" | translate }}
                                </button>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                      <div class="row d-flex align-items-baseline">
                        <div class="form-group col-3 d-flex align-items-baseline">
                          <label class="col-7" for="itemsPerPage">{{"Shared.ItemsPerPage" | translate}}</label>
                          <select class="form-control col-5" id="itemsPerPage" [(ngModel)]="itemsPerPage"
                            [ngModelOptions]="{standalone: true}" (ngModelChange)="setCurrentPage()">
                            <option *ngFor="let option of itemsPerPageOptions" [value]="option">{{ option }}</option>
                          </select>
                        </div>
                        <pagination style="justify-content: flex-end" [maxSize]="6" (pageChanged)="pageChanged($event)"
                          [boundaryLinks]="true" [itemsPerPage]="itemsPerPage" [totalItems]="newProductList.length"
                          previousText="{{ 'Shared.Previous' | translate }}" nextText="{{ 'Shared.Next' | translate }}"
                          firstText="{{ 'Shared.First' | translate }}" lastText="{{ 'Shared.Last' | translate }}">
                        </pagination>
                      </div>
                    </div>
                  </div>
                  <!-- New grouped UI for ValueType 1 or 5 -->
                  <div class="col-md-12" *ngIf="responseobj.ValueType == 1 || responseobj.ValueType == 5">
                    <div class="paddingLeftz">
                      <div class="input-group editInputGroup">
                        <table class="table returnOrderTable table-bordered m-0 meals-table table-section">
                          <thead>
                            <tr>
                              <th scope="col" style="width: 120px;">{{ 'Shared.Select' | translate }}</th>
                              <th scope="col">{{ "Reports.ProductGroups" | translate }}</th>
                              <th scope="col" style="width: 260px;">{{ "stock.Actions" | translate }}</th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr *ngFor="let g of groupedByGroup; index as gi">
                              <td>
                                <label class="ms-checkbox-wrap ms-todo-complete">
                                  <input type="checkbox" name="GroupSelected{{gi}}" id="GroupSelected{{gi}}"
                                    class="form-control borderRadius" [checked]="g.isGroupSelected"
                                    (change)="toggleGroupSelection(g, $event)" [disabled]="!disabledflag" />
                                </label>
                              </td>
                              <td>
                                <input type="text" class="form-control borderRadius" [value]="g.groupName" readonly />
                              </td>
                              <td class="group-actions">
                                <div class="group-actions__status" [title]="(g.selectedCount||0) + ' / ' + (g.totalCount||0) + ' selected'">
                                  <span class="chip"
                                    [ngClass]="{
                                      'chip--success': g.selectedCount === g.totalCount && g.totalCount > 0,
                                      'chip--warning': g.selectedCount > 0 && g.selectedCount < g.totalCount,
                                      'chip--muted': !g.selectedCount
                                    }">
                                    <span class="chip__dot"></span>
                                    <span class="chip__label">
                                      {{ g.selectedCount === g.totalCount && g.totalCount > 0 ? ("Shared.AllSelected" | translate) : (g.selectedCount > 0 ? ("Shared.SomeSelected" | translate) : ("Shared.NoneSelected" | translate)) }}
                                    </span>
                                  </span>
                                  <div class="mini-progress" *ngIf="g.totalCount">
                                    <div class="mini-progress__bar" [style.width.%]="(g.selectedCount||0) * 100 / (g.totalCount || 1)"></div>
                                  </div>
                                </div>
                                <button class="btn btn-outline-primary btn-sm" (click)="openGroupProductsModal(g)" [disabled]="!disabledflag || !g.isGroupSelected">
                                  {{ "Shared.SelectPromoProducts" | translate }}
                                </button>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</form>

<!-- WorkDays -->

<div class="modal fade" id="modal-WorkDays" tabindex="-1" role="dialog" aria-labelledby="modal-1">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="ms-card-title m-0">
          {{ "Shared.CheckPromoDays" | translate }}
        </h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>

      <div class="modal-body">
        <!-- Table -->
        <div class="col-md-12 paddingLeftz days-table">
          <table class="table returnOrderTable table-bordered m-0">
            <thead>
              <tr>
                <th scope="col">#</th>
                <th scope="col">{{ "Shared.isActive" | translate }}</th>
                <th scope="col">{{ "Shared.Day" | translate }}</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let detail of responseobj.WorkDays; index as i">
                <td scope="row">
                  {{ i + 1 }}
                </td>

                <td>
                  <label class="ms-checkbox-wrap ms-todo-complete">
                    <input type="checkbox" name="IsWork{{ i }}" #IsWork="ngModel" id="IsWork"
                      [(ngModel)]="detail.IsWork" class="form-control borderRadius" [disabled]="!disabledflag" />
                  </label>
                </td>
                <td>
                  <input type="text" class="form-control borderRadius" name="Name{{ i }}" [value]="detail.Name"
                    readonly />
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <div class="modal-footer">
        <button type="button" class="btn btn-light my-0" data-dismiss="modal">
          {{ "Shared.Close" | translate }}
        </button>
      </div>
    </div>
  </div>
</div>

<!-- ValueType 3 modal -->
<div class="modal fade" id="ValueTypeThreeModal" tabindex="-1" role="dialog" aria-labelledby="ValueTypeThreeModal">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="ms-card-title m-0">{{ selectedValueTypeThreeDetail?.PromoDiscritpion || ("Shared.Description" | translate) }}</h5>
        <button type="button" class="close" (click)="closeValueTypeThreeModal()"><span aria-hidden="true">&times;</span></button>
      </div>
      <div class="modal-body" *ngIf="selectedValueTypeThreeDetail">
        <div class="value-type-three-modal__section">
          <div class="value-type-three-modal__section-header">
            <h6 class="m-0">وجبات العرض</h6>
            <button class="btn btn-outline-primary btn-icon btn-sm" type="button" (click)="addValueTypeThreeTakeRow()" [disabled]="!disabledflag">
              <i class="fas fa-plus"></i>
            </button>
          </div>
          <div class="table-responsive value-type-three-modal__table">
            <table class="table returnOrderTable table-bordered m-0">
              <thead>
                <tr>
                  <th style="width:60px">#</th>
                  <th>{{ "products.Product" | translate }}</th>
                  <th style="width:150px">{{ "stock.Quantity" | translate }}</th>
                  <th style="width:60px"></th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let take of selectedValueTypeThreeDetail.TakeRows; index as ti">
                  <td>{{ ti + 1 }}</td>
                  <td>
                            <ejs-combobox [dataSource]="getTakeProductOptions(selectedValueTypeThreeDetail, take)" [fields]="ProductFId"
                      [(ngModel)]="take.SelectedProductKey" [ngModelOptions]="{standalone: true}"
                      (ngModelChange)="handleValueTypeThreeTakeProductChange(take)" class="form-control" [enabled]="disabledflag"></ejs-combobox>
                  </td>
                  <td>
                    <input type="number" class="form-control borderRadius" name="TakeRowQty{{ti}}"
                      [(ngModel)]="take.Quantity" min="1" [disabled]="!disabledflag" />
                  </td>
                  <td class="text-center">
                    <button class="btn btn-light btn-icon" type="button" (click)="removeValueTypeThreeTakeRow(ti)"
                      [disabled]="selectedValueTypeThreeDetail.TakeRows.length <= 1 || !disabledflag">
                      <i class="far fa-trash-alt"></i>
                    </button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        <div class="value-type-three-modal__section">
          <div class="value-type-three-modal__section-header">
            <h6 class="m-0">الوجبات المجانية</h6>
            <button class="btn btn-outline-primary btn-icon btn-sm" type="button" (click)="addValueTypeThreeFreeRow()" [disabled]="!disabledflag">
              <i class="fas fa-plus"></i>
            </button>
          </div>
          <div class="table-responsive value-type-three-modal__table">
            <table class="table returnOrderTable table-bordered m-0">
              <thead>
                <tr>
                  <th style="width:60px">#</th>
                  <th>{{ "products.Product" | translate }}</th>
                  <th style="width:150px">{{ "stock.Quantity" | translate }}</th>
                  <th style="width:150px">{{ "Order.enternewprice" | translate }}</th>
                  <th style="width:150px">{{ "CustomerOrder.DiscountPer" | translate }}</th>
                  <th style="width:60px"></th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let free of selectedValueTypeThreeDetail.FreeRows; index as fi">
                  <td>{{ fi + 1 }}</td>
                  <td>
                    <ejs-combobox [dataSource]="getFreeProductOptions(selectedValueTypeThreeDetail, free)" [fields]="ProductFId" [(ngModel)]="free.SelectedProductKey"
                      [ngModelOptions]="{standalone: true}"
                      (ngModelChange)="handleValueTypeThreeFreeProductChange(free)" class="form-control" [enabled]="disabledflag"></ejs-combobox>
                  </td>
                  <td>
                    <input type="number" class="form-control borderRadius" name="FreeRowQty{{fi}}"
                      [(ngModel)]="free.Quantity" min="1" [disabled]="!disabledflag" />
                  </td>
                  <td>
                    <input type="number" class="form-control borderRadius" name="FreeRowNewPrice{{fi}}"
                      [numbersOnly]="free.NewPrice" [(ngModel)]="free.NewPrice"
                      (ngModelChange)="handleValueTypeThreeRowPriceChange(free, 'NewPrice')"
                      [disabled]="!disabledflag || (free.DiscountPercentage || 0) > 0" />
                  </td>
                  <td>
                    <input type="number" class="form-control borderRadius" name="FreeRowDiscount{{fi}}"
                      [numbersOnly]="free.DiscountPercentage" [(ngModel)]="free.DiscountPercentage"
                      (keyup)="handleValueTypeThreeRowPriceChange(free, 'DiscountPercentage')"
                      [disabled]="!disabledflag || (free.NewPrice || 0) > 0" />
                  </td>
                  <td class="text-center">
                    <button class="btn btn-light btn-icon" type="button" (click)="removeValueTypeThreeFreeRow(fi)"
                      [disabled]="selectedValueTypeThreeDetail.FreeRows.length <= 1 || !disabledflag">
                      <i class="far fa-trash-alt"></i>
                    </button>
                  </td>
                </tr>
                <!-- <tr *ngIf="!selectedValueTypeThreeDetail.FreeRows?.length">
                  <td colspan="4" class="text-center text-muted">{{ "Shared.NoData" | translate }}</td>
                </tr> -->
              </tbody>
            </table>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary my-0" (click)="closeValueTypeThreeModal()">{{ "Shared.Ok" | translate }}</button>
        <button type="button" class="btn btn-light my-0" (click)="closeValueTypeThreeModal()">{{ "Shared.Close" | translate }}</button>
      </div>
    </div>
  </div>
</div>

<!-- FiltterPromoProducts -->

<div class="modal fade" id="FiltterPromoProducts" tabindex="-1" role="dialog" aria-labelledby="modal-1">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="ms-card-title m-0">{{ "Shared.Filtter" | translate }}</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>

      <div class="modal-body">
        <div class="row my-1">
          <div class="col-md-8">
            <label> {{ "Shared.IsCheckedOneForOne" | translate }}</label>
          </div>
          <div class="col-md-4">
            <label class="ms-checkbox-wrap ms-todo-complete">
              <input type="checkbox" [disabled]="!disabledflag" name="IsCheckedOneForOne" #IsCheckedOneForOne="ngModel"
                id="IsCheckedOneForOne" [(ngModel)]="FiltterObj.IsCheckedOneForOne" class="form-control borderRadius" />
            </label>
          </div>
        </div>
        <div class="col-md-12 paddingLeftz days-table">
          <table class="table returnOrderTable table-bordered m-0">
            <thead>
              <tr>
                <th scope="col">#</th>
                <th scope="col">{{ "Shared.isActive" | translate }}</th>
                <th scope="col">{{ "Reports.ProductGroups" | translate }}</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let G of FiltterObj.ProductGroupList; index as i">
                <td scope="row">
                  {{ i + 1 }}
                </td>

                <td>
                  <label class="ms-checkbox-wrap ms-todo-complete">
                    <input type="checkbox" name="IsSelectedProductGroup{{ i }}" #IsSelectedProductGroup="ngModel"
                      id="IsWork" [(ngModel)]="G.IsSelectedProductGroup" class="form-control borderRadius"
                      [disabled]="!disabledflag" />
                  </label>
                </td>
                <td>
                  <input type="text" class="form-control borderRadius" name="Name{{ i }}" [value]="G.Name" readonly />
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <div class="modal-footer">
        <button type="button" class="btn btn-light my-0" (click)="GetFiltterObj()">
          {{ "Shared.Ok" | translate }}
        </button>
        <button type="button" class="btn btn-light my-0" data-dismiss="modal">
          {{ "Shared.Close" | translate }}
        </button>
      </div>
    </div>
  </div>
</div>

<!-- addCustomProductDetails -->
<div class="modal fade" id="addCustomProductDetails" tabindex="-1" role="dialog" aria-labelledby="modal-1">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="ms-card-title m-0">{{ "Shared.Filtter" | translate }}</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>

      <div class="modal-body">
        <div class="row my-1">
          <div class="col-md-8">
            <label> {{ "Shared.UseNewPriceAndPercentage" | translate }}</label>
          </div>
            <div class="col-md-4">
                <button
                class="ms-btn-icon btn-pill btn-info"
                (click)="insertRow()">
                <i class="fas fa-plus"></i>
              </button>
            </div>
        </div>
        <div class="col-md-12 paddingLeftz days-table">
          <table class="table returnOrderTable table-bordered m-0">
            <thead>
              <tr>
                <th scope="col">#</th>
                <th scope="col" class="col-6">{{ "Reports.productName" | translate }}</th>
                <th scope="col">{{ "CustomerOrder.DiscountPer" | translate }}</th>
                <th scope="col">{{ "Order.enternewprice" | translate }}</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let p of takeProductNewList; index as i">
                <td scope="row">
                  {{ i + 1 }}
                </td>

                <td class="col-6">
                  <div class="input-group">
                    <ejs-combobox name="GetProductDocumentId{{ i }}" #GetProductDocumentId="ngModel" [(ngModel)]="p.GetProductDocumentId"
                      [allowFiltering]="true" [autofill]="true" [allowCustom]="false"
                      [(ngModel)]="p.selectedTakeProductDocumentId"
                      (ngModelChange)="GetProductDocumentIdChangeNewList(p)"
                      [dataSource]="productsLockUp" placeholder="" [fields]="ProductFId"
                      class="form-control borderRadius" id="selectProdcut_id" 
                        ></ejs-combobox>
                  </div>
                </td>
                <td>
                  <input type="number" class="form-control borderRadius" [disabled]="p.precentageDisabled"
                    (input)="p.newPriceDisabled = !!p.DiscountPercentage; p.NewPrice = undefined"
                  (keyup)="p.DiscountPercentage > 100 ? p.DiscountPercentage = 100 : p.DiscountPercentage"
                   #DiscountPercentage="ngModel" name="DiscountPercentage{{ i }}" [(ngModel)]="p.DiscountPercentage" />
                </td>
                <td>
                  <input  [disabled]="p.newPriceDisabled"
                  [numbersOnly]="p?.NewPrice" [allowDecimals]="true" 
                   class="form-control borderRadius" #NewPrice="ngModel" name="NewPrice{{ i }}" [(ngModel)]="p.NewPrice" 
                   (input)="p.precentageDisabled = !!p.NewPrice; p.DiscountPercentage = undefined" />
                </td>
                <td>
                  <button
                    (click)="deleteRow(i)"
                    class="btn btn-count far fa-trash-alt text-crosss p-0 bg-transparent"
                    style="
                      background-color: transparent !important;
                      border-color: transparent !important;
                    "
                    ></button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <div class="modal-footer">
        <button type="button" class="btn btn-primary my-0" (click)="showAddPromoCustomProductDetails(null)">
          {{ "Shared.Ok" | translate }}
        </button>
        <button type="button" class="btn btn-light my-0" data-dismiss="modal" (click)="clearDetail()">
          {{ "Shared.Close" | translate }}
        </button>
      </div>
    </div>
  </div>
</div>

<!-- GroupProductsModal: select products per group (for ValueType 1 or 5) -->
<div class="modal fade" id="GroupProductsModal" tabindex="-1" role="dialog" aria-labelledby="modal-1">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="ms-card-title m-0">{{ selectedGroup?.groupName }}</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <div class="col-md-12 paddingLeftz days-table">
          <table class="table returnOrderTable table-bordered m-0">
            <thead>
              <tr>
                <th scope="col" class="th-1">
                  <label class="ms-checkbox-wrap ms-todo-complete">
                    <input type="checkbox" name="GroupSelectAll" id="GroupSelectAll"
                      class="form-control borderRadius" [checked]="groupAllSelected"
                      (change)="toggleSelectAllInGroup($event)" [disabled]="!disabledflag" />
                  </label>
                </th>
                <th scope="col">{{ "products.Product" | translate }}</th>
                <th scope="col" *ngIf="responseobj.ValueType == 5">{{ "Shared.CustomPrice" | translate }}</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let p of selectedGroup?.products; index as i">
                <td>
                  <label class="ms-checkbox-wrap ms-todo-complete">
                    <input type="checkbox" name="IsCheckedGroup{{ i }}" id="IsCheckedGroup{{ i }}"
                      [(ngModel)]="p.IsChecked" (ngModelChange)="onGroupProductCheckedChange(selectedGroup)"
                      class="form-control borderRadius" [disabled]="!disabledflag" />
                  </label>
                </td>
                <td>
                  <input type="text" class="form-control borderRadius" [value]="p.TakeProductName" readonly />
                </td>
                <td *ngIf="responseobj.ValueType == 5">
                  <input type="number" class="form-control borderRadius" name="CustomPriceGroup{{ i }}"
                    [(ngModel)]="p.CustomPrice" [disabled]="!disabledflag" />
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary my-0" (click)="closeGroupProductsModal()">
          {{ "Shared.Ok" | translate }}
        </button>
        <button type="button" class="btn btn-light my-0" data-dismiss="modal">
          {{ "Shared.Close" | translate }}
        </button>
      </div>
    </div>
  </div>
  
</div>
